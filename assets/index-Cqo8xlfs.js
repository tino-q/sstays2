(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function i(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=i(a);fetch(a.href,c)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function getAugmentedNamespace(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var i=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(s).forEach(function(o){var a=Object.getOwnPropertyDescriptor(s,o);Object.defineProperty(i,o,a.get?a:{enumerable:!0,get:function(){return s[o]}})}),i}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(s){return s===null||typeof s!="object"?null:(s=z$1&&s[z$1]||s["@@iterator"],typeof s=="function"?s:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(s,e,i){this.props=s,this.context=e,this.refs=D$1,this.updater=i||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(s,e){if(typeof s!="object"&&typeof s!="function"&&s!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,s,e,"setState")};E$1.prototype.forceUpdate=function(s){this.updater.enqueueForceUpdate(this,s,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(s,e,i){this.props=s,this.context=e,this.refs=D$1,this.updater=i||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(s,e,i){var o,a={},c=null,d=null;if(e!=null)for(o in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(c=""+e.key),e)J.call(e,o)&&!L$1.hasOwnProperty(o)&&(a[o]=e[o]);var h=arguments.length-2;if(h===1)a.children=i;else if(1<h){for(var g=Array(h),_=0;_<h;_++)g[_]=arguments[_+2];a.children=g}if(s&&s.defaultProps)for(o in h=s.defaultProps,h)a[o]===void 0&&(a[o]=h[o]);return{$$typeof:l$1,type:s,key:c,ref:d,props:a,_owner:K$1.current}}function N$1(s,e){return{$$typeof:l$1,type:s.type,key:e,ref:s.ref,props:s.props,_owner:s._owner}}function O$1(s){return typeof s=="object"&&s!==null&&s.$$typeof===l$1}function escape$1(s){var e={"=":"=0",":":"=2"};return"$"+s.replace(/[=:]/g,function(i){return e[i]})}var P$1=/\/+/g;function Q$1(s,e){return typeof s=="object"&&s!==null&&s.key!=null?escape$1(""+s.key):e.toString(36)}function R$1(s,e,i,o,a){var c=typeof s;(c==="undefined"||c==="boolean")&&(s=null);var d=!1;if(s===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(s.$$typeof){case l$1:case n$1:d=!0}}if(d)return d=s,a=a(d),s=o===""?"."+Q$1(d,0):o,I$1(a)?(i="",s!=null&&(i=s.replace(P$1,"$&/")+"/"),R$1(a,e,i,"",function(_){return _})):a!=null&&(O$1(a)&&(a=N$1(a,i+(!a.key||d&&d.key===a.key?"":(""+a.key).replace(P$1,"$&/")+"/")+s)),e.push(a)),1;if(d=0,o=o===""?".":o+":",I$1(s))for(var h=0;h<s.length;h++){c=s[h];var g=o+Q$1(c,h);d+=R$1(c,e,i,g,a)}else if(g=A$1(s),typeof g=="function")for(s=g.call(s),h=0;!(c=s.next()).done;)c=c.value,g=o+Q$1(c,h++),d+=R$1(c,e,i,g,a);else if(c==="object")throw e=String(s),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function S$1(s,e,i){if(s==null)return s;var o=[],a=0;return R$1(s,o,"","",function(c){return e.call(i,c,a++)}),o}function T$1(s){if(s._status===-1){var e=s._result;e=e(),e.then(function(i){(s._status===0||s._status===-1)&&(s._status=1,s._result=i)},function(i){(s._status===0||s._status===-1)&&(s._status=2,s._result=i)}),s._status===-1&&(s._status=0,s._result=e)}if(s._status===1)return s._result.default;throw s._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(s,e,i){S$1(s,function(){e.apply(this,arguments)},i)},count:function(s){var e=0;return S$1(s,function(){e++}),e},toArray:function(s){return S$1(s,function(e){return e})||[]},only:function(s){if(!O$1(s))throw Error("React.Children.only expected to receive a single React element child.");return s}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(s,e,i){if(s==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+s+".");var o=C$1({},s.props),a=s.key,c=s.ref,d=s._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,d=K$1.current),e.key!==void 0&&(a=""+e.key),s.type&&s.type.defaultProps)var h=s.type.defaultProps;for(g in e)J.call(e,g)&&!L$1.hasOwnProperty(g)&&(o[g]=e[g]===void 0&&h!==void 0?h[g]:e[g])}var g=arguments.length-2;if(g===1)o.children=i;else if(1<g){h=Array(g);for(var _=0;_<g;_++)h[_]=arguments[_+2];o.children=h}return{$$typeof:l$1,type:s.type,key:a,ref:c,props:o,_owner:d}};react_production_min.createContext=function(s){return s={$$typeof:u,_currentValue:s,_currentValue2:s,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},s.Provider={$$typeof:t,_context:s},s.Consumer=s};react_production_min.createElement=M$1;react_production_min.createFactory=function(s){var e=M$1.bind(null,s);return e.type=s,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(s){return{$$typeof:v$1,render:s}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(s){return{$$typeof:y,_payload:{_status:-1,_result:s},_init:T$1}};react_production_min.memo=function(s,e){return{$$typeof:x,type:s,compare:e===void 0?null:e}};react_production_min.startTransition=function(s){var e=V$1.transition;V$1.transition={};try{s()}finally{V$1.transition=e}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(s,e){return U$1.current.useCallback(s,e)};react_production_min.useContext=function(s){return U$1.current.useContext(s)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(s){return U$1.current.useDeferredValue(s)};react_production_min.useEffect=function(s,e){return U$1.current.useEffect(s,e)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(s,e,i){return U$1.current.useImperativeHandle(s,e,i)};react_production_min.useInsertionEffect=function(s,e){return U$1.current.useInsertionEffect(s,e)};react_production_min.useLayoutEffect=function(s,e){return U$1.current.useLayoutEffect(s,e)};react_production_min.useMemo=function(s,e){return U$1.current.useMemo(s,e)};react_production_min.useReducer=function(s,e,i){return U$1.current.useReducer(s,e,i)};react_production_min.useRef=function(s){return U$1.current.useRef(s)};react_production_min.useState=function(s){return U$1.current.useState(s)};react_production_min.useSyncExternalStore=function(s,e,i){return U$1.current.useSyncExternalStore(s,e,i)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(s,e,i){var o,a={},c=null,d=null;i!==void 0&&(c=""+i),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(d=e.ref);for(o in e)m$1.call(e,o)&&!p$1.hasOwnProperty(o)&&(a[o]=e[o]);if(s&&s.defaultProps)for(o in e=s.defaultProps,e)a[o]===void 0&&(a[o]=e[o]);return{$$typeof:k,type:s,key:c,ref:d,props:a,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(s){function e(ft,mt){var xt=ft.length;ft.push(mt);e:for(;0<xt;){var Et=xt-1>>>1,St=ft[Et];if(0<a(St,mt))ft[Et]=mt,ft[xt]=St,xt=Et;else break e}}function i(ft){return ft.length===0?null:ft[0]}function o(ft){if(ft.length===0)return null;var mt=ft[0],xt=ft.pop();if(xt!==mt){ft[0]=xt;e:for(var Et=0,St=ft.length,wt=St>>>1;Et<wt;){var bt=2*(Et+1)-1,Lt=ft[bt],Ft=bt+1,Mt=ft[Ft];if(0>a(Lt,xt))Ft<St&&0>a(Mt,Lt)?(ft[Et]=Mt,ft[Ft]=xt,Et=Ft):(ft[Et]=Lt,ft[bt]=xt,Et=bt);else if(Ft<St&&0>a(Mt,xt))ft[Et]=Mt,ft[Ft]=xt,Et=Ft;else break e}}return mt}function a(ft,mt){var xt=ft.sortIndex-mt.sortIndex;return xt!==0?xt:ft.id-mt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;s.unstable_now=function(){return c.now()}}else{var d=Date,h=d.now();s.unstable_now=function(){return d.now()-h}}var g=[],_=[],j=1,b=null,$=3,et=!1,_e=!1,st=!1,ot=typeof setTimeout=="function"?setTimeout:null,tt=typeof clearTimeout=="function"?clearTimeout:null,nt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function rt(ft){for(var mt=i(_);mt!==null;){if(mt.callback===null)o(_);else if(mt.startTime<=ft)o(_),mt.sortIndex=mt.expirationTime,e(g,mt);else break;mt=i(_)}}function it(ft){if(st=!1,rt(ft),!_e)if(i(g)!==null)_e=!0,Ct(lt);else{var mt=i(_);mt!==null&&_t(it,mt.startTime-ft)}}function lt(ft,mt){_e=!1,st&&(st=!1,tt(ct),ct=-1),et=!0;var xt=$;try{for(rt(mt),b=i(g);b!==null&&(!(b.expirationTime>mt)||ft&&!pt());){var Et=b.callback;if(typeof Et=="function"){b.callback=null,$=b.priorityLevel;var St=Et(b.expirationTime<=mt);mt=s.unstable_now(),typeof St=="function"?b.callback=St:b===i(g)&&o(g),rt(mt)}else o(g);b=i(g)}if(b!==null)var wt=!0;else{var bt=i(_);bt!==null&&_t(it,bt.startTime-mt),wt=!1}return wt}finally{b=null,$=xt,et=!1}}var at=!1,ut=null,ct=-1,ht=5,dt=-1;function pt(){return!(s.unstable_now()-dt<ht)}function gt(){if(ut!==null){var ft=s.unstable_now();dt=ft;var mt=!0;try{mt=ut(!0,ft)}finally{mt?yt():(at=!1,ut=null)}}else at=!1}var yt;if(typeof nt=="function")yt=function(){nt(gt)};else if(typeof MessageChannel<"u"){var jt=new MessageChannel,Tt=jt.port2;jt.port1.onmessage=gt,yt=function(){Tt.postMessage(null)}}else yt=function(){ot(gt,0)};function Ct(ft){ut=ft,at||(at=!0,yt())}function _t(ft,mt){ct=ot(function(){ft(s.unstable_now())},mt)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(ft){ft.callback=null},s.unstable_continueExecution=function(){_e||et||(_e=!0,Ct(lt))},s.unstable_forceFrameRate=function(ft){0>ft||125<ft?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ht=0<ft?Math.floor(1e3/ft):5},s.unstable_getCurrentPriorityLevel=function(){return $},s.unstable_getFirstCallbackNode=function(){return i(g)},s.unstable_next=function(ft){switch($){case 1:case 2:case 3:var mt=3;break;default:mt=$}var xt=$;$=mt;try{return ft()}finally{$=xt}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(ft,mt){switch(ft){case 1:case 2:case 3:case 4:case 5:break;default:ft=3}var xt=$;$=ft;try{return mt()}finally{$=xt}},s.unstable_scheduleCallback=function(ft,mt,xt){var Et=s.unstable_now();switch(typeof xt=="object"&&xt!==null?(xt=xt.delay,xt=typeof xt=="number"&&0<xt?Et+xt:Et):xt=Et,ft){case 1:var St=-1;break;case 2:St=250;break;case 5:St=1073741823;break;case 4:St=1e4;break;default:St=5e3}return St=xt+St,ft={id:j++,callback:mt,priorityLevel:ft,startTime:xt,expirationTime:St,sortIndex:-1},xt>Et?(ft.sortIndex=xt,e(_,ft),i(g)===null&&ft===i(_)&&(st?(tt(ct),ct=-1):st=!0,_t(it,xt-Et))):(ft.sortIndex=St,e(g,ft),_e||et||(_e=!0,Ct(lt))),ft},s.unstable_shouldYield=pt,s.unstable_wrapCallback=function(ft){var mt=$;return function(){var xt=$;$=mt;try{return ft.apply(this,arguments)}finally{$=xt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(s){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+s,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+s+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(s,e){ha(s,e),ha(s+"Capture",e)}function ha(s,e){for(ea[s]=e,s=0;s<e.length;s++)da.add(e[s])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(s){return ja.call(ma,s)?!0:ja.call(la,s)?!1:ka.test(s)?ma[s]=!0:(la[s]=!0,!1)}function pa(s,e,i,o){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:i!==null?!i.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function qa(s,e,i,o){if(e===null||typeof e>"u"||pa(s,e,i,o))return!0;if(o)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v(s,e,i,o,a,c,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=a,this.mustUseProperty=i,this.propertyName=s,this.type=e,this.sanitizeURL=c,this.removeEmptyString=d}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){z[s]=new v(s,0,!1,s,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var e=s[0];z[e]=new v(e,1,!1,s[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(s){z[s]=new v(s,2,!1,s.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){z[s]=new v(s,2,!1,s,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){z[s]=new v(s,3,!1,s.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(s){z[s]=new v(s,3,!0,s,null,!1,!1)});["capture","download"].forEach(function(s){z[s]=new v(s,4,!1,s,null,!1,!1)});["cols","rows","size","span"].forEach(function(s){z[s]=new v(s,6,!1,s,null,!1,!1)});["rowSpan","start"].forEach(function(s){z[s]=new v(s,5,!1,s.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var e=s.replace(ra,sa);z[e]=new v(e,1,!1,s,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var e=s.replace(ra,sa);z[e]=new v(e,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(s){var e=s.replace(ra,sa);z[e]=new v(e,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(s){z[s]=new v(s,1,!1,s.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(s){z[s]=new v(s,1,!1,s.toLowerCase(),null,!0,!0)});function ta(s,e,i,o){var a=z.hasOwnProperty(e)?z[e]:null;(a!==null?a.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa(e,i,a,o)&&(i=null),o||a===null?oa(e)&&(i===null?s.removeAttribute(e):s.setAttribute(e,""+i)):a.mustUseProperty?s[a.propertyName]=i===null?a.type===3?!1:"":i:(e=a.attributeName,o=a.attributeNamespace,i===null?s.removeAttribute(e):(a=a.type,i=a===3||a===4&&i===!0?"":""+i,o?s.setAttributeNS(o,e,i):s.setAttribute(e,i))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(s){return s===null||typeof s!="object"?null:(s=Ja&&s[Ja]||s["@@iterator"],typeof s=="function"?s:null)}var A=Object.assign,La;function Ma(s){if(La===void 0)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);La=e&&e[1]||""}return`
`+La+s}var Na=!1;function Oa(s,e){if(!s||Na)return"";Na=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_){var o=_}Reflect.construct(s,[],e)}else{try{e.call()}catch(_){o=_}s.call(e.prototype)}else{try{throw Error()}catch(_){o=_}s()}}catch(_){if(_&&o&&typeof _.stack=="string"){for(var a=_.stack.split(`
`),c=o.stack.split(`
`),d=a.length-1,h=c.length-1;1<=d&&0<=h&&a[d]!==c[h];)h--;for(;1<=d&&0<=h;d--,h--)if(a[d]!==c[h]){if(d!==1||h!==1)do if(d--,h--,0>h||a[d]!==c[h]){var g=`
`+a[d].replace(" at new "," at ");return s.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",s.displayName)),g}while(1<=d&&0<=h);break}}}finally{Na=!1,Error.prepareStackTrace=i}return(s=s?s.displayName||s.name:"")?Ma(s):""}function Pa(s){switch(s.tag){case 5:return Ma(s.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return s=Oa(s.type,!1),s;case 11:return s=Oa(s.type.render,!1),s;case 1:return s=Oa(s.type,!0),s;default:return""}}function Qa(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Ca:return(s.displayName||"Context")+".Consumer";case Ba:return(s._context.displayName||"Context")+".Provider";case Da:var e=s.render;return s=s.displayName,s||(s=e.displayName||e.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Ga:return e=s.displayName||null,e!==null?e:Qa(s.type)||"Memo";case Ha:e=s._payload,s=s._init;try{return Qa(s(e))}catch{}}return null}function Ra(s){var e=s.type;switch(s.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=e.render,s=s.displayName||s.name||"",e.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(e);case 8:return e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ta(s){var e=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua(s){var e=Ta(s)?"checked":"value",i=Object.getOwnPropertyDescriptor(s.constructor.prototype,e),o=""+s[e];if(!s.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var a=i.get,c=i.set;return Object.defineProperty(s,e,{configurable:!0,get:function(){return a.call(this)},set:function(d){o=""+d,c.call(this,d)}}),Object.defineProperty(s,e,{enumerable:i.enumerable}),{getValue:function(){return o},setValue:function(d){o=""+d},stopTracking:function(){s._valueTracker=null,delete s[e]}}}}function Va(s){s._valueTracker||(s._valueTracker=Ua(s))}function Wa(s){if(!s)return!1;var e=s._valueTracker;if(!e)return!0;var i=e.getValue(),o="";return s&&(o=Ta(s)?s.checked?"true":"false":s.value),s=o,s!==i?(e.setValue(s),!0):!1}function Xa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ya(s,e){var i=e.checked;return A({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??s._wrapperState.initialChecked})}function Za(s,e){var i=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;i=Sa(e.value!=null?e.value:i),s._wrapperState={initialChecked:o,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(s,e){e=e.checked,e!=null&&ta(s,"checked",e,!1)}function bb(s,e){ab(s,e);var i=Sa(e.value),o=e.type;if(i!=null)o==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+i):s.value!==""+i&&(s.value=""+i);else if(o==="submit"||o==="reset"){s.removeAttribute("value");return}e.hasOwnProperty("value")?cb(s,e.type,i):e.hasOwnProperty("defaultValue")&&cb(s,e.type,Sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(s.defaultChecked=!!e.defaultChecked)}function db(s,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+s._wrapperState.initialValue,i||e===s.value||(s.value=e),s.defaultValue=e}i=s.name,i!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,i!==""&&(s.name=i)}function cb(s,e,i){(e!=="number"||Xa(s.ownerDocument)!==s)&&(i==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+i&&(s.defaultValue=""+i))}var eb=Array.isArray;function fb(s,e,i,o){if(s=s.options,e){e={};for(var a=0;a<i.length;a++)e["$"+i[a]]=!0;for(i=0;i<s.length;i++)a=e.hasOwnProperty("$"+s[i].value),s[i].selected!==a&&(s[i].selected=a),a&&o&&(s[i].defaultSelected=!0)}else{for(i=""+Sa(i),e=null,a=0;a<s.length;a++){if(s[a].value===i){s[a].selected=!0,o&&(s[a].defaultSelected=!0);return}e!==null||s[a].disabled||(e=s[a])}e!==null&&(e.selected=!0)}}function gb(s,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},e,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function hb(s,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(p(92));if(eb(i)){if(1<i.length)throw Error(p(93));i=i[0]}e=i}e==null&&(e=""),i=e}s._wrapperState={initialValue:Sa(i)}}function ib(s,e){var i=Sa(e.value),o=Sa(e.defaultValue);i!=null&&(i=""+i,i!==s.value&&(s.value=i),e.defaultValue==null&&s.defaultValue!==i&&(s.defaultValue=i)),o!=null&&(s.defaultValue=""+o)}function jb(s){var e=s.textContent;e===s._wrapperState.initialValue&&e!==""&&e!==null&&(s.value=e)}function kb(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(s,e){return s==null||s==="http://www.w3.org/1999/xhtml"?kb(e):s==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var mb,nb=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,i,o,a){MSApp.execUnsafeLocalFunction(function(){return s(e,i,o,a)})}:s}(function(s,e){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;e.firstChild;)s.appendChild(e.firstChild)}});function ob(s,e){if(e){var i=s.firstChild;if(i&&i===s.lastChild&&i.nodeType===3){i.nodeValue=e;return}}s.textContent=e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(s){qb.forEach(function(e){e=e+s.charAt(0).toUpperCase()+s.substring(1),pb[e]=pb[s]})});function rb(s,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||pb.hasOwnProperty(s)&&pb[s]?(""+e).trim():e+"px"}function sb(s,e){s=s.style;for(var i in e)if(e.hasOwnProperty(i)){var o=i.indexOf("--")===0,a=rb(i,e[i],o);i==="float"&&(i="cssFloat"),o?s.setProperty(i,a):s[i]=a}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(s,e){if(e){if(tb[s]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p(137,s));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p(62))}}function vb(s,e){if(s.indexOf("-")===-1)return typeof e.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var yb=null,zb=null,Ab=null;function Bb(s){if(s=Cb(s)){if(typeof yb!="function")throw Error(p(280));var e=s.stateNode;e&&(e=Db(e),yb(s.stateNode,s.type,e))}}function Eb(s){zb?Ab?Ab.push(s):Ab=[s]:zb=s}function Fb(){if(zb){var s=zb,e=Ab;if(Ab=zb=null,Bb(s),e)for(s=0;s<e.length;s++)Bb(e[s])}}function Gb(s,e){return s(e)}function Hb(){}var Ib=!1;function Jb(s,e,i){if(Ib)return s(e,i);Ib=!0;try{return Gb(s,e,i)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(s,e){var i=s.stateNode;if(i===null)return null;var o=Db(i);if(o===null)return null;i=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(s=s.type,o=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!o;break e;default:s=!1}if(s)return null;if(i&&typeof i!="function")throw Error(p(231,e,typeof i));return i}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(s,e,i,o,a,c,d,h,g){var _=Array.prototype.slice.call(arguments,3);try{e.apply(i,_)}catch(j){this.onError(j)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(s){Ob=!0,Pb=s}};function Tb(s,e,i,o,a,c,d,h,g){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(s,e,i,o,a,c,d,h,g){if(Tb.apply(this,arguments),Ob){if(Ob){var _=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_)}}function Vb(s){var e=s,i=s;if(s.alternate)for(;e.return;)e=e.return;else{s=e;do e=s,e.flags&4098&&(i=e.return),s=e.return;while(s)}return e.tag===3?i:null}function Wb(s){if(s.tag===13){var e=s.memoizedState;if(e===null&&(s=s.alternate,s!==null&&(e=s.memoizedState)),e!==null)return e.dehydrated}return null}function Xb(s){if(Vb(s)!==s)throw Error(p(188))}function Yb(s){var e=s.alternate;if(!e){if(e=Vb(s),e===null)throw Error(p(188));return e!==s?null:s}for(var i=s,o=e;;){var a=i.return;if(a===null)break;var c=a.alternate;if(c===null){if(o=a.return,o!==null){i=o;continue}break}if(a.child===c.child){for(c=a.child;c;){if(c===i)return Xb(a),s;if(c===o)return Xb(a),e;c=c.sibling}throw Error(p(188))}if(i.return!==o.return)i=a,o=c;else{for(var d=!1,h=a.child;h;){if(h===i){d=!0,i=a,o=c;break}if(h===o){d=!0,o=a,i=c;break}h=h.sibling}if(!d){for(h=c.child;h;){if(h===i){d=!0,i=c,o=a;break}if(h===o){d=!0,o=c,i=a;break}h=h.sibling}if(!d)throw Error(p(189))}}if(i.alternate!==o)throw Error(p(190))}if(i.tag!==3)throw Error(p(188));return i.stateNode.current===i?s:e}function Zb(s){return s=Yb(s),s!==null?$b(s):null}function $b(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var e=$b(s);if(e!==null)return e;s=s.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(s){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,s,void 0,(s.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(s){return s>>>=0,s===0?32:31-(pc(s)/qc|0)|0}var rc=64,sc=4194304;function tc(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function uc(s,e){var i=s.pendingLanes;if(i===0)return 0;var o=0,a=s.suspendedLanes,c=s.pingedLanes,d=i&268435455;if(d!==0){var h=d&~a;h!==0?o=tc(h):(c&=d,c!==0&&(o=tc(c)))}else d=i&~a,d!==0?o=tc(d):c!==0&&(o=tc(c));if(o===0)return 0;if(e!==0&&e!==o&&!(e&a)&&(a=o&-o,c=e&-e,a>=c||a===16&&(c&4194240)!==0))return e;if(o&4&&(o|=i&16),e=s.entangledLanes,e!==0)for(s=s.entanglements,e&=o;0<e;)i=31-oc(e),a=1<<i,o|=s[i],e&=~a;return o}function vc(s,e){switch(s){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(s,e){for(var i=s.suspendedLanes,o=s.pingedLanes,a=s.expirationTimes,c=s.pendingLanes;0<c;){var d=31-oc(c),h=1<<d,g=a[d];g===-1?(!(h&i)||h&o)&&(a[d]=vc(h,e)):g<=e&&(s.expiredLanes|=h),c&=~h}}function xc(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function yc(){var s=rc;return rc<<=1,!(rc&4194240)&&(rc=64),s}function zc(s){for(var e=[],i=0;31>i;i++)e.push(s);return e}function Ac(s,e,i){s.pendingLanes|=e,e!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,e=31-oc(e),s[e]=i}function Bc(s,e){var i=s.pendingLanes&~e;s.pendingLanes=e,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=e,s.mutableReadLanes&=e,s.entangledLanes&=e,e=s.entanglements;var o=s.eventTimes;for(s=s.expirationTimes;0<i;){var a=31-oc(i),c=1<<a;e[a]=0,o[a]=-1,s[a]=-1,i&=~c}}function Cc(s,e){var i=s.entangledLanes|=e;for(s=s.entanglements;i;){var o=31-oc(i),a=1<<o;a&e|s[o]&e&&(s[o]|=e),i&=~a}}var C=0;function Dc(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(s,e){switch(s){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function Tc(s,e,i,o,a,c){return s===null||s.nativeEvent!==c?(s={blockedOn:e,domEventName:i,eventSystemFlags:o,nativeEvent:c,targetContainers:[a]},e!==null&&(e=Cb(e),e!==null&&Fc(e)),s):(s.eventSystemFlags|=o,e=s.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),s)}function Uc(s,e,i,o,a){switch(e){case"focusin":return Lc=Tc(Lc,s,e,i,o,a),!0;case"dragenter":return Mc=Tc(Mc,s,e,i,o,a),!0;case"mouseover":return Nc=Tc(Nc,s,e,i,o,a),!0;case"pointerover":var c=a.pointerId;return Oc.set(c,Tc(Oc.get(c)||null,s,e,i,o,a)),!0;case"gotpointercapture":return c=a.pointerId,Pc.set(c,Tc(Pc.get(c)||null,s,e,i,o,a)),!0}return!1}function Vc(s){var e=Wc(s.target);if(e!==null){var i=Vb(e);if(i!==null){if(e=i.tag,e===13){if(e=Wb(i),e!==null){s.blockedOn=e,Ic(s.priority,function(){Gc(i)});return}}else if(e===3&&i.stateNode.current.memoizedState.isDehydrated){s.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Xc(s){if(s.blockedOn!==null)return!1;for(var e=s.targetContainers;0<e.length;){var i=Yc(s.domEventName,s.eventSystemFlags,e[0],s.nativeEvent);if(i===null){i=s.nativeEvent;var o=new i.constructor(i.type,i);wb=o,i.target.dispatchEvent(o),wb=null}else return e=Cb(i),e!==null&&Fc(e),s.blockedOn=i,!1;e.shift()}return!0}function Zc(s,e,i){Xc(s)&&i.delete(e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(s,e){s.blockedOn===e&&(s.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(s){function e(a){return ad(a,s)}if(0<Kc.length){ad(Kc[0],s);for(var i=1;i<Kc.length;i++){var o=Kc[i];o.blockedOn===s&&(o.blockedOn=null)}}for(Lc!==null&&ad(Lc,s),Mc!==null&&ad(Mc,s),Nc!==null&&ad(Nc,s),Oc.forEach(e),Pc.forEach(e),i=0;i<Qc.length;i++)o=Qc[i],o.blockedOn===s&&(o.blockedOn=null);for(;0<Qc.length&&(i=Qc[0],i.blockedOn===null);)Vc(i),i.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(s,e,i,o){var a=C,c=cd.transition;cd.transition=null;try{C=1,fd(s,e,i,o)}finally{C=a,cd.transition=c}}function gd(s,e,i,o){var a=C,c=cd.transition;cd.transition=null;try{C=4,fd(s,e,i,o)}finally{C=a,cd.transition=c}}function fd(s,e,i,o){if(dd){var a=Yc(s,e,i,o);if(a===null)hd(s,e,o,id,i),Sc(s,o);else if(Uc(a,s,e,i,o))o.stopPropagation();else if(Sc(s,o),e&4&&-1<Rc.indexOf(s)){for(;a!==null;){var c=Cb(a);if(c!==null&&Ec(c),c=Yc(s,e,i,o),c===null&&hd(s,e,o,id,i),c===a)break;a=c}a!==null&&o.stopPropagation()}else hd(s,e,o,null,i)}}var id=null;function Yc(s,e,i,o){if(id=null,s=xb(o),s=Wc(s),s!==null)if(e=Vb(s),e===null)s=null;else if(i=e.tag,i===13){if(s=Wb(e),s!==null)return s;s=null}else if(i===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;s=null}else e!==s&&(s=null);return id=s,null}function jd(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var s,e=ld,i=e.length,o,a="value"in kd?kd.value:kd.textContent,c=a.length;for(s=0;s<i&&e[s]===a[s];s++);var d=i-s;for(o=1;o<=d&&e[i-o]===a[c-o];o++);return md=a.slice(s,1<o?1-o:void 0)}function od(s){var e=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&e===13&&(s=13)):s=e,s===10&&(s=13),32<=s||s===13?s:0}function pd(){return!0}function qd(){return!1}function rd(s){function e(i,o,a,c,d){this._reactName=i,this._targetInst=a,this.type=o,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var h in s)s.hasOwnProperty(h)&&(i=s[h],this[h]=i?i(c):c[h]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==yd&&(yd&&s.type==="mousemove"?(wd=s.screenX-yd.screenX,xd=s.screenY-yd.screenY):xd=wd=0,yd=s),wd)},movementY:function(s){return"movementY"in s?s.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(s){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(s):(s=Od[s])?!!e[s]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(s){if(s.key){var e=Md[s.key]||s.key;if(e!=="Unidentified")return e}return s.type==="keypress"?(s=od(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Nd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(s){return s.type==="keypress"?od(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?od(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(s,e){switch(s){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ie=!1;function je(s,e){switch(s){case"compositionend":return he(e);case"keypress":return e.which!==32?null:(fe=!0,ee);case"textInput":return s=e.data,s===ee&&fe?null:s;default:return null}}function ke(s,e){if(ie)return s==="compositionend"||!ae&&ge(s,e)?(s=nd(),md=ld=kd=null,ie=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de&&e.locale!=="ko"?null:e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e==="input"?!!le[s.type]:e==="textarea"}function ne(s,e,i,o){Eb(o),e=oe(e,"onChange"),0<e.length&&(i=new td("onChange","change",null,i,o),s.push({event:i,listeners:e}))}var pe=null,qe=null;function re(s){se(s,0)}function te(s){var e=ue(s);if(Wa(e))return s}function ve(s,e){if(s==="change")return e}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(s){if(s.propertyName==="value"&&te(qe)){var e=[];ne(e,qe,s,xb(s)),Jb(re,e)}}function Ce(s,e,i){s==="focusin"?(Ae(),pe=e,qe=i,pe.attachEvent("onpropertychange",Be)):s==="focusout"&&Ae()}function De(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return te(qe)}function Ee(s,e){if(s==="click")return te(e)}function Fe(s,e){if(s==="input"||s==="change")return te(e)}function Ge(s,e){return s===e&&(s!==0||1/s===1/e)||s!==s&&e!==e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(s,e){if(He(s,e))return!0;if(typeof s!="object"||s===null||typeof e!="object"||e===null)return!1;var i=Object.keys(s),o=Object.keys(e);if(i.length!==o.length)return!1;for(o=0;o<i.length;o++){var a=i[o];if(!ja.call(e,a)||!He(s[a],e[a]))return!1}return!0}function Je(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ke(s,e){var i=Je(s);s=0;for(var o;i;){if(i.nodeType===3){if(o=s+i.textContent.length,s<=e&&o>=e)return{node:i,offset:e-s};s=o}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Je(i)}}function Le(s,e){return s&&e?s===e?!0:s&&s.nodeType===3?!1:e&&e.nodeType===3?Le(s,e.parentNode):"contains"in s?s.contains(e):s.compareDocumentPosition?!!(s.compareDocumentPosition(e)&16):!1:!1}function Me(){for(var s=window,e=Xa();e instanceof s.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)s=e.contentWindow;else break;e=Xa(s.document)}return e}function Ne(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e&&(e==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||e==="textarea"||s.contentEditable==="true")}function Oe(s){var e=Me(),i=s.focusedElem,o=s.selectionRange;if(e!==i&&i&&i.ownerDocument&&Le(i.ownerDocument.documentElement,i)){if(o!==null&&Ne(i)){if(e=o.start,s=o.end,s===void 0&&(s=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(s,i.value.length);else if(s=(e=i.ownerDocument||document)&&e.defaultView||window,s.getSelection){s=s.getSelection();var a=i.textContent.length,c=Math.min(o.start,a);o=o.end===void 0?c:Math.min(o.end,a),!s.extend&&c>o&&(a=o,o=c,c=a),a=Ke(i,c);var d=Ke(i,o);a&&d&&(s.rangeCount!==1||s.anchorNode!==a.node||s.anchorOffset!==a.offset||s.focusNode!==d.node||s.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),s.removeAllRanges(),c>o?(s.addRange(e),s.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),s.addRange(e)))}}for(e=[],s=i;s=s.parentNode;)s.nodeType===1&&e.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<e.length;i++)s=e[i],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(s,e,i){var o=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Te||Qe==null||Qe!==Xa(o)||(o=Qe,"selectionStart"in o&&Ne(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Se&&Ie(Se,o)||(Se=o,o=oe(Re,"onSelect"),0<o.length&&(e=new td("onSelect","select",null,e,i),s.push({event:e,listeners:o}),e.target=Qe)))}function Ve(s,e){var i={};return i[s.toLowerCase()]=e.toLowerCase(),i["Webkit"+s]="webkit"+e,i["Moz"+s]="moz"+e,i}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(s){if(Xe[s])return Xe[s];if(!We[s])return s;var e=We[s],i;for(i in e)if(e.hasOwnProperty(i)&&i in Ye)return Xe[s]=e[i];return s}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(s,e){df.set(s,e),fa(e,[s])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(s,e,i){var o=s.type||"unknown-event";s.currentTarget=i,Ub(o,e,void 0,s),s.currentTarget=null}function se(s,e){e=(e&4)!==0;for(var i=0;i<s.length;i++){var o=s[i],a=o.event;o=o.listeners;e:{var c=void 0;if(e)for(var d=o.length-1;0<=d;d--){var h=o[d],g=h.instance,_=h.currentTarget;if(h=h.listener,g!==c&&a.isPropagationStopped())break e;nf(a,h,_),c=g}else for(d=0;d<o.length;d++){if(h=o[d],g=h.instance,_=h.currentTarget,h=h.listener,g!==c&&a.isPropagationStopped())break e;nf(a,h,_),c=g}}}if(Qb)throw s=Rb,Qb=!1,Rb=null,s}function D(s,e){var i=e[of];i===void 0&&(i=e[of]=new Set);var o=s+"__bubble";i.has(o)||(pf(e,s,2,!1),i.add(o))}function qf(s,e,i){var o=0;e&&(o|=4),pf(i,s,o,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(s){if(!s[rf]){s[rf]=!0,da.forEach(function(i){i!=="selectionchange"&&(mf.has(i)||qf(i,!1,s),qf(i,!0,s))});var e=s.nodeType===9?s:s.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(s,e,i,o){switch(jd(e)){case 1:var a=ed;break;case 4:a=gd;break;default:a=fd}i=a.bind(null,e,i,s),a=void 0,!Lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),o?a!==void 0?s.addEventListener(e,i,{capture:!0,passive:a}):s.addEventListener(e,i,!0):a!==void 0?s.addEventListener(e,i,{passive:a}):s.addEventListener(e,i,!1)}function hd(s,e,i,o,a){var c=o;if(!(e&1)&&!(e&2)&&o!==null)e:for(;;){if(o===null)return;var d=o.tag;if(d===3||d===4){var h=o.stateNode.containerInfo;if(h===a||h.nodeType===8&&h.parentNode===a)break;if(d===4)for(d=o.return;d!==null;){var g=d.tag;if((g===3||g===4)&&(g=d.stateNode.containerInfo,g===a||g.nodeType===8&&g.parentNode===a))return;d=d.return}for(;h!==null;){if(d=Wc(h),d===null)return;if(g=d.tag,g===5||g===6){o=c=d;continue e}h=h.parentNode}}o=o.return}Jb(function(){var _=c,j=xb(i),b=[];e:{var $=df.get(s);if($!==void 0){var et=td,_e=s;switch(s){case"keypress":if(od(i)===0)break e;case"keydown":case"keyup":et=Rd;break;case"focusin":_e="focus",et=Fd;break;case"focusout":_e="blur",et=Fd;break;case"beforeblur":case"afterblur":et=Fd;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=Vd;break;case $e:case af:case bf:et=Hd;break;case cf:et=Xd;break;case"scroll":et=vd;break;case"wheel":et=Zd;break;case"copy":case"cut":case"paste":et=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=Td}var st=(e&4)!==0,ot=!st&&s==="scroll",tt=st?$!==null?$+"Capture":null:$;st=[];for(var nt=_,rt;nt!==null;){rt=nt;var it=rt.stateNode;if(rt.tag===5&&it!==null&&(rt=it,tt!==null&&(it=Kb(nt,tt),it!=null&&st.push(tf(nt,it,rt)))),ot)break;nt=nt.return}0<st.length&&($=new et($,_e,null,i,j),b.push({event:$,listeners:st}))}}if(!(e&7)){e:{if($=s==="mouseover"||s==="pointerover",et=s==="mouseout"||s==="pointerout",$&&i!==wb&&(_e=i.relatedTarget||i.fromElement)&&(Wc(_e)||_e[uf]))break e;if((et||$)&&($=j.window===j?j:($=j.ownerDocument)?$.defaultView||$.parentWindow:window,et?(_e=i.relatedTarget||i.toElement,et=_,_e=_e?Wc(_e):null,_e!==null&&(ot=Vb(_e),_e!==ot||_e.tag!==5&&_e.tag!==6)&&(_e=null)):(et=null,_e=_),et!==_e)){if(st=Bd,it="onMouseLeave",tt="onMouseEnter",nt="mouse",(s==="pointerout"||s==="pointerover")&&(st=Td,it="onPointerLeave",tt="onPointerEnter",nt="pointer"),ot=et==null?$:ue(et),rt=_e==null?$:ue(_e),$=new st(it,nt+"leave",et,i,j),$.target=ot,$.relatedTarget=rt,it=null,Wc(j)===_&&(st=new st(tt,nt+"enter",_e,i,j),st.target=rt,st.relatedTarget=ot,it=st),ot=it,et&&_e)t:{for(st=et,tt=_e,nt=0,rt=st;rt;rt=vf(rt))nt++;for(rt=0,it=tt;it;it=vf(it))rt++;for(;0<nt-rt;)st=vf(st),nt--;for(;0<rt-nt;)tt=vf(tt),rt--;for(;nt--;){if(st===tt||tt!==null&&st===tt.alternate)break t;st=vf(st),tt=vf(tt)}st=null}else st=null;et!==null&&wf(b,$,et,st,!1),_e!==null&&ot!==null&&wf(b,ot,_e,st,!0)}}e:{if($=_?ue(_):window,et=$.nodeName&&$.nodeName.toLowerCase(),et==="select"||et==="input"&&$.type==="file")var lt=ve;else if(me($))if(we)lt=Fe;else{lt=De;var at=Ce}else(et=$.nodeName)&&et.toLowerCase()==="input"&&($.type==="checkbox"||$.type==="radio")&&(lt=Ee);if(lt&&(lt=lt(s,_))){ne(b,lt,i,j);break e}at&&at(s,$,_),s==="focusout"&&(at=$._wrapperState)&&at.controlled&&$.type==="number"&&cb($,"number",$.value)}switch(at=_?ue(_):window,s){case"focusin":(me(at)||at.contentEditable==="true")&&(Qe=at,Re=_,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(b,i,j);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(b,i,j)}var ut;if(ae)e:{switch(s){case"compositionstart":var ct="onCompositionStart";break e;case"compositionend":ct="onCompositionEnd";break e;case"compositionupdate":ct="onCompositionUpdate";break e}ct=void 0}else ie?ge(s,i)&&(ct="onCompositionEnd"):s==="keydown"&&i.keyCode===229&&(ct="onCompositionStart");ct&&(de&&i.locale!=="ko"&&(ie||ct!=="onCompositionStart"?ct==="onCompositionEnd"&&ie&&(ut=nd()):(kd=j,ld="value"in kd?kd.value:kd.textContent,ie=!0)),at=oe(_,ct),0<at.length&&(ct=new Ld(ct,s,null,i,j),b.push({event:ct,listeners:at}),ut?ct.data=ut:(ut=he(i),ut!==null&&(ct.data=ut)))),(ut=ce?je(s,i):ke(s,i))&&(_=oe(_,"onBeforeInput"),0<_.length&&(j=new Ld("onBeforeInput","beforeinput",null,i,j),b.push({event:j,listeners:_}),j.data=ut))}se(b,e)})}function tf(s,e,i){return{instance:s,listener:e,currentTarget:i}}function oe(s,e){for(var i=e+"Capture",o=[];s!==null;){var a=s,c=a.stateNode;a.tag===5&&c!==null&&(a=c,c=Kb(s,i),c!=null&&o.unshift(tf(s,c,a)),c=Kb(s,e),c!=null&&o.push(tf(s,c,a))),s=s.return}return o}function vf(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function wf(s,e,i,o,a){for(var c=e._reactName,d=[];i!==null&&i!==o;){var h=i,g=h.alternate,_=h.stateNode;if(g!==null&&g===o)break;h.tag===5&&_!==null&&(h=_,a?(g=Kb(i,c),g!=null&&d.unshift(tf(i,g,h))):a||(g=Kb(i,c),g!=null&&d.push(tf(i,g,h)))),i=i.return}d.length!==0&&s.push({event:e,listeners:d})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(s){return(typeof s=="string"?s:""+s).replace(xf,`
`).replace(yf,"")}function Af(s,e,i){if(e=zf(e),zf(s)!==e&&i)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(s,e){return s==="textarea"||s==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(s){return Hf.resolve(null).then(s).catch(If)}:Ff;function If(s){setTimeout(function(){throw s})}function Kf(s,e){var i=e,o=0;do{var a=i.nextSibling;if(s.removeChild(i),a&&a.nodeType===8)if(i=a.data,i==="/$"){if(o===0){s.removeChild(a),bd(e);return}o--}else i!=="$"&&i!=="$?"&&i!=="$!"||o++;i=a}while(i);bd(e)}function Lf(s){for(;s!=null;s=s.nextSibling){var e=s.nodeType;if(e===1||e===3)break;if(e===8){if(e=s.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return s}function Mf(s){s=s.previousSibling;for(var e=0;s;){if(s.nodeType===8){var i=s.data;if(i==="$"||i==="$!"||i==="$?"){if(e===0)return s;e--}else i==="/$"&&e++}s=s.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(s){var e=s[Of];if(e)return e;for(var i=s.parentNode;i;){if(e=i[uf]||i[Of]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(s=Mf(s);s!==null;){if(i=s[Of])return i;s=Mf(s)}return e}s=i,i=s.parentNode}return null}function Cb(s){return s=s[Of]||s[uf],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function ue(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(p(33))}function Db(s){return s[Pf]||null}var Sf=[],Tf=-1;function Uf(s){return{current:s}}function E(s){0>Tf||(s.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(s,e){Tf++,Sf[Tf]=s.current,s.current=e}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(s,e){var i=s.type.contextTypes;if(!i)return Vf;var o=s.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var a={},c;for(c in i)a[c]=e[c];return o&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=e,s.__reactInternalMemoizedMaskedChildContext=a),a}function Zf(s){return s=s.childContextTypes,s!=null}function $f(){E(Wf),E(H)}function ag(s,e,i){if(H.current!==Vf)throw Error(p(168));G(H,e),G(Wf,i)}function bg(s,e,i){var o=s.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return i;o=o.getChildContext();for(var a in o)if(!(a in e))throw Error(p(108,Ra(s)||"Unknown",a));return A({},i,o)}function cg(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,s),G(Wf,Wf.current),!0}function dg(s,e,i){var o=s.stateNode;if(!o)throw Error(p(169));i?(s=bg(s,e,Xf),o.__reactInternalMemoizedMergedChildContext=s,E(Wf),E(H),G(H,s)):E(Wf),G(Wf,i)}var eg=null,fg=!1,gg=!1;function hg(s){eg===null?eg=[s]:eg.push(s)}function ig(s){fg=!0,hg(s)}function jg(){if(!gg&&eg!==null){gg=!0;var s=0,e=C;try{var i=eg;for(C=1;s<i.length;s++){var o=i[s];do o=o(!0);while(o!==null)}eg=null,fg=!1}catch(a){throw eg!==null&&(eg=eg.slice(s+1)),ac(fc,jg),a}finally{C=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(s,e){kg[lg++]=ng,kg[lg++]=mg,mg=s,ng=e}function ug(s,e,i){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=s;var o=rg;s=sg;var a=32-oc(o)-1;o&=~(1<<a),i+=1;var c=32-oc(e)+a;if(30<c){var d=a-a%5;c=(o&(1<<d)-1).toString(32),o>>=d,a-=d,rg=1<<32-oc(e)+a|i<<a|o,sg=c+s}else rg=1<<c|i<<a|o,sg=s}function vg(s){s.return!==null&&(tg(s,1),ug(s,1,0))}function wg(s){for(;s===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;s===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(s,e){var i=Bg(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=s,e=s.deletions,e===null?(s.deletions=[i],s.flags|=16):e.push(i)}function Cg(s,e){switch(s.tag){case 5:var i=s.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(s.stateNode=e,xg=s,yg=Lf(e.firstChild),!0):!1;case 6:return e=s.pendingProps===""||e.nodeType!==3?null:e,e!==null?(s.stateNode=e,xg=s,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(i=qg!==null?{id:rg,overflow:sg}:null,s.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},i=Bg(18,null,null,0),i.stateNode=e,i.return=s,s.child=i,xg=s,yg=null,!0):!1;default:return!1}}function Dg(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Eg(s){if(I){var e=yg;if(e){var i=e;if(!Cg(s,e)){if(Dg(s))throw Error(p(418));e=Lf(i.nextSibling);var o=xg;e&&Cg(s,e)?Ag(o,i):(s.flags=s.flags&-4097|2,I=!1,xg=s)}}else{if(Dg(s))throw Error(p(418));s.flags=s.flags&-4097|2,I=!1,xg=s}}}function Fg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;xg=s}function Gg(s){if(s!==xg)return!1;if(!I)return Fg(s),I=!0,!1;var e;if((e=s.tag!==3)&&!(e=s.tag!==5)&&(e=s.type,e=e!=="head"&&e!=="body"&&!Ef(s.type,s.memoizedProps)),e&&(e=yg)){if(Dg(s))throw Hg(),Error(p(418));for(;e;)Ag(s,e),e=Lf(e.nextSibling)}if(Fg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(p(317));e:{for(s=s.nextSibling,e=0;s;){if(s.nodeType===8){var i=s.data;if(i==="/$"){if(e===0){yg=Lf(s.nextSibling);break e}e--}else i!=="$"&&i!=="$!"&&i!=="$?"||e++}s=s.nextSibling}yg=null}}else yg=xg?Lf(s.stateNode.nextSibling):null;return!0}function Hg(){for(var s=yg;s;)s=Lf(s.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(s){zg===null?zg=[s]:zg.push(s)}var Kg=ua.ReactCurrentBatchConfig;function Lg(s,e,i){if(s=i.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(p(309));var o=i.stateNode}if(!o)throw Error(p(147,s));var a=o,c=""+s;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(d){var h=a.refs;d===null?delete h[c]:h[c]=d},e._stringRef=c,e)}if(typeof s!="string")throw Error(p(284));if(!i._owner)throw Error(p(290,s))}return s}function Mg(s,e){throw s=Object.prototype.toString.call(e),Error(p(31,s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s))}function Ng(s){var e=s._init;return e(s._payload)}function Og(s){function e(tt,nt){if(s){var rt=tt.deletions;rt===null?(tt.deletions=[nt],tt.flags|=16):rt.push(nt)}}function i(tt,nt){if(!s)return null;for(;nt!==null;)e(tt,nt),nt=nt.sibling;return null}function o(tt,nt){for(tt=new Map;nt!==null;)nt.key!==null?tt.set(nt.key,nt):tt.set(nt.index,nt),nt=nt.sibling;return tt}function a(tt,nt){return tt=Pg(tt,nt),tt.index=0,tt.sibling=null,tt}function c(tt,nt,rt){return tt.index=rt,s?(rt=tt.alternate,rt!==null?(rt=rt.index,rt<nt?(tt.flags|=2,nt):rt):(tt.flags|=2,nt)):(tt.flags|=1048576,nt)}function d(tt){return s&&tt.alternate===null&&(tt.flags|=2),tt}function h(tt,nt,rt,it){return nt===null||nt.tag!==6?(nt=Qg(rt,tt.mode,it),nt.return=tt,nt):(nt=a(nt,rt),nt.return=tt,nt)}function g(tt,nt,rt,it){var lt=rt.type;return lt===ya?j(tt,nt,rt.props.children,it,rt.key):nt!==null&&(nt.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===Ha&&Ng(lt)===nt.type)?(it=a(nt,rt.props),it.ref=Lg(tt,nt,rt),it.return=tt,it):(it=Rg(rt.type,rt.key,rt.props,null,tt.mode,it),it.ref=Lg(tt,nt,rt),it.return=tt,it)}function _(tt,nt,rt,it){return nt===null||nt.tag!==4||nt.stateNode.containerInfo!==rt.containerInfo||nt.stateNode.implementation!==rt.implementation?(nt=Sg(rt,tt.mode,it),nt.return=tt,nt):(nt=a(nt,rt.children||[]),nt.return=tt,nt)}function j(tt,nt,rt,it,lt){return nt===null||nt.tag!==7?(nt=Tg(rt,tt.mode,it,lt),nt.return=tt,nt):(nt=a(nt,rt),nt.return=tt,nt)}function b(tt,nt,rt){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return nt=Qg(""+nt,tt.mode,rt),nt.return=tt,nt;if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case va:return rt=Rg(nt.type,nt.key,nt.props,null,tt.mode,rt),rt.ref=Lg(tt,null,nt),rt.return=tt,rt;case wa:return nt=Sg(nt,tt.mode,rt),nt.return=tt,nt;case Ha:var it=nt._init;return b(tt,it(nt._payload),rt)}if(eb(nt)||Ka(nt))return nt=Tg(nt,tt.mode,rt,null),nt.return=tt,nt;Mg(tt,nt)}return null}function $(tt,nt,rt,it){var lt=nt!==null?nt.key:null;if(typeof rt=="string"&&rt!==""||typeof rt=="number")return lt!==null?null:h(tt,nt,""+rt,it);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case va:return rt.key===lt?g(tt,nt,rt,it):null;case wa:return rt.key===lt?_(tt,nt,rt,it):null;case Ha:return lt=rt._init,$(tt,nt,lt(rt._payload),it)}if(eb(rt)||Ka(rt))return lt!==null?null:j(tt,nt,rt,it,null);Mg(tt,rt)}return null}function et(tt,nt,rt,it,lt){if(typeof it=="string"&&it!==""||typeof it=="number")return tt=tt.get(rt)||null,h(nt,tt,""+it,lt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case va:return tt=tt.get(it.key===null?rt:it.key)||null,g(nt,tt,it,lt);case wa:return tt=tt.get(it.key===null?rt:it.key)||null,_(nt,tt,it,lt);case Ha:var at=it._init;return et(tt,nt,rt,at(it._payload),lt)}if(eb(it)||Ka(it))return tt=tt.get(rt)||null,j(nt,tt,it,lt,null);Mg(nt,it)}return null}function _e(tt,nt,rt,it){for(var lt=null,at=null,ut=nt,ct=nt=0,ht=null;ut!==null&&ct<rt.length;ct++){ut.index>ct?(ht=ut,ut=null):ht=ut.sibling;var dt=$(tt,ut,rt[ct],it);if(dt===null){ut===null&&(ut=ht);break}s&&ut&&dt.alternate===null&&e(tt,ut),nt=c(dt,nt,ct),at===null?lt=dt:at.sibling=dt,at=dt,ut=ht}if(ct===rt.length)return i(tt,ut),I&&tg(tt,ct),lt;if(ut===null){for(;ct<rt.length;ct++)ut=b(tt,rt[ct],it),ut!==null&&(nt=c(ut,nt,ct),at===null?lt=ut:at.sibling=ut,at=ut);return I&&tg(tt,ct),lt}for(ut=o(tt,ut);ct<rt.length;ct++)ht=et(ut,tt,ct,rt[ct],it),ht!==null&&(s&&ht.alternate!==null&&ut.delete(ht.key===null?ct:ht.key),nt=c(ht,nt,ct),at===null?lt=ht:at.sibling=ht,at=ht);return s&&ut.forEach(function(pt){return e(tt,pt)}),I&&tg(tt,ct),lt}function st(tt,nt,rt,it){var lt=Ka(rt);if(typeof lt!="function")throw Error(p(150));if(rt=lt.call(rt),rt==null)throw Error(p(151));for(var at=lt=null,ut=nt,ct=nt=0,ht=null,dt=rt.next();ut!==null&&!dt.done;ct++,dt=rt.next()){ut.index>ct?(ht=ut,ut=null):ht=ut.sibling;var pt=$(tt,ut,dt.value,it);if(pt===null){ut===null&&(ut=ht);break}s&&ut&&pt.alternate===null&&e(tt,ut),nt=c(pt,nt,ct),at===null?lt=pt:at.sibling=pt,at=pt,ut=ht}if(dt.done)return i(tt,ut),I&&tg(tt,ct),lt;if(ut===null){for(;!dt.done;ct++,dt=rt.next())dt=b(tt,dt.value,it),dt!==null&&(nt=c(dt,nt,ct),at===null?lt=dt:at.sibling=dt,at=dt);return I&&tg(tt,ct),lt}for(ut=o(tt,ut);!dt.done;ct++,dt=rt.next())dt=et(ut,tt,ct,dt.value,it),dt!==null&&(s&&dt.alternate!==null&&ut.delete(dt.key===null?ct:dt.key),nt=c(dt,nt,ct),at===null?lt=dt:at.sibling=dt,at=dt);return s&&ut.forEach(function(gt){return e(tt,gt)}),I&&tg(tt,ct),lt}function ot(tt,nt,rt,it){if(typeof rt=="object"&&rt!==null&&rt.type===ya&&rt.key===null&&(rt=rt.props.children),typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case va:e:{for(var lt=rt.key,at=nt;at!==null;){if(at.key===lt){if(lt=rt.type,lt===ya){if(at.tag===7){i(tt,at.sibling),nt=a(at,rt.props.children),nt.return=tt,tt=nt;break e}}else if(at.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===Ha&&Ng(lt)===at.type){i(tt,at.sibling),nt=a(at,rt.props),nt.ref=Lg(tt,at,rt),nt.return=tt,tt=nt;break e}i(tt,at);break}else e(tt,at);at=at.sibling}rt.type===ya?(nt=Tg(rt.props.children,tt.mode,it,rt.key),nt.return=tt,tt=nt):(it=Rg(rt.type,rt.key,rt.props,null,tt.mode,it),it.ref=Lg(tt,nt,rt),it.return=tt,tt=it)}return d(tt);case wa:e:{for(at=rt.key;nt!==null;){if(nt.key===at)if(nt.tag===4&&nt.stateNode.containerInfo===rt.containerInfo&&nt.stateNode.implementation===rt.implementation){i(tt,nt.sibling),nt=a(nt,rt.children||[]),nt.return=tt,tt=nt;break e}else{i(tt,nt);break}else e(tt,nt);nt=nt.sibling}nt=Sg(rt,tt.mode,it),nt.return=tt,tt=nt}return d(tt);case Ha:return at=rt._init,ot(tt,nt,at(rt._payload),it)}if(eb(rt))return _e(tt,nt,rt,it);if(Ka(rt))return st(tt,nt,rt,it);Mg(tt,rt)}return typeof rt=="string"&&rt!==""||typeof rt=="number"?(rt=""+rt,nt!==null&&nt.tag===6?(i(tt,nt.sibling),nt=a(nt,rt),nt.return=tt,tt=nt):(i(tt,nt),nt=Qg(rt,tt.mode,it),nt.return=tt,tt=nt),d(tt)):i(tt,nt)}return ot}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(s){var e=Wg.current;E(Wg),s._currentValue=e}function bh(s,e,i){for(;s!==null;){var o=s.alternate;if((s.childLanes&e)!==e?(s.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),s===i)break;s=s.return}}function ch(s,e){Xg=s,Zg=Yg=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&e&&(dh=!0),s.firstContext=null)}function eh(s){var e=s._currentValue;if(Zg!==s)if(s={context:s,memoizedValue:e,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=s,Xg.dependencies={lanes:0,firstContext:s}}else Yg=Yg.next=s;return e}var fh=null;function gh(s){fh===null?fh=[s]:fh.push(s)}function hh(s,e,i,o){var a=e.interleaved;return a===null?(i.next=i,gh(e)):(i.next=a.next,a.next=i),e.interleaved=i,ih(s,o)}function ih(s,e){s.lanes|=e;var i=s.alternate;for(i!==null&&(i.lanes|=e),i=s,s=s.return;s!==null;)s.childLanes|=e,i=s.alternate,i!==null&&(i.childLanes|=e),i=s,s=s.return;return i.tag===3?i.stateNode:null}var jh=!1;function kh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(s,e){s=s.updateQueue,e.updateQueue===s&&(e.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function mh(s,e){return{eventTime:s,lane:e,tag:0,payload:null,callback:null,next:null}}function nh(s,e,i){var o=s.updateQueue;if(o===null)return null;if(o=o.shared,K&2){var a=o.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),o.pending=e,ih(s,i)}return a=o.interleaved,a===null?(e.next=e,gh(o)):(e.next=a.next,a.next=e),o.interleaved=e,ih(s,i)}function oh(s,e,i){if(e=e.updateQueue,e!==null&&(e=e.shared,(i&4194240)!==0)){var o=e.lanes;o&=s.pendingLanes,i|=o,e.lanes=i,Cc(s,i)}}function ph(s,e){var i=s.updateQueue,o=s.alternate;if(o!==null&&(o=o.updateQueue,i===o)){var a=null,c=null;if(i=i.firstBaseUpdate,i!==null){do{var d={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};c===null?a=c=d:c=c.next=d,i=i.next}while(i!==null);c===null?a=c=e:c=c.next=e}else a=c=e;i={baseState:o.baseState,firstBaseUpdate:a,lastBaseUpdate:c,shared:o.shared,effects:o.effects},s.updateQueue=i;return}s=i.lastBaseUpdate,s===null?i.firstBaseUpdate=e:s.next=e,i.lastBaseUpdate=e}function qh(s,e,i,o){var a=s.updateQueue;jh=!1;var c=a.firstBaseUpdate,d=a.lastBaseUpdate,h=a.shared.pending;if(h!==null){a.shared.pending=null;var g=h,_=g.next;g.next=null,d===null?c=_:d.next=_,d=g;var j=s.alternate;j!==null&&(j=j.updateQueue,h=j.lastBaseUpdate,h!==d&&(h===null?j.firstBaseUpdate=_:h.next=_,j.lastBaseUpdate=g))}if(c!==null){var b=a.baseState;d=0,j=_=g=null,h=c;do{var $=h.lane,et=h.eventTime;if((o&$)===$){j!==null&&(j=j.next={eventTime:et,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var _e=s,st=h;switch($=e,et=i,st.tag){case 1:if(_e=st.payload,typeof _e=="function"){b=_e.call(et,b,$);break e}b=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=st.payload,$=typeof _e=="function"?_e.call(et,b,$):_e,$==null)break e;b=A({},b,$);break e;case 2:jh=!0}}h.callback!==null&&h.lane!==0&&(s.flags|=64,$=a.effects,$===null?a.effects=[h]:$.push(h))}else et={eventTime:et,lane:$,tag:h.tag,payload:h.payload,callback:h.callback,next:null},j===null?(_=j=et,g=b):j=j.next=et,d|=$;if(h=h.next,h===null){if(h=a.shared.pending,h===null)break;$=h,h=$.next,$.next=null,a.lastBaseUpdate=$,a.shared.pending=null}}while(!0);if(j===null&&(g=b),a.baseState=g,a.firstBaseUpdate=_,a.lastBaseUpdate=j,e=a.shared.interleaved,e!==null){a=e;do d|=a.lane,a=a.next;while(a!==e)}else c===null&&(a.shared.lanes=0);rh|=d,s.lanes=d,s.memoizedState=b}}function sh(s,e,i){if(s=e.effects,e.effects=null,s!==null)for(e=0;e<s.length;e++){var o=s[e],a=o.callback;if(a!==null){if(o.callback=null,o=i,typeof a!="function")throw Error(p(191,a));a.call(o)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(s){if(s===th)throw Error(p(174));return s}function yh(s,e){switch(G(wh,e),G(vh,s),G(uh,th),s=e.nodeType,s){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:s=s===8?e.parentNode:e,e=s.namespaceURI||null,s=s.tagName,e=lb(e,s)}E(uh),G(uh,e)}function zh(){E(uh),E(vh),E(wh)}function Ah(s){xh(wh.current);var e=xh(uh.current),i=lb(e,s.type);e!==i&&(G(vh,s),G(uh,i))}function Bh(s){vh.current===s&&(E(uh),E(vh))}var L=Uf(0);function Ch(s){for(var e=s;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dh=[];function Eh(){for(var s=0;s<Dh.length;s++)Dh[s]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(s,e){if(e===null)return!1;for(var i=0;i<e.length&&i<s.length;i++)if(!He(s[i],e[i]))return!1;return!0}function Nh(s,e,i,o,a,c){if(Hh=c,M=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fh.current=s===null||s.memoizedState===null?Oh:Ph,s=i(o,a),Jh){c=0;do{if(Jh=!1,Kh=0,25<=c)throw Error(p(301));c+=1,O=N=null,e.updateQueue=null,Fh.current=Qh,s=i(o,a)}while(Jh)}if(Fh.current=Rh,e=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,e)throw Error(p(300));return s}function Sh(){var s=Kh!==0;return Kh=0,s}function Th(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=s:O=O.next=s,O}function Uh(){if(N===null){var s=M.alternate;s=s!==null?s.memoizedState:null}else s=N.next;var e=O===null?M.memoizedState:O.next;if(e!==null)O=e,N=s;else{if(s===null)throw Error(p(310));N=s,s={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=s:O=O.next=s}return O}function Vh(s,e){return typeof e=="function"?e(s):e}function Wh(s){var e=Uh(),i=e.queue;if(i===null)throw Error(p(311));i.lastRenderedReducer=s;var o=N,a=o.baseQueue,c=i.pending;if(c!==null){if(a!==null){var d=a.next;a.next=c.next,c.next=d}o.baseQueue=a=c,i.pending=null}if(a!==null){c=a.next,o=o.baseState;var h=d=null,g=null,_=c;do{var j=_.lane;if((Hh&j)===j)g!==null&&(g=g.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),o=_.hasEagerState?_.eagerState:s(o,_.action);else{var b={lane:j,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};g===null?(h=g=b,d=o):g=g.next=b,M.lanes|=j,rh|=j}_=_.next}while(_!==null&&_!==c);g===null?d=o:g.next=h,He(o,e.memoizedState)||(dh=!0),e.memoizedState=o,e.baseState=d,e.baseQueue=g,i.lastRenderedState=o}if(s=i.interleaved,s!==null){a=s;do c=a.lane,M.lanes|=c,rh|=c,a=a.next;while(a!==s)}else a===null&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function Xh(s){var e=Uh(),i=e.queue;if(i===null)throw Error(p(311));i.lastRenderedReducer=s;var o=i.dispatch,a=i.pending,c=e.memoizedState;if(a!==null){i.pending=null;var d=a=a.next;do c=s(c,d.action),d=d.next;while(d!==a);He(c,e.memoizedState)||(dh=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),i.lastRenderedState=c}return[c,o]}function Yh(){}function Zh(s,e){var i=M,o=Uh(),a=e(),c=!He(o.memoizedState,a);if(c&&(o.memoizedState=a,dh=!0),o=o.queue,$h(ai.bind(null,i,o,s),[s]),o.getSnapshot!==e||c||O!==null&&O.memoizedState.tag&1){if(i.flags|=2048,bi(9,ci.bind(null,i,o,a,e),void 0,null),Q===null)throw Error(p(349));Hh&30||di(i,e,a)}return a}function di(s,e,i){s.flags|=16384,s={getSnapshot:e,value:i},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.stores=[s]):(i=e.stores,i===null?e.stores=[s]:i.push(s))}function ci(s,e,i,o){e.value=i,e.getSnapshot=o,ei(e)&&fi(s)}function ai(s,e,i){return i(function(){ei(e)&&fi(s)})}function ei(s){var e=s.getSnapshot;s=s.value;try{var i=e();return!He(s,i)}catch{return!0}}function fi(s){var e=ih(s,1);e!==null&&gi(e,s,1,-1)}function hi(s){var e=Th();return typeof s=="function"&&(s=s()),e.memoizedState=e.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:s},e.queue=s,s=s.dispatch=ii.bind(null,M,s),[e.memoizedState,s]}function bi(s,e,i,o){return s={tag:s,create:e,destroy:i,deps:o,next:null},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.lastEffect=s.next=s):(i=e.lastEffect,i===null?e.lastEffect=s.next=s:(o=i.next,i.next=s,s.next=o,e.lastEffect=s)),s}function ji(){return Uh().memoizedState}function ki(s,e,i,o){var a=Th();M.flags|=s,a.memoizedState=bi(1|e,i,void 0,o===void 0?null:o)}function li(s,e,i,o){var a=Uh();o=o===void 0?null:o;var c=void 0;if(N!==null){var d=N.memoizedState;if(c=d.destroy,o!==null&&Mh(o,d.deps)){a.memoizedState=bi(e,i,c,o);return}}M.flags|=s,a.memoizedState=bi(1|e,i,c,o)}function mi(s,e){return ki(8390656,8,s,e)}function $h(s,e){return li(2048,8,s,e)}function ni(s,e){return li(4,2,s,e)}function oi(s,e){return li(4,4,s,e)}function pi(s,e){if(typeof e=="function")return s=s(),e(s),function(){e(null)};if(e!=null)return s=s(),e.current=s,function(){e.current=null}}function qi(s,e,i){return i=i!=null?i.concat([s]):null,li(4,4,pi.bind(null,e,s),i)}function ri(){}function si(s,e){var i=Uh();e=e===void 0?null:e;var o=i.memoizedState;return o!==null&&e!==null&&Mh(e,o[1])?o[0]:(i.memoizedState=[s,e],s)}function ti(s,e){var i=Uh();e=e===void 0?null:e;var o=i.memoizedState;return o!==null&&e!==null&&Mh(e,o[1])?o[0]:(s=s(),i.memoizedState=[s,e],s)}function ui(s,e,i){return Hh&21?(He(i,e)||(i=yc(),M.lanes|=i,rh|=i,s.baseState=!0),e):(s.baseState&&(s.baseState=!1,dh=!0),s.memoizedState=i)}function vi(s,e){var i=C;C=i!==0&&4>i?i:4,s(!0);var o=Gh.transition;Gh.transition={};try{s(!1),e()}finally{C=i,Gh.transition=o}}function wi(){return Uh().memoizedState}function xi(s,e,i){var o=yi(s);if(i={lane:o,action:i,hasEagerState:!1,eagerState:null,next:null},zi(s))Ai(e,i);else if(i=hh(s,e,i,o),i!==null){var a=R();gi(i,s,o,a),Bi(i,e,o)}}function ii(s,e,i){var o=yi(s),a={lane:o,action:i,hasEagerState:!1,eagerState:null,next:null};if(zi(s))Ai(e,a);else{var c=s.alternate;if(s.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var d=e.lastRenderedState,h=c(d,i);if(a.hasEagerState=!0,a.eagerState=h,He(h,d)){var g=e.interleaved;g===null?(a.next=a,gh(e)):(a.next=g.next,g.next=a),e.interleaved=a;return}}catch{}finally{}i=hh(s,e,a,o),i!==null&&(a=R(),gi(i,s,o,a),Bi(i,e,o))}}function zi(s){var e=s.alternate;return s===M||e!==null&&e===M}function Ai(s,e){Jh=Ih=!0;var i=s.pending;i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e}function Bi(s,e,i){if(i&4194240){var o=e.lanes;o&=s.pendingLanes,i|=o,e.lanes=i,Cc(s,i)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(s,e){return Th().memoizedState=[s,e===void 0?null:e],s},useContext:eh,useEffect:mi,useImperativeHandle:function(s,e,i){return i=i!=null?i.concat([s]):null,ki(4194308,4,pi.bind(null,e,s),i)},useLayoutEffect:function(s,e){return ki(4194308,4,s,e)},useInsertionEffect:function(s,e){return ki(4,2,s,e)},useMemo:function(s,e){var i=Th();return e=e===void 0?null:e,s=s(),i.memoizedState=[s,e],s},useReducer:function(s,e,i){var o=Th();return e=i!==void 0?i(e):e,o.memoizedState=o.baseState=e,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:e},o.queue=s,s=s.dispatch=xi.bind(null,M,s),[o.memoizedState,s]},useRef:function(s){var e=Th();return s={current:s},e.memoizedState=s},useState:hi,useDebugValue:ri,useDeferredValue:function(s){return Th().memoizedState=s},useTransition:function(){var s=hi(!1),e=s[0];return s=vi.bind(null,s[1]),Th().memoizedState=s,[e,s]},useMutableSource:function(){},useSyncExternalStore:function(s,e,i){var o=M,a=Th();if(I){if(i===void 0)throw Error(p(407));i=i()}else{if(i=e(),Q===null)throw Error(p(349));Hh&30||di(o,e,i)}a.memoizedState=i;var c={value:i,getSnapshot:e};return a.queue=c,mi(ai.bind(null,o,c,s),[s]),o.flags|=2048,bi(9,ci.bind(null,o,c,i,e),void 0,null),i},useId:function(){var s=Th(),e=Q.identifierPrefix;if(I){var i=sg,o=rg;i=(o&~(1<<32-oc(o)-1)).toString(32)+i,e=":"+e+"R"+i,i=Kh++,0<i&&(e+="H"+i.toString(32)),e+=":"}else i=Lh++,e=":"+e+"r"+i.toString(32)+":";return s.memoizedState=e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var e=Uh();return ui(e,N.memoizedState,s)},useTransition:function(){var s=Wh(Vh)[0],e=Uh().memoizedState;return[s,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var e=Uh();return N===null?e.memoizedState=s:ui(e,N.memoizedState,s)},useTransition:function(){var s=Xh(Vh)[0],e=Uh().memoizedState;return[s,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(s,e){if(s&&s.defaultProps){e=A({},e),s=s.defaultProps;for(var i in s)e[i]===void 0&&(e[i]=s[i]);return e}return e}function Di(s,e,i,o){e=s.memoizedState,i=i(o,e),i=i==null?e:A({},e,i),s.memoizedState=i,s.lanes===0&&(s.updateQueue.baseState=i)}var Ei={isMounted:function(s){return(s=s._reactInternals)?Vb(s)===s:!1},enqueueSetState:function(s,e,i){s=s._reactInternals;var o=R(),a=yi(s),c=mh(o,a);c.payload=e,i!=null&&(c.callback=i),e=nh(s,c,a),e!==null&&(gi(e,s,a,o),oh(e,s,a))},enqueueReplaceState:function(s,e,i){s=s._reactInternals;var o=R(),a=yi(s),c=mh(o,a);c.tag=1,c.payload=e,i!=null&&(c.callback=i),e=nh(s,c,a),e!==null&&(gi(e,s,a,o),oh(e,s,a))},enqueueForceUpdate:function(s,e){s=s._reactInternals;var i=R(),o=yi(s),a=mh(i,o);a.tag=2,e!=null&&(a.callback=e),e=nh(s,a,o),e!==null&&(gi(e,s,o,i),oh(e,s,o))}};function Fi(s,e,i,o,a,c,d){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(o,c,d):e.prototype&&e.prototype.isPureReactComponent?!Ie(i,o)||!Ie(a,c):!0}function Gi(s,e,i){var o=!1,a=Vf,c=e.contextType;return typeof c=="object"&&c!==null?c=eh(c):(a=Zf(e)?Xf:H.current,o=e.contextTypes,c=(o=o!=null)?Yf(s,a):Vf),e=new e(i,c),s.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ei,s.stateNode=e,e._reactInternals=s,o&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=a,s.__reactInternalMemoizedMaskedChildContext=c),e}function Hi(s,e,i,o){s=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,o),e.state!==s&&Ei.enqueueReplaceState(e,e.state,null)}function Ii(s,e,i,o){var a=s.stateNode;a.props=i,a.state=s.memoizedState,a.refs={},kh(s);var c=e.contextType;typeof c=="object"&&c!==null?a.context=eh(c):(c=Zf(e)?Xf:H.current,a.context=Yf(s,c)),a.state=s.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(Di(s,e,c,i),a.state=s.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Ei.enqueueReplaceState(a,a.state,null),qh(s,i,a,o),a.state=s.memoizedState),typeof a.componentDidMount=="function"&&(s.flags|=4194308)}function Ji(s,e){try{var i="",o=e;do i+=Pa(o),o=o.return;while(o);var a=i}catch(c){a=`
Error generating stack: `+c.message+`
`+c.stack}return{value:s,source:e,stack:a,digest:null}}function Ki(s,e,i){return{value:s,source:null,stack:i??null,digest:e??null}}function Li(s,e){try{console.error(e.value)}catch(i){setTimeout(function(){throw i})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(s,e,i){i=mh(-1,i),i.tag=3,i.payload={element:null};var o=e.value;return i.callback=function(){Oi||(Oi=!0,Pi=o),Li(s,e)},i}function Qi(s,e,i){i=mh(-1,i),i.tag=3;var o=s.type.getDerivedStateFromError;if(typeof o=="function"){var a=e.value;i.payload=function(){return o(a)},i.callback=function(){Li(s,e)}}var c=s.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(i.callback=function(){Li(s,e),typeof o!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),i}function Si(s,e,i){var o=s.pingCache;if(o===null){o=s.pingCache=new Mi;var a=new Set;o.set(e,a)}else a=o.get(e),a===void 0&&(a=new Set,o.set(e,a));a.has(i)||(a.add(i),s=Ti.bind(null,s,e,i),e.then(s,s))}function Ui(s){do{var e;if((e=s.tag===13)&&(e=s.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return s;s=s.return}while(s!==null);return null}function Vi(s,e,i,o,a){return s.mode&1?(s.flags|=65536,s.lanes=a,s):(s===e?s.flags|=65536:(s.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(e=mh(-1,1),e.tag=2,nh(i,e,1))),i.lanes|=1),s)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(s,e,i,o){e.child=s===null?Vg(e,null,i,o):Ug(e,s.child,i,o)}function Yi(s,e,i,o,a){i=i.render;var c=e.ref;return ch(e,a),o=Nh(s,e,i,o,c,a),i=Sh(),s!==null&&!dh?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~a,Zi(s,e,a)):(I&&i&&vg(e),e.flags|=1,Xi(s,e,o,a),e.child)}function $i(s,e,i,o,a){if(s===null){var c=i.type;return typeof c=="function"&&!aj(c)&&c.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=c,bj(s,e,c,o,a)):(s=Rg(i.type,null,o,e,e.mode,a),s.ref=e.ref,s.return=e,e.child=s)}if(c=s.child,!(s.lanes&a)){var d=c.memoizedProps;if(i=i.compare,i=i!==null?i:Ie,i(d,o)&&s.ref===e.ref)return Zi(s,e,a)}return e.flags|=1,s=Pg(c,o),s.ref=e.ref,s.return=e,e.child=s}function bj(s,e,i,o,a){if(s!==null){var c=s.memoizedProps;if(Ie(c,o)&&s.ref===e.ref)if(dh=!1,e.pendingProps=o=c,(s.lanes&a)!==0)s.flags&131072&&(dh=!0);else return e.lanes=s.lanes,Zi(s,e,a)}return cj(s,e,i,o,a)}function dj(s,e,i){var o=e.pendingProps,a=o.children,c=s!==null?s.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=i;else{if(!(i&1073741824))return s=c!==null?c.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:s,cachePool:null,transitions:null},e.updateQueue=null,G(ej,fj),fj|=s,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=c!==null?c.baseLanes:i,G(ej,fj),fj|=o}else c!==null?(o=c.baseLanes|i,e.memoizedState=null):o=i,G(ej,fj),fj|=o;return Xi(s,e,a,i),e.child}function gj(s,e){var i=e.ref;(s===null&&i!==null||s!==null&&s.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function cj(s,e,i,o,a){var c=Zf(i)?Xf:H.current;return c=Yf(e,c),ch(e,a),i=Nh(s,e,i,o,c,a),o=Sh(),s!==null&&!dh?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~a,Zi(s,e,a)):(I&&o&&vg(e),e.flags|=1,Xi(s,e,i,a),e.child)}function hj(s,e,i,o,a){if(Zf(i)){var c=!0;cg(e)}else c=!1;if(ch(e,a),e.stateNode===null)ij(s,e),Gi(e,i,o),Ii(e,i,o,a),o=!0;else if(s===null){var d=e.stateNode,h=e.memoizedProps;d.props=h;var g=d.context,_=i.contextType;typeof _=="object"&&_!==null?_=eh(_):(_=Zf(i)?Xf:H.current,_=Yf(e,_));var j=i.getDerivedStateFromProps,b=typeof j=="function"||typeof d.getSnapshotBeforeUpdate=="function";b||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==o||g!==_)&&Hi(e,d,o,_),jh=!1;var $=e.memoizedState;d.state=$,qh(e,o,d,a),g=e.memoizedState,h!==o||$!==g||Wf.current||jh?(typeof j=="function"&&(Di(e,i,j,o),g=e.memoizedState),(h=jh||Fi(e,i,h,o,$,g,_))?(b||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=g),d.props=o,d.state=g,d.context=_,o=h):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{d=e.stateNode,lh(s,e),h=e.memoizedProps,_=e.type===e.elementType?h:Ci(e.type,h),d.props=_,b=e.pendingProps,$=d.context,g=i.contextType,typeof g=="object"&&g!==null?g=eh(g):(g=Zf(i)?Xf:H.current,g=Yf(e,g));var et=i.getDerivedStateFromProps;(j=typeof et=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==b||$!==g)&&Hi(e,d,o,g),jh=!1,$=e.memoizedState,d.state=$,qh(e,o,d,a);var _e=e.memoizedState;h!==b||$!==_e||Wf.current||jh?(typeof et=="function"&&(Di(e,i,et,o),_e=e.memoizedState),(_=jh||Fi(e,i,_,o,$,_e,g)||!1)?(j||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(o,_e,g),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(o,_e,g)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||h===s.memoizedProps&&$===s.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===s.memoizedProps&&$===s.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=_e),d.props=o,d.state=_e,d.context=g,o=_):(typeof d.componentDidUpdate!="function"||h===s.memoizedProps&&$===s.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===s.memoizedProps&&$===s.memoizedState||(e.flags|=1024),o=!1)}return jj(s,e,i,o,c,a)}function jj(s,e,i,o,a,c){gj(s,e);var d=(e.flags&128)!==0;if(!o&&!d)return a&&dg(e,i,!1),Zi(s,e,c);o=e.stateNode,Wi.current=e;var h=d&&typeof i.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,s!==null&&d?(e.child=Ug(e,s.child,null,c),e.child=Ug(e,null,h,c)):Xi(s,e,h,c),e.memoizedState=o.state,a&&dg(e,i,!0),e.child}function kj(s){var e=s.stateNode;e.pendingContext?ag(s,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(s,e.context,!1),yh(s,e.containerInfo)}function lj(s,e,i,o,a){return Ig(),Jg(a),e.flags|=256,Xi(s,e,i,o),e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(s){return{baseLanes:s,cachePool:null,transitions:null}}function oj(s,e,i){var o=e.pendingProps,a=L.current,c=!1,d=(e.flags&128)!==0,h;if((h=d)||(h=s!==null&&s.memoizedState===null?!1:(a&2)!==0),h?(c=!0,e.flags&=-129):(s===null||s.memoizedState!==null)&&(a|=1),G(L,a&1),s===null)return Eg(e),s=e.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(e.mode&1?s.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=o.children,s=o.fallback,c?(o=e.mode,c=e.child,d={mode:"hidden",children:d},!(o&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=pj(d,o,0,null),s=Tg(s,o,i,null),c.return=e,s.return=e,c.sibling=s,e.child=c,e.child.memoizedState=nj(i),e.memoizedState=mj,s):qj(e,d));if(a=s.memoizedState,a!==null&&(h=a.dehydrated,h!==null))return rj(s,e,d,o,h,a,i);if(c){c=o.fallback,d=e.mode,a=s.child,h=a.sibling;var g={mode:"hidden",children:o.children};return!(d&1)&&e.child!==a?(o=e.child,o.childLanes=0,o.pendingProps=g,e.deletions=null):(o=Pg(a,g),o.subtreeFlags=a.subtreeFlags&14680064),h!==null?c=Pg(h,c):(c=Tg(c,d,i,null),c.flags|=2),c.return=e,o.return=e,o.sibling=c,e.child=o,o=c,c=e.child,d=s.child.memoizedState,d=d===null?nj(i):{baseLanes:d.baseLanes|i,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=s.childLanes&~i,e.memoizedState=mj,o}return c=s.child,s=c.sibling,o=Pg(c,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=i),o.return=e,o.sibling=null,s!==null&&(i=e.deletions,i===null?(e.deletions=[s],e.flags|=16):i.push(s)),e.child=o,e.memoizedState=null,o}function qj(s,e){return e=pj({mode:"visible",children:e},s.mode,0,null),e.return=s,s.child=e}function sj(s,e,i,o){return o!==null&&Jg(o),Ug(e,s.child,null,i),s=qj(e,e.pendingProps.children),s.flags|=2,e.memoizedState=null,s}function rj(s,e,i,o,a,c,d){if(i)return e.flags&256?(e.flags&=-257,o=Ki(Error(p(422))),sj(s,e,d,o)):e.memoizedState!==null?(e.child=s.child,e.flags|=128,null):(c=o.fallback,a=e.mode,o=pj({mode:"visible",children:o.children},a,0,null),c=Tg(c,a,d,null),c.flags|=2,o.return=e,c.return=e,o.sibling=c,e.child=o,e.mode&1&&Ug(e,s.child,null,d),e.child.memoizedState=nj(d),e.memoizedState=mj,c);if(!(e.mode&1))return sj(s,e,d,null);if(a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var h=o.dgst;return o=h,c=Error(p(419)),o=Ki(c,o,void 0),sj(s,e,d,o)}if(h=(d&s.childLanes)!==0,dh||h){if(o=Q,o!==null){switch(d&-d){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(o.suspendedLanes|d)?0:a,a!==0&&a!==c.retryLane&&(c.retryLane=a,ih(s,a),gi(o,s,a,-1))}return tj(),o=Ki(Error(p(421))),sj(s,e,d,o)}return a.data==="$?"?(e.flags|=128,e.child=s.child,e=uj.bind(null,s),a._reactRetry=e,null):(s=c.treeContext,yg=Lf(a.nextSibling),xg=e,I=!0,zg=null,s!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=s.id,sg=s.overflow,qg=e),e=qj(e,o.children),e.flags|=4096,e)}function vj(s,e,i){s.lanes|=e;var o=s.alternate;o!==null&&(o.lanes|=e),bh(s.return,e,i)}function wj(s,e,i,o,a){var c=s.memoizedState;c===null?s.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:i,tailMode:a}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=o,c.tail=i,c.tailMode=a)}function xj(s,e,i){var o=e.pendingProps,a=o.revealOrder,c=o.tail;if(Xi(s,e,o.children,i),o=L.current,o&2)o=o&1|2,e.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=e.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&vj(s,i,e);else if(s.tag===19)vj(s,i,e);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}o&=1}if(G(L,o),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(i=e.child,a=null;i!==null;)s=i.alternate,s!==null&&Ch(s)===null&&(a=i),i=i.sibling;i=a,i===null?(a=e.child,e.child=null):(a=i.sibling,i.sibling=null),wj(e,!1,a,i,c);break;case"backwards":for(i=null,a=e.child,e.child=null;a!==null;){if(s=a.alternate,s!==null&&Ch(s)===null){e.child=a;break}s=a.sibling,a.sibling=i,i=a,a=s}wj(e,!0,i,null,c);break;case"together":wj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ij(s,e){!(e.mode&1)&&s!==null&&(s.alternate=null,e.alternate=null,e.flags|=2)}function Zi(s,e,i){if(s!==null&&(e.dependencies=s.dependencies),rh|=e.lanes,!(i&e.childLanes))return null;if(s!==null&&e.child!==s.child)throw Error(p(153));if(e.child!==null){for(s=e.child,i=Pg(s,s.pendingProps),e.child=i,i.return=e;s.sibling!==null;)s=s.sibling,i=i.sibling=Pg(s,s.pendingProps),i.return=e;i.sibling=null}return e.child}function yj(s,e,i){switch(e.tag){case 3:kj(e),Ig();break;case 5:Ah(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:yh(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,a=e.memoizedProps.value;G(Wg,o._currentValue),o._currentValue=a;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(G(L,L.current&1),e.flags|=128,null):i&e.child.childLanes?oj(s,e,i):(G(L,L.current&1),s=Zi(s,e,i),s!==null?s.sibling:null);G(L,L.current&1);break;case 19:if(o=(i&e.childLanes)!==0,s.flags&128){if(o)return xj(s,e,i);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),G(L,L.current),o)break;return null;case 22:case 23:return e.lanes=0,dj(s,e,i)}return Zi(s,e,i)}var zj,Aj,Bj,Cj;zj=function(s,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)s.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Aj=function(){};Bj=function(s,e,i,o){var a=s.memoizedProps;if(a!==o){s=e.stateNode,xh(uh.current);var c=null;switch(i){case"input":a=Ya(s,a),o=Ya(s,o),c=[];break;case"select":a=A({},a,{value:void 0}),o=A({},o,{value:void 0}),c=[];break;case"textarea":a=gb(s,a),o=gb(s,o),c=[];break;default:typeof a.onClick!="function"&&typeof o.onClick=="function"&&(s.onclick=Bf)}ub(i,o);var d;i=null;for(_ in a)if(!o.hasOwnProperty(_)&&a.hasOwnProperty(_)&&a[_]!=null)if(_==="style"){var h=a[_];for(d in h)h.hasOwnProperty(d)&&(i||(i={}),i[d]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(ea.hasOwnProperty(_)?c||(c=[]):(c=c||[]).push(_,null));for(_ in o){var g=o[_];if(h=a!=null?a[_]:void 0,o.hasOwnProperty(_)&&g!==h&&(g!=null||h!=null))if(_==="style")if(h){for(d in h)!h.hasOwnProperty(d)||g&&g.hasOwnProperty(d)||(i||(i={}),i[d]="");for(d in g)g.hasOwnProperty(d)&&h[d]!==g[d]&&(i||(i={}),i[d]=g[d])}else i||(c||(c=[]),c.push(_,i)),i=g;else _==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,h=h?h.__html:void 0,g!=null&&h!==g&&(c=c||[]).push(_,g)):_==="children"?typeof g!="string"&&typeof g!="number"||(c=c||[]).push(_,""+g):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_)?(g!=null&&_==="onScroll"&&D("scroll",s),c||h===g||(c=[])):(c=c||[]).push(_,g))}i&&(c=c||[]).push("style",i);var _=c;(e.updateQueue=_)&&(e.flags|=4)}};Cj=function(s,e,i,o){i!==o&&(e.flags|=4)};function Dj(s,e){if(!I)switch(s.tailMode){case"hidden":e=s.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?s.tail=null:i.sibling=null;break;case"collapsed":i=s.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?e||s.tail===null?s.tail=null:s.tail.sibling=null:o.sibling=null}}function S(s){var e=s.alternate!==null&&s.alternate.child===s.child,i=0,o=0;if(e)for(var a=s.child;a!==null;)i|=a.lanes|a.childLanes,o|=a.subtreeFlags&14680064,o|=a.flags&14680064,a.return=s,a=a.sibling;else for(a=s.child;a!==null;)i|=a.lanes|a.childLanes,o|=a.subtreeFlags,o|=a.flags,a.return=s,a=a.sibling;return s.subtreeFlags|=o,s.childLanes=i,e}function Ej(s,e,i){var o=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(e),null;case 1:return Zf(e.type)&&$f(),S(e),null;case 3:return o=e.stateNode,zh(),E(Wf),E(H),Eh(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(Gg(e)?e.flags|=4:s===null||s.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(s,e),S(e),null;case 5:Bh(e);var a=xh(wh.current);if(i=e.type,s!==null&&e.stateNode!=null)Bj(s,e,i,o,a),s.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(p(166));return S(e),null}if(s=xh(uh.current),Gg(e)){o=e.stateNode,i=e.type;var c=e.memoizedProps;switch(o[Of]=e,o[Pf]=c,s=(e.mode&1)!==0,i){case"dialog":D("cancel",o),D("close",o);break;case"iframe":case"object":case"embed":D("load",o);break;case"video":case"audio":for(a=0;a<lf.length;a++)D(lf[a],o);break;case"source":D("error",o);break;case"img":case"image":case"link":D("error",o),D("load",o);break;case"details":D("toggle",o);break;case"input":Za(o,c),D("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!c.multiple},D("invalid",o);break;case"textarea":hb(o,c),D("invalid",o)}ub(i,c),a=null;for(var d in c)if(c.hasOwnProperty(d)){var h=c[d];d==="children"?typeof h=="string"?o.textContent!==h&&(c.suppressHydrationWarning!==!0&&Af(o.textContent,h,s),a=["children",h]):typeof h=="number"&&o.textContent!==""+h&&(c.suppressHydrationWarning!==!0&&Af(o.textContent,h,s),a=["children",""+h]):ea.hasOwnProperty(d)&&h!=null&&d==="onScroll"&&D("scroll",o)}switch(i){case"input":Va(o),db(o,c,!0);break;case"textarea":Va(o),jb(o);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(o.onclick=Bf)}o=a,e.updateQueue=o,o!==null&&(e.flags|=4)}else{d=a.nodeType===9?a:a.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=kb(i)),s==="http://www.w3.org/1999/xhtml"?i==="script"?(s=d.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof o.is=="string"?s=d.createElement(i,{is:o.is}):(s=d.createElement(i),i==="select"&&(d=s,o.multiple?d.multiple=!0:o.size&&(d.size=o.size))):s=d.createElementNS(s,i),s[Of]=e,s[Pf]=o,zj(s,e,!1,!1),e.stateNode=s;e:{switch(d=vb(i,o),i){case"dialog":D("cancel",s),D("close",s),a=o;break;case"iframe":case"object":case"embed":D("load",s),a=o;break;case"video":case"audio":for(a=0;a<lf.length;a++)D(lf[a],s);a=o;break;case"source":D("error",s),a=o;break;case"img":case"image":case"link":D("error",s),D("load",s),a=o;break;case"details":D("toggle",s),a=o;break;case"input":Za(s,o),a=Ya(s,o),D("invalid",s);break;case"option":a=o;break;case"select":s._wrapperState={wasMultiple:!!o.multiple},a=A({},o,{value:void 0}),D("invalid",s);break;case"textarea":hb(s,o),a=gb(s,o),D("invalid",s);break;default:a=o}ub(i,a),h=a;for(c in h)if(h.hasOwnProperty(c)){var g=h[c];c==="style"?sb(s,g):c==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&nb(s,g)):c==="children"?typeof g=="string"?(i!=="textarea"||g!=="")&&ob(s,g):typeof g=="number"&&ob(s,""+g):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ea.hasOwnProperty(c)?g!=null&&c==="onScroll"&&D("scroll",s):g!=null&&ta(s,c,g,d))}switch(i){case"input":Va(s),db(s,o,!1);break;case"textarea":Va(s),jb(s);break;case"option":o.value!=null&&s.setAttribute("value",""+Sa(o.value));break;case"select":s.multiple=!!o.multiple,c=o.value,c!=null?fb(s,!!o.multiple,c,!1):o.defaultValue!=null&&fb(s,!!o.multiple,o.defaultValue,!0);break;default:typeof a.onClick=="function"&&(s.onclick=Bf)}switch(i){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S(e),null;case 6:if(s&&e.stateNode!=null)Cj(s,e,s.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(p(166));if(i=xh(wh.current),xh(uh.current),Gg(e)){if(o=e.stateNode,i=e.memoizedProps,o[Of]=e,(c=o.nodeValue!==i)&&(s=xg,s!==null))switch(s.tag){case 3:Af(o.nodeValue,i,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Af(o.nodeValue,i,(s.mode&1)!==0)}c&&(e.flags|=4)}else o=(i.nodeType===9?i:i.ownerDocument).createTextNode(o),o[Of]=e,e.stateNode=o}return S(e),null;case 13:if(E(L),o=e.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(I&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,c=!1;else if(c=Gg(e),o!==null&&o.dehydrated!==null){if(s===null){if(!c)throw Error(p(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(p(317));c[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S(e),c=!1}else zg!==null&&(Fj(zg),zg=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=i,e):(o=o!==null,o!==(s!==null&&s.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(s===null||L.current&1?T===0&&(T=3):tj())),e.updateQueue!==null&&(e.flags|=4),S(e),null);case 4:return zh(),Aj(s,e),s===null&&sf(e.stateNode.containerInfo),S(e),null;case 10:return ah(e.type._context),S(e),null;case 17:return Zf(e.type)&&$f(),S(e),null;case 19:if(E(L),c=e.memoizedState,c===null)return S(e),null;if(o=(e.flags&128)!==0,d=c.rendering,d===null)if(o)Dj(c,!1);else{if(T!==0||s!==null&&s.flags&128)for(s=e.child;s!==null;){if(d=Ch(s),d!==null){for(e.flags|=128,Dj(c,!1),o=d.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=i,i=e.child;i!==null;)c=i,s=o,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=s,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,s=d.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i=i.sibling;return G(L,L.current&1|2),e.child}s=s.sibling}c.tail!==null&&B()>Gj&&(e.flags|=128,o=!0,Dj(c,!1),e.lanes=4194304)}else{if(!o)if(s=Ch(d),s!==null){if(e.flags|=128,o=!0,i=s.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),Dj(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!I)return S(e),null}else 2*B()-c.renderingStartTime>Gj&&i!==1073741824&&(e.flags|=128,o=!0,Dj(c,!1),e.lanes=4194304);c.isBackwards?(d.sibling=e.child,e.child=d):(i=c.last,i!==null?i.sibling=d:e.child=d,c.last=d)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=B(),e.sibling=null,i=L.current,G(L,o?i&1|2:i&1),e):(S(e),null);case 22:case 23:return Hj(),o=e.memoizedState!==null,s!==null&&s.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?fj&1073741824&&(S(e),e.subtreeFlags&6&&(e.flags|=8192)):S(e),null;case 24:return null;case 25:return null}throw Error(p(156,e.tag))}function Ij(s,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 3:return zh(),E(Wf),E(H),Eh(),s=e.flags,s&65536&&!(s&128)?(e.flags=s&-65537|128,e):null;case 5:return Bh(e),null;case 13:if(E(L),s=e.memoizedState,s!==null&&s.dehydrated!==null){if(e.alternate===null)throw Error(p(340));Ig()}return s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(s,e){var i=s.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(o){W(s,e,o)}else i.current=null}function Mj(s,e,i){try{i()}catch(o){W(s,e,o)}}var Nj=!1;function Oj(s,e){if(Cf=dd,s=Me(),Ne(s)){if("selectionStart"in s)var i={start:s.selectionStart,end:s.selectionEnd};else e:{i=(i=s.ownerDocument)&&i.defaultView||window;var o=i.getSelection&&i.getSelection();if(o&&o.rangeCount!==0){i=o.anchorNode;var a=o.anchorOffset,c=o.focusNode;o=o.focusOffset;try{i.nodeType,c.nodeType}catch{i=null;break e}var d=0,h=-1,g=-1,_=0,j=0,b=s,$=null;t:for(;;){for(var et;b!==i||a!==0&&b.nodeType!==3||(h=d+a),b!==c||o!==0&&b.nodeType!==3||(g=d+o),b.nodeType===3&&(d+=b.nodeValue.length),(et=b.firstChild)!==null;)$=b,b=et;for(;;){if(b===s)break t;if($===i&&++_===a&&(h=d),$===c&&++j===o&&(g=d),(et=b.nextSibling)!==null)break;b=$,$=b.parentNode}b=et}i=h===-1||g===-1?null:{start:h,end:g}}else i=null}i=i||{start:0,end:0}}else i=null;for(Df={focusedElem:s,selectionRange:i},dd=!1,V=e;V!==null;)if(e=V,s=e.child,(e.subtreeFlags&1028)!==0&&s!==null)s.return=e,V=s;else for(;V!==null;){e=V;try{var _e=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_e!==null){var st=_e.memoizedProps,ot=_e.memoizedState,tt=e.stateNode,nt=tt.getSnapshotBeforeUpdate(e.elementType===e.type?st:Ci(e.type,st),ot);tt.__reactInternalSnapshotBeforeUpdate=nt}break;case 3:var rt=e.stateNode.containerInfo;rt.nodeType===1?rt.textContent="":rt.nodeType===9&&rt.documentElement&&rt.removeChild(rt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(it){W(e,e.return,it)}if(s=e.sibling,s!==null){s.return=e.return,V=s;break}V=e.return}return _e=Nj,Nj=!1,_e}function Pj(s,e,i){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var a=o=o.next;do{if((a.tag&s)===s){var c=a.destroy;a.destroy=void 0,c!==void 0&&Mj(e,i,c)}a=a.next}while(a!==o)}}function Qj(s,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&s)===s){var o=i.create;i.destroy=o()}i=i.next}while(i!==e)}}function Rj(s){var e=s.ref;if(e!==null){var i=s.stateNode;switch(s.tag){case 5:s=i;break;default:s=i}typeof e=="function"?e(s):e.current=s}}function Sj(s){var e=s.alternate;e!==null&&(s.alternate=null,Sj(e)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(e=s.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Tj(s){return s.tag===5||s.tag===3||s.tag===4}function Uj(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Tj(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vj(s,e,i){var o=s.tag;if(o===5||o===6)s=s.stateNode,e?i.nodeType===8?i.parentNode.insertBefore(s,e):i.insertBefore(s,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(s,i)):(e=i,e.appendChild(s)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=Bf));else if(o!==4&&(s=s.child,s!==null))for(Vj(s,e,i),s=s.sibling;s!==null;)Vj(s,e,i),s=s.sibling}function Wj(s,e,i){var o=s.tag;if(o===5||o===6)s=s.stateNode,e?i.insertBefore(s,e):i.appendChild(s);else if(o!==4&&(s=s.child,s!==null))for(Wj(s,e,i),s=s.sibling;s!==null;)Wj(s,e,i),s=s.sibling}var X=null,Xj=!1;function Yj(s,e,i){for(i=i.child;i!==null;)Zj(s,e,i),i=i.sibling}function Zj(s,e,i){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,i)}catch{}switch(i.tag){case 5:U||Lj(i,e);case 6:var o=X,a=Xj;X=null,Yj(s,e,i),X=o,Xj=a,X!==null&&(Xj?(s=X,i=i.stateNode,s.nodeType===8?s.parentNode.removeChild(i):s.removeChild(i)):X.removeChild(i.stateNode));break;case 18:X!==null&&(Xj?(s=X,i=i.stateNode,s.nodeType===8?Kf(s.parentNode,i):s.nodeType===1&&Kf(s,i),bd(s)):Kf(X,i.stateNode));break;case 4:o=X,a=Xj,X=i.stateNode.containerInfo,Xj=!0,Yj(s,e,i),X=o,Xj=a;break;case 0:case 11:case 14:case 15:if(!U&&(o=i.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){a=o=o.next;do{var c=a,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&Mj(i,e,d),a=a.next}while(a!==o)}Yj(s,e,i);break;case 1:if(!U&&(Lj(i,e),o=i.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=i.memoizedProps,o.state=i.memoizedState,o.componentWillUnmount()}catch(h){W(i,e,h)}Yj(s,e,i);break;case 21:Yj(s,e,i);break;case 22:i.mode&1?(U=(o=U)||i.memoizedState!==null,Yj(s,e,i),U=o):Yj(s,e,i);break;default:Yj(s,e,i)}}function ak(s){var e=s.updateQueue;if(e!==null){s.updateQueue=null;var i=s.stateNode;i===null&&(i=s.stateNode=new Kj),e.forEach(function(o){var a=bk.bind(null,s,o);i.has(o)||(i.add(o),o.then(a,a))})}}function ck(s,e){var i=e.deletions;if(i!==null)for(var o=0;o<i.length;o++){var a=i[o];try{var c=s,d=e,h=d;e:for(;h!==null;){switch(h.tag){case 5:X=h.stateNode,Xj=!1;break e;case 3:X=h.stateNode.containerInfo,Xj=!0;break e;case 4:X=h.stateNode.containerInfo,Xj=!0;break e}h=h.return}if(X===null)throw Error(p(160));Zj(c,d,a),X=null,Xj=!1;var g=a.alternate;g!==null&&(g.return=null),a.return=null}catch(_){W(a,e,_)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dk(e,s),e=e.sibling}function dk(s,e){var i=s.alternate,o=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(ck(e,s),ek(s),o&4){try{Pj(3,s,s.return),Qj(3,s)}catch(st){W(s,s.return,st)}try{Pj(5,s,s.return)}catch(st){W(s,s.return,st)}}break;case 1:ck(e,s),ek(s),o&512&&i!==null&&Lj(i,i.return);break;case 5:if(ck(e,s),ek(s),o&512&&i!==null&&Lj(i,i.return),s.flags&32){var a=s.stateNode;try{ob(a,"")}catch(st){W(s,s.return,st)}}if(o&4&&(a=s.stateNode,a!=null)){var c=s.memoizedProps,d=i!==null?i.memoizedProps:c,h=s.type,g=s.updateQueue;if(s.updateQueue=null,g!==null)try{h==="input"&&c.type==="radio"&&c.name!=null&&ab(a,c),vb(h,d);var _=vb(h,c);for(d=0;d<g.length;d+=2){var j=g[d],b=g[d+1];j==="style"?sb(a,b):j==="dangerouslySetInnerHTML"?nb(a,b):j==="children"?ob(a,b):ta(a,j,b,_)}switch(h){case"input":bb(a,c);break;case"textarea":ib(a,c);break;case"select":var $=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!c.multiple;var et=c.value;et!=null?fb(a,!!c.multiple,et,!1):$!==!!c.multiple&&(c.defaultValue!=null?fb(a,!!c.multiple,c.defaultValue,!0):fb(a,!!c.multiple,c.multiple?[]:"",!1))}a[Pf]=c}catch(st){W(s,s.return,st)}}break;case 6:if(ck(e,s),ek(s),o&4){if(s.stateNode===null)throw Error(p(162));a=s.stateNode,c=s.memoizedProps;try{a.nodeValue=c}catch(st){W(s,s.return,st)}}break;case 3:if(ck(e,s),ek(s),o&4&&i!==null&&i.memoizedState.isDehydrated)try{bd(e.containerInfo)}catch(st){W(s,s.return,st)}break;case 4:ck(e,s),ek(s);break;case 13:ck(e,s),ek(s),a=s.child,a.flags&8192&&(c=a.memoizedState!==null,a.stateNode.isHidden=c,!c||a.alternate!==null&&a.alternate.memoizedState!==null||(fk=B())),o&4&&ak(s);break;case 22:if(j=i!==null&&i.memoizedState!==null,s.mode&1?(U=(_=U)||j,ck(e,s),U=_):ck(e,s),ek(s),o&8192){if(_=s.memoizedState!==null,(s.stateNode.isHidden=_)&&!j&&s.mode&1)for(V=s,j=s.child;j!==null;){for(b=V=j;V!==null;){switch($=V,et=$.child,$.tag){case 0:case 11:case 14:case 15:Pj(4,$,$.return);break;case 1:Lj($,$.return);var _e=$.stateNode;if(typeof _e.componentWillUnmount=="function"){o=$,i=$.return;try{e=o,_e.props=e.memoizedProps,_e.state=e.memoizedState,_e.componentWillUnmount()}catch(st){W(o,i,st)}}break;case 5:Lj($,$.return);break;case 22:if($.memoizedState!==null){gk(b);continue}}et!==null?(et.return=$,V=et):gk(b)}j=j.sibling}e:for(j=null,b=s;;){if(b.tag===5){if(j===null){j=b;try{a=b.stateNode,_?(c=a.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(h=b.stateNode,g=b.memoizedProps.style,d=g!=null&&g.hasOwnProperty("display")?g.display:null,h.style.display=rb("display",d))}catch(st){W(s,s.return,st)}}}else if(b.tag===6){if(j===null)try{b.stateNode.nodeValue=_?"":b.memoizedProps}catch(st){W(s,s.return,st)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===s)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===s)break e;for(;b.sibling===null;){if(b.return===null||b.return===s)break e;j===b&&(j=null),b=b.return}j===b&&(j=null),b.sibling.return=b.return,b=b.sibling}}break;case 19:ck(e,s),ek(s),o&4&&ak(s);break;case 21:break;default:ck(e,s),ek(s)}}function ek(s){var e=s.flags;if(e&2){try{e:{for(var i=s.return;i!==null;){if(Tj(i)){var o=i;break e}i=i.return}throw Error(p(160))}switch(o.tag){case 5:var a=o.stateNode;o.flags&32&&(ob(a,""),o.flags&=-33);var c=Uj(s);Wj(s,c,a);break;case 3:case 4:var d=o.stateNode.containerInfo,h=Uj(s);Vj(s,h,d);break;default:throw Error(p(161))}}catch(g){W(s,s.return,g)}s.flags&=-3}e&4096&&(s.flags&=-4097)}function hk(s,e,i){V=s,ik(s)}function ik(s,e,i){for(var o=(s.mode&1)!==0;V!==null;){var a=V,c=a.child;if(a.tag===22&&o){var d=a.memoizedState!==null||Jj;if(!d){var h=a.alternate,g=h!==null&&h.memoizedState!==null||U;h=Jj;var _=U;if(Jj=d,(U=g)&&!_)for(V=a;V!==null;)d=V,g=d.child,d.tag===22&&d.memoizedState!==null?jk(a):g!==null?(g.return=d,V=g):jk(a);for(;c!==null;)V=c,ik(c),c=c.sibling;V=a,Jj=h,U=_}kk(s)}else a.subtreeFlags&8772&&c!==null?(c.return=a,V=c):kk(s)}}function kk(s){for(;V!==null;){var e=V;if(e.flags&8772){var i=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U||Qj(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!U)if(i===null)o.componentDidMount();else{var a=e.elementType===e.type?i.memoizedProps:Ci(e.type,i.memoizedProps);o.componentDidUpdate(a,i.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&sh(e,c,o);break;case 3:var d=e.updateQueue;if(d!==null){if(i=null,e.child!==null)switch(e.child.tag){case 5:i=e.child.stateNode;break;case 1:i=e.child.stateNode}sh(e,d,i)}break;case 5:var h=e.stateNode;if(i===null&&e.flags&4){i=h;var g=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&i.focus();break;case"img":g.src&&(i.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _=e.alternate;if(_!==null){var j=_.memoizedState;if(j!==null){var b=j.dehydrated;b!==null&&bd(b)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||e.flags&512&&Rj(e)}catch($){W(e,e.return,$)}}if(e===s){V=null;break}if(i=e.sibling,i!==null){i.return=e.return,V=i;break}V=e.return}}function gk(s){for(;V!==null;){var e=V;if(e===s){V=null;break}var i=e.sibling;if(i!==null){i.return=e.return,V=i;break}V=e.return}}function jk(s){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{Qj(4,e)}catch(g){W(e,i,g)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var a=e.return;try{o.componentDidMount()}catch(g){W(e,a,g)}}var c=e.return;try{Rj(e)}catch(g){W(e,c,g)}break;case 5:var d=e.return;try{Rj(e)}catch(g){W(e,d,g)}}}catch(g){W(e,e.return,g)}if(e===s){V=null;break}var h=e.sibling;if(h!==null){h.return=e.return,V=h;break}V=e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(s){return s.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(s=C,s!==0||(s=window.event,s=s===void 0?16:jd(s.type)),s):1}function gi(s,e,i,o){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(s,i,o),(!(K&2)||s!==Q)&&(s===Q&&(!(K&2)&&(qk|=i),T===4&&Ck(s,Z)),Dk(s,o),i===1&&K===0&&!(e.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(s,e){var i=s.callbackNode;wc(s,e);var o=uc(s,s===Q?Z:0);if(o===0)i!==null&&bc(i),s.callbackNode=null,s.callbackPriority=0;else if(e=o&-o,s.callbackPriority!==e){if(i!=null&&bc(i),e===1)s.tag===0?ig(Ek.bind(null,s)):hg(Ek.bind(null,s)),Jf(function(){!(K&6)&&jg()}),i=null;else{switch(Dc(o)){case 1:i=fc;break;case 4:i=gc;break;case 16:i=hc;break;case 536870912:i=jc;break;default:i=hc}i=Fk(i,Gk.bind(null,s))}s.callbackPriority=e,s.callbackNode=i}}function Gk(s,e){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var i=s.callbackNode;if(Hk()&&s.callbackNode!==i)return null;var o=uc(s,s===Q?Z:0);if(o===0)return null;if(o&30||o&s.expiredLanes||e)e=Ik(s,o);else{e=o;var a=K;K|=2;var c=Jk();(Q!==s||Z!==e)&&(uk=null,Gj=B()+500,Kk(s,e));do try{Lk();break}catch(h){Mk(s,h)}while(!0);$g(),mk.current=c,K=a,Y!==null?e=0:(Q=null,Z=0,e=T)}if(e!==0){if(e===2&&(a=xc(s),a!==0&&(o=a,e=Nk(s,a))),e===1)throw i=pk,Kk(s,0),Ck(s,o),Dk(s,B()),i;if(e===6)Ck(s,o);else{if(a=s.current.alternate,!(o&30)&&!Ok(a)&&(e=Ik(s,o),e===2&&(c=xc(s),c!==0&&(o=c,e=Nk(s,c))),e===1))throw i=pk,Kk(s,0),Ck(s,o),Dk(s,B()),i;switch(s.finishedWork=a,s.finishedLanes=o,e){case 0:case 1:throw Error(p(345));case 2:Pk(s,tk,uk);break;case 3:if(Ck(s,o),(o&130023424)===o&&(e=fk+500-B(),10<e)){if(uc(s,0)!==0)break;if(a=s.suspendedLanes,(a&o)!==o){R(),s.pingedLanes|=s.suspendedLanes&a;break}s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),e);break}Pk(s,tk,uk);break;case 4:if(Ck(s,o),(o&4194240)===o)break;for(e=s.eventTimes,a=-1;0<o;){var d=31-oc(o);c=1<<d,d=e[d],d>a&&(a=d),o&=~c}if(o=a,o=B()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*lk(o/1960))-o,10<o){s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),o);break}Pk(s,tk,uk);break;case 5:Pk(s,tk,uk);break;default:throw Error(p(329))}}}return Dk(s,B()),s.callbackNode===i?Gk.bind(null,s):null}function Nk(s,e){var i=sk;return s.current.memoizedState.isDehydrated&&(Kk(s,e).flags|=256),s=Ik(s,e),s!==2&&(e=tk,tk=i,e!==null&&Fj(e)),s}function Fj(s){tk===null?tk=s:tk.push.apply(tk,s)}function Ok(s){for(var e=s;;){if(e.flags&16384){var i=e.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var o=0;o<i.length;o++){var a=i[o],c=a.getSnapshot;a=a.value;try{if(!He(c(),a))return!1}catch{return!1}}}if(i=e.child,e.subtreeFlags&16384&&i!==null)i.return=e,e=i;else{if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ck(s,e){for(e&=~rk,e&=~qk,s.suspendedLanes|=e,s.pingedLanes&=~e,s=s.expirationTimes;0<e;){var i=31-oc(e),o=1<<i;s[i]=-1,e&=~o}}function Ek(s){if(K&6)throw Error(p(327));Hk();var e=uc(s,0);if(!(e&1))return Dk(s,B()),null;var i=Ik(s,e);if(s.tag!==0&&i===2){var o=xc(s);o!==0&&(e=o,i=Nk(s,o))}if(i===1)throw i=pk,Kk(s,0),Ck(s,e),Dk(s,B()),i;if(i===6)throw Error(p(345));return s.finishedWork=s.current.alternate,s.finishedLanes=e,Pk(s,tk,uk),Dk(s,B()),null}function Qk(s,e){var i=K;K|=1;try{return s(e)}finally{K=i,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(s){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var e=K;K|=1;var i=ok.transition,o=C;try{if(ok.transition=null,C=1,s)return s()}finally{C=o,ok.transition=i,K=e,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(s,e){s.finishedWork=null,s.finishedLanes=0;var i=s.timeoutHandle;if(i!==-1&&(s.timeoutHandle=-1,Gf(i)),Y!==null)for(i=Y.return;i!==null;){var o=i;switch(wg(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(o);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(o.type._context);break;case 22:case 23:Hj()}i=i.return}if(Q=s,Y=s=Pg(s.current,null),Z=fj=e,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(e=0;e<fh.length;e++)if(i=fh[e],o=i.interleaved,o!==null){i.interleaved=null;var a=o.next,c=i.pending;if(c!==null){var d=c.next;c.next=a,o.next=d}i.pending=o}fh=null}return s}function Mk(s,e){do{var i=Y;try{if($g(),Fh.current=Rh,Ih){for(var o=M.memoizedState;o!==null;){var a=o.queue;a!==null&&(a.pending=null),o=o.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,i===null||i.return===null){T=1,pk=e,Y=null;break}e:{var c=s,d=i.return,h=i,g=e;if(e=Z,h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var _=g,j=h,b=j.tag;if(!(j.mode&1)&&(b===0||b===11||b===15)){var $=j.alternate;$?(j.updateQueue=$.updateQueue,j.memoizedState=$.memoizedState,j.lanes=$.lanes):(j.updateQueue=null,j.memoizedState=null)}var et=Ui(d);if(et!==null){et.flags&=-257,Vi(et,d,h,c,e),et.mode&1&&Si(c,_,e),e=et,g=_;var _e=e.updateQueue;if(_e===null){var st=new Set;st.add(g),e.updateQueue=st}else _e.add(g);break e}else{if(!(e&1)){Si(c,_,e),tj();break e}g=Error(p(426))}}else if(I&&h.mode&1){var ot=Ui(d);if(ot!==null){!(ot.flags&65536)&&(ot.flags|=256),Vi(ot,d,h,c,e),Jg(Ji(g,h));break e}}c=g=Ji(g,h),T!==4&&(T=2),sk===null?sk=[c]:sk.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var tt=Ni(c,g,e);ph(c,tt);break e;case 1:h=g;var nt=c.type,rt=c.stateNode;if(!(c.flags&128)&&(typeof nt.getDerivedStateFromError=="function"||rt!==null&&typeof rt.componentDidCatch=="function"&&(Ri===null||!Ri.has(rt)))){c.flags|=65536,e&=-e,c.lanes|=e;var it=Qi(c,h,e);ph(c,it);break e}}c=c.return}while(c!==null)}Sk(i)}catch(lt){e=lt,Y===i&&i!==null&&(Y=i=i.return);continue}break}while(!0)}function Jk(){var s=mk.current;return mk.current=Rh,s===null?Rh:s}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(s,e){var i=K;K|=2;var o=Jk();(Q!==s||Z!==e)&&(uk=null,Kk(s,e));do try{Tk();break}catch(a){Mk(s,a)}while(!0);if($g(),K=i,mk.current=o,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(s){var e=Vk(s.alternate,s,fj);s.memoizedProps=s.pendingProps,e===null?Sk(s):Y=e,nk.current=null}function Sk(s){var e=s;do{var i=e.alternate;if(s=e.return,e.flags&32768){if(i=Ij(i,e),i!==null){i.flags&=32767,Y=i;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{T=6,Y=null;return}}else if(i=Ej(i,e,fj),i!==null){Y=i;return}if(e=e.sibling,e!==null){Y=e;return}Y=e=s}while(e!==null);T===0&&(T=5)}function Pk(s,e,i){var o=C,a=ok.transition;try{ok.transition=null,C=1,Wk(s,e,i,o)}finally{ok.transition=a,C=o}return null}function Wk(s,e,i,o){do Hk();while(wk!==null);if(K&6)throw Error(p(327));i=s.finishedWork;var a=s.finishedLanes;if(i===null)return null;if(s.finishedWork=null,s.finishedLanes=0,i===s.current)throw Error(p(177));s.callbackNode=null,s.callbackPriority=0;var c=i.lanes|i.childLanes;if(Bc(s,c),s===Q&&(Y=Q=null,Z=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),c=(i.flags&15990)!==0,i.subtreeFlags&15990||c){c=ok.transition,ok.transition=null;var d=C;C=1;var h=K;K|=4,nk.current=null,Oj(s,i),dk(i,s),Oe(Df),dd=!!Cf,Df=Cf=null,s.current=i,hk(i),dc(),K=h,C=d,ok.transition=c}else s.current=i;if(vk&&(vk=!1,wk=s,xk=a),c=s.pendingLanes,c===0&&(Ri=null),mc(i.stateNode),Dk(s,B()),e!==null)for(o=s.onRecoverableError,i=0;i<e.length;i++)a=e[i],o(a.value,{componentStack:a.stack,digest:a.digest});if(Oi)throw Oi=!1,s=Pi,Pi=null,s;return xk&1&&s.tag!==0&&Hk(),c=s.pendingLanes,c&1?s===zk?yk++:(yk=0,zk=s):yk=0,jg(),null}function Hk(){if(wk!==null){var s=Dc(xk),e=ok.transition,i=C;try{if(ok.transition=null,C=16>s?16:s,wk===null)var o=!1;else{if(s=wk,wk=null,xk=0,K&6)throw Error(p(331));var a=K;for(K|=4,V=s.current;V!==null;){var c=V,d=c.child;if(V.flags&16){var h=c.deletions;if(h!==null){for(var g=0;g<h.length;g++){var _=h[g];for(V=_;V!==null;){var j=V;switch(j.tag){case 0:case 11:case 15:Pj(8,j,c)}var b=j.child;if(b!==null)b.return=j,V=b;else for(;V!==null;){j=V;var $=j.sibling,et=j.return;if(Sj(j),j===_){V=null;break}if($!==null){$.return=et,V=$;break}V=et}}}var _e=c.alternate;if(_e!==null){var st=_e.child;if(st!==null){_e.child=null;do{var ot=st.sibling;st.sibling=null,st=ot}while(st!==null)}}V=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,V=d;else e:for(;V!==null;){if(c=V,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Pj(9,c,c.return)}var tt=c.sibling;if(tt!==null){tt.return=c.return,V=tt;break e}V=c.return}}var nt=s.current;for(V=nt;V!==null;){d=V;var rt=d.child;if(d.subtreeFlags&2064&&rt!==null)rt.return=d,V=rt;else e:for(d=nt;V!==null;){if(h=V,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:Qj(9,h)}}catch(lt){W(h,h.return,lt)}if(h===d){V=null;break e}var it=h.sibling;if(it!==null){it.return=h.return,V=it;break e}V=h.return}}if(K=a,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,s)}catch{}o=!0}return o}finally{C=i,ok.transition=e}}return!1}function Xk(s,e,i){e=Ji(i,e),e=Ni(s,e,1),s=nh(s,e,1),e=R(),s!==null&&(Ac(s,1,e),Dk(s,e))}function W(s,e,i){if(s.tag===3)Xk(s,s,i);else for(;e!==null;){if(e.tag===3){Xk(e,s,i);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ri===null||!Ri.has(o))){s=Ji(i,s),s=Qi(e,s,1),e=nh(e,s,1),s=R(),e!==null&&(Ac(e,1,s),Dk(e,s));break}}e=e.return}}function Ti(s,e,i){var o=s.pingCache;o!==null&&o.delete(e),e=R(),s.pingedLanes|=s.suspendedLanes&i,Q===s&&(Z&i)===i&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(s,0):rk|=i),Dk(s,e)}function Yk(s,e){e===0&&(s.mode&1?(e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):e=1);var i=R();s=ih(s,e),s!==null&&(Ac(s,e,i),Dk(s,i))}function uj(s){var e=s.memoizedState,i=0;e!==null&&(i=e.retryLane),Yk(s,i)}function bk(s,e){var i=0;switch(s.tag){case 13:var o=s.stateNode,a=s.memoizedState;a!==null&&(i=a.retryLane);break;case 19:o=s.stateNode;break;default:throw Error(p(314))}o!==null&&o.delete(e),Yk(s,i)}var Vk;Vk=function(s,e,i){if(s!==null)if(s.memoizedProps!==e.pendingProps||Wf.current)dh=!0;else{if(!(s.lanes&i)&&!(e.flags&128))return dh=!1,yj(s,e,i);dh=!!(s.flags&131072)}else dh=!1,I&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;ij(s,e),s=e.pendingProps;var a=Yf(e,H.current);ch(e,i),a=Nh(null,e,o,s,a,i);var c=Sh();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(o)?(c=!0,cg(e)):c=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,kh(e),a.updater=Ei,e.stateNode=a,a._reactInternals=e,Ii(e,o,s,i),e=jj(null,e,o,!0,c,i)):(e.tag=0,I&&c&&vg(e),Xi(null,e,a,i),e=e.child),e;case 16:o=e.elementType;e:{switch(ij(s,e),s=e.pendingProps,a=o._init,o=a(o._payload),e.type=o,a=e.tag=Zk(o),s=Ci(o,s),a){case 0:e=cj(null,e,o,s,i);break e;case 1:e=hj(null,e,o,s,i);break e;case 11:e=Yi(null,e,o,s,i);break e;case 14:e=$i(null,e,o,Ci(o.type,s),i);break e}throw Error(p(306,o,""))}return e;case 0:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Ci(o,a),cj(s,e,o,a,i);case 1:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Ci(o,a),hj(s,e,o,a,i);case 3:e:{if(kj(e),s===null)throw Error(p(387));o=e.pendingProps,c=e.memoizedState,a=c.element,lh(s,e),qh(e,o,null,i);var d=e.memoizedState;if(o=d.element,c.isDehydrated)if(c={element:o,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){a=Ji(Error(p(423)),e),e=lj(s,e,o,i,a);break e}else if(o!==a){a=Ji(Error(p(424)),e),e=lj(s,e,o,i,a);break e}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I=!0,zg=null,i=Vg(e,null,o,i),e.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Ig(),o===a){e=Zi(s,e,i);break e}Xi(s,e,o,i)}e=e.child}return e;case 5:return Ah(e),s===null&&Eg(e),o=e.type,a=e.pendingProps,c=s!==null?s.memoizedProps:null,d=a.children,Ef(o,a)?d=null:c!==null&&Ef(o,c)&&(e.flags|=32),gj(s,e),Xi(s,e,d,i),e.child;case 6:return s===null&&Eg(e),null;case 13:return oj(s,e,i);case 4:return yh(e,e.stateNode.containerInfo),o=e.pendingProps,s===null?e.child=Ug(e,null,o,i):Xi(s,e,o,i),e.child;case 11:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Ci(o,a),Yi(s,e,o,a,i);case 7:return Xi(s,e,e.pendingProps,i),e.child;case 8:return Xi(s,e,e.pendingProps.children,i),e.child;case 12:return Xi(s,e,e.pendingProps.children,i),e.child;case 10:e:{if(o=e.type._context,a=e.pendingProps,c=e.memoizedProps,d=a.value,G(Wg,o._currentValue),o._currentValue=d,c!==null)if(He(c.value,d)){if(c.children===a.children&&!Wf.current){e=Zi(s,e,i);break e}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var h=c.dependencies;if(h!==null){d=c.child;for(var g=h.firstContext;g!==null;){if(g.context===o){if(c.tag===1){g=mh(-1,i&-i),g.tag=2;var _=c.updateQueue;if(_!==null){_=_.shared;var j=_.pending;j===null?g.next=g:(g.next=j.next,j.next=g),_.pending=g}}c.lanes|=i,g=c.alternate,g!==null&&(g.lanes|=i),bh(c.return,i,e),h.lanes|=i;break}g=g.next}}else if(c.tag===10)d=c.type===e.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(p(341));d.lanes|=i,h=d.alternate,h!==null&&(h.lanes|=i),bh(d,i,e),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===e){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}Xi(s,e,a.children,i),e=e.child}return e;case 9:return a=e.type,o=e.pendingProps.children,ch(e,i),a=eh(a),o=o(a),e.flags|=1,Xi(s,e,o,i),e.child;case 14:return o=e.type,a=Ci(o,e.pendingProps),a=Ci(o.type,a),$i(s,e,o,a,i);case 15:return bj(s,e,e.type,e.pendingProps,i);case 17:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:Ci(o,a),ij(s,e),e.tag=1,Zf(o)?(s=!0,cg(e)):s=!1,ch(e,i),Gi(e,o,a),Ii(e,o,a,i),jj(null,e,o,!0,s,i);case 19:return xj(s,e,i);case 22:return dj(s,e,i)}throw Error(p(156,e.tag))};function Fk(s,e){return ac(s,e)}function $k(s,e,i,o){this.tag=s,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(s,e,i,o){return new $k(s,e,i,o)}function aj(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zk(s){if(typeof s=="function")return aj(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Da)return 11;if(s===Ga)return 14}return 2}function Pg(s,e){var i=s.alternate;return i===null?(i=Bg(s.tag,e,s.key,s.mode),i.elementType=s.elementType,i.type=s.type,i.stateNode=s.stateNode,i.alternate=s,s.alternate=i):(i.pendingProps=e,i.type=s.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=s.flags&14680064,i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=s.sibling,i.index=s.index,i.ref=s.ref,i}function Rg(s,e,i,o,a,c){var d=2;if(o=s,typeof s=="function")aj(s)&&(d=1);else if(typeof s=="string")d=5;else e:switch(s){case ya:return Tg(i.children,a,c,e);case za:d=8,a|=8;break;case Aa:return s=Bg(12,i,e,a|2),s.elementType=Aa,s.lanes=c,s;case Ea:return s=Bg(13,i,e,a),s.elementType=Ea,s.lanes=c,s;case Fa:return s=Bg(19,i,e,a),s.elementType=Fa,s.lanes=c,s;case Ia:return pj(i,a,c,e);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Ba:d=10;break e;case Ca:d=9;break e;case Da:d=11;break e;case Ga:d=14;break e;case Ha:d=16,o=null;break e}throw Error(p(130,s==null?s:typeof s,""))}return e=Bg(d,i,e,a),e.elementType=s,e.type=o,e.lanes=c,e}function Tg(s,e,i,o){return s=Bg(7,s,o,e),s.lanes=i,s}function pj(s,e,i,o){return s=Bg(22,s,o,e),s.elementType=Ia,s.lanes=i,s.stateNode={isHidden:!1},s}function Qg(s,e,i){return s=Bg(6,s,null,e),s.lanes=i,s}function Sg(s,e,i){return e=Bg(4,s.children!==null?s.children:[],s.key,e),e.lanes=i,e.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},e}function al(s,e,i,o,a){this.tag=e,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=o,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function bl(s,e,i,o,a,c,d,h,g){return s=new al(s,e,i,h,g),e===1?(e=1,c===!0&&(e|=8)):e=0,c=Bg(3,null,null,e),s.current=c,c.stateNode=s,c.memoizedState={element:o,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(c),s}function cl(s,e,i){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:o==null?null:""+o,children:s,containerInfo:e,implementation:i}}function dl(s){if(!s)return Vf;s=s._reactInternals;e:{if(Vb(s)!==s||s.tag!==1)throw Error(p(170));var e=s;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(p(171))}if(s.tag===1){var i=s.type;if(Zf(i))return bg(s,i,e)}return e}function el(s,e,i,o,a,c,d,h,g){return s=bl(i,o,!0,s,a,c,d,h,g),s.context=dl(null),i=s.current,o=R(),a=yi(i),c=mh(o,a),c.callback=e??null,nh(i,c,a),s.current.lanes=a,Ac(s,a,o),Dk(s,o),s}function fl(s,e,i,o){var a=e.current,c=R(),d=yi(a);return i=dl(i),e.context===null?e.context=i:e.pendingContext=i,e=mh(c,d),e.payload={element:s},o=o===void 0?null:o,o!==null&&(e.callback=o),s=nh(a,e,d),s!==null&&(gi(s,a,d,c),oh(s,a,d)),d}function gl(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function hl(s,e){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var i=s.retryLane;s.retryLane=i!==0&&i<e?i:e}}function il(s,e){hl(s,e),(s=s.alternate)&&hl(s,e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(s){console.error(s)};function ll(s){this._internalRoot=s}ml.prototype.render=ll.prototype.render=function(s){var e=this._internalRoot;if(e===null)throw Error(p(409));fl(s,e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var e=s.containerInfo;Rk(function(){fl(null,s,null,null)}),e[uf]=null}};function ml(s){this._internalRoot=s}ml.prototype.unstable_scheduleHydration=function(s){if(s){var e=Hc();s={blockedOn:null,target:s,priority:e};for(var i=0;i<Qc.length&&e!==0&&e<Qc[i].priority;i++);Qc.splice(i,0,s),i===0&&Vc(s)}};function nl(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ol(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(s,e,i,o,a){if(a){if(typeof o=="function"){var c=o;o=function(){var _=gl(d);c.call(_)}}var d=el(e,o,s,0,null,!1,!1,"",pl);return s._reactRootContainer=d,s[uf]=d.current,sf(s.nodeType===8?s.parentNode:s),Rk(),d}for(;a=s.lastChild;)s.removeChild(a);if(typeof o=="function"){var h=o;o=function(){var _=gl(g);h.call(_)}}var g=bl(s,0,!1,null,null,!1,!1,"",pl);return s._reactRootContainer=g,s[uf]=g.current,sf(s.nodeType===8?s.parentNode:s),Rk(function(){fl(e,g,i,o)}),g}function rl(s,e,i,o,a){var c=i._reactRootContainer;if(c){var d=c;if(typeof a=="function"){var h=a;a=function(){var g=gl(d);h.call(g)}}fl(e,d,s,a)}else d=ql(i,e,s,a,o);return gl(d)}Ec=function(s){switch(s.tag){case 3:var e=s.stateNode;if(e.current.memoizedState.isDehydrated){var i=tc(e.pendingLanes);i!==0&&(Cc(e,i|1),Dk(e,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var o=ih(s,1);if(o!==null){var a=R();gi(o,s,1,a)}}),il(s,1)}};Fc=function(s){if(s.tag===13){var e=ih(s,134217728);if(e!==null){var i=R();gi(e,s,134217728,i)}il(s,134217728)}};Gc=function(s){if(s.tag===13){var e=yi(s),i=ih(s,e);if(i!==null){var o=R();gi(i,s,e,o)}il(s,e)}};Hc=function(){return C};Ic=function(s,e){var i=C;try{return C=s,e()}finally{C=i}};yb=function(s,e,i){switch(e){case"input":if(bb(s,i),e=i.name,i.type==="radio"&&e!=null){for(i=s;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var o=i[e];if(o!==s&&o.form===s.form){var a=Db(o);if(!a)throw Error(p(90));Wa(o),bb(o,a)}}}break;case"textarea":ib(s,i);break;case"select":e=i.value,e!=null&&fb(s,!!i.multiple,e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Zb(s),s===null?null:s.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(s,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(e))throw Error(p(200));return cl(s,e,null,i)};reactDom_production_min.createRoot=function(s,e){if(!nl(s))throw Error(p(299));var i=!1,o="",a=kl;return e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=bl(s,1,!1,null,null,i,!1,o,a),s[uf]=e.current,sf(s.nodeType===8?s.parentNode:s),new ll(e)};reactDom_production_min.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var e=s._reactInternals;if(e===void 0)throw typeof s.render=="function"?Error(p(188)):(s=Object.keys(s).join(","),Error(p(268,s)));return s=Zb(e),s=s===null?null:s.stateNode,s};reactDom_production_min.flushSync=function(s){return Rk(s)};reactDom_production_min.hydrate=function(s,e,i){if(!ol(e))throw Error(p(200));return rl(null,s,e,!0,i)};reactDom_production_min.hydrateRoot=function(s,e,i){if(!nl(s))throw Error(p(405));var o=i!=null&&i.hydratedSources||null,a=!1,c="",d=kl;if(i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onRecoverableError!==void 0&&(d=i.onRecoverableError)),e=el(e,null,s,1,i??null,a,!1,c,d),s[uf]=e.current,sf(s),o)for(s=0;s<o.length;s++)i=o[s],a=i._getVersion,a=a(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,a]:e.mutableSourceEagerHydrationData.push(i,a);return new ml(e)};reactDom_production_min.render=function(s,e,i){if(!ol(e))throw Error(p(200));return rl(null,s,e,!1,i)};reactDom_production_min.unmountComponentAtNode=function(s){if(!ol(s))throw Error(p(40));return s._reactRootContainer?(Rk(function(){rl(null,null,s,!1,function(){s._reactRootContainer=null,s[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(s,e,i,o){if(!ol(i))throw Error(p(200));if(s==null||s._reactInternals===void 0)throw Error(p(38));return rl(s,e,i,!1,o)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(s){console.error(s)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(s={}){function e(o,a){let{pathname:c,search:d,hash:h}=o.location;return createLocation("",{pathname:c,search:d,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function i(o,a){return typeof a=="string"?a:createPath(a)}return getUrlBasedHistory(e,i,null,s)}function invariant(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function warning(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(s,e){return{usr:s.state,key:s.key,idx:e}}function createLocation(s,e,i=null,o){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?parsePath(e):e,state:i,key:e&&e.key||o||createKey()}}function createPath({pathname:s="/",search:e="",hash:i=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),i&&i!=="#"&&(s+=i.charAt(0)==="#"?i:"#"+i),s}function parsePath(s){let e={};if(s){let i=s.indexOf("#");i>=0&&(e.hash=s.substring(i),s=s.substring(0,i));let o=s.indexOf("?");o>=0&&(e.search=s.substring(o),s=s.substring(0,o)),s&&(e.pathname=s)}return e}function getUrlBasedHistory(s,e,i,o={}){let{window:a=document.defaultView,v5Compat:c=!1}=o,d=a.history,h="POP",g=null,_=j();_==null&&(_=0,d.replaceState({...d.state,idx:_},""));function j(){return(d.state||{idx:null}).idx}function b(){h="POP";let ot=j(),tt=ot==null?null:ot-_;_=ot,g&&g({action:h,location:st.location,delta:tt})}function $(ot,tt){h="PUSH";let nt=createLocation(st.location,ot,tt);_=j()+1;let rt=getHistoryState(nt,_),it=st.createHref(nt);try{d.pushState(rt,"",it)}catch(lt){if(lt instanceof DOMException&&lt.name==="DataCloneError")throw lt;a.location.assign(it)}c&&g&&g({action:h,location:st.location,delta:1})}function et(ot,tt){h="REPLACE";let nt=createLocation(st.location,ot,tt);_=j();let rt=getHistoryState(nt,_),it=st.createHref(nt);d.replaceState(rt,"",it),c&&g&&g({action:h,location:st.location,delta:0})}function _e(ot){return createBrowserURLImpl(ot)}let st={get action(){return h},get location(){return s(a,d)},listen(ot){if(g)throw new Error("A history only accepts one active listener");return a.addEventListener(PopStateEventType,b),g=ot,()=>{a.removeEventListener(PopStateEventType,b),g=null}},createHref(ot){return e(a,ot)},createURL:_e,encodeLocation(ot){let tt=_e(ot);return{pathname:tt.pathname,search:tt.search,hash:tt.hash}},push:$,replace:et,go(ot){return d.go(ot)}};return st}function createBrowserURLImpl(s,e=!1){let i="http://localhost";typeof window<"u"&&(i=window.location.origin!=="null"?window.location.origin:window.location.href),invariant(i,"No window.location.(origin|href) available to create URL");let o=typeof s=="string"?s:createPath(s);return o=o.replace(/ $/,"%20"),!e&&o.startsWith("//")&&(o=i+o),new URL(o,i)}function matchRoutes(s,e,i="/"){return matchRoutesImpl(s,e,i,!1)}function matchRoutesImpl(s,e,i,o){let a=typeof e=="string"?parsePath(e):e,c=stripBasename(a.pathname||"/",i);if(c==null)return null;let d=flattenRoutes(s);rankRouteBranches(d);let h=null;for(let g=0;h==null&&g<d.length;++g){let _=decodePath(c);h=matchRouteBranch(d[g],_,o)}return h}function flattenRoutes(s,e=[],i=[],o="",a=!1){let c=(d,h,g=a,_)=>{let j={relativePath:_===void 0?d.path||"":_,caseSensitive:d.caseSensitive===!0,childrenIndex:h,route:d};if(j.relativePath.startsWith("/")){if(!j.relativePath.startsWith(o)&&g)return;invariant(j.relativePath.startsWith(o),`Absolute route path "${j.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),j.relativePath=j.relativePath.slice(o.length)}let b=joinPaths([o,j.relativePath]),$=i.concat(j);d.children&&d.children.length>0&&(invariant(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),flattenRoutes(d.children,e,$,b,g)),!(d.path==null&&!d.index)&&e.push({path:b,score:computeScore(b,d.index),routesMeta:$})};return s.forEach((d,h)=>{var g;if(d.path===""||!((g=d.path)!=null&&g.includes("?")))c(d,h);else for(let _ of explodeOptionalSegments(d.path))c(d,h,!0,_)}),e}function explodeOptionalSegments(s){let e=s.split("/");if(e.length===0)return[];let[i,...o]=e,a=i.endsWith("?"),c=i.replace(/\?$/,"");if(o.length===0)return a?[c,""]:[c];let d=explodeOptionalSegments(o.join("/")),h=[];return h.push(...d.map(g=>g===""?c:[c,g].join("/"))),a&&h.push(...d),h.map(g=>s.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(s){s.sort((e,i)=>e.score!==i.score?i.score-e.score:compareIndexes(e.routesMeta.map(o=>o.childrenIndex),i.routesMeta.map(o=>o.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=s=>s==="*";function computeScore(s,e){let i=s.split("/"),o=i.length;return i.some(isSplat)&&(o+=splatPenalty),e&&(o+=indexRouteValue),i.filter(a=>!isSplat(a)).reduce((a,c)=>a+(paramRe.test(c)?dynamicSegmentValue:c===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(s,e){return s.length===e.length&&s.slice(0,-1).every((o,a)=>o===e[a])?s[s.length-1]-e[e.length-1]:0}function matchRouteBranch(s,e,i=!1){let{routesMeta:o}=s,a={},c="/",d=[];for(let h=0;h<o.length;++h){let g=o[h],_=h===o.length-1,j=c==="/"?e:e.slice(c.length)||"/",b=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:_},j),$=g.route;if(!b&&_&&i&&!o[o.length-1].route.index&&(b=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},j)),!b)return null;Object.assign(a,b.params),d.push({params:a,pathname:joinPaths([c,b.pathname]),pathnameBase:normalizePathname(joinPaths([c,b.pathnameBase])),route:$}),b.pathnameBase!=="/"&&(c=joinPaths([c,b.pathnameBase]))}return d}function matchPath(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[i,o]=compilePath(s.path,s.caseSensitive,s.end),a=e.match(i);if(!a)return null;let c=a[0],d=c.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:o.reduce((_,{paramName:j,isOptional:b},$)=>{if(j==="*"){let _e=h[$]||"";d=c.slice(0,c.length-_e.length).replace(/(.)\/+$/,"$1")}const et=h[$];return b&&!et?_[j]=void 0:_[j]=(et||"").replace(/%2F/g,"/"),_},{}),pathname:c,pathnameBase:d,pattern:s}}function compilePath(s,e=!1,i=!0){warning(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let o=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,h,g)=>(o.push({paramName:h,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(o.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),o]}function decodePath(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function stripBasename(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,o=s.charAt(i);return o&&o!=="/"?null:s.slice(i)||"/"}function resolvePath(s,e="/"){let{pathname:i,search:o="",hash:a=""}=typeof s=="string"?parsePath(s):s;return{pathname:i?i.startsWith("/")?i:resolvePathname(i,e):e,search:normalizeSearch(o),hash:normalizeHash(a)}}function resolvePathname(s,e){let i=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(a=>{a===".."?i.length>1&&i.pop():a!=="."&&i.push(a)}),i.length>1?i.join("/"):"/"}function getInvalidPathError(s,e,i,o){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(s){return s.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(s){let e=getPathContributingMatches(s);return e.map((i,o)=>o===e.length-1?i.pathname:i.pathnameBase)}function resolveTo(s,e,i,o=!1){let a;typeof s=="string"?a=parsePath(s):(a={...s},invariant(!a.pathname||!a.pathname.includes("?"),getInvalidPathError("?","pathname","search",a)),invariant(!a.pathname||!a.pathname.includes("#"),getInvalidPathError("#","pathname","hash",a)),invariant(!a.search||!a.search.includes("#"),getInvalidPathError("#","search","hash",a)));let c=s===""||a.pathname==="",d=c?"/":a.pathname,h;if(d==null)h=i;else{let b=e.length-1;if(!o&&d.startsWith("..")){let $=d.split("/");for(;$[0]==="..";)$.shift(),b-=1;a.pathname=$.join("/")}h=b>=0?e[b]:"/"}let g=resolvePath(a,h),_=d&&d!=="/"&&d.endsWith("/"),j=(c||d===".")&&i.endsWith("/");return!g.pathname.endsWith("/")&&(_||j)&&(g.pathname+="/"),g}var joinPaths=s=>s.join("/").replace(/\/\/+/g,"/"),normalizePathname=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,normalizeHash=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function isRouteErrorResponse(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";reactExports.createContext(!1);var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(s,{relative:e}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:o}=reactExports.useContext(NavigationContext),{hash:a,pathname:c,search:d}=useResolvedPath(s,{relative:e}),h=c;return i!=="/"&&(h=c==="/"?i:joinPaths([i,c])),o.createHref({pathname:h,search:d,hash:a})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(s){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(s)}function useNavigate(){let{isDataRoute:s}=reactExports.useContext(RouteContext);return s?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let s=reactExports.useContext(DataRouterContext),{basename:e,navigator:i}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:a}=useLocation(),c=JSON.stringify(getResolveToMatches(o)),d=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{d.current=!0}),reactExports.useCallback((g,_={})=>{if(warning(d.current,navigateEffectWarning),!d.current)return;if(typeof g=="number"){i.go(g);return}let j=resolveTo(g,JSON.parse(c),a,_.relative==="path");s==null&&e!=="/"&&(j.pathname=j.pathname==="/"?e:joinPaths([e,j.pathname])),(_.replace?i.replace:i.push)(j,_.state,_)},[e,i,c,a,s])}reactExports.createContext(null);function useParams(){let{matches:s}=reactExports.useContext(RouteContext),e=s[s.length-1];return e?e.params:{}}function useResolvedPath(s,{relative:e}={}){let{matches:i}=reactExports.useContext(RouteContext),{pathname:o}=useLocation(),a=JSON.stringify(getResolveToMatches(i));return reactExports.useMemo(()=>resolveTo(s,JSON.parse(a),o,e==="path"),[s,a,o,e])}function useRoutes(s,e){return useRoutesImpl(s,e)}function useRoutesImpl(s,e,i,o,a){var nt;invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=reactExports.useContext(NavigationContext),{matches:d}=reactExports.useContext(RouteContext),h=d[d.length-1],g=h?h.params:{},_=h?h.pathname:"/",j=h?h.pathnameBase:"/",b=h&&h.route;{let rt=b&&b.path||"";warningOnce(_,!b||rt.endsWith("*")||rt.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${_}" (under <Route path="${rt}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${rt}"> to <Route path="${rt==="/"?"*":`${rt}/*`}">.`)}let $=useLocation(),et;if(e){let rt=typeof e=="string"?parsePath(e):e;invariant(j==="/"||((nt=rt.pathname)==null?void 0:nt.startsWith(j)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${j}" but pathname "${rt.pathname}" was given in the \`location\` prop.`),et=rt}else et=$;let _e=et.pathname||"/",st=_e;if(j!=="/"){let rt=j.replace(/^\//,"").split("/");st="/"+_e.replace(/^\//,"").split("/").slice(rt.length).join("/")}let ot=matchRoutes(s,{pathname:st});warning(b||ot!=null,`No routes matched location "${et.pathname}${et.search}${et.hash}" `),warning(ot==null||ot[ot.length-1].route.element!==void 0||ot[ot.length-1].route.Component!==void 0||ot[ot.length-1].route.lazy!==void 0,`Matched leaf route at location "${et.pathname}${et.search}${et.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let tt=_renderMatches(ot&&ot.map(rt=>Object.assign({},rt,{params:Object.assign({},g,rt.params),pathname:joinPaths([j,c.encodeLocation?c.encodeLocation(rt.pathname).pathname:rt.pathname]),pathnameBase:rt.pathnameBase==="/"?j:joinPaths([j,c.encodeLocation?c.encodeLocation(rt.pathnameBase).pathname:rt.pathnameBase])})),d,i,o,a);return e&&tt?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...et},navigationType:"POP"}},tt):tt}function DefaultErrorComponent(){let s=useRouteError(),e=isRouteErrorResponse(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),i=s instanceof Error?s.stack:null,o="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:o},c={padding:"2px 4px",backgroundColor:o},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null," Hey developer "),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:c},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:c},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),i?reactExports.createElement("pre",{style:a},i):null,d)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.unstable_onError?this.props.unstable_onError(s,e):console.error("React Router caught the following error during render",s)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:s,match:e,children:i}){let o=reactExports.useContext(DataRouterContext);return o&&o.static&&o.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=e.route.id),reactExports.createElement(RouteContext.Provider,{value:s},i)}function _renderMatches(s,e=[],i=null,o=null,a=null){if(s==null){if(!i)return null;if(i.errors)s=i.matches;else if(e.length===0&&!i.initialized&&i.matches.length>0)s=i.matches;else return null}let c=s,d=i==null?void 0:i.errors;if(d!=null){let _=c.findIndex(j=>j.route.id&&(d==null?void 0:d[j.route.id])!==void 0);invariant(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,_+1))}let h=!1,g=-1;if(i)for(let _=0;_<c.length;_++){let j=c[_];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(g=_),j.route.id){let{loaderData:b,errors:$}=i,et=j.route.loader&&!b.hasOwnProperty(j.route.id)&&(!$||$[j.route.id]===void 0);if(j.route.lazy||et){h=!0,g>=0?c=c.slice(0,g+1):c=[c[0]];break}}}return c.reduceRight((_,j,b)=>{let $,et=!1,_e=null,st=null;i&&($=d&&j.route.id?d[j.route.id]:void 0,_e=j.route.errorElement||defaultErrorElement,h&&(g<0&&b===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),et=!0,st=null):g===b&&(et=!0,st=j.route.hydrateFallbackElement||null)));let ot=e.concat(c.slice(0,b+1)),tt=()=>{let nt;return $?nt=_e:et?nt=st:j.route.Component?nt=reactExports.createElement(j.route.Component,null):j.route.element?nt=j.route.element:nt=_,reactExports.createElement(RenderedRoute,{match:j,routeContext:{outlet:_,matches:ot,isDataRoute:i!=null},children:nt})};return i&&(j.route.ErrorBoundary||j.route.errorElement||b===0)?reactExports.createElement(RenderErrorBoundary,{location:i.location,revalidation:i.revalidation,component:_e,error:$,children:tt(),routeContext:{outlet:null,matches:ot,isDataRoute:!0},unstable_onError:o}):tt()},null)}function getDataRouterConsoleError(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(s){let e=reactExports.useContext(DataRouterContext);return invariant(e,getDataRouterConsoleError(s)),e}function useDataRouterState(s){let e=reactExports.useContext(DataRouterStateContext);return invariant(e,getDataRouterConsoleError(s)),e}function useRouteContext(s){let e=reactExports.useContext(RouteContext);return invariant(e,getDataRouterConsoleError(s)),e}function useCurrentRouteId(s){let e=useRouteContext(s),i=e.matches[e.matches.length-1];return invariant(i.route.id,`${s} can only be used on routes that contain a unique "id"`),i.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){var o;let s=reactExports.useContext(RouteErrorContext),e=useDataRouterState("useRouteError"),i=useCurrentRouteId("useRouteError");return s!==void 0?s:(o=e.errors)==null?void 0:o[i]}function useNavigateStable(){let{router:s}=useDataRouterContext("useNavigate"),e=useCurrentRouteId("useNavigate"),i=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{i.current=!0}),reactExports.useCallback(async(a,c={})=>{warning(i.current,navigateEffectWarning),i.current&&(typeof a=="number"?s.navigate(a):await s.navigate(a,{fromRouteId:e,...c}))},[s,e])}var alreadyWarned$1={};function warningOnce(s,e,i){!e&&!alreadyWarned$1[s]&&(alreadyWarned$1[s]=!0,warning(!1,i))}reactExports.memo(DataRoutes);function DataRoutes({routes:s,future:e,state:i,unstable_onError:o}){return useRoutesImpl(s,void 0,i,o,e)}function Route(s){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:s="/",children:e=null,location:i,navigationType:o="POP",navigator:a,static:c=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=s.replace(/^\/*/,"/"),h=reactExports.useMemo(()=>({basename:d,navigator:a,static:c,future:{}}),[d,a,c]);typeof i=="string"&&(i=parsePath(i));let{pathname:g="/",search:_="",hash:j="",state:b=null,key:$="default"}=i,et=reactExports.useMemo(()=>{let _e=stripBasename(g,d);return _e==null?null:{location:{pathname:_e,search:_,hash:j,state:b,key:$},navigationType:o}},[d,g,_,j,b,$,o]);return warning(et!=null,`<Router basename="${d}"> is not able to match the URL "${g}${_}${j}" because it does not start with the basename, so the <Router> won't render anything.`),et==null?null:reactExports.createElement(NavigationContext.Provider,{value:h},reactExports.createElement(LocationContext.Provider,{children:e,value:et}))}function Routes({children:s,location:e}){return useRoutes(createRoutesFromChildren(s),e)}function createRoutesFromChildren(s,e=[]){let i=[];return reactExports.Children.forEach(s,(o,a)=>{if(!reactExports.isValidElement(o))return;let c=[...e,a];if(o.type===reactExports.Fragment){i.push.apply(i,createRoutesFromChildren(o.props.children,c));return}invariant(o.type===Route,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant(!o.props.index||!o.props.children,"An index route cannot have child routes.");let d={id:o.props.id||c.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(d.children=createRoutesFromChildren(o.props.children,c)),i.push(d)}),i}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(s){return s!=null&&typeof s.tagName=="string"}function isButtonElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="button"}function isFormElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="form"}function isInputElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="input"}function isModifiedEvent(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function shouldProcessLinkClick(s,e){return s.button===0&&(!e||e==="_self")&&!isModifiedEvent(s)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(s){return s!=null&&!supportedFormEncTypes.has(s)?(warning(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):s}function getFormSubmissionInfo(s,e){let i,o,a,c,d;if(isFormElement(s)){let h=s.getAttribute("action");o=h?stripBasename(h,e):null,i=s.getAttribute("method")||defaultMethod,a=getFormEncType(s.getAttribute("enctype"))||defaultEncType,c=new FormData(s)}else if(isButtonElement(s)||isInputElement(s)&&(s.type==="submit"||s.type==="image")){let h=s.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||h.getAttribute("action");if(o=g?stripBasename(g,e):null,i=s.getAttribute("formmethod")||h.getAttribute("method")||defaultMethod,a=getFormEncType(s.getAttribute("formenctype"))||getFormEncType(h.getAttribute("enctype"))||defaultEncType,c=new FormData(h,s),!isFormDataSubmitterSupported()){let{name:_,type:j,value:b}=s;if(j==="image"){let $=_?`${_}.`:"";c.append(`${$}x`,"0"),c.append(`${$}y`,"0")}else _&&c.append(_,b)}}else{if(isHtmlElement(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=defaultMethod,o=null,a=defaultEncType,d=s}return c&&a==="text/plain"&&(d=c,c=void 0),{action:o,method:i.toLowerCase(),encType:a,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function singleFetchUrl(s,e,i){let o=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return o.pathname==="/"?o.pathname=`_root.${i}`:e&&stripBasename(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function loadRouteModule(s,e){if(s.id in e)return e[s.id];try{let i=await import(s.module);return e[s.id]=i,i}catch(i){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function getKeyedPrefetchLinks(s,e,i){let o=await Promise.all(s.map(async a=>{let c=e.routes[a.route.id];if(c){let d=await loadRouteModule(c,i);return d.links?d.links():[]}return[]}));return dedupeLinkDescriptors(o.flat(1).filter(isHtmlLinkDescriptor).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function getNewMatchesForLinks(s,e,i,o,a,c){let d=(g,_)=>i[_]?g.route.id!==i[_].route.id:!0,h=(g,_)=>{var j;return i[_].pathname!==g.pathname||((j=i[_].route.path)==null?void 0:j.endsWith("*"))&&i[_].params["*"]!==g.params["*"]};return c==="assets"?e.filter((g,_)=>d(g,_)||h(g,_)):c==="data"?e.filter((g,_)=>{var b;let j=o.routes[g.route.id];if(!j||!j.hasLoader)return!1;if(d(g,_)||h(g,_))return!0;if(g.route.shouldRevalidate){let $=g.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((b=i[0])==null?void 0:b.params)||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof $=="boolean")return $}return!0}):[]}function getModuleLinkHrefs(s,e,{includeHydrateFallback:i}={}){return dedupeHrefs(s.map(o=>{let a=e.routes[o.route.id];if(!a)return[];let c=[a.module];return a.clientActionModule&&(c=c.concat(a.clientActionModule)),a.clientLoaderModule&&(c=c.concat(a.clientLoaderModule)),i&&a.hydrateFallbackModule&&(c=c.concat(a.hydrateFallbackModule)),a.imports&&(c=c.concat(a.imports)),c}).flat(1))}function dedupeHrefs(s){return[...new Set(s)]}function sortKeys(s){let e={},i=Object.keys(s).sort();for(let o of i)e[o]=s[o];return e}function dedupeLinkDescriptors(s,e){let i=new Set;return new Set(e),s.reduce((o,a)=>{let c=JSON.stringify(sortKeys(a));return i.has(c)||(i.add(c),o.push({key:c,link:a})),o},[])}function useDataRouterContext2(){let s=reactExports.useContext(DataRouterContext);return invariant2(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function useDataRouterStateContext(){let s=reactExports.useContext(DataRouterStateContext);return invariant2(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let s=reactExports.useContext(FrameworkContext);return invariant2(s,"You must render this element inside a <HydratedRouter> element"),s}function usePrefetchBehavior(s,e){let i=reactExports.useContext(FrameworkContext),[o,a]=reactExports.useState(!1),[c,d]=reactExports.useState(!1),{onFocus:h,onBlur:g,onMouseEnter:_,onMouseLeave:j,onTouchStart:b}=e,$=reactExports.useRef(null);reactExports.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let st=tt=>{tt.forEach(nt=>{d(nt.isIntersecting)})},ot=new IntersectionObserver(st,{threshold:.5});return $.current&&ot.observe($.current),()=>{ot.disconnect()}}},[s]),reactExports.useEffect(()=>{if(o){let st=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(st)}}},[o]);let et=()=>{a(!0)},_e=()=>{a(!1),d(!1)};return i?s!=="intent"?[c,$,{}]:[c,$,{onFocus:composeEventHandlers(h,et),onBlur:composeEventHandlers(g,_e),onMouseEnter:composeEventHandlers(_,et),onMouseLeave:composeEventHandlers(j,_e),onTouchStart:composeEventHandlers(b,et)}]:[!1,$,{}]}function composeEventHandlers(s,e){return i=>{s&&s(i),i.defaultPrevented||e(i)}}function PrefetchPageLinks({page:s,...e}){let{router:i}=useDataRouterContext2(),o=reactExports.useMemo(()=>matchRoutes(i.routes,s,i.basename),[i.routes,s,i.basename]);return o?reactExports.createElement(PrefetchPageLinksImpl,{page:s,matches:o,...e}):null}function useKeyedPrefetchLinks(s){let{manifest:e,routeModules:i}=useFrameworkContext(),[o,a]=reactExports.useState([]);return reactExports.useEffect(()=>{let c=!1;return getKeyedPrefetchLinks(s,e,i).then(d=>{c||a(d)}),()=>{c=!0}},[s,e,i]),o}function PrefetchPageLinksImpl({page:s,matches:e,...i}){let o=useLocation(),{manifest:a,routeModules:c}=useFrameworkContext(),{basename:d}=useDataRouterContext2(),{loaderData:h,matches:g}=useDataRouterStateContext(),_=reactExports.useMemo(()=>getNewMatchesForLinks(s,e,g,a,o,"data"),[s,e,g,a,o]),j=reactExports.useMemo(()=>getNewMatchesForLinks(s,e,g,a,o,"assets"),[s,e,g,a,o]),b=reactExports.useMemo(()=>{if(s===o.pathname+o.search+o.hash)return[];let _e=new Set,st=!1;if(e.forEach(tt=>{var rt;let nt=a.routes[tt.route.id];!nt||!nt.hasLoader||(!_.some(it=>it.route.id===tt.route.id)&&tt.route.id in h&&((rt=c[tt.route.id])!=null&&rt.shouldRevalidate)||nt.hasClientLoader?st=!0:_e.add(tt.route.id))}),_e.size===0)return[];let ot=singleFetchUrl(s,d,"data");return st&&_e.size>0&&ot.searchParams.set("_routes",e.filter(tt=>_e.has(tt.route.id)).map(tt=>tt.route.id).join(",")),[ot.pathname+ot.search]},[d,h,o,a,_,e,s,c]),$=reactExports.useMemo(()=>getModuleLinkHrefs(j,a),[j,a]),et=useKeyedPrefetchLinks(j);return reactExports.createElement(reactExports.Fragment,null,b.map(_e=>reactExports.createElement("link",{key:_e,rel:"prefetch",as:"fetch",href:_e,...i})),$.map(_e=>reactExports.createElement("link",{key:_e,rel:"modulepreload",href:_e,...i})),et.map(({key:_e,link:st})=>reactExports.createElement("link",{key:_e,nonce:i.nonce,...st})))}function mergeRefs(...s){return e=>{s.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}var isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser$1&&(window.__reactRouterVersion="7.8.2")}catch{}function BrowserRouter({basename:s,children:e,window:i}){let o=reactExports.useRef();o.current==null&&(o.current=createBrowserHistory({window:i,v5Compat:!0}));let a=o.current,[c,d]=reactExports.useState({action:a.action,location:a.location}),h=reactExports.useCallback(g=>{reactExports.startTransition(()=>d(g))},[d]);return reactExports.useLayoutEffect(()=>a.listen(h),[a,h]),reactExports.createElement(Router,{basename:s,children:e,location:c.location,navigationType:c.action,navigator:a})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:e,discover:i="render",prefetch:o="none",relative:a,reloadDocument:c,replace:d,state:h,target:g,to:_,preventScrollReset:j,viewTransition:b,...$},et){let{basename:_e}=reactExports.useContext(NavigationContext),st=typeof _=="string"&&ABSOLUTE_URL_REGEX2.test(_),ot,tt=!1;if(typeof _=="string"&&st&&(ot=_,isBrowser$1))try{let ht=new URL(window.location.href),dt=_.startsWith("//")?new URL(ht.protocol+_):new URL(_),pt=stripBasename(dt.pathname,_e);dt.origin===ht.origin&&pt!=null?_=pt+dt.search+dt.hash:tt=!0}catch{warning(!1,`<Link to="${_}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let nt=useHref(_,{relative:a}),[rt,it,lt]=usePrefetchBehavior(o,$),at=useLinkClickHandler(_,{replace:d,state:h,target:g,preventScrollReset:j,relative:a,viewTransition:b});function ut(ht){e&&e(ht),ht.defaultPrevented||at(ht)}let ct=reactExports.createElement("a",{...$,...lt,href:ot||nt,onClick:tt||c?e:ut,ref:mergeRefs(et,it),target:g,"data-discover":!st&&i==="render"?"true":void 0});return rt&&!st?reactExports.createElement(reactExports.Fragment,null,ct,reactExports.createElement(PrefetchPageLinks,{page:nt})):ct});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":e="page",caseSensitive:i=!1,className:o="",end:a=!1,style:c,to:d,viewTransition:h,children:g,..._},j){let b=useResolvedPath(d,{relative:_.relative}),$=useLocation(),et=reactExports.useContext(DataRouterStateContext),{navigator:_e,basename:st}=reactExports.useContext(NavigationContext),ot=et!=null&&useViewTransitionState(b)&&h===!0,tt=_e.encodeLocation?_e.encodeLocation(b).pathname:b.pathname,nt=$.pathname,rt=et&&et.navigation&&et.navigation.location?et.navigation.location.pathname:null;i||(nt=nt.toLowerCase(),rt=rt?rt.toLowerCase():null,tt=tt.toLowerCase()),rt&&st&&(rt=stripBasename(rt,st)||rt);const it=tt!=="/"&&tt.endsWith("/")?tt.length-1:tt.length;let lt=nt===tt||!a&&nt.startsWith(tt)&&nt.charAt(it)==="/",at=rt!=null&&(rt===tt||!a&&rt.startsWith(tt)&&rt.charAt(tt.length)==="/"),ut={isActive:lt,isPending:at,isTransitioning:ot},ct=lt?e:void 0,ht;typeof o=="function"?ht=o(ut):ht=[o,lt?"active":null,at?"pending":null,ot?"transitioning":null].filter(Boolean).join(" ");let dt=typeof c=="function"?c(ut):c;return reactExports.createElement(Link,{..._,"aria-current":ct,className:ht,ref:j,style:dt,to:d,viewTransition:h},typeof g=="function"?g(ut):g)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:s="render",fetcherKey:e,navigate:i,reloadDocument:o,replace:a,state:c,method:d=defaultMethod,action:h,onSubmit:g,relative:_,preventScrollReset:j,viewTransition:b,...$},et)=>{let _e=useSubmit(),st=useFormAction(h,{relative:_}),ot=d.toLowerCase()==="get"?"get":"post",tt=typeof h=="string"&&ABSOLUTE_URL_REGEX2.test(h),nt=rt=>{if(g&&g(rt),rt.defaultPrevented)return;rt.preventDefault();let it=rt.nativeEvent.submitter,lt=(it==null?void 0:it.getAttribute("formmethod"))||d;_e(it||rt.currentTarget,{fetcherKey:e,method:lt,navigate:i,replace:a,state:c,relative:_,preventScrollReset:j,viewTransition:b})};return reactExports.createElement("form",{ref:et,method:ot,action:st,onSubmit:o?g:nt,...$,"data-discover":!tt&&s==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(s){let e=reactExports.useContext(DataRouterContext);return invariant(e,getDataRouterConsoleError2(s)),e}function useLinkClickHandler(s,{target:e,replace:i,state:o,preventScrollReset:a,relative:c,viewTransition:d}={}){let h=useNavigate(),g=useLocation(),_=useResolvedPath(s,{relative:c});return reactExports.useCallback(j=>{if(shouldProcessLinkClick(j,e)){j.preventDefault();let b=i!==void 0?i:createPath(g)===createPath(_);h(s,{replace:b,state:o,preventScrollReset:a,relative:c,viewTransition:d})}},[g,h,_,i,o,e,s,a,c,d])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:s}=useDataRouterContext3("useSubmit"),{basename:e}=reactExports.useContext(NavigationContext),i=useRouteId();return reactExports.useCallback(async(o,a={})=>{let{action:c,method:d,encType:h,formData:g,body:_}=getFormSubmissionInfo(o,e);if(a.navigate===!1){let j=a.fetcherKey||getUniqueFetcherId();await s.fetch(j,i,a.action||c,{preventScrollReset:a.preventScrollReset,formData:g,body:_,formMethod:a.method||d,formEncType:a.encType||h,flushSync:a.flushSync})}else await s.navigate(a.action||c,{preventScrollReset:a.preventScrollReset,formData:g,body:_,formMethod:a.method||d,formEncType:a.encType||h,replace:a.replace,state:a.state,fromRouteId:i,flushSync:a.flushSync,viewTransition:a.viewTransition})},[s,e,i])}function useFormAction(s,{relative:e}={}){let{basename:i}=reactExports.useContext(NavigationContext),o=reactExports.useContext(RouteContext);invariant(o,"useFormAction must be used inside a RouteContext");let[a]=o.matches.slice(-1),c={...useResolvedPath(s||".",{relative:e})},d=useLocation();if(s==null){c.search=d.search;let h=new URLSearchParams(c.search),g=h.getAll("index");if(g.some(j=>j==="")){h.delete("index"),g.filter(b=>b).forEach(b=>h.append("index",b));let j=h.toString();c.search=j?`?${j}`:""}}return(!s||s===".")&&a.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(c.pathname=c.pathname==="/"?i:joinPaths([i,c.pathname])),createPath(c)}function useViewTransitionState(s,{relative:e}={}){let i=reactExports.useContext(ViewTransitionContext);invariant(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=useDataRouterContext3("useViewTransitionState"),a=useResolvedPath(s,{relative:e});if(!i.isTransitioning)return!1;let c=stripBasename(i.currentLocation.pathname,o)||i.currentLocation.pathname,d=stripBasename(i.nextLocation.pathname,o)||i.nextLocation.pathname;return matchPath(a.pathname,d)!=null||matchPath(a.pathname,c)!=null}const scriptRel="modulepreload",assetsURL=function(s){return"/"+s},seen={},__vitePreload=function(e,i,o){let a=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));a=Promise.allSettled(i.map(g=>{if(g=assetsURL(g),g in seen)return;seen[g]=!0;const _=g.endsWith(".css"),j=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${j}`))return;const b=document.createElement("link");if(b.rel=_?"stylesheet":scriptRel,_||(b.as="script"),b.crossOrigin="",b.href=g,h&&b.setAttribute("nonce",h),document.head.appendChild(b),_)return new Promise(($,et)=>{b.addEventListener("load",$),b.addEventListener("error",()=>et(new Error(`Unable to preload CSS for ${g}`)))})}))}function c(d){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=d,window.dispatchEvent(h),!h.defaultPrevented)throw d}return a.then(d=>{for(const h of d||[])h.status==="rejected"&&c(h.reason);return e().catch(c)})},resolveFetch$3=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...i)=>__vitePreload(async()=>{const{default:o}=await Promise.resolve().then(()=>browser);return{default:o}},[]).then(({default:o})=>o(...i)):e=fetch,(...i)=>e(...i)};class FunctionsError extends Error{constructor(e,i="FunctionsError",o){super(e),this.name=i,this.context=o}}class FunctionsFetchError extends FunctionsError{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class FunctionsRelayError extends FunctionsError{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class FunctionsHttpError extends FunctionsError{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var FunctionRegion;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(FunctionRegion||(FunctionRegion={}));var __awaiter$7=function(s,e,i,o){function a(c){return c instanceof i?c:new i(function(d){d(c)})}return new(i||(i=Promise))(function(c,d){function h(j){try{_(o.next(j))}catch(b){d(b)}}function g(j){try{_(o.throw(j))}catch(b){d(b)}}function _(j){j.done?c(j.value):a(j.value).then(h,g)}_((o=o.apply(s,e||[])).next())})};class FunctionsClient{constructor(e,{headers:i={},customFetch:o,region:a=FunctionRegion.Any}={}){this.url=e,this.headers=i,this.region=a,this.fetch=resolveFetch$3(o)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,i={}){var o;return __awaiter$7(this,void 0,void 0,function*(){try{const{headers:a,method:c,body:d}=i;let h={},{region:g}=i;g||(g=this.region);const _=new URL(`${this.url}/${e}`);g&&g!=="any"&&(h["x-region"]=g,_.searchParams.set("forceFunctionRegion",g));let j;d&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",j=d):typeof d=="string"?(h["Content-Type"]="text/plain",j=d):typeof FormData<"u"&&d instanceof FormData?j=d:(h["Content-Type"]="application/json",j=JSON.stringify(d)));const b=yield this.fetch(_.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),a),body:j}).catch(st=>{throw new FunctionsFetchError(st)}),$=b.headers.get("x-relay-error");if($&&$==="true")throw new FunctionsRelayError(b);if(!b.ok)throw new FunctionsHttpError(b);let et=((o=b.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),_e;return et==="application/json"?_e=yield b.json():et==="application/octet-stream"?_e=yield b.blob():et==="text/event-stream"?_e=b:et==="multipart/form-data"?_e=yield b.formData():_e=yield b.text(),{data:_e,error:null,response:b}}catch(a){return{data:null,error:a,response:a instanceof FunctionsHttpError||a instanceof FunctionsRelayError?a.context:void 0}}})}}var cjs={},PostgrestClient$2={},PostgrestQueryBuilder$2={},PostgrestFilterBuilder$2={},PostgrestTransformBuilder$2={},PostgrestBuilder$2={},getGlobal=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},globalObject=getGlobal();const fetch$1=globalObject.fetch,nodeFetch=globalObject.fetch.bind(globalObject),Headers$2=globalObject.Headers,Request=globalObject.Request,Response$1=globalObject.Response,browser=Object.freeze(Object.defineProperty({__proto__:null,Headers:Headers$2,Request,Response:Response$1,default:nodeFetch,fetch:fetch$1},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(browser);var PostgrestError$2={};Object.defineProperty(PostgrestError$2,"__esModule",{value:!0});let PostgrestError$1=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};PostgrestError$2.default=PostgrestError$1;var __importDefault$5=commonjsGlobal&&commonjsGlobal.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(PostgrestBuilder$2,"__esModule",{value:!0});const node_fetch_1=__importDefault$5(require$$0$1),PostgrestError_1$1=__importDefault$5(PostgrestError$2);let PostgrestBuilder$1=class{constructor(e){var i,o;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(i=e.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=e.signal,this.isMaybeSingle=(o=e.isMaybeSingle)!==null&&o!==void 0?o:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=node_fetch_1.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,i){return this.headers=new Headers(this.headers),this.headers.set(e,i),this}then(e,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let a=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,h,g,_;let j=null,b=null,$=null,et=c.status,_e=c.statusText;if(c.ok){if(this.method!=="HEAD"){const nt=await c.text();nt===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?b=nt:b=JSON.parse(nt))}const ot=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),tt=(g=c.headers.get("content-range"))===null||g===void 0?void 0:g.split("/");ot&&tt&&tt.length>1&&($=parseInt(tt[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(j={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,$=null,et=406,_e="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const ot=await c.text();try{j=JSON.parse(ot),Array.isArray(j)&&c.status===404&&(b=[],j=null,et=200,_e="OK")}catch{c.status===404&&ot===""?(et=204,_e="No Content"):j={message:ot}}if(j&&this.isMaybeSingle&&(!((_=j==null?void 0:j.details)===null||_===void 0)&&_.includes("0 rows"))&&(j=null,et=200,_e="OK"),j&&this.shouldThrowOnError)throw new PostgrestError_1$1.default(j)}return{error:j,data:b,count:$,status:et,statusText:_e}});return this.shouldThrowOnError||(a=a.catch(c=>{var d,h,g;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(g=c==null?void 0:c.code)!==null&&g!==void 0?g:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,i)}returns(){return this}overrideTypes(){return this}};PostgrestBuilder$2.default=PostgrestBuilder$1;var __importDefault$4=commonjsGlobal&&commonjsGlobal.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(PostgrestTransformBuilder$2,"__esModule",{value:!0});const PostgrestBuilder_1$1=__importDefault$4(PostgrestBuilder$2);let PostgrestTransformBuilder$1=class extends PostgrestBuilder_1$1.default{select(e){let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:c=a}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${e}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,i,{foreignTable:o,referencedTable:a=o}={}){const c=typeof a>"u"?"offset":`${a}.offset`,d=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(c,`${e}`),this.url.searchParams.set(d,`${i-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:c=!1,format:d="text"}={}){var h;const g=[e?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,c?"wal":null].filter(Boolean).join("|"),_=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${_}"; options=${g};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};PostgrestTransformBuilder$2.default=PostgrestTransformBuilder$1;var __importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(PostgrestFilterBuilder$2,"__esModule",{value:!0});const PostgrestTransformBuilder_1$1=__importDefault$3(PostgrestTransformBuilder$2);let PostgrestFilterBuilder$1=class extends PostgrestTransformBuilder_1$1.default{eq(e,i){return this.url.searchParams.append(e,`eq.${i}`),this}neq(e,i){return this.url.searchParams.append(e,`neq.${i}`),this}gt(e,i){return this.url.searchParams.append(e,`gt.${i}`),this}gte(e,i){return this.url.searchParams.append(e,`gte.${i}`),this}lt(e,i){return this.url.searchParams.append(e,`lt.${i}`),this}lte(e,i){return this.url.searchParams.append(e,`lte.${i}`),this}like(e,i){return this.url.searchParams.append(e,`like.${i}`),this}likeAllOf(e,i){return this.url.searchParams.append(e,`like(all).{${i.join(",")}}`),this}likeAnyOf(e,i){return this.url.searchParams.append(e,`like(any).{${i.join(",")}}`),this}ilike(e,i){return this.url.searchParams.append(e,`ilike.${i}`),this}ilikeAllOf(e,i){return this.url.searchParams.append(e,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(e,i){return this.url.searchParams.append(e,`ilike(any).{${i.join(",")}}`),this}is(e,i){return this.url.searchParams.append(e,`is.${i}`),this}in(e,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${o})`),this}contains(e,i){return typeof i=="string"?this.url.searchParams.append(e,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(e,`cs.{${i.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(i)}`),this}containedBy(e,i){return typeof i=="string"?this.url.searchParams.append(e,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(e,`cd.{${i.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(i)}`),this}rangeGt(e,i){return this.url.searchParams.append(e,`sr.${i}`),this}rangeGte(e,i){return this.url.searchParams.append(e,`nxl.${i}`),this}rangeLt(e,i){return this.url.searchParams.append(e,`sl.${i}`),this}rangeLte(e,i){return this.url.searchParams.append(e,`nxr.${i}`),this}rangeAdjacent(e,i){return this.url.searchParams.append(e,`adj.${i}`),this}overlaps(e,i){return typeof i=="string"?this.url.searchParams.append(e,`ov.${i}`):this.url.searchParams.append(e,`ov.{${i.join(",")}}`),this}textSearch(e,i,{config:o,type:a}={}){let c="";a==="plain"?c="pl":a==="phrase"?c="ph":a==="websearch"&&(c="w");const d=o===void 0?"":`(${o})`;return this.url.searchParams.append(e,`${c}fts${d}.${i}`),this}match(e){return Object.entries(e).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(e,i,o){return this.url.searchParams.append(e,`not.${i}.${o}`),this}or(e,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,i,o){return this.url.searchParams.append(e,`${i}.${o}`),this}};PostgrestFilterBuilder$2.default=PostgrestFilterBuilder$1;var __importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(PostgrestQueryBuilder$2,"__esModule",{value:!0});const PostgrestFilterBuilder_1$2=__importDefault$2(PostgrestFilterBuilder$2);let PostgrestQueryBuilder$1=class{constructor(e,{headers:i={},schema:o,fetch:a}){this.url=e,this.headers=new Headers(i),this.schema=o,this.fetch=a}select(e,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let c=!1;const d=(e??"*").split("").map(h=>/\s/.test(h)&&!c?"":(h==='"'&&(c=!c),h)).join("");return this.url.searchParams.set("select",d),o&&this.headers.append("Prefer",`count=${o}`),new PostgrestFilterBuilder_1$2.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:i,defaultToNull:o=!0}={}){var a;const c="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const d=e.reduce((h,g)=>h.concat(Object.keys(g)),[]);if(d.length>0){const h=[...new Set(d)].map(g=>`"${g}"`);this.url.searchParams.set("columns",h.join(","))}}return new PostgrestFilterBuilder_1$2.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:c=!0}={}){var d;const h="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),a&&this.headers.append("Prefer",`count=${a}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const g=e.reduce((_,j)=>_.concat(Object.keys(j)),[]);if(g.length>0){const _=[...new Set(g)].map(j=>`"${j}"`);this.url.searchParams.set("columns",_.join(","))}}return new PostgrestFilterBuilder_1$2.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(e,{count:i}={}){var o;const a="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new PostgrestFilterBuilder_1$2.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:e}={}){var i;const o="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new PostgrestFilterBuilder_1$2.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};PostgrestQueryBuilder$2.default=PostgrestQueryBuilder$1;var __importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(PostgrestClient$2,"__esModule",{value:!0});const PostgrestQueryBuilder_1$1=__importDefault$1(PostgrestQueryBuilder$2),PostgrestFilterBuilder_1$1=__importDefault$1(PostgrestFilterBuilder$2);let PostgrestClient$1=class Kt{constructor(e,{headers:i={},schema:o,fetch:a}={}){this.url=e,this.headers=new Headers(i),this.schemaName=o,this.fetch=a}from(e){const i=new URL(`${this.url}/${e}`);return new PostgrestQueryBuilder_1$1.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Kt(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,i={},{head:o=!1,get:a=!1,count:c}={}){var d;let h;const g=new URL(`${this.url}/rpc/${e}`);let _;o||a?(h=o?"HEAD":"GET",Object.entries(i).filter(([b,$])=>$!==void 0).map(([b,$])=>[b,Array.isArray($)?`{${$.join(",")}}`:`${$}`]).forEach(([b,$])=>{g.searchParams.append(b,$)})):(h="POST",_=i);const j=new Headers(this.headers);return c&&j.set("Prefer",`count=${c}`),new PostgrestFilterBuilder_1$1.default({method:h,url:g,headers:j,schema:this.schemaName,body:_,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}};PostgrestClient$2.default=PostgrestClient$1;var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(cjs,"__esModule",{value:!0});cjs.PostgrestError=cjs.PostgrestBuilder=cjs.PostgrestTransformBuilder=cjs.PostgrestFilterBuilder=cjs.PostgrestQueryBuilder=cjs.PostgrestClient=void 0;const PostgrestClient_1=__importDefault(PostgrestClient$2);cjs.PostgrestClient=PostgrestClient_1.default;const PostgrestQueryBuilder_1=__importDefault(PostgrestQueryBuilder$2);cjs.PostgrestQueryBuilder=PostgrestQueryBuilder_1.default;const PostgrestFilterBuilder_1=__importDefault(PostgrestFilterBuilder$2);cjs.PostgrestFilterBuilder=PostgrestFilterBuilder_1.default;const PostgrestTransformBuilder_1=__importDefault(PostgrestTransformBuilder$2);cjs.PostgrestTransformBuilder=PostgrestTransformBuilder_1.default;const PostgrestBuilder_1=__importDefault(PostgrestBuilder$2);cjs.PostgrestBuilder=PostgrestBuilder_1.default;const PostgrestError_1=__importDefault(PostgrestError$2);cjs.PostgrestError=PostgrestError_1.default;var _default=cjs.default={PostgrestClient:PostgrestClient_1.default,PostgrestQueryBuilder:PostgrestQueryBuilder_1.default,PostgrestFilterBuilder:PostgrestFilterBuilder_1.default,PostgrestTransformBuilder:PostgrestTransformBuilder_1.default,PostgrestBuilder:PostgrestBuilder_1.default,PostgrestError:PostgrestError_1.default};const{PostgrestClient,PostgrestQueryBuilder,PostgrestFilterBuilder,PostgrestTransformBuilder,PostgrestBuilder,PostgrestError}=_default;class WebSocketFactory{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const i=parseInt(process.versions.node.split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let i=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(i+=`

Suggested solution: ${e.workaround}`),new Error(i)}static createWebSocket(e,i){const o=this.getWebSocketConstructor();return new o(e,i)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const version$4="2.15.1",DEFAULT_VERSION=`realtime-js/${version$4}`,VSN="1.0.0",DEFAULT_TIMEOUT=1e4,WS_CLOSE_NORMAL=1e3,MAX_PUSH_BUFFER_SIZE=100;var SOCKET_STATES;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(SOCKET_STATES||(SOCKET_STATES={}));var CHANNEL_STATES;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(CHANNEL_STATES||(CHANNEL_STATES={}));var CHANNEL_EVENTS;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(CHANNEL_EVENTS||(CHANNEL_EVENTS={}));var TRANSPORTS;(function(s){s.websocket="websocket"})(TRANSPORTS||(TRANSPORTS={}));var CONNECTION_STATE;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(CONNECTION_STATE||(CONNECTION_STATE={}));class Serializer{constructor(){this.HEADER_LENGTH=1}decode(e,i){return e.constructor===ArrayBuffer?i(this._binaryDecode(e)):i(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const i=new DataView(e),o=new TextDecoder;return this._decodeBroadcast(e,i,o)}_decodeBroadcast(e,i,o){const a=i.getUint8(1),c=i.getUint8(2);let d=this.HEADER_LENGTH+2;const h=o.decode(e.slice(d,d+a));d=d+a;const g=o.decode(e.slice(d,d+c));d=d+c;const _=JSON.parse(o.decode(e.slice(d,e.byteLength)));return{ref:null,topic:h,event:g,payload:_}}}class Timer{constructor(e,i){this.callback=e,this.timerCalc=i,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=i}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var PostgresTypes;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(PostgresTypes||(PostgresTypes={}));const convertChangeData=(s,e,i={})=>{var o;const a=(o=i.skipTypes)!==null&&o!==void 0?o:[];return Object.keys(e).reduce((c,d)=>(c[d]=convertColumn(d,s,e,a),c),{})},convertColumn=(s,e,i,o)=>{const a=e.find(h=>h.name===s),c=a==null?void 0:a.type,d=i[s];return c&&!o.includes(c)?convertCell(c,d):noop$2(d)},convertCell=(s,e)=>{if(s.charAt(0)==="_"){const i=s.slice(1,s.length);return toArray(e,i)}switch(s){case PostgresTypes.bool:return toBoolean(e);case PostgresTypes.float4:case PostgresTypes.float8:case PostgresTypes.int2:case PostgresTypes.int4:case PostgresTypes.int8:case PostgresTypes.numeric:case PostgresTypes.oid:return toNumber(e);case PostgresTypes.json:case PostgresTypes.jsonb:return toJson(e);case PostgresTypes.timestamp:return toTimestampString(e);case PostgresTypes.abstime:case PostgresTypes.date:case PostgresTypes.daterange:case PostgresTypes.int4range:case PostgresTypes.int8range:case PostgresTypes.money:case PostgresTypes.reltime:case PostgresTypes.text:case PostgresTypes.time:case PostgresTypes.timestamptz:case PostgresTypes.timetz:case PostgresTypes.tsrange:case PostgresTypes.tstzrange:return noop$2(e);default:return noop$2(e)}},noop$2=s=>s,toBoolean=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},toNumber=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},toJson=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},toArray=(s,e)=>{if(typeof s!="string")return s;const i=s.length-1,o=s[i];if(s[0]==="{"&&o==="}"){let c;const d=s.slice(1,i);try{c=JSON.parse("["+d+"]")}catch{c=d?d.split(","):[]}return c.map(h=>convertCell(e,h))}return s},toTimestampString=s=>typeof s=="string"?s.replace(" ","T"):s,httpEndpointURL=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Push{constructor(e,i,o={},a=DEFAULT_TIMEOUT){this.channel=e,this.event=i,this.payload=o,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,i){var o;return this._hasReceived(e)&&i((o=this.receivedResp)===null||o===void 0?void 0:o.response),this.recHooks.push({status:e,callback:i}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=i=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=i,this._matchReceive(i)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,i){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:i})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:i}){this.recHooks.filter(o=>o.status===e).forEach(o=>o.callback(i))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var REALTIME_PRESENCE_LISTEN_EVENTS;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(REALTIME_PRESENCE_LISTEN_EVENTS||(REALTIME_PRESENCE_LISTEN_EVENTS={}));class RealtimePresence{constructor(e,i){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=(i==null?void 0:i.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},a=>{const{onJoin:c,onLeave:d,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,a,c,d),this.pendingDiffs.forEach(g=>{this.state=RealtimePresence.syncDiff(this.state,g,c,d)}),this.pendingDiffs=[],h()}),this.channel._on(o.diff,{},a=>{const{onJoin:c,onLeave:d,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=RealtimePresence.syncDiff(this.state,a,c,d),h())}),this.onJoin((a,c,d)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:c,newPresences:d})}),this.onLeave((a,c,d)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:c,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,i,o,a){const c=this.cloneDeep(e),d=this.transformState(i),h={},g={};return this.map(c,(_,j)=>{d[_]||(g[_]=j)}),this.map(d,(_,j)=>{const b=c[_];if(b){const $=j.map(ot=>ot.presence_ref),et=b.map(ot=>ot.presence_ref),_e=j.filter(ot=>et.indexOf(ot.presence_ref)<0),st=b.filter(ot=>$.indexOf(ot.presence_ref)<0);_e.length>0&&(h[_]=_e),st.length>0&&(g[_]=st)}else h[_]=j}),this.syncDiff(c,{joins:h,leaves:g},o,a)}static syncDiff(e,i,o,a){const{joins:c,leaves:d}={joins:this.transformState(i.joins),leaves:this.transformState(i.leaves)};return o||(o=()=>{}),a||(a=()=>{}),this.map(c,(h,g)=>{var _;const j=(_=e[h])!==null&&_!==void 0?_:[];if(e[h]=this.cloneDeep(g),j.length>0){const b=e[h].map(et=>et.presence_ref),$=j.filter(et=>b.indexOf(et.presence_ref)<0);e[h].unshift(...$)}o(h,j,g)}),this.map(d,(h,g)=>{let _=e[h];if(!_)return;const j=g.map(b=>b.presence_ref);_=_.filter(b=>j.indexOf(b.presence_ref)<0),e[h]=_,a(h,_,g),_.length===0&&delete e[h]}),e}static map(e,i){return Object.getOwnPropertyNames(e).map(o=>i(o,e[o]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((i,o)=>{const a=e[o];return"metas"in a?i[o]=a.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):i[o]=a,i},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT||(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT={}));var REALTIME_LISTEN_TYPES;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(REALTIME_LISTEN_TYPES||(REALTIME_LISTEN_TYPES={}));var REALTIME_SUBSCRIBE_STATES;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(REALTIME_SUBSCRIBE_STATES||(REALTIME_SUBSCRIBE_STATES={}));class RealtimeChannel{constructor(e,i={config:{}},o){this.topic=e,this.params=i,this.socket=o,this.bindings={},this.state=CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},i.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new Timer(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=CHANNEL_STATES.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this._on(CHANNEL_EVENTS.reply,{},(a,c)=>{this._trigger(this._replyEventName(c),a)}),this.presence=new RealtimePresence(this),this.broadcastEndpointURL=httpEndpointURL(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,i=this.timeout){var o,a;if(this.socket.isConnected()||this.socket.connect(),this.state==CHANNEL_STATES.closed){const{config:{broadcast:c,presence:d,private:h}}=this.params,g=(a=(o=this.bindings.postgres_changes)===null||o===void 0?void 0:o.map($=>$.filter))!==null&&a!==void 0?a:[],_=!!this.bindings[REALTIME_LISTEN_TYPES.PRESENCE]&&this.bindings[REALTIME_LISTEN_TYPES.PRESENCE].length>0,j={},b={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:_}),postgres_changes:g,private:h};this.socket.accessTokenValue&&(j.access_token=this.socket.accessTokenValue),this._onError($=>e==null?void 0:e(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,$)),this._onClose(()=>e==null?void 0:e(REALTIME_SUBSCRIBE_STATES.CLOSED)),this.updateJoinPayload(Object.assign({config:b},j)),this.joinedOnce=!0,this._rejoin(i),this.joinPush.receive("ok",async({postgres_changes:$})=>{var et;if(this.socket.setAuth(),$===void 0){e==null||e(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}else{const _e=this.bindings.postgres_changes,st=(et=_e==null?void 0:_e.length)!==null&&et!==void 0?et:0,ot=[];for(let tt=0;tt<st;tt++){const nt=_e[tt],{filter:{event:rt,schema:it,table:lt,filter:at}}=nt,ut=$&&$[tt];if(ut&&ut.event===rt&&ut.schema===it&&ut.table===lt&&ut.filter===at)ot.push(Object.assign(Object.assign({},nt),{id:ut.id}));else{this.unsubscribe(),this.state=CHANNEL_STATES.errored,e==null||e(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=ot,e&&e(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}}).receive("error",$=>{this.state=CHANNEL_STATES.errored,e==null||e(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error(JSON.stringify(Object.values($).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(REALTIME_SUBSCRIBE_STATES.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,i={}){return await this.send({type:"presence",event:"track",payload:e},i.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,i,o){return this.state===CHANNEL_STATES.joined&&e===REALTIME_LISTEN_TYPES.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,i,o)}async send(e,i={}){var o,a;if(!this._canPush()&&e.type==="broadcast"){const{event:c,payload:d}=e,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:d,private:this.private}]})};try{const _=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(o=i.timeout)!==null&&o!==void 0?o:this.timeout);return await((a=_.body)===null||a===void 0?void 0:a.cancel()),_.ok?"ok":"error"}catch(_){return _.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var d,h,g;const _=this._push(e.type,e,i.timeout||this.timeout);e.type==="broadcast"&&!(!((g=(h=(d=this.params)===null||d===void 0?void 0:d.config)===null||h===void 0?void 0:h.broadcast)===null||g===void 0)&&g.ack)&&c("ok"),_.receive("ok",()=>c("ok")),_.receive("error",()=>c("error")),_.receive("timeout",()=>c("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=CHANNEL_STATES.leaving;const i=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(CHANNEL_EVENTS.close,"leave",this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(a=>{o=new Push(this,CHANNEL_EVENTS.leave,{},e),o.receive("ok",()=>{i(),a("ok")}).receive("timeout",()=>{i(),a("timed out")}).receive("error",()=>{a("error")}),o.send(),this._canPush()||o.trigger("ok",{})}).finally(()=>{o==null||o.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=CHANNEL_STATES.closed,this.bindings={}}async _fetchWithTimeout(e,i,o){const a=new AbortController,c=setTimeout(()=>a.abort(),o),d=await this.socket.fetch(e,Object.assign(Object.assign({},i),{signal:a.signal}));return clearTimeout(c),d}_push(e,i,o=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Push(this,e,i,o);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>MAX_PUSH_BUFFER_SIZE){const i=this.pushBuffer.shift();i&&(i.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${i.event}`,i.payload))}}_onMessage(e,i,o){return i}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,i,o){var a,c;const d=e.toLocaleLowerCase(),{close:h,error:g,leave:_,join:j}=CHANNEL_EVENTS;if(o&&[h,g,_,j].indexOf(d)>=0&&o!==this._joinRef())return;let $=this._onMessage(d,i,o);if(i&&!$)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(et=>{var _e,st,ot;return((_e=et.filter)===null||_e===void 0?void 0:_e.event)==="*"||((ot=(st=et.filter)===null||st===void 0?void 0:st.event)===null||ot===void 0?void 0:ot.toLocaleLowerCase())===d}).map(et=>et.callback($,o)):(c=this.bindings[d])===null||c===void 0||c.filter(et=>{var _e,st,ot,tt,nt,rt;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in et){const it=et.id,lt=(_e=et.filter)===null||_e===void 0?void 0:_e.event;return it&&((st=i.ids)===null||st===void 0?void 0:st.includes(it))&&(lt==="*"||(lt==null?void 0:lt.toLocaleLowerCase())===((ot=i.data)===null||ot===void 0?void 0:ot.type.toLocaleLowerCase()))}else{const it=(nt=(tt=et==null?void 0:et.filter)===null||tt===void 0?void 0:tt.event)===null||nt===void 0?void 0:nt.toLocaleLowerCase();return it==="*"||it===((rt=i==null?void 0:i.event)===null||rt===void 0?void 0:rt.toLocaleLowerCase())}else return et.type.toLocaleLowerCase()===d}).map(et=>{if(typeof $=="object"&&"ids"in $){const _e=$.data,{schema:st,table:ot,commit_timestamp:tt,type:nt,errors:rt}=_e;$=Object.assign(Object.assign({},{schema:st,table:ot,commit_timestamp:tt,eventType:nt,new:{},old:{},errors:rt}),this._getPayloadRecords(_e))}et.callback($,o)})}_isClosed(){return this.state===CHANNEL_STATES.closed}_isJoined(){return this.state===CHANNEL_STATES.joined}_isJoining(){return this.state===CHANNEL_STATES.joining}_isLeaving(){return this.state===CHANNEL_STATES.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,i,o){const a=e.toLocaleLowerCase(),c={type:a,filter:i,callback:o};return this.bindings[a]?this.bindings[a].push(c):this.bindings[a]=[c],this}_off(e,i){const o=e.toLocaleLowerCase();return this.bindings[o]&&(this.bindings[o]=this.bindings[o].filter(a=>{var c;return!(((c=a.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===o&&RealtimeChannel.isEqual(a.filter,i))})),this}static isEqual(e,i){if(Object.keys(e).length!==Object.keys(i).length)return!1;for(const o in e)if(e[o]!==i[o])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(CHANNEL_EVENTS.close,{},e)}_onError(e){this._on(CHANNEL_EVENTS.error,{},i=>e(i))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=CHANNEL_STATES.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const i={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(i.new=convertChangeData(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(i.old=convertChangeData(e.columns,e.old_record)),i}}const noop$1=()=>{},CONNECTION_TIMEOUTS={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},RECONNECT_INTERVALS=[1e3,2e3,5e3,1e4],DEFAULT_RECONNECT_FALLBACK=1e4,WORKER_SCRIPT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class RealtimeClient{constructor(e,i){var o;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=DEFAULT_TIMEOUT,this.transport=null,this.heartbeatIntervalMs=CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=noop$1,this.ref=0,this.reconnectTimer=null,this.logger=noop$1,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let c;return a?c=a:typeof fetch>"u"?c=(...d)=>__vitePreload(async()=>{const{default:h}=await Promise.resolve().then(()=>browser);return{default:h}},void 0).then(({default:h})=>h(...d)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):c=fetch,(...d)=>c(...d)},!(!((o=i==null?void 0:i.params)===null||o===void 0)&&o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=i.params.apikey,this.endPoint=`${e}/${TRANSPORTS.websocket}`,this.httpEndpoint=httpEndpointURL(e),this._initializeOptions(i),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(i==null?void 0:i.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=WebSocketFactory.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const i=e.message;throw i.includes("Node.js")?new Error(`${i}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${i}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:VSN}))}disconnect(e,i){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const o=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(o),this._setConnectionState("disconnected")},e?this.conn.close(e,i??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const i=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),i}async removeAllChannels(){const e=await Promise.all(this.channels.map(i=>i.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,i,o){this.logger(e,i,o)}connectionState(){switch(this.conn&&this.conn.readyState){case SOCKET_STATES.connecting:return CONNECTION_STATE.Connecting;case SOCKET_STATES.open:return CONNECTION_STATE.Open;case SOCKET_STATES.closing:return CONNECTION_STATE.Closing;default:return CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===CONNECTION_STATE.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,i={config:{}}){const o=`realtime:${e}`,a=this.getChannels().find(c=>c.topic===o);if(a)return a;{const c=new RealtimeChannel(`realtime:${e}`,i,this);return this.channels.push(c),c}}push(e){const{topic:i,event:o,payload:a,ref:c}=e,d=()=>{this.encode(e,h=>{var g;(g=this.conn)===null||g===void 0||g.send(h)})};this.log("push",`${i} ${o} (${c})`,a),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(WS_CLOSE_NORMAL,"heartbeat timeout"),setTimeout(()=>{var i;this.isConnected()||(i=this.reconnectTimer)===null||i===void 0||i.scheduleTimeout()},CONNECTION_TIMEOUTS.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let i=this.channels.find(o=>o.topic===e&&(o._isJoined()||o._isJoining()));i&&(this.log("transport",`leaving duplicate topic "${e}"`),i.unsubscribe())}_remove(e){this.channels=this.channels.filter(i=>i.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,i=>{i.topic==="phoenix"&&i.event==="phx_reply"&&this.heartbeatCallback(i.payload.status==="ok"?"ok":"error"),i.ref&&i.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:o,event:a,payload:c,ref:d}=i,h=d?`(${d})`:"",g=c.status||"";this.log("receive",`${g} ${o} ${a} ${h}`.trim(),c),this.channels.filter(_=>_._isMember(o)).forEach(_=>_._trigger(a,c,d)),this._triggerStateCallbacks("message",i)})}_clearTimer(e){var i;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((i=this.reconnectTimer)===null||i===void 0||i.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=i=>{this.log("worker","worker error",i.message),this.workerRef.terminate()},this.workerRef.onmessage=i=>{i.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var i;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(i=this.reconnectTimer)===null||i===void 0||i.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(CHANNEL_EVENTS.error))}_appendParams(e,i){if(Object.keys(i).length===0)return e;const o=e.match(/\?/)?"&":"?",a=new URLSearchParams(i);return`${e}${o}${a}`}_workerObjectUrl(e){let i;if(e)i=e;else{const o=new Blob([WORKER_SCRIPT],{type:"application/javascript"});i=URL.createObjectURL(o)}return i}_setConnectionState(e,i=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=i)}async _performAuth(e=null){let i;e?i=e:this.accessToken?i=await this.accessToken():i=this.accessTokenValue,this.accessTokenValue!=i&&(this.accessTokenValue=i,this.channels.forEach(o=>{const a={access_token:i,version:DEFAULT_VERSION};i&&o.updateJoinPayload(a),o.joinedOnce&&o._isJoined()&&o._push(CHANNEL_EVENTS.access_token,{access_token:i})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(i=>{this.log("error",`error setting auth in ${e}`,i)})}_triggerStateCallbacks(e,i){try{this.stateChangeCallbacks[e].forEach(o=>{try{o(i)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(o){this.log("error",`error triggering ${e} callbacks`,o)}}_setupReconnectionTimer(){this.reconnectTimer=new Timer(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},CONNECTION_TIMEOUTS.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var i,o,a,c,d,h,g,_;if(this.transport=(i=e==null?void 0:e.transport)!==null&&i!==void 0?i:null,this.timeout=(o=e==null?void 0:e.timeout)!==null&&o!==void 0?o:DEFAULT_TIMEOUT,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL,this.worker=(c=e==null?void 0:e.worker)!==null&&c!==void 0?c:!1,this.accessToken=(d=e==null?void 0:e.accessToken)!==null&&d!==void 0?d:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e==null?void 0:e.reconnectAfterMs)!==null&&h!==void 0?h:j=>RECONNECT_INTERVALS[j-1]||DEFAULT_RECONNECT_FALLBACK,this.encode=(g=e==null?void 0:e.encode)!==null&&g!==void 0?g:(j,b)=>b(JSON.stringify(j)),this.decode=(_=e==null?void 0:e.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class StorageError extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class StorageApiError extends StorageError{constructor(e,i,o){super(e),this.name="StorageApiError",this.status=i,this.statusCode=o}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class StorageUnknownError extends StorageError{constructor(e,i){super(e),this.name="StorageUnknownError",this.originalError=i}}var __awaiter$6=function(s,e,i,o){function a(c){return c instanceof i?c:new i(function(d){d(c)})}return new(i||(i=Promise))(function(c,d){function h(j){try{_(o.next(j))}catch(b){d(b)}}function g(j){try{_(o.throw(j))}catch(b){d(b)}}function _(j){j.done?c(j.value):a(j.value).then(h,g)}_((o=o.apply(s,e||[])).next())})};const resolveFetch$2=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...i)=>__vitePreload(async()=>{const{default:o}=await Promise.resolve().then(()=>browser);return{default:o}},void 0).then(({default:o})=>o(...i)):e=fetch,(...i)=>e(...i)},resolveResponse=()=>__awaiter$6(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield __vitePreload(()=>Promise.resolve().then(()=>browser),void 0)).Response:Response}),recursiveToCamel=s=>{if(Array.isArray(s))return s.map(i=>recursiveToCamel(i));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([i,o])=>{const a=i.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));e[a]=recursiveToCamel(o)}),e},isPlainObject=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)};var __awaiter$5=function(s,e,i,o){function a(c){return c instanceof i?c:new i(function(d){d(c)})}return new(i||(i=Promise))(function(c,d){function h(j){try{_(o.next(j))}catch(b){d(b)}}function g(j){try{_(o.throw(j))}catch(b){d(b)}}function _(j){j.done?c(j.value):a(j.value).then(h,g)}_((o=o.apply(s,e||[])).next())})};const _getErrorMessage$1=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),handleError$1=(s,e,i)=>__awaiter$5(void 0,void 0,void 0,function*(){const o=yield resolveResponse();s instanceof o&&!(i!=null&&i.noResolveJson)?s.json().then(a=>{const c=s.status||500,d=(a==null?void 0:a.statusCode)||c+"";e(new StorageApiError(_getErrorMessage$1(a),c,d))}).catch(a=>{e(new StorageUnknownError(_getErrorMessage$1(a),a))}):e(new StorageUnknownError(_getErrorMessage$1(s),s))}),_getRequestParams$1=(s,e,i,o)=>{const a={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"||!o?a:(isPlainObject(o)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(o)):a.body=o,e!=null&&e.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),i))};function _handleRequest$1(s,e,i,o,a,c){return __awaiter$5(this,void 0,void 0,function*(){return new Promise((d,h)=>{s(i,_getRequestParams$1(e,o,a,c)).then(g=>{if(!g.ok)throw g;return o!=null&&o.noResolveJson?g:g.json()}).then(g=>d(g)).catch(g=>handleError$1(g,h,o))})})}function get$1(s,e,i,o){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(s,"GET",e,i,o)})}function post(s,e,i,o,a){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(s,"POST",e,o,a,i)})}function put(s,e,i,o,a){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(s,"PUT",e,o,a,i)})}function head(s,e,i,o){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(s,"HEAD",e,Object.assign(Object.assign({},i),{noResolveJson:!0}),o)})}function remove(s,e,i,o,a){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(s,"DELETE",e,o,a,i)})}var __awaiter$4=function(s,e,i,o){function a(c){return c instanceof i?c:new i(function(d){d(c)})}return new(i||(i=Promise))(function(c,d){function h(j){try{_(o.next(j))}catch(b){d(b)}}function g(j){try{_(o.throw(j))}catch(b){d(b)}}function _(j){j.done?c(j.value):a(j.value).then(h,g)}_((o=o.apply(s,e||[])).next())})};const DEFAULT_SEARCH_OPTIONS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DEFAULT_FILE_OPTIONS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(e,i={},o,a){this.url=e,this.headers=i,this.bucketId=o,this.fetch=resolveFetch$2(a)}uploadOrUpdate(e,i,o,a){return __awaiter$4(this,void 0,void 0,function*(){try{let c;const d=Object.assign(Object.assign({},DEFAULT_FILE_OPTIONS),a);let h=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(d.upsert)});const g=d.metadata;typeof Blob<"u"&&o instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),g&&c.append("metadata",this.encodeMetadata(g)),c.append("",o)):typeof FormData<"u"&&o instanceof FormData?(c=o,c.append("cacheControl",d.cacheControl),g&&c.append("metadata",this.encodeMetadata(g))):(c=o,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType,g&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(g)))),a!=null&&a.headers&&(h=Object.assign(Object.assign({},h),a.headers));const _=this._removeEmptyFolders(i),j=this._getFinalPath(_),b=yield(e=="PUT"?put:post)(this.fetch,`${this.url}/object/${j}`,c,Object.assign({headers:h},d!=null&&d.duplex?{duplex:d.duplex}:{}));return{data:{path:_,id:b.Id,fullPath:b.Key},error:null}}catch(c){if(isStorageError(c))return{data:null,error:c};throw c}})}upload(e,i,o){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,i,o)})}uploadToSignedUrl(e,i,o,a){return __awaiter$4(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(e),d=this._getFinalPath(c),h=new URL(this.url+`/object/upload/sign/${d}`);h.searchParams.set("token",i);try{let g;const _=Object.assign({upsert:DEFAULT_FILE_OPTIONS.upsert},a),j=Object.assign(Object.assign({},this.headers),{"x-upsert":String(_.upsert)});typeof Blob<"u"&&o instanceof Blob?(g=new FormData,g.append("cacheControl",_.cacheControl),g.append("",o)):typeof FormData<"u"&&o instanceof FormData?(g=o,g.append("cacheControl",_.cacheControl)):(g=o,j["cache-control"]=`max-age=${_.cacheControl}`,j["content-type"]=_.contentType);const b=yield put(this.fetch,h.toString(),g,{headers:j});return{data:{path:c,fullPath:b.Key},error:null}}catch(g){if(isStorageError(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(e,i){return __awaiter$4(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e);const a=Object.assign({},this.headers);i!=null&&i.upsert&&(a["x-upsert"]="true");const c=yield post(this.fetch,`${this.url}/object/upload/sign/${o}`,{},{headers:a}),d=new URL(this.url+c.url),h=d.searchParams.get("token");if(!h)throw new StorageError("No token returned by API");return{data:{signedUrl:d.toString(),path:e,token:h},error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}update(e,i,o){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,i,o)})}move(e,i,o){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:i,destinationBucket:o==null?void 0:o.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}copy(e,i,o){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:i,destinationBucket:o==null?void 0:o.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}createSignedUrl(e,i,o){return __awaiter$4(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),c=yield post(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:i},o!=null&&o.transform?{transform:o.transform}:{}),{headers:this.headers});const d=o!=null&&o.download?`&download=${o.download===!0?"":o.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${d}`)},{data:c,error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}createSignedUrls(e,i,o){return __awaiter$4(this,void 0,void 0,function*(){try{const a=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:i,paths:e},{headers:this.headers}),c=o!=null&&o.download?`&download=${o.download===!0?"":o.download}`:"";return{data:a.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${c}`):null})),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}download(e,i){return __awaiter$4(this,void 0,void 0,function*(){const a=typeof(i==null?void 0:i.transform)<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString((i==null?void 0:i.transform)||{}),d=c?`?${c}`:"";try{const h=this._getFinalPath(e);return{data:yield(yield get$1(this.fetch,`${this.url}/${a}/${h}${d}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(h){if(isStorageError(h))return{data:null,error:h};throw h}})}info(e){return __awaiter$4(this,void 0,void 0,function*(){const i=this._getFinalPath(e);try{const o=yield get$1(this.fetch,`${this.url}/object/info/${i}`,{headers:this.headers});return{data:recursiveToCamel(o),error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}exists(e){return __awaiter$4(this,void 0,void 0,function*(){const i=this._getFinalPath(e);try{return yield head(this.fetch,`${this.url}/object/${i}`,{headers:this.headers}),{data:!0,error:null}}catch(o){if(isStorageError(o)&&o instanceof StorageUnknownError){const a=o.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:o}}throw o}})}getPublicUrl(e,i){const o=this._getFinalPath(e),a=[],c=i!=null&&i.download?`download=${i.download===!0?"":i.download}`:"";c!==""&&a.push(c);const h=typeof(i==null?void 0:i.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((i==null?void 0:i.transform)||{});g!==""&&a.push(g);let _=a.join("&");return _!==""&&(_=`?${_}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${o}${_}`)}}}remove(e){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}list(e,i,o){return __awaiter$4(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},DEFAULT_SEARCH_OPTIONS),i),{prefix:e||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},o),error:null}}catch(a){if(isStorageError(a))return{data:null,error:a};throw a}})}listV2(e,i){return __awaiter$4(this,void 0,void 0,function*(){try{const o=Object.assign({},e);return{data:yield post(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,o,{headers:this.headers},i),error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const i=[];return e.width&&i.push(`width=${e.width}`),e.height&&i.push(`height=${e.height}`),e.resize&&i.push(`resize=${e.resize}`),e.format&&i.push(`format=${e.format}`),e.quality&&i.push(`quality=${e.quality}`),i.join("&")}}const version$3="2.11.0",DEFAULT_HEADERS$2={"X-Client-Info":`storage-js/${version$3}`};var __awaiter$3=function(s,e,i,o){function a(c){return c instanceof i?c:new i(function(d){d(c)})}return new(i||(i=Promise))(function(c,d){function h(j){try{_(o.next(j))}catch(b){d(b)}}function g(j){try{_(o.throw(j))}catch(b){d(b)}}function _(j){j.done?c(j.value):a(j.value).then(h,g)}_((o=o.apply(s,e||[])).next())})};class StorageBucketApi{constructor(e,i={},o,a){const c=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href,this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS$2),i),this.fetch=resolveFetch$2(o)}listBuckets(){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get$1(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(isStorageError(e))return{data:null,error:e};throw e}})}getBucket(e){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get$1(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}createBucket(e,i={public:!1}){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}updateBucket(e,i){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield put(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(isStorageError(o))return{data:null,error:o};throw o}})}emptyBucket(e){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}deleteBucket(e){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}}class StorageClient extends StorageBucketApi{constructor(e,i={},o,a){super(e,i,o,a)}from(e){return new StorageFileApi(this.url,this.headers,e,this.fetch)}}const version$2="2.56.0";let JS_ENV="";typeof Deno<"u"?JS_ENV="deno":typeof document<"u"?JS_ENV="web":typeof navigator<"u"&&navigator.product==="ReactNative"?JS_ENV="react-native":JS_ENV="node";const DEFAULT_HEADERS$1={"X-Client-Info":`supabase-js-${JS_ENV}/${version$2}`},DEFAULT_GLOBAL_OPTIONS={headers:DEFAULT_HEADERS$1},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};var __awaiter$2=function(s,e,i,o){function a(c){return c instanceof i?c:new i(function(d){d(c)})}return new(i||(i=Promise))(function(c,d){function h(j){try{_(o.next(j))}catch(b){d(b)}}function g(j){try{_(o.throw(j))}catch(b){d(b)}}function _(j){j.done?c(j.value):a(j.value).then(h,g)}_((o=o.apply(s,e||[])).next())})};const resolveFetch$1=s=>{let e;return s?e=s:typeof fetch>"u"?e=nodeFetch:e=fetch,(...i)=>e(...i)},resolveHeadersConstructor=()=>typeof Headers>"u"?Headers$2:Headers,fetchWithAuth=(s,e,i)=>{const o=resolveFetch$1(i),a=resolveHeadersConstructor();return(c,d)=>__awaiter$2(void 0,void 0,void 0,function*(){var h;const g=(h=yield e())!==null&&h!==void 0?h:s;let _=new a(d==null?void 0:d.headers);return _.has("apikey")||_.set("apikey",s),_.has("Authorization")||_.set("Authorization",`Bearer ${g}`),o(c,Object.assign(Object.assign({},d),{headers:_}))})};var __awaiter$1=function(s,e,i,o){function a(c){return c instanceof i?c:new i(function(d){d(c)})}return new(i||(i=Promise))(function(c,d){function h(j){try{_(o.next(j))}catch(b){d(b)}}function g(j){try{_(o.throw(j))}catch(b){d(b)}}function _(j){j.done?c(j.value):a(j.value).then(h,g)}_((o=o.apply(s,e||[])).next())})};function ensureTrailingSlash(s){return s.endsWith("/")?s:s+"/"}function applySettingDefaults(s,e){var i,o;const{db:a,auth:c,realtime:d,global:h}=s,{db:g,auth:_,realtime:j,global:b}=e,$={db:Object.assign(Object.assign({},g),a),auth:Object.assign(Object.assign({},_),c),realtime:Object.assign(Object.assign({},j),d),storage:{},global:Object.assign(Object.assign(Object.assign({},b),h),{headers:Object.assign(Object.assign({},(i=b==null?void 0:b.headers)!==null&&i!==void 0?i:{}),(o=h==null?void 0:h.headers)!==null&&o!==void 0?o:{})}),accessToken:()=>__awaiter$1(this,void 0,void 0,function*(){return""})};return s.accessToken?$.accessToken=s.accessToken:delete $.accessToken,$}const version$1="2.71.1",AUTO_REFRESH_TICK_DURATION_MS=30*1e3,AUTO_REFRESH_TICK_THRESHOLD=3,EXPIRY_MARGIN_MS=AUTO_REFRESH_TICK_THRESHOLD*AUTO_REFRESH_TICK_DURATION_MS,GOTRUE_URL="http://localhost:9999",STORAGE_KEY="supabase.auth.token",DEFAULT_HEADERS={"X-Client-Info":`gotrue-js/${version$1}`},API_VERSION_HEADER_NAME="X-Supabase-Api-Version",API_VERSIONS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},BASE64URL_REGEX=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,JWKS_TTL=10*60*1e3;class AuthError extends Error{constructor(e,i,o){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=i,this.code=o}}function isAuthError(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class AuthApiError extends AuthError{constructor(e,i,o){super(e,i,o),this.name="AuthApiError",this.status=i,this.code=o}}function isAuthApiError(s){return isAuthError(s)&&s.name==="AuthApiError"}class AuthUnknownError extends AuthError{constructor(e,i){super(e),this.name="AuthUnknownError",this.originalError=i}}class CustomAuthError extends AuthError{constructor(e,i,o,a){super(e,o,a),this.name=i,this.status=o}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function isAuthSessionMissingError(s){return isAuthError(s)&&s.name==="AuthSessionMissingError"}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(e,i=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=i}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function isAuthImplicitGrantRedirectError(s){return isAuthError(s)&&s.name==="AuthImplicitGrantRedirectError"}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(e,i=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=i}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(e,i){super(e,"AuthRetryableFetchError",i,void 0)}}function isAuthRetryableFetchError(s){return isAuthError(s)&&s.name==="AuthRetryableFetchError"}class AuthWeakPasswordError extends CustomAuthError{constructor(e,i,o){super(e,"AuthWeakPasswordError",i,"weak_password"),this.reasons=o}}class AuthInvalidJwtError extends CustomAuthError{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const TO_BASE64URL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),IGNORE_BASE64URL=` 	
\r=`.split(""),FROM_BASE64URL=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<IGNORE_BASE64URL.length;e+=1)s[IGNORE_BASE64URL[e].charCodeAt(0)]=-2;for(let e=0;e<TO_BASE64URL.length;e+=1)s[TO_BASE64URL[e].charCodeAt(0)]=e;return s})();function byteToBase64URL(s,e,i){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const o=e.queue>>e.queuedBits-6&63;i(TO_BASE64URL[o]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const o=e.queue>>e.queuedBits-6&63;i(TO_BASE64URL[o]),e.queuedBits-=6}}function byteFromBase64URL(s,e,i){const o=FROM_BASE64URL[s];if(o>-1)for(e.queue=e.queue<<6|o,e.queuedBits+=6;e.queuedBits>=8;)i(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(o===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function stringFromBase64URL(s){const e=[],i=d=>{e.push(String.fromCodePoint(d))},o={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},c=d=>{stringFromUTF8(d,o,i)};for(let d=0;d<s.length;d+=1)byteFromBase64URL(s.charCodeAt(d),a,c);return e.join("")}function codepointToUTF8(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function stringToUTF8(s,e){for(let i=0;i<s.length;i+=1){let o=s.charCodeAt(i);if(o>55295&&o<=56319){const a=(o-55296)*1024&65535;o=(s.charCodeAt(i+1)-56320&65535|a)+65536,i+=1}codepointToUTF8(o,e)}}function stringFromUTF8(s,e,i){if(e.utf8seq===0){if(s<=127){i(s);return}for(let o=1;o<6;o+=1)if(!(s>>7-o&1)){e.utf8seq=o;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&i(e.codepoint)}}function base64UrlToUint8Array(s){const e=[],i={queue:0,queuedBits:0},o=a=>{e.push(a)};for(let a=0;a<s.length;a+=1)byteFromBase64URL(s.charCodeAt(a),i,o);return new Uint8Array(e)}function stringToUint8Array(s){const e=[];return stringToUTF8(s,i=>e.push(i)),new Uint8Array(e)}function bytesToBase64URL(s){const e=[],i={queue:0,queuedBits:0},o=a=>{e.push(a)};return s.forEach(a=>byteToBase64URL(a,i,o)),byteToBase64URL(null,i,o),e.join("")}function expiresAt(s){return Math.round(Date.now()/1e3)+s}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const isBrowser=()=>typeof window<"u"&&typeof document<"u",localStorageWriteTests={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!isBrowser())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(localStorageWriteTests.tested)return localStorageWriteTests.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!0}catch{localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!1}return localStorageWriteTests.writable};function parseParametersFromURL(s){const e={},i=new URL(s);if(i.hash&&i.hash[0]==="#")try{new URLSearchParams(i.hash.substring(1)).forEach((a,c)=>{e[c]=a})}catch{}return i.searchParams.forEach((o,a)=>{e[a]=o}),e}const resolveFetch=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...i)=>__vitePreload(async()=>{const{default:o}=await Promise.resolve().then(()=>browser);return{default:o}},void 0).then(({default:o})=>o(...i)):e=fetch,(...i)=>e(...i)},looksLikeFetchResponse=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",setItemAsync=async(s,e,i)=>{await s.setItem(e,JSON.stringify(i))},getItemAsync=async(s,e)=>{const i=await s.getItem(e);if(!i)return null;try{return JSON.parse(i)}catch{return i}},removeItemAsync=async(s,e)=>{await s.removeItem(e)};class Deferred{constructor(){this.promise=new Deferred.promiseConstructor((e,i)=>{this.resolve=e,this.reject=i})}}Deferred.promiseConstructor=Promise;function decodeJWT(s){const e=s.split(".");if(e.length!==3)throw new AuthInvalidJwtError("Invalid JWT structure");for(let o=0;o<e.length;o++)if(!BASE64URL_REGEX.test(e[o]))throw new AuthInvalidJwtError("JWT not in base64url format");return{header:JSON.parse(stringFromBase64URL(e[0])),payload:JSON.parse(stringFromBase64URL(e[1])),signature:base64UrlToUint8Array(e[2]),raw:{header:e[0],payload:e[1]}}}async function sleep(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function retryable(s,e){return new Promise((o,a)=>{(async()=>{for(let c=0;c<1/0;c++)try{const d=await s(c);if(!e(c,null,d)){o(d);return}}catch(d){if(!e(c,d)){a(d);return}}})()})}function dec2hex(s){return("0"+s.toString(16)).substr(-2)}function generatePKCEVerifier(){const e=new Uint32Array(56);if(typeof crypto>"u"){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",o=i.length;let a="";for(let c=0;c<56;c++)a+=i.charAt(Math.floor(Math.random()*o));return a}return crypto.getRandomValues(e),Array.from(e,dec2hex).join("")}async function sha256(s){const i=new TextEncoder().encode(s),o=await crypto.subtle.digest("SHA-256",i),a=new Uint8Array(o);return Array.from(a).map(c=>String.fromCharCode(c)).join("")}async function generatePKCEChallenge(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const i=await sha256(s);return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function getCodeChallengeAndMethod(s,e,i=!1){const o=generatePKCEVerifier();let a=o;i&&(a+="/PASSWORD_RECOVERY"),await setItemAsync(s,`${e}-code-verifier`,a);const c=await generatePKCEChallenge(o);return[c,o===c?"plain":"s256"]}const API_VERSION_REGEX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function parseResponseAPIVersion(s){const e=s.headers.get(API_VERSION_HEADER_NAME);if(!e||!e.match(API_VERSION_REGEX))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function validateExp(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function getAlgorithm(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const UUID_REGEX=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function validateUUID(s){if(!UUID_REGEX.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function userNotAvailableProxy(){const s={};return new Proxy(s,{get:(e,i)=>{if(i==="__isUserNotAvailableProxy")return!0;if(typeof i=="symbol"){const o=i.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${i}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,i)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${i}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,i)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${i}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function deepClone(s){return JSON.parse(JSON.stringify(s))}var __rest$1=function(s,e){var i={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&e.indexOf(o)<0&&(i[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(s);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(s,o[a])&&(i[o[a]]=s[o[a]]);return i};const _getErrorMessage=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),NETWORK_ERROR_CODES=[502,503,504];async function handleError(s){var e;if(!looksLikeFetchResponse(s))throw new AuthRetryableFetchError(_getErrorMessage(s),0);if(NETWORK_ERROR_CODES.includes(s.status))throw new AuthRetryableFetchError(_getErrorMessage(s),s.status);let i;try{i=await s.json()}catch(c){throw new AuthUnknownError(_getErrorMessage(c),c)}let o;const a=parseResponseAPIVersion(s);if(a&&a.getTime()>=API_VERSIONS["2024-01-01"].timestamp&&typeof i=="object"&&i&&typeof i.code=="string"?o=i.code:typeof i=="object"&&i&&typeof i.error_code=="string"&&(o=i.error_code),o){if(o==="weak_password")throw new AuthWeakPasswordError(_getErrorMessage(i),s.status,((e=i.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(o==="session_not_found")throw new AuthSessionMissingError}else if(typeof i=="object"&&i&&typeof i.weak_password=="object"&&i.weak_password&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.reasons.reduce((c,d)=>c&&typeof d=="string",!0))throw new AuthWeakPasswordError(_getErrorMessage(i),s.status,i.weak_password.reasons);throw new AuthApiError(_getErrorMessage(i),s.status||500,o)}const _getRequestParams=(s,e,i,o)=>{const a={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(o),Object.assign(Object.assign({},a),i))};async function _request(s,e,i,o){var a;const c=Object.assign({},o==null?void 0:o.headers);c[API_VERSION_HEADER_NAME]||(c[API_VERSION_HEADER_NAME]=API_VERSIONS["2024-01-01"].name),o!=null&&o.jwt&&(c.Authorization=`Bearer ${o.jwt}`);const d=(a=o==null?void 0:o.query)!==null&&a!==void 0?a:{};o!=null&&o.redirectTo&&(d.redirect_to=o.redirectTo);const h=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",g=await _handleRequest(s,e,i+h,{headers:c,noResolveJson:o==null?void 0:o.noResolveJson},{},o==null?void 0:o.body);return o!=null&&o.xform?o==null?void 0:o.xform(g):{data:Object.assign({},g),error:null}}async function _handleRequest(s,e,i,o,a,c){const d=_getRequestParams(e,o,a,c);let h;try{h=await s(i,Object.assign({},d))}catch(g){throw console.error(g),new AuthRetryableFetchError(_getErrorMessage(g),0)}if(h.ok||await handleError(h),o!=null&&o.noResolveJson)return h;try{return await h.json()}catch(g){await handleError(g)}}function _sessionResponse(s){var e;let i=null;hasSession(s)&&(i=Object.assign({},s),s.expires_at||(i.expires_at=expiresAt(s.expires_in)));const o=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:i,user:o},error:null}}function _sessionResponsePassword(s){const e=_sessionResponse(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0)&&(e.data.weak_password=s.weak_password),e}function _userResponse(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function _ssoResponse(s){return{data:s,error:null}}function _generateLinkResponse(s){const{action_link:e,email_otp:i,hashed_token:o,redirect_to:a,verification_type:c}=s,d=__rest$1(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:e,email_otp:i,hashed_token:o,redirect_to:a,verification_type:c},g=Object.assign({},d);return{data:{properties:h,user:g},error:null}}function _noResolveJsonResponse(s){return s}function hasSession(s){return s.access_token&&s.refresh_token&&s.expires_in}const SIGN_OUT_SCOPES=["global","local","others"];var __rest=function(s,e){var i={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&e.indexOf(o)<0&&(i[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(s);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(s,o[a])&&(i[o[a]]=s[o[a]]);return i};class GoTrueAdminApi{constructor({url:e="",headers:i={},fetch:o}){this.url=e,this.headers=i,this.fetch=resolveFetch(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,i=SIGN_OUT_SCOPES[0]){if(SIGN_OUT_SCOPES.indexOf(i)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${SIGN_OUT_SCOPES.join(", ")}`);try{return await _request(this.fetch,"POST",`${this.url}/logout?scope=${i}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(o){if(isAuthError(o))return{data:null,error:o};throw o}}async inviteUserByEmail(e,i={}){try{return await _request(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:i.data},headers:this.headers,redirectTo:i.redirectTo,xform:_userResponse})}catch(o){if(isAuthError(o))return{data:{user:null},error:o};throw o}}async generateLink(e){try{const{options:i}=e,o=__rest(e,["options"]),a=Object.assign(Object.assign({},o),i);return"newEmail"in o&&(a.new_email=o==null?void 0:o.newEmail,delete a.newEmail),await _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:_generateLinkResponse,redirectTo:i==null?void 0:i.redirectTo})}catch(i){if(isAuthError(i))return{data:{properties:null,user:null},error:i};throw i}}async createUser(e){try{return await _request(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:_userResponse})}catch(i){if(isAuthError(i))return{data:{user:null},error:i};throw i}}async listUsers(e){var i,o,a,c,d,h,g;try{const _={nextPage:null,lastPage:0,total:0},j=await _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(i=e==null?void 0:e.page)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:"",per_page:(c=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&c!==void 0?c:""},xform:_noResolveJsonResponse});if(j.error)throw j.error;const b=await j.json(),$=(d=j.headers.get("x-total-count"))!==null&&d!==void 0?d:0,et=(g=(h=j.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&g!==void 0?g:[];return et.length>0&&(et.forEach(_e=>{const st=parseInt(_e.split(";")[0].split("=")[1].substring(0,1)),ot=JSON.parse(_e.split(";")[1].split("=")[1]);_[`${ot}Page`]=st}),_.total=parseInt($)),{data:Object.assign(Object.assign({},b),_),error:null}}catch(_){if(isAuthError(_))return{data:{users:[]},error:_};throw _}}async getUserById(e){validateUUID(e);try{return await _request(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:_userResponse})}catch(i){if(isAuthError(i))return{data:{user:null},error:i};throw i}}async updateUserById(e,i){validateUUID(e);try{return await _request(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:i,headers:this.headers,xform:_userResponse})}catch(o){if(isAuthError(o))return{data:{user:null},error:o};throw o}}async deleteUser(e,i=!1){validateUUID(e);try{return await _request(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:i},xform:_userResponse})}catch(o){if(isAuthError(o))return{data:{user:null},error:o};throw o}}async _listFactors(e){validateUUID(e.userId);try{const{data:i,error:o}=await _request(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:i,error:o}}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}}async _deleteFactor(e){validateUUID(e.userId),validateUUID(e.id);try{return{data:await _request(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}}}function memoryLocalStorageAdapter(s={}){return{getItem:e=>s[e]||null,setItem:(e,i)=>{s[e]=i},removeItem:e=>{delete s[e]}}}function polyfillGlobalThis(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const internals={debug:!!(globalThis&&supportsLocalStorage()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class LockAcquireTimeoutError extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError{}async function navigatorLock(s,e,i){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const o=new globalThis.AbortController;return e>0&&setTimeout(()=>{o.abort(),internals.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async a=>{if(a){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,a.name);try{return await i()}finally{internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,a.name)}}else{if(e===0)throw internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(internals.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await i()}}))}polyfillGlobalThis();const DEFAULT_OPTIONS={url:GOTRUE_URL,storageKey:STORAGE_KEY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DEFAULT_HEADERS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function lockNoOp(s,e,i){return await i()}const GLOBAL_JWKS={};class GoTrueClient{constructor(e){var i,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&isBrowser()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},DEFAULT_OPTIONS),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new GoTrueAdminApi({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=resolveFetch(a.fetch),this.lock=a.lock||lockNoOp,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:isBrowser()&&(!((i=globalThis==null?void 0:globalThis.navigator)===null||i===void 0)&&i.locks)?this.lock=navigatorLock:this.lock=lockNoOp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:supportsLocalStorage()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}get jwks(){var e,i;return(i=(e=GLOBAL_JWKS[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&i!==void 0?i:{keys:[]}}set jwks(e){GLOBAL_JWKS[this.storageKey]=Object.assign(Object.assign({},GLOBAL_JWKS[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,i;return(i=(e=GLOBAL_JWKS[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&i!==void 0?i:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){GLOBAL_JWKS[this.storageKey]=Object.assign(Object.assign({},GLOBAL_JWKS[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${version$1}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const i=parseParametersFromURL(window.location.href);let o="none";if(this._isImplicitGrantCallback(i)?o="implicit":await this._isPKCECallback(i)&&(o="pkce"),isBrowser()&&this.detectSessionInUrl&&o!=="none"){const{data:a,error:c}=await this._getSessionFromURL(i,o);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),isAuthImplicitGrantRedirectError(c)){const g=(e=c.details)===null||e===void 0?void 0:e.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:d,redirectType:h}=a;return this._debug("#_initialize()","detected session in URL",d,"redirect type",h),await this._saveSession(d),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(i){return isAuthError(i)?{error:i}:{error:new AuthUnknownError("Unexpected error during initialization",i)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var i,o,a;try{const c=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(o=(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:_sessionResponse}),{data:d,error:h}=c;if(h||!d)return{data:{user:null,session:null},error:h};const g=d.session,_=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:_,session:g},error:null}}catch(c){if(isAuthError(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(e){var i,o,a;try{let c;if("email"in e){const{email:j,password:b,options:$}=e;let et=null,_e=null;this.flowType==="pkce"&&([et,_e]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),c=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:$==null?void 0:$.emailRedirectTo,body:{email:j,password:b,data:(i=$==null?void 0:$.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:$==null?void 0:$.captchaToken},code_challenge:et,code_challenge_method:_e},xform:_sessionResponse})}else if("phone"in e){const{phone:j,password:b,options:$}=e;c=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:j,password:b,data:(o=$==null?void 0:$.data)!==null&&o!==void 0?o:{},channel:(a=$==null?void 0:$.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:$==null?void 0:$.captchaToken}},xform:_sessionResponse})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:d,error:h}=c;if(h||!d)return{data:{user:null,session:null},error:h};const g=d.session,_=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",g)),{data:{user:_,session:g},error:null}}catch(c){if(isAuthError(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(e){try{let i;if("email"in e){const{email:c,password:d,options:h}=e;i=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:_sessionResponsePassword})}else if("phone"in e){const{phone:c,password:d,options:h}=e;i=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:_sessionResponsePassword})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:o,error:a}=i;return a?{data:{user:null,session:null},error:a}:!o||!o.session||!o.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:a})}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithOAuth(e){var i,o,a,c;return await this._handleProviderSignIn(e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(c=e.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:i}=e;if(i==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${i}"`)}async signInWithSolana(e){var i,o,a,c,d,h,g,_,j,b,$,et;let _e,st;if("message"in e)_e=e.message,st=e.signature;else{const{chain:ot,wallet:tt,statement:nt,options:rt}=e;let it;if(isBrowser())if(typeof tt=="object")it=tt;else{const at=window;if("solana"in at&&typeof at.solana=="object"&&("signIn"in at.solana&&typeof at.solana.signIn=="function"||"signMessage"in at.solana&&typeof at.solana.signMessage=="function"))it=at.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof tt!="object"||!(rt!=null&&rt.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");it=tt}const lt=new URL((i=rt==null?void 0:rt.url)!==null&&i!==void 0?i:window.location.href);if("signIn"in it&&it.signIn){const at=await it.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},rt==null?void 0:rt.signInWithSolana),{version:"1",domain:lt.host,uri:lt.href}),nt?{statement:nt}:null));let ut;if(Array.isArray(at)&&at[0]&&typeof at[0]=="object")ut=at[0];else if(at&&typeof at=="object"&&"signedMessage"in at&&"signature"in at)ut=at;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ut&&"signature"in ut&&(typeof ut.signedMessage=="string"||ut.signedMessage instanceof Uint8Array)&&ut.signature instanceof Uint8Array)_e=typeof ut.signedMessage=="string"?ut.signedMessage:new TextDecoder().decode(ut.signedMessage),st=ut.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in it)||typeof it.signMessage!="function"||!("publicKey"in it)||typeof it!="object"||!it.publicKey||!("toBase58"in it.publicKey)||typeof it.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_e=[`${lt.host} wants you to sign in with your Solana account:`,it.publicKey.toBase58(),...nt?["",nt,""]:[""],"Version: 1",`URI: ${lt.href}`,`Issued At: ${(a=(o=rt==null?void 0:rt.signInWithSolana)===null||o===void 0?void 0:o.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((c=rt==null?void 0:rt.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${rt.signInWithSolana.notBefore}`]:[],...!((d=rt==null?void 0:rt.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${rt.signInWithSolana.expirationTime}`]:[],...!((h=rt==null?void 0:rt.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${rt.signInWithSolana.chainId}`]:[],...!((g=rt==null?void 0:rt.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${rt.signInWithSolana.nonce}`]:[],...!((_=rt==null?void 0:rt.signInWithSolana)===null||_===void 0)&&_.requestId?[`Request ID: ${rt.signInWithSolana.requestId}`]:[],...!((b=(j=rt==null?void 0:rt.signInWithSolana)===null||j===void 0?void 0:j.resources)===null||b===void 0)&&b.length?["Resources",...rt.signInWithSolana.resources.map(ut=>`- ${ut}`)]:[]].join(`
`);const at=await it.signMessage(new TextEncoder().encode(_e),"utf8");if(!at||!(at instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");st=at}}try{const{data:ot,error:tt}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_e,signature:bytesToBase64URL(st)},!(($=e.options)===null||$===void 0)&&$.captchaToken?{gotrue_meta_security:{captcha_token:(et=e.options)===null||et===void 0?void 0:et.captchaToken}}:null),xform:_sessionResponse});if(tt)throw tt;return!ot||!ot.session||!ot.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(ot.session&&(await this._saveSession(ot.session),await this._notifyAllSubscribers("SIGNED_IN",ot.session)),{data:Object.assign({},ot),error:tt})}catch(ot){if(isAuthError(ot))return{data:{user:null,session:null},error:ot};throw ot}}async _exchangeCodeForSession(e){const i=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`),[o,a]=(i??"").split("/");try{const{data:c,error:d}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:o},xform:_sessionResponse});if(await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),d)throw d;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new AuthInvalidTokenResponseError}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:a??null}),error:d})}catch(c){if(isAuthError(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(e){try{const{options:i,provider:o,token:a,access_token:c,nonce:d}=e,h=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:a,access_token:c,nonce:d,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:_sessionResponse}),{data:g,error:_}=h;return _?{data:{user:null,session:null},error:_}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:g,error:_})}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithOtp(e){var i,o,a,c,d;try{if("email"in e){const{email:h,options:g}=e;let _=null,j=null;this.flowType==="pkce"&&([_,j]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{error:b}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(i=g==null?void 0:g.data)!==null&&i!==void 0?i:{},create_user:(o=g==null?void 0:g.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:_,code_challenge_method:j},redirectTo:g==null?void 0:g.emailRedirectTo});return{data:{user:null,session:null},error:b}}if("phone"in e){const{phone:h,options:g}=e,{data:_,error:j}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(a=g==null?void 0:g.data)!==null&&a!==void 0?a:{},create_user:(c=g==null?void 0:g.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(d=g==null?void 0:g.channel)!==null&&d!==void 0?d:"sms"}});return{data:{user:null,session:null,messageId:_==null?void 0:_.message_id},error:j}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(h){if(isAuthError(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(e){var i,o;try{let a,c;"options"in e&&(a=(i=e.options)===null||i===void 0?void 0:i.redirectTo,c=(o=e.options)===null||o===void 0?void 0:o.captchaToken);const{data:d,error:h}=await _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:c}}),redirectTo:a,xform:_sessionResponse});if(h)throw h;if(!d)throw new Error("An error occurred on token verification.");const g=d.session,_=d.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),{data:{user:_,session:g},error:null}}catch(a){if(isAuthError(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var i,o,a;try{let c=null,d=null;return this.flowType==="pkce"&&([c,d]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),await _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(o=(i=e.options)===null||i===void 0?void 0:i.redirectTo)!==null&&o!==void 0?o:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:_ssoResponse})}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:i},error:o}=e;if(o)throw o;if(!i)throw new AuthSessionMissingError;const{error:a}=await _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:i.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(isAuthError(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const i=`${this.url}/resend`;if("email"in e){const{email:o,type:a,options:c}=e,{error:d}=await _request(this.fetch,"POST",i,{headers:this.headers,body:{email:o,type:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}else if("phone"in e){const{phone:o,type:a,options:c}=e,{data:d,error:h}=await _request(this.fetch,"POST",i,{headers:this.headers,body:{phone:o,type:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:h}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async i=>i))}async _acquireLock(e,i){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const o=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await o,await i()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const o=i();for(this.pendingInLock.push((async()=>{try{await o}catch{}})()),await o;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await o}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const i=await this.__loadSession();return await e(i)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const i=await getItemAsync(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",i),i!==null&&(this._isValidSession(i)?e=i:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const o=e.expires_at?e.expires_at*1e3-Date.now()<EXPIRY_MARGIN_MS:!1;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",e.expires_at),!o){if(this.userStorage){const d=await getItemAsync(this.userStorage,this.storageKey+"-user");d!=null&&d.user?e.user=d.user:e.user=userNotAvailableProxy()}if(this.storage.isServer&&e.user){let d=this.suppressGetSessionWarning;e=new Proxy(e,{get:(g,_,j)=>(!d&&_==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),d=!0,this.suppressGetSessionWarning=!0),Reflect.get(g,_,j))})}return{data:{session:e},error:null}}const{session:a,error:c}=await this._callRefreshToken(e.refresh_token);return c?{data:{session:null},error:c}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:_userResponse}):await this._useSession(async i=>{var o,a,c;const{data:d,error:h}=i;if(h)throw h;return!(!((o=d.session)===null||o===void 0)&&o.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new AuthSessionMissingError}:await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(a=d.session)===null||a===void 0?void 0:a.access_token)!==null&&c!==void 0?c:void 0,xform:_userResponse})})}catch(i){if(isAuthError(i))return isAuthSessionMissingError(i)&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:i};throw i}}async updateUser(e,i={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,i))}async _updateUser(e,i={}){try{return await this._useSession(async o=>{const{data:a,error:c}=o;if(c)throw c;if(!a.session)throw new AuthSessionMissingError;const d=a.session;let h=null,g=null;this.flowType==="pkce"&&e.email!=null&&([h,g]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{data:_,error:j}=await _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:i==null?void 0:i.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:h,code_challenge_method:g}),jwt:d.access_token,xform:_userResponse});if(j)throw j;return d.user=_.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),{data:{user:d.user},error:null}})}catch(o){if(isAuthError(o))return{data:{user:null},error:o};throw o}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new AuthSessionMissingError;const i=Date.now()/1e3;let o=i,a=!0,c=null;const{payload:d}=decodeJWT(e.access_token);if(d.exp&&(o=d.exp,a=o<=i),a){const{session:h,error:g}=await this._callRefreshToken(e.refresh_token);if(g)return{data:{user:null,session:null},error:g};if(!h)return{data:{user:null,session:null},error:null};c=h}else{const{data:h,error:g}=await this._getUser(e.access_token);if(g)throw g;c={access_token:e.access_token,refresh_token:e.refresh_token,user:h.user,token_type:"bearer",expires_in:o-i,expires_at:o},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(i){if(isAuthError(i))return{data:{session:null,user:null},error:i};throw i}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async i=>{var o;if(!e){const{data:d,error:h}=i;if(h)throw h;e=(o=d.session)!==null&&o!==void 0?o:void 0}if(!(e!=null&&e.refresh_token))throw new AuthSessionMissingError;const{session:a,error:c}=await this._callRefreshToken(e.refresh_token);return c?{data:{user:null,session:null},error:c}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}}async _getSessionFromURL(e,i){try{if(!isBrowser())throw new AuthImplicitGrantRedirectError("No browser detected.");if(e.error||e.error_description||e.error_code)throw new AuthImplicitGrantRedirectError(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(i){case"implicit":if(this.flowType==="pkce")throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.");break;default:}if(i==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data:nt,error:rt}=await this._exchangeCodeForSession(e.code);if(rt)throw rt;const it=new URL(window.location.href);return it.searchParams.delete("code"),window.history.replaceState(window.history.state,"",it.toString()),{data:{session:nt.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:a,access_token:c,refresh_token:d,expires_in:h,expires_at:g,token_type:_}=e;if(!c||!h||!d||!_)throw new AuthImplicitGrantRedirectError("No session defined in URL");const j=Math.round(Date.now()/1e3),b=parseInt(h);let $=j+b;g&&($=parseInt(g));const et=$-j;et*1e3<=AUTO_REFRESH_TICK_DURATION_MS&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${et}s, should have been closer to ${b}s`);const _e=$-b;j-_e>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_e,$,j):j-_e<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_e,$,j);const{data:st,error:ot}=await this._getUser(c);if(ot)throw ot;const tt={provider_token:o,provider_refresh_token:a,access_token:c,expires_in:b,expires_at:$,refresh_token:d,token_type:_,user:st.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:tt,redirectType:e.type},error:null}}catch(o){if(isAuthError(o))return{data:{session:null,redirectType:null},error:o};throw o}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const i=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&i)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async i=>{var o;const{data:a,error:c}=i;if(c)return{error:c};const d=(o=a.session)===null||o===void 0?void 0:o.access_token;if(d){const{error:h}=await this.admin.signOut(d,e);if(h&&!(isAuthApiError(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return e!=="others"&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const i=uuid(),o={id:i,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",i),this.stateChangeEmitters.delete(i)}};return this._debug("#onAuthStateChange()","registered callback with id",i),this.stateChangeEmitters.set(i,o),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(i)})))(),{data:{subscription:o}}}async _emitInitialSession(e){return await this._useSession(async i=>{var o,a;try{const{data:{session:c},error:d}=i;if(d)throw d;await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",e,"session",c)}catch(c){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",c),console.error(c)}})}async resetPasswordForEmail(e,i={}){let o=null,a=null;this.flowType==="pkce"&&([o,a]=await getCodeChallengeAndMethod(this.storage,this.storageKey,!0));try{return await _request(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:o,code_challenge_method:a,gotrue_meta_security:{captcha_token:i.captchaToken}},headers:this.headers,redirectTo:i.redirectTo})}catch(c){if(isAuthError(c))return{data:null,error:c};throw c}}async getUserIdentities(){var e;try{const{data:i,error:o}=await this.getUser();if(o)throw o;return{data:{identities:(e=i.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}}async linkIdentity(e){var i;try{const{data:o,error:a}=await this._useSession(async c=>{var d,h,g,_,j;const{data:b,error:$}=c;if($)throw $;const et=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(d=e.options)===null||d===void 0?void 0:d.redirectTo,scopes:(h=e.options)===null||h===void 0?void 0:h.scopes,queryParams:(g=e.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await _request(this.fetch,"GET",et,{headers:this.headers,jwt:(j=(_=b.session)===null||_===void 0?void 0:_.access_token)!==null&&j!==void 0?j:void 0})});if(a)throw a;return isBrowser()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(o==null?void 0:o.url),{data:{provider:e.provider,url:o==null?void 0:o.url},error:null}}catch(o){if(isAuthError(o))return{data:{provider:e.provider,url:null},error:o};throw o}}async unlinkIdentity(e){try{return await this._useSession(async i=>{var o,a;const{data:c,error:d}=i;if(d)throw d;return await _request(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(o=c.session)===null||o===void 0?void 0:o.access_token)!==null&&a!==void 0?a:void 0})})}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}}async _refreshAccessToken(e){const i=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{const o=Date.now();return await retryable(async a=>(a>0&&await sleep(200*Math.pow(2,a-1)),this._debug(i,"refreshing attempt",a),await _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:_sessionResponse})),(a,c)=>{const d=200*Math.pow(2,a);return c&&isAuthRetryableFetchError(c)&&Date.now()+d-o<AUTO_REFRESH_TICK_DURATION_MS})}catch(o){if(this._debug(i,"error",o),isAuthError(o))return{data:{session:null,user:null},error:o};throw o}finally{this._debug(i,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,i){const o=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:i.redirectTo,scopes:i.scopes,queryParams:i.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",i,"url",o),isBrowser()&&!i.skipBrowserRedirect&&window.location.assign(o),{data:{provider:e,url:o},error:null}}async _recoverAndRefresh(){var e,i;const o="#_recoverAndRefresh()";this._debug(o,"begin");try{const a=await getItemAsync(this.storage,this.storageKey);if(a&&this.userStorage){let d=await getItemAsync(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!d&&(d={user:a.user},await setItemAsync(this.userStorage,this.storageKey+"-user",d)),a.user=(e=d==null?void 0:d.user)!==null&&e!==void 0?e:userNotAvailableProxy()}else if(a&&!a.user&&!a.user){const d=await getItemAsync(this.storage,this.storageKey+"-user");d&&(d!=null&&d.user)?(a.user=d.user,await removeItemAsync(this.storage,this.storageKey+"-user"),await setItemAsync(this.storage,this.storageKey,a)):a.user=userNotAvailableProxy()}if(this._debug(o,"session from storage",a),!this._isValidSession(a)){this._debug(o,"session is not valid"),a!==null&&await this._removeSession();return}const c=((i=a.expires_at)!==null&&i!==void 0?i:1/0)*1e3-Date.now()<EXPIRY_MARGIN_MS;if(this._debug(o,`session has${c?"":" not"} expired with margin of ${EXPIRY_MARGIN_MS}s`),c){if(this.autoRefreshToken&&a.refresh_token){const{error:d}=await this._callRefreshToken(a.refresh_token);d&&(console.error(d),isAuthRetryableFetchError(d)||(this._debug(o,"refresh failed with a non-retryable error, removing the session",d),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:d,error:h}=await this._getUser(a.access_token);!h&&(d!=null&&d.user)?(a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(o,"could not get user data, skipping SIGNED_IN notification")}catch(d){console.error("Error getting user data:",d),this._debug(o,"error getting user data, skipping SIGNED_IN notification",d)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(o,"error",a),console.error(a);return}finally{this._debug(o,"end")}}async _callRefreshToken(e){var i,o;if(!e)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Deferred;const{data:c,error:d}=await this._refreshAccessToken(e);if(d)throw d;if(!c.session)throw new AuthSessionMissingError;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const h={session:c.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(c){if(this._debug(a,"error",c),isAuthError(c)){const d={session:null,error:c};return isAuthRetryableFetchError(c)||await this._removeSession(),(i=this.refreshingDeferred)===null||i===void 0||i.resolve(d),d}throw(o=this.refreshingDeferred)===null||o===void 0||o.reject(c),c}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,i,o=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",i,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:e,session:i});const c=[],d=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(e,i)}catch(g){c.push(g)}});if(await Promise.all(d),c.length>0){for(let h=0;h<c.length;h+=1)console.error(c[h]);throw c[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const i=Object.assign({},e),o=i.user&&i.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!o&&i.user&&await setItemAsync(this.userStorage,this.storageKey+"-user",{user:i.user});const a=Object.assign({},i);delete a.user;const c=deepClone(a);await setItemAsync(this.storage,this.storageKey,c)}else{const a=deepClone(i);await setItemAsync(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await removeItemAsync(this.storage,this.storageKey),await removeItemAsync(this.storage,this.storageKey+"-code-verifier"),await removeItemAsync(this.storage,this.storageKey+"-user"),this.userStorage&&await removeItemAsync(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&isBrowser()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(i){console.error("removing visibilitychange callback failed",i)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),AUTO_REFRESH_TICK_DURATION_MS);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async i=>{const{data:{session:o}}=i;if(!o||!o.refresh_token||!o.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((o.expires_at*1e3-e)/AUTO_REFRESH_TICK_DURATION_MS);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${AUTO_REFRESH_TICK_DURATION_MS}ms, refresh threshold is ${AUTO_REFRESH_TICK_THRESHOLD} ticks`),a<=AUTO_REFRESH_TICK_THRESHOLD&&await this._callRefreshToken(o.refresh_token)})}catch(i){console.error("Auto refresh tick failed with error. This is likely a transient error.",i)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof LockAcquireTimeoutError)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!isBrowser()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const i=`#_onVisibilityChanged(${e})`;this._debug(i,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(i,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,i,o){const a=[`provider=${encodeURIComponent(i)}`];if(o!=null&&o.redirectTo&&a.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),o!=null&&o.scopes&&a.push(`scopes=${encodeURIComponent(o.scopes)}`),this.flowType==="pkce"){const[c,d]=await getCodeChallengeAndMethod(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(d)}`});a.push(h.toString())}if(o!=null&&o.queryParams){const c=new URLSearchParams(o.queryParams);a.push(c.toString())}return o!=null&&o.skipBrowserRedirect&&a.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async i=>{var o;const{data:a,error:c}=i;return c?{data:null,error:c}:await _request(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(o=a==null?void 0:a.session)===null||o===void 0?void 0:o.access_token})})}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}}async _enroll(e){try{return await this._useSession(async i=>{var o,a;const{data:c,error:d}=i;if(d)return{data:null,error:d};const h=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:g,error:_}=await _request(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(o=c==null?void 0:c.session)===null||o===void 0?void 0:o.access_token});return _?{data:null,error:_}:(e.factorType==="totp"&&(!((a=g==null?void 0:g.totp)===null||a===void 0)&&a.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),{data:g,error:null})})}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async i=>{var o;const{data:a,error:c}=i;if(c)return{data:null,error:c};const{data:d,error:h}=await _request(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(o=a==null?void 0:a.session)===null||o===void 0?void 0:o.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:h})})}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async i=>{var o;const{data:a,error:c}=i;return c?{data:null,error:c}:await _request(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(o=a==null?void 0:a.session)===null||o===void 0?void 0:o.access_token})})}catch(i){if(isAuthError(i))return{data:null,error:i};throw i}})}async _challengeAndVerify(e){const{data:i,error:o}=await this._challenge({factorId:e.factorId});return o?{data:null,error:o}:await this._verify({factorId:e.factorId,challengeId:i.id,code:e.code})}async _listFactors(){const{data:{user:e},error:i}=await this.getUser();if(i)return{data:null,error:i};const o=(e==null?void 0:e.factors)||[],a=o.filter(d=>d.factor_type==="totp"&&d.status==="verified"),c=o.filter(d=>d.factor_type==="phone"&&d.status==="verified");return{data:{all:o,totp:a,phone:c},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var i,o;const{data:{session:a},error:c}=e;if(c)return{data:null,error:c};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=decodeJWT(a.access_token);let h=null;d.aal&&(h=d.aal);let g=h;((o=(i=a.user.factors)===null||i===void 0?void 0:i.filter(b=>b.status==="verified"))!==null&&o!==void 0?o:[]).length>0&&(g="aal2");const j=d.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:j},error:null}}))}async fetchJwk(e,i={keys:[]}){let o=i.keys.find(h=>h.kid===e);if(o)return o;const a=Date.now();if(o=this.jwks.keys.find(h=>h.kid===e),o&&this.jwks_cached_at+JWKS_TTL>a)return o;const{data:c,error:d}=await _request(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(d)throw d;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=a,o=c.keys.find(h=>h.kid===e),!o)?null:o}async getClaims(e,i={}){try{let o=e;if(!o){const{data:et,error:_e}=await this.getSession();if(_e||!et.session)return{data:null,error:_e};o=et.session.access_token}const{header:a,payload:c,signature:d,raw:{header:h,payload:g}}=decodeJWT(o);i!=null&&i.allowExpired||validateExp(c.exp);const _=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,i!=null&&i.keys?{keys:i.keys}:i==null?void 0:i.jwks);if(!_){const{error:et}=await this.getUser(o);if(et)throw et;return{data:{claims:c,header:a,signature:d},error:null}}const j=getAlgorithm(a.alg),b=await crypto.subtle.importKey("jwk",_,j,!0,["verify"]);if(!await crypto.subtle.verify(j,b,d,stringToUint8Array(`${h}.${g}`)))throw new AuthInvalidJwtError("Invalid JWT signature");return{data:{claims:c,header:a,signature:d},error:null}}catch(o){if(isAuthError(o))return{data:null,error:o};throw o}}}GoTrueClient.nextInstanceID=0;const AuthClient=GoTrueClient;class SupabaseAuthClient extends AuthClient{constructor(e){super(e)}}var __awaiter=function(s,e,i,o){function a(c){return c instanceof i?c:new i(function(d){d(c)})}return new(i||(i=Promise))(function(c,d){function h(j){try{_(o.next(j))}catch(b){d(b)}}function g(j){try{_(o.throw(j))}catch(b){d(b)}}function _(j){j.done?c(j.value):a(j.value).then(h,g)}_((o=o.apply(s,e||[])).next())})};class SupabaseClient{constructor(e,i,o){var a,c,d;if(this.supabaseUrl=e,this.supabaseKey=i,!e)throw new Error("supabaseUrl is required.");if(!i)throw new Error("supabaseKey is required.");const h=ensureTrailingSlash(e),g=new URL(h);this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const _=`sb-${g.hostname.split(".")[0]}-auth-token`,j={db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),{storageKey:_}),global:DEFAULT_GLOBAL_OPTIONS},b=applySettingDefaults(o??{},j);this.storageKey=(a=b.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(c=b.global.headers)!==null&&c!==void 0?c:{},b.accessToken?(this.accessToken=b.accessToken,this.auth=new Proxy({},{get:($,et)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(et)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=b.auth)!==null&&d!==void 0?d:{},this.headers,b.global.fetch),this.fetch=fetchWithAuth(i,this._getAccessToken.bind(this),b.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},b.realtime)),this.rest=new PostgrestClient(new URL("rest/v1",g).href,{headers:this.headers,schema:b.db.schema,fetch:this.fetch}),this.storage=new StorageClient(this.storageUrl.href,this.headers,this.fetch,o==null?void 0:o.storage),b.accessToken||this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,i={},o={}){return this.rest.rpc(e,i,o)}channel(e,i={config:{}}){return this.realtime.channel(e,i)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,i;return __awaiter(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:o}=yield this.auth.getSession();return(i=(e=o.session)===null||e===void 0?void 0:e.access_token)!==null&&i!==void 0?i:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:i,detectSessionInUrl:o,storage:a,storageKey:c,flowType:d,lock:h,debug:g},_,j){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),_),storageKey:c,autoRefreshToken:e,persistSession:i,detectSessionInUrl:o,storage:a,flowType:d,lock:h,debug:g,fetch:j,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((i,o)=>{this._handleTokenChanged(i,"CLIENT",o==null?void 0:o.access_token)})}_handleTokenChanged(e,i,o){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==o?this.changedAccessToken=o:e==="SIGNED_OUT"&&(this.realtime.setAuth(),i=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const createClient=(s,e,i)=>new SupabaseClient(s,e,i);function shouldShowDeprecationWarning(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const e=s.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}shouldShowDeprecationWarning()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const __vite_import_meta_env__={BASE_URL:"/",DEV:!1,MODE:"production",NODE_ENV:"production",PROD:!0,SSR:!1,SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxZGhlZ2N6d3djZm5yYW5reWRlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQwNTY2NDIsImV4cCI6MjA2OTYzMjY0Mn0.7BisAmVNNmsr-zdqrrJoILPnW0sQ6DfSfH0IEsjLoOI",SUPABASE_URL:"https://sqdhegczwwcfnrankyde.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0"},getEnvironmentVariable=s=>__vite_import_meta_env__[s],getSupabaseUrl=()=>getEnvironmentVariable("SUPABASE_URL"),getSupabaseAnonKey=()=>getEnvironmentVariable("SUPABASE_ANON_KEY");class SupabaseService{constructor(e){this.supabase=e}async callSupabaseFunction(e,i){const{method:o="GET",body:a,headers:c={},requiresAuth:d=!0}=i||{};try{let h={};if(d){const{data:$,error:et}=await this.supabase.auth.getSession();if(et)throw et;const _e=$.session;if(!(_e!=null&&_e.access_token))throw new Error("No valid authentication session found");h={Authorization:`Bearer ${_e.access_token}`}}const g={"Content-Type":"application/json",...h,...c},_=a&&o!=="GET"?a:void 0,{data:j,error:b}=await this.supabase.functions.invoke(e,{body:_,headers:g});if(b)throw b;return j}catch(h){if(h instanceof Error){if(h.message.includes("401")||h.message.includes("Unauthorized"))throw new Error("Authentication failed. Please log in again.");if(h.message.includes("403")||h.message.includes("Forbidden"))throw new Error("Access denied. Insufficient permissions.");if(h.message.includes("404")||h.message.includes("Not Found"))throw new Error("API endpoint not found.");if(h.message.includes("500")||h.message.includes("Internal Server Error"))throw new Error("Server error. Please try again later.")}throw h}}getSupabaseClient(){return this.supabase}handleSingleQuery(e){if(e.error)throw e.error.code==="PGRST116"?new Error("Record not found"):e.error;return e.data}async performCrudOperation(e,i,o,a){let c=this.supabase.from(i);switch(e){case"insert":{const d=await c.insert(a).select().single();return this.handleSingleQuery(d)}case"update":{const d=await c.update(a).eq("id",o).select().single();return this.handleSingleQuery(d)}case"delete":{const d=await c.delete().eq("id",o);this.handleSingleQuery(d);return}}}async executeQuery(e){const i=await e();return this.handleSingleQuery(i)}applyGlobalFilter(e,i,o=[]){if(i&&o.length>0){const a=o.map(c=>`${c}.ilike.%${i}%`).join(",");return e.or(a)}return e}applySorting(e,i){if(i&&i.length>0){const o=i[0];if(o)return e.order(o.id,{ascending:!o.desc})}return e}applyPagination(e,i){if(i){const o=i.pageIndex*i.pageSize,a=o+i.pageSize-1;return e.range(o,a)}return e}applyUserFilter(e,i,o,a="assigned_to"){return i&&o?e.eq(a,o):e}async getCurrentUser(){const{data:e,error:i}=await this.supabase.auth.getUser();if(i)throw i;return e}async queryFromTable(e,i){const{filterByUser:o=!1,userId:a=null,userColumn:c="assigned_to",additionalFilters:d={},globalFilter:h="",globalFilterColumns:g=[],sorting:_=[],pagination:j,select:b="*"}=i;let $=this.supabase.from(e).select(b,{count:"exact"});$=this.applyUserFilter($,o,a,c),$=this.applyGlobalFilter($,h,g),$=this.applySorting($,_),$=this.applyPagination($,j),d&&Object.entries(d).forEach(([ot,tt])=>{tt!=null&&(Array.isArray(tt)?$=$.in(ot,tt):$=$.eq(ot,tt))});const{data:et,error:_e,count:st}=await $;if(_e)throw _e;return{data:et||[],count:st||0}}async getRecordById(e,i,o){try{return await this.executeQuery(()=>this.supabase.from(e).select(o||"*").eq("id",i).single())}catch(a){throw a instanceof Error&&a.message==="Record not found"?new Error(`${e} record not found`):a}}async recordExists(e,i){try{return await this.getRecordById(e,i),!0}catch{return!1}}async updateRecord(e,i,o){await this.performCrudOperation("update",e,i,o)}async createRecord(e,i){return this.performCrudOperation("insert",e,void 0,i)}async deleteRecord(e,i){await this.performCrudOperation("delete",e,i)}async queryRecordsWithFilter(e,i,o){let a=this.supabase.from(e).select((o==null?void 0:o.select)||"*");Object.entries(i).forEach(([d,h])=>{h!=null&&(typeof h=="object"&&h!==null?"lt"in h?a=a.lt(d,h.lt):"gte"in h?a=a.gte(d,h.gte):"not"in h&&"in"in h.not?a=a.not(d,"in",h.not.in):a=a.eq(d,h):a=a.eq(d,h))}),a=this.applySorting(a,o==null?void 0:o.sorting),a=this.applyPagination(a,o==null?void 0:o.pagination);const c=await a;if(c.error)throw c.error;return c.data||[]}}const supabaseUrl=getSupabaseUrl(),supabaseAnonKey=getSupabaseAnonKey(),supabase=createClient(supabaseUrl,supabaseAnonKey),supabaseService=new SupabaseService(supabase);typeof window<"u"&&(window.supabase=supabase);const signInWithGoogle=async()=>{try{const s=`${window.location.origin}/auth/callback`,{error:e}=await supabase.auth.signInWithOAuth({provider:"google",options:{redirectTo:s}});if(e)throw e}catch(s){throw console.error("Error signing in with Google:",s),s}},signOut=async()=>{try{const{error:s}=await supabase.auth.signOut();if(s)throw s}catch(s){throw console.error("Error signing out:",s),s}},getAccessToken=async()=>{try{const{data:{session:s}}=await supabase.auth.getSession();return(s==null?void 0:s.access_token)??null}catch(s){return console.error("Error getting access token:",s),null}},getUserRole=async s=>{try{const{data:e,error:i}=await supabaseService.getSupabaseClient().from("roles").select("role").eq("user_id",s);if(i)return console.error("Role check error:",i),"unassigned";const o=(e??[]).map(a=>a.role);return o.includes("admin")?"admin":o.includes("cleaner")?"cleaner":"unassigned"}catch(e){return console.error("Error getting user role:",e),"unassigned"}},AuthContext=reactExports.createContext(void 0),useAuth=()=>{const s=reactExports.useContext(AuthContext);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s},AuthProvider=({children:s})=>{var g;const[e,i]=reactExports.useState(!0),[o,a]=reactExports.useState(null),[c,d]=reactExports.useState("unassigned");reactExports.useEffect(()=>{supabase.auth.getSession().then(({data:{session:_}})=>{a(_??null),i(!1)}).catch(_=>{console.error("Error fetching initial session:",_),i(!1)})},[]),reactExports.useEffect(()=>{const{data:{subscription:_}}=supabase.auth.onAuthStateChange((j,b)=>{if(j==="SIGNED_OUT"){a(null),d("unassigned"),i(!1);return}(j==="INITIAL_SESSION"||j==="SIGNED_IN"||j==="USER_UPDATED"||j==="TOKEN_REFRESHED")&&(a(b??null),i(!1))});return()=>_.unsubscribe()},[]),reactExports.useEffect(()=>{var b;const _=(b=o==null?void 0:o.user)==null?void 0:b.id;if(!_){d("unassigned");return}let j=!1;return(async()=>{const $=await getUserRole(_);j||d($)})(),()=>{j=!0}},[(g=o==null?void 0:o.user)==null?void 0:g.id]);const h={user:(o==null?void 0:o.user)??null,loading:e,role:c,isAdmin:c==="admin",isCleaner:c==="cleaner",signInWithGoogle,signOut,getAccessToken,supabaseService};return jsxRuntimeExports.jsx(AuthContext.Provider,{value:h,children:s})},warn=(s,e,i,o)=>{var c,d,h,g;const a=[i,{code:e,...o||{}}];if((d=(c=s==null?void 0:s.services)==null?void 0:c.logger)!=null&&d.forward)return s.services.logger.forward(a,"warn","react-i18next::",!0);isString$1(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),(g=(h=s==null?void 0:s.services)==null?void 0:h.logger)!=null&&g.warn?s.services.logger.warn(...a):console!=null&&console.warn&&console.warn(...a)},alreadyWarned={},warnOnce=(s,e,i,o)=>{isString$1(i)&&alreadyWarned[i]||(isString$1(i)&&(alreadyWarned[i]=new Date),warn(s,e,i,o))},loadedClb=(s,e)=>()=>{if(s.isInitialized)e();else{const i=()=>{setTimeout(()=>{s.off("initialized",i)},0),e()};s.on("initialized",i)}},loadNamespaces=(s,e,i)=>{s.loadNamespaces(e,loadedClb(s,i))},loadLanguages=(s,e,i,o)=>{if(isString$1(i)&&(i=[i]),s.options.preload&&s.options.preload.indexOf(e)>-1)return loadNamespaces(s,i,o);i.forEach(a=>{s.options.ns.indexOf(a)<0&&s.options.ns.push(a)}),s.loadLanguages(e,loadedClb(s,o))},hasLoadedNamespace=(s,e,i={})=>!e.languages||!e.languages.length?(warnOnce(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(s,{lng:i.lng,precheck:(o,a)=>{if(i.bindI18n&&i.bindI18n.indexOf("languageChanging")>-1&&o.services.backendConnector.backend&&o.isLanguageChangingTo&&!a(o.isLanguageChangingTo,s))return!1}}),isString$1=s=>typeof s=="string",isObject=s=>typeof s=="object"&&s!==null,matchHtmlEntity=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,htmlEntities={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},unescapeHtmlEntity=s=>htmlEntities[s],unescape=s=>s.replace(matchHtmlEntity,unescapeHtmlEntity);let defaultOptions={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape};const setDefaults=(s={})=>{defaultOptions={...defaultOptions,...s}},getDefaults$1=()=>defaultOptions;let i18nInstance;const setI18n=s=>{i18nInstance=s},getI18n=()=>i18nInstance,initReactI18next={type:"3rdParty",init(s){setDefaults(s.options.react),setI18n(s)}},I18nContext=reactExports.createContext();class ReportNamespaces{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(i=>{this.usedNamespaces[i]||(this.usedNamespaces[i]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const usePrevious=(s,e)=>{const i=reactExports.useRef();return reactExports.useEffect(()=>{i.current=s},[s,e]),i.current},alwaysNewT=(s,e,i,o)=>s.getFixedT(e,i,o),useMemoizedT=(s,e,i,o)=>reactExports.useCallback(alwaysNewT(s,e,i,o),[s,e,i,o]),useTranslation=(s,e={})=>{var it,lt,at,ut;const{i18n:i}=e,{i18n:o,defaultNS:a}=reactExports.useContext(I18nContext)||{},c=i||o||getI18n();if(c&&!c.reportNamespaces&&(c.reportNamespaces=new ReportNamespaces),!c){warnOnce(c,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const ct=(dt,pt)=>isString$1(pt)?pt:isObject(pt)&&isString$1(pt.defaultValue)?pt.defaultValue:Array.isArray(dt)?dt[dt.length-1]:dt,ht=[ct,{},!1];return ht.t=ct,ht.i18n={},ht.ready=!1,ht}(it=c.options.react)!=null&&it.wait&&warnOnce(c,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const d={...getDefaults$1(),...c.options.react,...e},{useSuspense:h,keyPrefix:g}=d;let _=a||((lt=c.options)==null?void 0:lt.defaultNS);_=isString$1(_)?[_]:_||["translation"],(ut=(at=c.reportNamespaces).addUsedNamespaces)==null||ut.call(at,_);const j=(c.isInitialized||c.initializedStoreOnce)&&_.every(ct=>hasLoadedNamespace(ct,c,d)),b=useMemoizedT(c,e.lng||null,d.nsMode==="fallback"?_:_[0],g),$=()=>b,et=()=>alwaysNewT(c,e.lng||null,d.nsMode==="fallback"?_:_[0],g),[_e,st]=reactExports.useState($);let ot=_.join();e.lng&&(ot=`${e.lng}${ot}`);const tt=usePrevious(ot),nt=reactExports.useRef(!0);reactExports.useEffect(()=>{const{bindI18n:ct,bindI18nStore:ht}=d;nt.current=!0,!j&&!h&&(e.lng?loadLanguages(c,e.lng,_,()=>{nt.current&&st(et)}):loadNamespaces(c,_,()=>{nt.current&&st(et)})),j&&tt&&tt!==ot&&nt.current&&st(et);const dt=()=>{nt.current&&st(et)};return ct&&(c==null||c.on(ct,dt)),ht&&(c==null||c.store.on(ht,dt)),()=>{nt.current=!1,c&&ct&&(ct==null||ct.split(" ").forEach(pt=>c.off(pt,dt))),ht&&c&&ht.split(" ").forEach(pt=>c.store.off(pt,dt))}},[c,ot]),reactExports.useEffect(()=>{nt.current&&j&&st($)},[c,g,j]);const rt=[_e,c,j];if(rt.t=_e,rt.i18n=c,rt.ready=j,j||!j&&!h)return rt;throw new Promise(ct=>{e.lng?loadLanguages(c,e.lng,_,()=>ct()):loadNamespaces(c,_,()=>ct())})},LanguageContext=reactExports.createContext(void 0),LanguageProvider=({children:s})=>{const{i18n:e}=useTranslation(),[i,o]=reactExports.useState(e.language);reactExports.useEffect(()=>{o(e.language)},[e.language]);const c={currentLanguage:i,changeLanguage:d=>{e.changeLanguage(d),o(d)}};return jsxRuntimeExports.jsx(LanguageContext.Provider,{value:c,children:s})},useLanguage=()=>{const s=reactExports.useContext(LanguageContext);if(!s)throw new Error("useLanguage must be used within a LanguageProvider");return s},Login=()=>{const{signInWithGoogle:s,loading:e}=useAuth(),{t:i}=useTranslation(),o=async()=>{try{await s()}catch(a){console.error("Sign in error:",a)}};return jsxRuntimeExports.jsx("div",{className:"auth-container",children:jsxRuntimeExports.jsxs("div",{className:"auth-card",children:[jsxRuntimeExports.jsx("h1",{className:"auth-title",children:i("auth.welcome")}),jsxRuntimeExports.jsx("p",{className:"auth-description",children:i("auth.signInDescription")}),jsxRuntimeExports.jsx("button",{onClick:o,disabled:e,className:"google-signin-btn",children:e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner",style:{width:"20px",height:"20px",margin:0}}),i("auth.signingIn")]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[jsxRuntimeExports.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),jsxRuntimeExports.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),jsxRuntimeExports.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),jsxRuntimeExports.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),i("auth.signInWithGoogle")]})})]})})},ProtectedRoute=({children:s})=>{console.log("ProtectedRoute rendering...");const{user:e,loading:i}=useAuth(),{t:o}=useTranslation();return console.log("ProtectedRoute state:",{user:e,loading:i}),i?(console.log("ProtectedRoute: showing loading state"),jsxRuntimeExports.jsx("div",{className:"auth-container",children:jsxRuntimeExports.jsx("div",{className:"auth-card",children:jsxRuntimeExports.jsxs("div",{className:"loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),o("common.loading")]})})})):e?(console.log("ProtectedRoute: showing protected content"),s):(console.log("ProtectedRoute: showing login component"),jsxRuntimeExports.jsx(Login,{}))},AdminRoute=({children:s})=>{const{user:e,loading:i,isAdmin:o}=useAuth(),{t:a}=useTranslation();return i?jsxRuntimeExports.jsx("div",{className:"auth-container",children:jsxRuntimeExports.jsx("div",{className:"auth-card",children:jsxRuntimeExports.jsxs("div",{className:"loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),a("admin.checkingAccess")]})})}):e?o?s:jsxRuntimeExports.jsx("div",{className:"auth-container",children:jsxRuntimeExports.jsx("div",{className:"auth-card",children:jsxRuntimeExports.jsxs("div",{className:"access-denied",children:[jsxRuntimeExports.jsx("div",{className:"access-denied-icon",children:""}),jsxRuntimeExports.jsx("h2",{className:"access-denied-title",children:a("admin.adminAccessRequired")}),jsxRuntimeExports.jsx("p",{className:"access-denied-description",children:a("admin.noAdminPrivileges")})]})})}):jsxRuntimeExports.jsx("div",{className:"auth-container",children:jsxRuntimeExports.jsx("div",{className:"auth-card",children:jsxRuntimeExports.jsxs("div",{className:"access-denied",children:[jsxRuntimeExports.jsx("div",{className:"access-denied-icon",children:""}),jsxRuntimeExports.jsx("h2",{className:"access-denied-title",children:a("admin.authenticationRequired")}),jsxRuntimeExports.jsx("p",{className:"access-denied-description",children:a("admin.signInToAccess")})]})})})},TODO_VALID_ATTACHMENT_TYPES=["listing","task"],TASK_STATUSES=["unassigned","assigned","accepted","in_progress","completed","admin_accepted","cancelled"],VALID_STATUS_TRANSITIONS={unassigned:["assigned"],assigned:["accepted","in_progress","unassigned"],accepted:["assigned","in_progress"],in_progress:["completed","assigned"],completed:["admin_accepted"],admin_accepted:[],cancelled:["assigned"]},NOTE_VALID_ATTACHMENT_TYPES=["listing","task"];class TodoService{constructor(e,i){this.supabaseService=e,this.role=i}async fetchTodos(e={}){const i=this.role==="cleaner"?"id, title, description, products, done, completed_at, completed_by, created_at, updated_at, attached_to_type, attached_to_id":"*",o={};return e.attachedToType!==void 0&&(o.attached_to_type=e.attachedToType),e.attachedToId!==void 0&&(o.attached_to_id=e.attachedToId),e.isDone!==void 0&&(o.done=e.isDone),(await this.supabaseService.queryFromTable("todos",{select:i,additionalFilters:o,globalFilter:e.titlePattern||"",globalFilterColumns:["title"]})).data}async fetchTodosWithUserInfo(e={}){const i=await this.fetchTodos(e);return i.length>0&&this.role==="admin"?this.enrichTodosWithUserInfo(i):i}async updateTodoStatus(e,i,o){if(!await this.supabaseService.getRecordById("todos",e))throw new Error(`Todo with ID ${e} not found`);const c={done:i,updated_at:new Date().toISOString(),completed_at:i?new Date().toISOString():null,completed_by:i&&o||null};await this.supabaseService.updateRecord("todos",e,c)}async createTodo(e){return this.validateTodoData(e),this.supabaseService.createRecord("todos",e)}async updateTodo(e,i){return this.validateTodoUpdate(i),await this.supabaseService.updateRecord("todos",e,i),this.supabaseService.getRecordById("todos",e)}async deleteTodo(e){await this.supabaseService.deleteRecord("todos",e)}validateTodoData(e){const i=[];if((!e.title||typeof e.title!="string"||e.title.trim().length===0)&&i.push("Title is required and cannot be empty"),e.title&&e.title.length>255&&i.push("Title cannot exceed 255 characters"),e.description!==void 0&&e.description!==null&&(typeof e.description!="string"?i.push("Description must be a string"):e.description.length>1e3&&i.push("Description cannot exceed 1000 characters")),e.attached_to_type!==void 0&&e.attached_to_type!==null&&(TODO_VALID_ATTACHMENT_TYPES.includes(e.attached_to_type)||i.push(`Invalid attachment type: ${e.attached_to_type}`)),e.attached_to_type&&!e.attached_to_id&&i.push("Attachment ID is required when attachment type is specified"),!e.attached_to_type&&e.attached_to_id&&i.push("Attachment type is required when attachment ID is specified"),e.products!==void 0&&e.products!==null&&(Array.isArray(e.products)?e.products.forEach((o,a)=>{(!o.product_name||typeof o.product_name!="string")&&i.push(`Product ${a+1}: product_name is required and must be a string`),(typeof o.quantity!="number"||o.quantity<=0)&&i.push(`Product ${a+1}: quantity must be a positive number`)}):i.push("Products must be an array")),i.length>0)throw new Error(`Todo validation failed: ${i.join(", ")}`)}validateTodoUpdate(e){const i=[];if(e.title!==void 0&&((typeof e.title!="string"||e.title.trim().length===0)&&i.push("Title cannot be empty"),e.title.length>255&&i.push("Title cannot exceed 255 characters")),e.description!==void 0&&e.description!==null&&(typeof e.description!="string"?i.push("Description must be a string"):e.description.length>1e3&&i.push("Description cannot exceed 1000 characters")),e.attached_to_type!==void 0&&e.attached_to_type!==null&&(TODO_VALID_ATTACHMENT_TYPES.includes(e.attached_to_type)||i.push(`Invalid attachment type: ${e.attached_to_type}`)),e.attached_to_type&&!e.attached_to_id&&i.push("Attachment ID is required when attachment type is specified"),!e.attached_to_type&&e.attached_to_id&&i.push("Attachment type is required when attachment ID is specified"),e.products!==void 0&&e.products!==null&&(Array.isArray(e.products)?e.products.forEach((o,a)=>{(!o.product_name||typeof o.product_name!="string")&&i.push(`Product ${a+1}: product_name is required and must be a string`),(typeof o.quantity!="number"||o.quantity<=0)&&i.push(`Product ${a+1}: quantity must be a positive number`)}):i.push("Products must be an array")),e.completed_at!==void 0&&e.completed_at!==null&&(typeof e.completed_at!="string"&&i.push("Completed at must be a string"),isNaN(Date.parse(e.completed_at))&&i.push("Completed at must be a valid ISO date string")),i.length>0)throw new Error(`Todo update validation failed: ${i.join(", ")}`)}async enrichTodosWithUserInfo(e){const i=[...new Set(e.map(c=>[c.created_by,c.completed_by]).flat().filter(Boolean))];if(i.length===0)return e;const o=await this.supabaseService.queryFromTable("user_profiles",{select:"id, email, name",additionalFilters:{id:i}}),a=new Map(o.data.map(c=>[c.id,c]));return e.map(c=>{const d=c,h=a.get(c.created_by);return h&&(h.email!==null&&(d.user_email=h.email),h.name!==null&&(d.user_name=h.name)),d})}async getTodosByAttachment(e,i){return this.fetchTodos({attachedToType:e,attachedToId:i})}async getCompletedTodos(e={}){return this.fetchTodos({...e,isDone:!0})}async getPendingTodos(e={}){return this.fetchTodos({...e,isDone:!1})}async searchTodosByTitle(e,i={}){return this.fetchTodos({...i,titlePattern:e})}}class TaskService{constructor(e,i){this.supabaseService=e,this.auditService=i}validateTaskUpdate(e){const i=[],o=e.status;o!==void 0&&(typeof o!="string"||!TASK_STATUSES.includes(o))&&i.push(`Invalid status: ${String(o)}`),["started_at","finished_at","accepted_at","completed_at","assigned_at","admin_accepted_at","scheduled_datetime"].forEach(h=>{const g=e[h];if(g!=null)if(typeof g=="string"||typeof g=="number"||g instanceof Date){const _=new Date(g);isNaN(_.getTime())&&i.push(`Invalid date format for ${h}: ${String(g)}`)}else i.push(`Invalid date type for ${h}: ${typeof g}`)});const c=["assigned_to","assigned_by"],d=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;if(c.forEach(h=>{const g=e[h];g!=null&&(typeof g=="string"?d.test(g)||i.push(`Invalid UUID format for ${h}: ${g}`):i.push(`Invalid ID type for ${h}: ${typeof g}`))}),i.length>0)throw new Error(`Validation errors: ${i.join(", ")}`)}validateStatusTransition(e,i){var o;if(!((o=VALID_STATUS_TRANSITIONS[e])!=null&&o.includes(i)))throw new Error(`Invalid status transition from ${e} to ${i}`)}async getTask(e){try{return await this.supabaseService.getRecordById("tasks",e)}catch(i){throw console.error("Error fetching task:",i),i}}async updateTaskField(e,i,o,a={}){const c={[i]:o};try{this.validateTaskUpdate(c)}catch(d){throw new Error(`Invalid update: ${d instanceof Error?d.message:String(d)}`)}try{return await this.supabaseService.updateRecord("tasks",e,c),{success:!0}}catch(d){throw console.error(`Error updating task ${i}:`,d),d}}async updateTaskFields(e,i){try{this.validateTaskUpdate(i)}catch(o){throw new Error(`Invalid updates: ${o instanceof Error?o.message:String(o)}`)}try{return await this.supabaseService.updateRecord("tasks",e,i),{success:!0}}catch(o){throw console.error("Error updating task fields:",o),o}}async updateTaskStatus(e,i,o={}){if(i==="admin_accepted")throw new Error("Direct status update to admin_accepted is not allowed. Use the finalize task endpoint instead.");const a={status:i,...o};switch(i){case"accepted":a.accepted_at=new Date().toISOString();break;case"completed":a.completed_at=new Date().toISOString();break;case"assigned":o.clearAccepted&&(a.accepted_at=null);break}return this.updateTaskFields(e,a)}async updateTaskTimes(e,{started_at:i,finished_at:o}){const a={};if(i!==void 0&&(a.started_at=i),o!==void 0&&(a.finished_at=o),i&&o&&new Date(o)<=new Date(i))throw new Error("Finish time must be after start time");return this.updateTaskFields(e,a)}async updateTaskAssignment(e,i,o=null){const a={assigned_to:i,assigned_at:i?new Date().toISOString():null};return o&&(a.assigned_by=o),this.updateTaskFields(e,a)}async queryTasks(e={}){const{pagination:i={pageIndex:0,pageSize:10},sorting:o=[{id:"scheduled_datetime",desc:!1}],globalFilter:a="",additionalFilters:c={}}=e;try{const d=await this.supabaseService.queryFromTable("tasks",{userId:e.userId||null,userColumn:"assigned_to",additionalFilters:c,globalFilter:a,globalFilterColumns:["title","description","task_type","status"],sorting:o,pagination:i});return{tasks:d.data,totalCount:d.count}}catch(d){throw console.error("Error querying tasks:",d),d}}async createTask(e){try{this.validateTaskUpdate(e)}catch(i){throw new Error(`Invalid task data: ${i instanceof Error?i.message:String(i)}`)}try{return await this.supabaseService.createRecord("tasks",e)}catch(i){throw console.error("Error creating task:",i),i}}async finalizeTask(e){try{return await this.supabaseService.callSupabaseFunction("finalize-task",{method:"POST",body:{task_id:e}}),{success:!0}}catch(i){throw console.error("Error finalizing task:",i),i}}async deleteTask(e){try{return await this.supabaseService.deleteRecord("tasks",e),{success:!0}}catch(i){throw console.error("Error deleting task:",i),i}}async getTasksCountByStatus(e){try{let i=this.supabaseService.getSupabaseClient().from("tasks").select("status");e&&(i=i.eq("assigned_to",e));const{data:o,error:a}=await i;if(a)throw a;const c={};return TASK_STATUSES.forEach(d=>{c[d]=0}),o==null||o.forEach(d=>{const h=d.status;Object.prototype.hasOwnProperty.call(c,h)&&TASK_STATUSES.includes(h)&&(c[h]=(c[h]||0)+1)}),c}catch(i){throw console.error("Error getting task counts:",i),i}}async getOverdueTasks(e){try{let i=this.supabaseService.getSupabaseClient().from("tasks").select("*");i=i.lt("scheduled_datetime",new Date().toISOString()),i=i.neq("status","completed").neq("status","admin_accepted").neq("status","cancelled"),e&&(i=i.eq("assigned_to",e));const{data:o,error:a}=await i;if(a)throw a;return o||[]}catch(i){throw console.error("Error getting overdue tasks:",i),i}}async getUpcomingTasks(e){try{const i=new Date,o=new Date(i.getTime()+24*60*60*1e3);let a=this.supabaseService.getSupabaseClient().from("tasks").select("*");a=a.gte("scheduled_datetime",i.toISOString()),a=a.lt("scheduled_datetime",o.toISOString()),a=a.neq("status","completed").neq("status","admin_accepted").neq("status","cancelled"),e&&(a=a.eq("assigned_to",e));const{data:c,error:d}=await a;if(d)throw d;return c||[]}catch(i){throw console.error("Error getting upcoming tasks:",i),i}}async getTaskAuditTrail(e){try{return await this.auditService.getAuditLog("tasks",e)}catch(i){throw console.error("Error fetching task audit trail:",i),i}}}class NoteService{constructor(e,i){this.supabaseService=e,this.role=i}async fetchNotes(e){if(e.attachedToType&&!NOTE_VALID_ATTACHMENT_TYPES.includes(e.attachedToType))throw new Error(`Invalid attachment type: ${e.attachedToType}`);if(e.attachedToType&&!e.attachedToId)throw new Error("attachedToId is required when attachedToType is specified");const o={select:this.role==="cleaner"?"id, content, created_at, attached_to_type, attached_to_id":"id, content, created_by, created_at, attached_to_type, attached_to_id",sorting:[{id:"created_at",desc:!1}]};e.attachedToType&&e.attachedToId&&(o.additionalFilters={attached_to_type:e.attachedToType,attached_to_id:e.attachedToId});const c=(await this.supabaseService.queryFromTable("notes",o)).data;return c.length>0&&this.role==="admin"?this.enrichNotesWithUserInfo(c):c}async createNote(e){return this.validateNoteData(e),await this.supabaseService.createRecord("notes",e)}async deleteNote(e){if(!e)throw new Error("Note ID is required for deletion");await this.supabaseService.deleteRecord("notes",e)}async getNotesByAttachment(e,i){return this.fetchNotes({attachedToType:e,attachedToId:i})}validateNoteData(e){const i=[];if((!e.content||e.content.trim().length===0)&&i.push("Note content is required"),e.content&&e.content.trim().length>1e4&&i.push("Note content cannot exceed 10,000 characters"),e.attached_to_type&&!NOTE_VALID_ATTACHMENT_TYPES.includes(e.attached_to_type)&&i.push(`Invalid attachment type: ${e.attached_to_type}`),e.attached_to_type&&!e.attached_to_id&&i.push("attached_to_id is required when attached_to_type is specified"),e.attached_to_id&&!e.attached_to_type&&i.push("attached_to_type is required when attached_to_id is specified"),i.length>0)throw new Error(`Note validation failed: ${i.join(", ")}`)}async enrichNotesWithUserInfo(e){const i=[...new Set(e.map(d=>d.created_by).filter(Boolean))];if(i.length===0)return e;const{data:o,error:a}=await this.supabaseService.getSupabaseClient().from("user_profiles").select("id, email, name").in("id",i);if(a)throw a;const c=new Map(o.map(d=>[d.id,d]));return e.map(d=>{const h=d,g=c.get(d.created_by);return g&&(g.email!==null&&(h.user_email=g.email),g.name!==null&&(h.user_name=g.name)),h})}}class ReservationService{constructor(e){this.supabaseService=e}async getReservations(e={}){const{filters:i={},sorting:o=[{id:"check_in",desc:!0}],pagination:a={pageIndex:0,pageSize:10}}=e;let c=this.supabaseService.getSupabaseClient().from("reservations").select("*",{count:"exact"});if(i.status&&(c=c.eq("status",i.status)),i.listingId&&(c=c.eq("listing_id",i.listingId)),i.dateRange&&(i.dateRange.checkInFrom&&(c=c.gte("check_in",i.dateRange.checkInFrom)),i.dateRange.checkInTo&&(c=c.lte("check_in",i.dateRange.checkInTo)),i.dateRange.checkOutFrom&&(c=c.gte("check_out",i.dateRange.checkOutFrom)),i.dateRange.checkOutTo&&(c=c.lte("check_out",i.dateRange.checkOutTo))),i.globalFilter&&(c=c.or(`guest_name.ilike.%${i.globalFilter}%,listing_id.ilike.%${i.globalFilter}%,status.ilike.%${i.globalFilter}%`)),o&&o.length>0){const b=o[0];b&&(c=c.order(b.id,{ascending:!b.desc}))}const d=a.pageIndex*a.pageSize,h=d+a.pageSize-1;c=c.range(d,h);const{data:g,error:_,count:j}=await c;if(_)throw _;return{data:g||[],count:j||0}}async getReservationById(e){if(!e)throw new Error("Reservation ID is required");return this.supabaseService.getRecordById("reservations",e)}async createReservation(e){return this.validateReservationData(e),await this.supabaseService.createRecord("reservations",e)}async updateReservation(e,i){if(!e)throw new Error("Reservation ID is required for updates");this.validateReservationUpdate(i),await this.supabaseService.updateRecord("reservations",e,i)}async deleteReservation(e){if(!e)throw new Error("Reservation ID is required for deletion");await this.supabaseService.deleteRecord("reservations",e)}async getReservationsByListing(e){return(await this.supabaseService.queryFromTable("reservations",{additionalFilters:{listing_id:e},sorting:[{id:"check_in",desc:!0}]})).data}async getReservationsByStatus(e){return(await this.supabaseService.queryFromTable("reservations",{additionalFilters:{status:e},sorting:[{id:"check_in",desc:!0}]})).data}async getUpcomingReservations(){const e=new Date().toISOString().split("T")[0];return this.supabaseService.executeQuery(()=>this.supabaseService.getSupabaseClient().from("reservations").select("*").gte("check_in",e).order("check_in",{ascending:!0}))}validateReservationData(e){const i=[];if((!e.id||e.id.trim().length===0)&&i.push("Reservation ID is required"),(!e.guest_name||e.guest_name.trim().length===0)&&i.push("Guest name is required"),e.guest_name&&e.guest_name.trim().length>255&&i.push("Guest name cannot exceed 255 characters"),e.check_in&&e.check_out){const a=new Date(e.check_in);new Date(e.check_out)<=a&&i.push("Check-out date must be after check-in date")}e.nights!==void 0&&e.nights!==null&&e.nights<0&&i.push("Number of nights cannot be negative"),e.party_size!==void 0&&e.party_size!==null&&e.party_size<0&&i.push("Party size cannot be negative");const o=["pricing_nightly_rate","pricing_subtotal","pricing_cleaning_fee","pricing_guest_service_fee","pricing_guest_total","pricing_host_service_fee","pricing_host_payout"];for(const a of o){const c=e[a];c!=null&&c<0&&i.push(`${a} cannot be negative`)}if(i.length>0)throw new Error(`Reservation validation failed: ${i.join(", ")}`)}validateReservationUpdate(e){const i=[];if(e.guest_name!==void 0&&e.guest_name.trim().length===0&&i.push("Guest name cannot be empty"),e.guest_name&&e.guest_name.trim().length>255&&i.push("Guest name cannot exceed 255 characters"),e.check_in&&e.check_out){const a=new Date(e.check_in);new Date(e.check_out)<=a&&i.push("Check-out date must be after check-in date")}e.nights!==void 0&&e.nights!==null&&e.nights<0&&i.push("Number of nights cannot be negative"),e.party_size!==void 0&&e.party_size!==null&&e.party_size<0&&i.push("Party size cannot be negative");const o=["pricing_nightly_rate","pricing_subtotal","pricing_cleaning_fee","pricing_guest_service_fee","pricing_guest_total","pricing_host_service_fee","pricing_host_payout"];for(const a of o){const c=e[a];c!=null&&c<0&&i.push(`${a} cannot be negative`)}if(i.length>0)throw new Error(`Reservation update validation failed: ${i.join(", ")}`)}}class UserService{constructor(e,i){this.supabaseService=e,this.role=i}async getCleaners(){const e=this.supabaseService.getSupabaseClient(),{data:i,error:o}=await e.from("roles").select("user_id").eq("role","cleaner").order("created_at");if(o)throw o;if(!i||i.length===0)return[];const{data:a,error:c}=await e.from("user_profiles").select("id, name, email").in("id",i.map(h=>h.user_id)).overrideTypes();if(c)throw c;return(a==null?void 0:a.map(h=>({id:h.id,name:h.name||h.email||`User ${h.id.substring(0,8)}...`,email:h.email||""})))||[]}async getCurrentSession(){const e=this.supabaseService.getSupabaseClient(),{data:i,error:o}=await e.auth.getSession();if(o)throw o;return i.session}async getCurrentUser(){const e=this.supabaseService.getSupabaseClient(),{data:i,error:o}=await e.auth.getUser();if(o)throw o;return i.user}async getUserProfile(e){if(!e)throw new Error("User ID is required");try{return await this.supabaseService.getRecordById("user_profiles",e)}catch(i){if(i instanceof Error&&i.message.includes("not found"))return null;throw i}}async getUsersByRole(e){if(e==="cleaner")return this.getCleaners();const i=this.supabaseService.getSupabaseClient(),{data:o,error:a}=await i.from("roles").select("user_id").eq("role",e).order("created_at");if(a)throw a;if(!o||o.length===0)return[];const{data:c,error:d}=await i.from("user_profiles").select("id, name, email").in("id",o.map(g=>g.user_id)).overrideTypes();if(d)throw d;return(c==null?void 0:c.map(g=>({id:g.id,name:g.name||g.email||`User ${g.id.substring(0,8)}...`,email:g.email||""})))||[]}async getAllUsers(e={}){if(this.role!=="admin")throw new Error("Only admins can fetch all users");const{sorting:i=[{id:"created_at",desc:!0}],pagination:o={pageIndex:0,pageSize:10}}=e,a={sorting:i,pagination:o};if(e.role){const c=await this.supabaseService.queryFromTable("user_profiles",a);if(e.role!=="unassigned"){const d=await this.getUsersByRole(e.role),h=new Set(d.map(_=>_.id)),g=c.data.filter(_=>h.has(_.id));return{data:g,count:g.length}}return c}return this.supabaseService.queryFromTable("user_profiles",a)}async hasRole(e,i){if(!e)throw new Error("User ID is required");const o=this.supabaseService.getSupabaseClient();if(i==="unassigned"){const{data:d,error:h}=await o.from("roles").select("role").eq("user_id",e);if(h)throw h;return!d||d.length===0}const{data:a,error:c}=await o.from("roles").select("role").eq("user_id",e).eq("role",i).single();if(c){if(c.code==="PGRST116")return!1;throw c}return!!a}async getUserRoles(e){if(!e)throw new Error("User ID is required");const i=this.supabaseService.getSupabaseClient(),{data:o,error:a}=await i.from("roles").select("role").eq("user_id",e);if(a)throw a;return(o==null?void 0:o.map(c=>c.role))||[]}async validateUserPermission(e,i,o){if(!e)throw new Error("User ID is required for permission validation");return await this.hasRole(e,i)?!0:(console.warn(`User ${e} lacks ${i} role for operation: ${o}`),!1)}async deleteUserProfile(e){if(!e)throw new Error("User ID is required for profile deletion");await this.supabaseService.deleteRecord("user_profiles",e)}}class ListingService{constructor(e){this.supabaseService=e}async fetchListings(){return(await this.supabaseService.queryFromTable("listings",{select:"id, airbnb_id, airbnb_payload, created_at, updated_at",sorting:[{id:"id",desc:!1}]})).data}async fetchListing(e){return this.supabaseService.getRecordById("listings",e)}async getListingsForSelection(){return(await this.supabaseService.queryFromTable("listings",{sorting:[{id:"id",desc:!1}]})).data}async searchListings(e={}){const i={};return e.id&&(i.id=e.id),e.airbnbId&&(i.airbnb_id=e.airbnbId),(await this.supabaseService.queryFromTable("listings",{additionalFilters:i,globalFilter:e.searchPattern||"",globalFilterColumns:["id","airbnb_id"],sorting:[{id:"id",desc:!1}]})).data}}class AuditService{constructor(e){this.supabaseService=e}async getAuditLog(e,i){const o=await this.supabaseService.executeQuery(()=>this.supabaseService.getSupabaseClient().from("audit_log").select("*").eq("table_name",e).eq("record_id",i).order("changed_at",{ascending:!1}));return!o||o.length===0?[]:this.enrichWithUserProfiles(o)}async getAuditLogWithFilters(e={}){const{tableName:i,recordId:o,actionType:a,changedBy:c,dateFrom:d,dateTo:h,limit:g=100}=e;let _=this.supabaseService.getSupabaseClient().from("audit_log").select("*").order("changed_at",{ascending:!1}).limit(g);i&&(_=_.eq("table_name",i)),o&&(_=_.eq("record_id",o)),a&&(_=_.eq("action_type",a)),c&&(_=_.eq("changed_by",c)),d&&(_=_.gte("changed_at",d)),h&&(_=_.lte("changed_at",h));const j=await this.supabaseService.executeQuery(()=>_);return!j||j.length===0?[]:this.enrichWithUserProfiles(j)}async getTableAuditLog(e,i){if(!i||i.length===0)return[];const o=await this.supabaseService.executeQuery(()=>this.supabaseService.getSupabaseClient().from("audit_log").select("*").eq("table_name",e).in("record_id",i).order("changed_at",{ascending:!1}));return!o||o.length===0?[]:this.enrichWithUserProfiles(o)}async getUserAuditLog(e,i=50){const o=await this.supabaseService.executeQuery(()=>this.supabaseService.getSupabaseClient().from("audit_log").select("*").eq("changed_by",e).order("changed_at",{ascending:!1}).limit(i));return!o||o.length===0?[]:this.enrichWithUserProfiles(o)}async getRecentAuditActivity(e=20){const i=await this.supabaseService.executeQuery(()=>this.supabaseService.getSupabaseClient().from("audit_log").select("*").order("changed_at",{ascending:!1}).limit(e));return!i||i.length===0?[]:this.enrichWithUserProfiles(i)}async enrichWithUserProfiles(e){if(!e||e.length===0)return e;const i=[...new Set(e.map(c=>c.changed_by).filter(c=>c!==null))];if(i.length===0)return e;const o=await this.supabaseService.executeQuery(()=>this.supabaseService.getSupabaseClient().from("user_profiles").select("id, email, name").in("id",i)),a=new Map((o==null?void 0:o.map(c=>[c.id,c]))||[]);return e.map(c=>{const d={...c};if(c.changed_by&&a.has(c.changed_by)){const h=a.get(c.changed_by);d.changed_by_name=h.name||void 0,d.changed_by_email=h.email||void 0}return d})}formatAuditEntry(e){const i=this.getActionDescription(e.action_type||"UPDATE"),o=this.getChangeDescription(e),a=new Date(e.changed_at).toLocaleString(),c=this.getUserDisplayName(e);return{action:i,description:o,timestamp:a,user:c}}getActionDescription(e){switch(e){case"INSERT":return"Created";case"UPDATE":return"Updated";case"DELETE":return"Deleted";default:return"Modified"}}getChangeDescription(e){if(e.action_type==="INSERT")return`New ${e.table_name} record created`;if(e.action_type==="DELETE")return`${e.table_name} record deleted`;if(e.changed_fields&&e.changed_fields.length>0){const i=e.changed_fields.length,o=e.changed_fields.join(", ");return`Updated ${i} field(s): ${o}`}return`${e.table_name} record updated`}getUserDisplayName(e){return e.changed_by?e.changed_by_name?e.changed_by_name:e.changed_by_email?e.changed_by_email.split("@")[0]:"Unknown User":"System"}}class HealthCheckService{constructor(e){this.supabaseService=e}async getHealthCheck(){return this.supabaseService.callSupabaseFunction("health")}}const useServices=()=>{const{role:s,supabaseService:e}=useAuth(),i=reactExports.useMemo(()=>new TodoService(e,s),[e,s]),o=reactExports.useMemo(()=>new NoteService(e,s),[e,s]),a=reactExports.useMemo(()=>new ReservationService(e),[e]),c=reactExports.useMemo(()=>new UserService(e,s),[e,s]),d=reactExports.useMemo(()=>new ListingService(e),[e]),h=reactExports.useMemo(()=>new AuditService(e),[e]),g=reactExports.useMemo(()=>new TaskService(e,h),[e,h]),_=reactExports.useMemo(()=>new HealthCheckService(e),[e]);return{supabaseService:e,todoService:i,taskService:g,noteService:o,reservationService:a,userService:c,listingService:d,auditService:h,healthCheckService:_}};/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function functionalUpdate(s,e){return typeof s=="function"?s(e):s}function makeStateUpdater(s,e){return i=>{e.setState(o=>({...o,[s]:functionalUpdate(i,o[s])}))}}function isFunction(s){return s instanceof Function}function isNumberArray(s){return Array.isArray(s)&&s.every(e=>typeof e=="number")}function flattenBy(s,e){const i=[],o=a=>{a.forEach(c=>{i.push(c);const d=e(c);d!=null&&d.length&&o(d)})};return o(s),i}function memo(s,e,i){let o=[],a;return c=>{let d;i.key&&i.debug&&(d=Date.now());const h=s(c);if(!(h.length!==o.length||h.some((j,b)=>o[b]!==j)))return a;o=h;let _;if(i.key&&i.debug&&(_=Date.now()),a=e(...h),i==null||i.onChange==null||i.onChange(a),i.key&&i.debug&&i!=null&&i.debug()){const j=Math.round((Date.now()-d)*100)/100,b=Math.round((Date.now()-_)*100)/100,$=b/16,et=(_e,st)=>{for(_e=String(_e);_e.length<st;)_e=" "+_e;return _e};console.info(`%c ${et(b,5)} /${et(j,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*$,120))}deg 100% 31%);`,i==null?void 0:i.key)}return a}}function getMemoOptions(s,e,i,o){return{debug:()=>{var a;return(a=s==null?void 0:s.debugAll)!=null?a:s[e]},key:!1,onChange:o}}function createCell(s,e,i,o){const a=()=>{var d;return(d=c.getValue())!=null?d:s.options.renderFallbackValue},c={id:`${e.id}_${i.id}`,row:e,column:i,getValue:()=>e.getValue(o),renderValue:a,getContext:memo(()=>[s,i,e,c],(d,h,g,_)=>({table:d,column:h,row:g,cell:_,getValue:_.getValue,renderValue:_.renderValue}),getMemoOptions(s.options,"debugCells"))};return s._features.forEach(d=>{d.createCell==null||d.createCell(c,i,e,s)},{}),c}function createColumn(s,e,i,o){var a,c;const h={...s._getDefaultColumnDef(),...e},g=h.accessorKey;let _=(a=(c=h.id)!=null?c:g?typeof String.prototype.replaceAll=="function"?g.replaceAll(".","_"):g.replace(/\./g,"_"):void 0)!=null?a:typeof h.header=="string"?h.header:void 0,j;if(h.accessorFn?j=h.accessorFn:g&&(g.includes(".")?j=$=>{let et=$;for(const st of g.split(".")){var _e;et=(_e=et)==null?void 0:_e[st]}return et}:j=$=>$[h.accessorKey]),!_)throw new Error;let b={id:`${String(_)}`,accessorFn:j,parent:o,depth:i,columnDef:h,columns:[],getFlatColumns:memo(()=>[!0],()=>{var $;return[b,...($=b.columns)==null?void 0:$.flatMap(et=>et.getFlatColumns())]},getMemoOptions(s.options,"debugColumns")),getLeafColumns:memo(()=>[s._getOrderColumnsFn()],$=>{var et;if((et=b.columns)!=null&&et.length){let _e=b.columns.flatMap(st=>st.getLeafColumns());return $(_e)}return[b]},getMemoOptions(s.options,"debugColumns"))};for(const $ of s._features)$.createColumn==null||$.createColumn(b,s);return b}const debug="debugHeaders";function createHeader(s,e,i){var o;let c={id:(o=i.id)!=null?o:e.id,column:e,index:i.index,isPlaceholder:!!i.isPlaceholder,placeholderId:i.placeholderId,depth:i.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const d=[],h=g=>{g.subHeaders&&g.subHeaders.length&&g.subHeaders.map(h),d.push(g)};return h(c),d},getContext:()=>({table:s,header:c,column:e})};return s._features.forEach(d=>{d.createHeader==null||d.createHeader(c,s)}),c}const Headers$1={createTable:s=>{s.getHeaderGroups=memo(()=>[s.getAllColumns(),s.getVisibleLeafColumns(),s.getState().columnPinning.left,s.getState().columnPinning.right],(e,i,o,a)=>{var c,d;const h=(c=o==null?void 0:o.map(b=>i.find($=>$.id===b)).filter(Boolean))!=null?c:[],g=(d=a==null?void 0:a.map(b=>i.find($=>$.id===b)).filter(Boolean))!=null?d:[],_=i.filter(b=>!(o!=null&&o.includes(b.id))&&!(a!=null&&a.includes(b.id)));return buildHeaderGroups(e,[...h,..._,...g],s)},getMemoOptions(s.options,debug)),s.getCenterHeaderGroups=memo(()=>[s.getAllColumns(),s.getVisibleLeafColumns(),s.getState().columnPinning.left,s.getState().columnPinning.right],(e,i,o,a)=>(i=i.filter(c=>!(o!=null&&o.includes(c.id))&&!(a!=null&&a.includes(c.id))),buildHeaderGroups(e,i,s,"center")),getMemoOptions(s.options,debug)),s.getLeftHeaderGroups=memo(()=>[s.getAllColumns(),s.getVisibleLeafColumns(),s.getState().columnPinning.left],(e,i,o)=>{var a;const c=(a=o==null?void 0:o.map(d=>i.find(h=>h.id===d)).filter(Boolean))!=null?a:[];return buildHeaderGroups(e,c,s,"left")},getMemoOptions(s.options,debug)),s.getRightHeaderGroups=memo(()=>[s.getAllColumns(),s.getVisibleLeafColumns(),s.getState().columnPinning.right],(e,i,o)=>{var a;const c=(a=o==null?void 0:o.map(d=>i.find(h=>h.id===d)).filter(Boolean))!=null?a:[];return buildHeaderGroups(e,c,s,"right")},getMemoOptions(s.options,debug)),s.getFooterGroups=memo(()=>[s.getHeaderGroups()],e=>[...e].reverse(),getMemoOptions(s.options,debug)),s.getLeftFooterGroups=memo(()=>[s.getLeftHeaderGroups()],e=>[...e].reverse(),getMemoOptions(s.options,debug)),s.getCenterFooterGroups=memo(()=>[s.getCenterHeaderGroups()],e=>[...e].reverse(),getMemoOptions(s.options,debug)),s.getRightFooterGroups=memo(()=>[s.getRightHeaderGroups()],e=>[...e].reverse(),getMemoOptions(s.options,debug)),s.getFlatHeaders=memo(()=>[s.getHeaderGroups()],e=>e.map(i=>i.headers).flat(),getMemoOptions(s.options,debug)),s.getLeftFlatHeaders=memo(()=>[s.getLeftHeaderGroups()],e=>e.map(i=>i.headers).flat(),getMemoOptions(s.options,debug)),s.getCenterFlatHeaders=memo(()=>[s.getCenterHeaderGroups()],e=>e.map(i=>i.headers).flat(),getMemoOptions(s.options,debug)),s.getRightFlatHeaders=memo(()=>[s.getRightHeaderGroups()],e=>e.map(i=>i.headers).flat(),getMemoOptions(s.options,debug)),s.getCenterLeafHeaders=memo(()=>[s.getCenterFlatHeaders()],e=>e.filter(i=>{var o;return!((o=i.subHeaders)!=null&&o.length)}),getMemoOptions(s.options,debug)),s.getLeftLeafHeaders=memo(()=>[s.getLeftFlatHeaders()],e=>e.filter(i=>{var o;return!((o=i.subHeaders)!=null&&o.length)}),getMemoOptions(s.options,debug)),s.getRightLeafHeaders=memo(()=>[s.getRightFlatHeaders()],e=>e.filter(i=>{var o;return!((o=i.subHeaders)!=null&&o.length)}),getMemoOptions(s.options,debug)),s.getLeafHeaders=memo(()=>[s.getLeftHeaderGroups(),s.getCenterHeaderGroups(),s.getRightHeaderGroups()],(e,i,o)=>{var a,c,d,h,g,_;return[...(a=(c=e[0])==null?void 0:c.headers)!=null?a:[],...(d=(h=i[0])==null?void 0:h.headers)!=null?d:[],...(g=(_=o[0])==null?void 0:_.headers)!=null?g:[]].map(j=>j.getLeafHeaders()).flat()},getMemoOptions(s.options,debug))}};function buildHeaderGroups(s,e,i,o){var a,c;let d=0;const h=function($,et){et===void 0&&(et=1),d=Math.max(d,et),$.filter(_e=>_e.getIsVisible()).forEach(_e=>{var st;(st=_e.columns)!=null&&st.length&&h(_e.columns,et+1)},0)};h(s);let g=[];const _=($,et)=>{const _e={depth:et,id:[o,`${et}`].filter(Boolean).join("_"),headers:[]},st=[];$.forEach(ot=>{const tt=[...st].reverse()[0],nt=ot.column.depth===_e.depth;let rt,it=!1;if(nt&&ot.column.parent?rt=ot.column.parent:(rt=ot.column,it=!0),tt&&(tt==null?void 0:tt.column)===rt)tt.subHeaders.push(ot);else{const lt=createHeader(i,rt,{id:[o,et,rt.id,ot==null?void 0:ot.id].filter(Boolean).join("_"),isPlaceholder:it,placeholderId:it?`${st.filter(at=>at.column===rt).length}`:void 0,depth:et,index:st.length});lt.subHeaders.push(ot),st.push(lt)}_e.headers.push(ot),ot.headerGroup=_e}),g.push(_e),et>0&&_(st,et-1)},j=e.map(($,et)=>createHeader(i,$,{depth:d,index:et}));_(j,d-1),g.reverse();const b=$=>$.filter(_e=>_e.column.getIsVisible()).map(_e=>{let st=0,ot=0,tt=[0];_e.subHeaders&&_e.subHeaders.length?(tt=[],b(_e.subHeaders).forEach(rt=>{let{colSpan:it,rowSpan:lt}=rt;st+=it,tt.push(lt)})):st=1;const nt=Math.min(...tt);return ot=ot+nt,_e.colSpan=st,_e.rowSpan=ot,{colSpan:st,rowSpan:ot}});return b((a=(c=g[0])==null?void 0:c.headers)!=null?a:[]),g}const createRow=(s,e,i,o,a,c,d)=>{let h={id:e,index:o,original:i,depth:a,parentId:d,_valuesCache:{},_uniqueValuesCache:{},getValue:g=>{if(h._valuesCache.hasOwnProperty(g))return h._valuesCache[g];const _=s.getColumn(g);if(_!=null&&_.accessorFn)return h._valuesCache[g]=_.accessorFn(h.original,o),h._valuesCache[g]},getUniqueValues:g=>{if(h._uniqueValuesCache.hasOwnProperty(g))return h._uniqueValuesCache[g];const _=s.getColumn(g);if(_!=null&&_.accessorFn)return _.columnDef.getUniqueValues?(h._uniqueValuesCache[g]=_.columnDef.getUniqueValues(h.original,o),h._uniqueValuesCache[g]):(h._uniqueValuesCache[g]=[h.getValue(g)],h._uniqueValuesCache[g])},renderValue:g=>{var _;return(_=h.getValue(g))!=null?_:s.options.renderFallbackValue},subRows:[],getLeafRows:()=>flattenBy(h.subRows,g=>g.subRows),getParentRow:()=>h.parentId?s.getRow(h.parentId,!0):void 0,getParentRows:()=>{let g=[],_=h;for(;;){const j=_.getParentRow();if(!j)break;g.push(j),_=j}return g.reverse()},getAllCells:memo(()=>[s.getAllLeafColumns()],g=>g.map(_=>createCell(s,h,_,_.id)),getMemoOptions(s.options,"debugRows")),_getAllCellsByColumnId:memo(()=>[h.getAllCells()],g=>g.reduce((_,j)=>(_[j.column.id]=j,_),{}),getMemoOptions(s.options,"debugRows"))};for(let g=0;g<s._features.length;g++){const _=s._features[g];_==null||_.createRow==null||_.createRow(h,s)}return h},ColumnFaceting={createColumn:(s,e)=>{s._getFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,s.id),s.getFacetedRowModel=()=>s._getFacetedRowModel?s._getFacetedRowModel():e.getPreFilteredRowModel(),s._getFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,s.id),s.getFacetedUniqueValues=()=>s._getFacetedUniqueValues?s._getFacetedUniqueValues():new Map,s._getFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,s.id),s.getFacetedMinMaxValues=()=>{if(s._getFacetedMinMaxValues)return s._getFacetedMinMaxValues()}}},includesString=(s,e,i)=>{var o,a;const c=i==null||(o=i.toString())==null?void 0:o.toLowerCase();return!!(!((a=s.getValue(e))==null||(a=a.toString())==null||(a=a.toLowerCase())==null)&&a.includes(c))};includesString.autoRemove=s=>testFalsey(s);const includesStringSensitive=(s,e,i)=>{var o;return!!(!((o=s.getValue(e))==null||(o=o.toString())==null)&&o.includes(i))};includesStringSensitive.autoRemove=s=>testFalsey(s);const equalsString=(s,e,i)=>{var o;return((o=s.getValue(e))==null||(o=o.toString())==null?void 0:o.toLowerCase())===(i==null?void 0:i.toLowerCase())};equalsString.autoRemove=s=>testFalsey(s);const arrIncludes=(s,e,i)=>{var o;return(o=s.getValue(e))==null?void 0:o.includes(i)};arrIncludes.autoRemove=s=>testFalsey(s);const arrIncludesAll=(s,e,i)=>!i.some(o=>{var a;return!((a=s.getValue(e))!=null&&a.includes(o))});arrIncludesAll.autoRemove=s=>testFalsey(s)||!(s!=null&&s.length);const arrIncludesSome=(s,e,i)=>i.some(o=>{var a;return(a=s.getValue(e))==null?void 0:a.includes(o)});arrIncludesSome.autoRemove=s=>testFalsey(s)||!(s!=null&&s.length);const equals=(s,e,i)=>s.getValue(e)===i;equals.autoRemove=s=>testFalsey(s);const weakEquals=(s,e,i)=>s.getValue(e)==i;weakEquals.autoRemove=s=>testFalsey(s);const inNumberRange=(s,e,i)=>{let[o,a]=i;const c=s.getValue(e);return c>=o&&c<=a};inNumberRange.resolveFilterValue=s=>{let[e,i]=s,o=typeof e!="number"?parseFloat(e):e,a=typeof i!="number"?parseFloat(i):i,c=e===null||Number.isNaN(o)?-1/0:o,d=i===null||Number.isNaN(a)?1/0:a;if(c>d){const h=c;c=d,d=h}return[c,d]};inNumberRange.autoRemove=s=>testFalsey(s)||testFalsey(s[0])&&testFalsey(s[1]);const filterFns={includesString,includesStringSensitive,equalsString,arrIncludes,arrIncludesAll,arrIncludesSome,equals,weakEquals,inNumberRange};function testFalsey(s){return s==null||s===""}const ColumnFiltering={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:s=>({columnFilters:[],...s}),getDefaultOptions:s=>({onColumnFiltersChange:makeStateUpdater("columnFilters",s),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(s,e)=>{s.getAutoFilterFn=()=>{const i=e.getCoreRowModel().flatRows[0],o=i==null?void 0:i.getValue(s.id);return typeof o=="string"?filterFns.includesString:typeof o=="number"?filterFns.inNumberRange:typeof o=="boolean"||o!==null&&typeof o=="object"?filterFns.equals:Array.isArray(o)?filterFns.arrIncludes:filterFns.weakEquals},s.getFilterFn=()=>{var i,o;return isFunction(s.columnDef.filterFn)?s.columnDef.filterFn:s.columnDef.filterFn==="auto"?s.getAutoFilterFn():(i=(o=e.options.filterFns)==null?void 0:o[s.columnDef.filterFn])!=null?i:filterFns[s.columnDef.filterFn]},s.getCanFilter=()=>{var i,o,a;return((i=s.columnDef.enableColumnFilter)!=null?i:!0)&&((o=e.options.enableColumnFilters)!=null?o:!0)&&((a=e.options.enableFilters)!=null?a:!0)&&!!s.accessorFn},s.getIsFiltered=()=>s.getFilterIndex()>-1,s.getFilterValue=()=>{var i;return(i=e.getState().columnFilters)==null||(i=i.find(o=>o.id===s.id))==null?void 0:i.value},s.getFilterIndex=()=>{var i,o;return(i=(o=e.getState().columnFilters)==null?void 0:o.findIndex(a=>a.id===s.id))!=null?i:-1},s.setFilterValue=i=>{e.setColumnFilters(o=>{const a=s.getFilterFn(),c=o==null?void 0:o.find(j=>j.id===s.id),d=functionalUpdate(i,c?c.value:void 0);if(shouldAutoRemoveFilter(a,d,s)){var h;return(h=o==null?void 0:o.filter(j=>j.id!==s.id))!=null?h:[]}const g={id:s.id,value:d};if(c){var _;return(_=o==null?void 0:o.map(j=>j.id===s.id?g:j))!=null?_:[]}return o!=null&&o.length?[...o,g]:[g]})}},createRow:(s,e)=>{s.columnFilters={},s.columnFiltersMeta={}},createTable:s=>{s.setColumnFilters=e=>{const i=s.getAllLeafColumns(),o=a=>{var c;return(c=functionalUpdate(e,a))==null?void 0:c.filter(d=>{const h=i.find(g=>g.id===d.id);if(h){const g=h.getFilterFn();if(shouldAutoRemoveFilter(g,d.value,h))return!1}return!0})};s.options.onColumnFiltersChange==null||s.options.onColumnFiltersChange(o)},s.resetColumnFilters=e=>{var i,o;s.setColumnFilters(e?[]:(i=(o=s.initialState)==null?void 0:o.columnFilters)!=null?i:[])},s.getPreFilteredRowModel=()=>s.getCoreRowModel(),s.getFilteredRowModel=()=>(!s._getFilteredRowModel&&s.options.getFilteredRowModel&&(s._getFilteredRowModel=s.options.getFilteredRowModel(s)),s.options.manualFiltering||!s._getFilteredRowModel?s.getPreFilteredRowModel():s._getFilteredRowModel())}};function shouldAutoRemoveFilter(s,e,i){return(s&&s.autoRemove?s.autoRemove(e,i):!1)||typeof e>"u"||typeof e=="string"&&!e}const sum=(s,e,i)=>i.reduce((o,a)=>{const c=a.getValue(s);return o+(typeof c=="number"?c:0)},0),min=(s,e,i)=>{let o;return i.forEach(a=>{const c=a.getValue(s);c!=null&&(o>c||o===void 0&&c>=c)&&(o=c)}),o},max=(s,e,i)=>{let o;return i.forEach(a=>{const c=a.getValue(s);c!=null&&(o<c||o===void 0&&c>=c)&&(o=c)}),o},extent=(s,e,i)=>{let o,a;return i.forEach(c=>{const d=c.getValue(s);d!=null&&(o===void 0?d>=d&&(o=a=d):(o>d&&(o=d),a<d&&(a=d)))}),[o,a]},mean=(s,e)=>{let i=0,o=0;if(e.forEach(a=>{let c=a.getValue(s);c!=null&&(c=+c)>=c&&(++i,o+=c)}),i)return o/i},median=(s,e)=>{if(!e.length)return;const i=e.map(c=>c.getValue(s));if(!isNumberArray(i))return;if(i.length===1)return i[0];const o=Math.floor(i.length/2),a=i.sort((c,d)=>c-d);return i.length%2!==0?a[o]:(a[o-1]+a[o])/2},unique=(s,e)=>Array.from(new Set(e.map(i=>i.getValue(s))).values()),uniqueCount=(s,e)=>new Set(e.map(i=>i.getValue(s))).size,count=(s,e)=>e.length,aggregationFns={sum,min,max,extent,mean,median,unique,uniqueCount,count},ColumnGrouping={getDefaultColumnDef:()=>({aggregatedCell:s=>{var e,i;return(e=(i=s.getValue())==null||i.toString==null?void 0:i.toString())!=null?e:null},aggregationFn:"auto"}),getInitialState:s=>({grouping:[],...s}),getDefaultOptions:s=>({onGroupingChange:makeStateUpdater("grouping",s),groupedColumnMode:"reorder"}),createColumn:(s,e)=>{s.toggleGrouping=()=>{e.setGrouping(i=>i!=null&&i.includes(s.id)?i.filter(o=>o!==s.id):[...i??[],s.id])},s.getCanGroup=()=>{var i,o;return((i=s.columnDef.enableGrouping)!=null?i:!0)&&((o=e.options.enableGrouping)!=null?o:!0)&&(!!s.accessorFn||!!s.columnDef.getGroupingValue)},s.getIsGrouped=()=>{var i;return(i=e.getState().grouping)==null?void 0:i.includes(s.id)},s.getGroupedIndex=()=>{var i;return(i=e.getState().grouping)==null?void 0:i.indexOf(s.id)},s.getToggleGroupingHandler=()=>{const i=s.getCanGroup();return()=>{i&&s.toggleGrouping()}},s.getAutoAggregationFn=()=>{const i=e.getCoreRowModel().flatRows[0],o=i==null?void 0:i.getValue(s.id);if(typeof o=="number")return aggregationFns.sum;if(Object.prototype.toString.call(o)==="[object Date]")return aggregationFns.extent},s.getAggregationFn=()=>{var i,o;if(!s)throw new Error;return isFunction(s.columnDef.aggregationFn)?s.columnDef.aggregationFn:s.columnDef.aggregationFn==="auto"?s.getAutoAggregationFn():(i=(o=e.options.aggregationFns)==null?void 0:o[s.columnDef.aggregationFn])!=null?i:aggregationFns[s.columnDef.aggregationFn]}},createTable:s=>{s.setGrouping=e=>s.options.onGroupingChange==null?void 0:s.options.onGroupingChange(e),s.resetGrouping=e=>{var i,o;s.setGrouping(e?[]:(i=(o=s.initialState)==null?void 0:o.grouping)!=null?i:[])},s.getPreGroupedRowModel=()=>s.getFilteredRowModel(),s.getGroupedRowModel=()=>(!s._getGroupedRowModel&&s.options.getGroupedRowModel&&(s._getGroupedRowModel=s.options.getGroupedRowModel(s)),s.options.manualGrouping||!s._getGroupedRowModel?s.getPreGroupedRowModel():s._getGroupedRowModel())},createRow:(s,e)=>{s.getIsGrouped=()=>!!s.groupingColumnId,s.getGroupingValue=i=>{if(s._groupingValuesCache.hasOwnProperty(i))return s._groupingValuesCache[i];const o=e.getColumn(i);return o!=null&&o.columnDef.getGroupingValue?(s._groupingValuesCache[i]=o.columnDef.getGroupingValue(s.original),s._groupingValuesCache[i]):s.getValue(i)},s._groupingValuesCache={}},createCell:(s,e,i,o)=>{s.getIsGrouped=()=>e.getIsGrouped()&&e.id===i.groupingColumnId,s.getIsPlaceholder=()=>!s.getIsGrouped()&&e.getIsGrouped(),s.getIsAggregated=()=>{var a;return!s.getIsGrouped()&&!s.getIsPlaceholder()&&!!((a=i.subRows)!=null&&a.length)}}};function orderColumns(s,e,i){if(!(e!=null&&e.length)||!i)return s;const o=s.filter(c=>!e.includes(c.id));return i==="remove"?o:[...e.map(c=>s.find(d=>d.id===c)).filter(Boolean),...o]}const ColumnOrdering={getInitialState:s=>({columnOrder:[],...s}),getDefaultOptions:s=>({onColumnOrderChange:makeStateUpdater("columnOrder",s)}),createColumn:(s,e)=>{s.getIndex=memo(i=>[_getVisibleLeafColumns(e,i)],i=>i.findIndex(o=>o.id===s.id),getMemoOptions(e.options,"debugColumns")),s.getIsFirstColumn=i=>{var o;return((o=_getVisibleLeafColumns(e,i)[0])==null?void 0:o.id)===s.id},s.getIsLastColumn=i=>{var o;const a=_getVisibleLeafColumns(e,i);return((o=a[a.length-1])==null?void 0:o.id)===s.id}},createTable:s=>{s.setColumnOrder=e=>s.options.onColumnOrderChange==null?void 0:s.options.onColumnOrderChange(e),s.resetColumnOrder=e=>{var i;s.setColumnOrder(e?[]:(i=s.initialState.columnOrder)!=null?i:[])},s._getOrderColumnsFn=memo(()=>[s.getState().columnOrder,s.getState().grouping,s.options.groupedColumnMode],(e,i,o)=>a=>{let c=[];if(!(e!=null&&e.length))c=a;else{const d=[...e],h=[...a];for(;h.length&&d.length;){const g=d.shift(),_=h.findIndex(j=>j.id===g);_>-1&&c.push(h.splice(_,1)[0])}c=[...c,...h]}return orderColumns(c,i,o)},getMemoOptions(s.options,"debugTable"))}},getDefaultColumnPinningState=()=>({left:[],right:[]}),ColumnPinning={getInitialState:s=>({columnPinning:getDefaultColumnPinningState(),...s}),getDefaultOptions:s=>({onColumnPinningChange:makeStateUpdater("columnPinning",s)}),createColumn:(s,e)=>{s.pin=i=>{const o=s.getLeafColumns().map(a=>a.id).filter(Boolean);e.setColumnPinning(a=>{var c,d;if(i==="right"){var h,g;return{left:((h=a==null?void 0:a.left)!=null?h:[]).filter(b=>!(o!=null&&o.includes(b))),right:[...((g=a==null?void 0:a.right)!=null?g:[]).filter(b=>!(o!=null&&o.includes(b))),...o]}}if(i==="left"){var _,j;return{left:[...((_=a==null?void 0:a.left)!=null?_:[]).filter(b=>!(o!=null&&o.includes(b))),...o],right:((j=a==null?void 0:a.right)!=null?j:[]).filter(b=>!(o!=null&&o.includes(b)))}}return{left:((c=a==null?void 0:a.left)!=null?c:[]).filter(b=>!(o!=null&&o.includes(b))),right:((d=a==null?void 0:a.right)!=null?d:[]).filter(b=>!(o!=null&&o.includes(b)))}})},s.getCanPin=()=>s.getLeafColumns().some(o=>{var a,c,d;return((a=o.columnDef.enablePinning)!=null?a:!0)&&((c=(d=e.options.enableColumnPinning)!=null?d:e.options.enablePinning)!=null?c:!0)}),s.getIsPinned=()=>{const i=s.getLeafColumns().map(h=>h.id),{left:o,right:a}=e.getState().columnPinning,c=i.some(h=>o==null?void 0:o.includes(h)),d=i.some(h=>a==null?void 0:a.includes(h));return c?"left":d?"right":!1},s.getPinnedIndex=()=>{var i,o;const a=s.getIsPinned();return a?(i=(o=e.getState().columnPinning)==null||(o=o[a])==null?void 0:o.indexOf(s.id))!=null?i:-1:0}},createRow:(s,e)=>{s.getCenterVisibleCells=memo(()=>[s._getAllVisibleCells(),e.getState().columnPinning.left,e.getState().columnPinning.right],(i,o,a)=>{const c=[...o??[],...a??[]];return i.filter(d=>!c.includes(d.column.id))},getMemoOptions(e.options,"debugRows")),s.getLeftVisibleCells=memo(()=>[s._getAllVisibleCells(),e.getState().columnPinning.left],(i,o)=>(o??[]).map(c=>i.find(d=>d.column.id===c)).filter(Boolean).map(c=>({...c,position:"left"})),getMemoOptions(e.options,"debugRows")),s.getRightVisibleCells=memo(()=>[s._getAllVisibleCells(),e.getState().columnPinning.right],(i,o)=>(o??[]).map(c=>i.find(d=>d.column.id===c)).filter(Boolean).map(c=>({...c,position:"right"})),getMemoOptions(e.options,"debugRows"))},createTable:s=>{s.setColumnPinning=e=>s.options.onColumnPinningChange==null?void 0:s.options.onColumnPinningChange(e),s.resetColumnPinning=e=>{var i,o;return s.setColumnPinning(e?getDefaultColumnPinningState():(i=(o=s.initialState)==null?void 0:o.columnPinning)!=null?i:getDefaultColumnPinningState())},s.getIsSomeColumnsPinned=e=>{var i;const o=s.getState().columnPinning;if(!e){var a,c;return!!((a=o.left)!=null&&a.length||(c=o.right)!=null&&c.length)}return!!((i=o[e])!=null&&i.length)},s.getLeftLeafColumns=memo(()=>[s.getAllLeafColumns(),s.getState().columnPinning.left],(e,i)=>(i??[]).map(o=>e.find(a=>a.id===o)).filter(Boolean),getMemoOptions(s.options,"debugColumns")),s.getRightLeafColumns=memo(()=>[s.getAllLeafColumns(),s.getState().columnPinning.right],(e,i)=>(i??[]).map(o=>e.find(a=>a.id===o)).filter(Boolean),getMemoOptions(s.options,"debugColumns")),s.getCenterLeafColumns=memo(()=>[s.getAllLeafColumns(),s.getState().columnPinning.left,s.getState().columnPinning.right],(e,i,o)=>{const a=[...i??[],...o??[]];return e.filter(c=>!a.includes(c.id))},getMemoOptions(s.options,"debugColumns"))}};function safelyAccessDocument(s){return s||(typeof document<"u"?document:null)}const defaultColumnSizing={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},getDefaultColumnSizingInfoState=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),ColumnSizing={getDefaultColumnDef:()=>defaultColumnSizing,getInitialState:s=>({columnSizing:{},columnSizingInfo:getDefaultColumnSizingInfoState(),...s}),getDefaultOptions:s=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:makeStateUpdater("columnSizing",s),onColumnSizingInfoChange:makeStateUpdater("columnSizingInfo",s)}),createColumn:(s,e)=>{s.getSize=()=>{var i,o,a;const c=e.getState().columnSizing[s.id];return Math.min(Math.max((i=s.columnDef.minSize)!=null?i:defaultColumnSizing.minSize,(o=c??s.columnDef.size)!=null?o:defaultColumnSizing.size),(a=s.columnDef.maxSize)!=null?a:defaultColumnSizing.maxSize)},s.getStart=memo(i=>[i,_getVisibleLeafColumns(e,i),e.getState().columnSizing],(i,o)=>o.slice(0,s.getIndex(i)).reduce((a,c)=>a+c.getSize(),0),getMemoOptions(e.options,"debugColumns")),s.getAfter=memo(i=>[i,_getVisibleLeafColumns(e,i),e.getState().columnSizing],(i,o)=>o.slice(s.getIndex(i)+1).reduce((a,c)=>a+c.getSize(),0),getMemoOptions(e.options,"debugColumns")),s.resetSize=()=>{e.setColumnSizing(i=>{let{[s.id]:o,...a}=i;return a})},s.getCanResize=()=>{var i,o;return((i=s.columnDef.enableResizing)!=null?i:!0)&&((o=e.options.enableColumnResizing)!=null?o:!0)},s.getIsResizing=()=>e.getState().columnSizingInfo.isResizingColumn===s.id},createHeader:(s,e)=>{s.getSize=()=>{let i=0;const o=a=>{if(a.subHeaders.length)a.subHeaders.forEach(o);else{var c;i+=(c=a.column.getSize())!=null?c:0}};return o(s),i},s.getStart=()=>{if(s.index>0){const i=s.headerGroup.headers[s.index-1];return i.getStart()+i.getSize()}return 0},s.getResizeHandler=i=>{const o=e.getColumn(s.column.id),a=o==null?void 0:o.getCanResize();return c=>{if(!o||!a||(c.persist==null||c.persist(),isTouchStartEvent(c)&&c.touches&&c.touches.length>1))return;const d=s.getSize(),h=s?s.getLeafHeaders().map(tt=>[tt.column.id,tt.column.getSize()]):[[o.id,o.getSize()]],g=isTouchStartEvent(c)?Math.round(c.touches[0].clientX):c.clientX,_={},j=(tt,nt)=>{typeof nt=="number"&&(e.setColumnSizingInfo(rt=>{var it,lt;const at=e.options.columnResizeDirection==="rtl"?-1:1,ut=(nt-((it=rt==null?void 0:rt.startOffset)!=null?it:0))*at,ct=Math.max(ut/((lt=rt==null?void 0:rt.startSize)!=null?lt:0),-.999999);return rt.columnSizingStart.forEach(ht=>{let[dt,pt]=ht;_[dt]=Math.round(Math.max(pt+pt*ct,0)*100)/100}),{...rt,deltaOffset:ut,deltaPercentage:ct}}),(e.options.columnResizeMode==="onChange"||tt==="end")&&e.setColumnSizing(rt=>({...rt,..._})))},b=tt=>j("move",tt),$=tt=>{j("end",tt),e.setColumnSizingInfo(nt=>({...nt,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},et=safelyAccessDocument(i),_e={moveHandler:tt=>b(tt.clientX),upHandler:tt=>{et==null||et.removeEventListener("mousemove",_e.moveHandler),et==null||et.removeEventListener("mouseup",_e.upHandler),$(tt.clientX)}},st={moveHandler:tt=>(tt.cancelable&&(tt.preventDefault(),tt.stopPropagation()),b(tt.touches[0].clientX),!1),upHandler:tt=>{var nt;et==null||et.removeEventListener("touchmove",st.moveHandler),et==null||et.removeEventListener("touchend",st.upHandler),tt.cancelable&&(tt.preventDefault(),tt.stopPropagation()),$((nt=tt.touches[0])==null?void 0:nt.clientX)}},ot=passiveEventSupported()?{passive:!1}:!1;isTouchStartEvent(c)?(et==null||et.addEventListener("touchmove",st.moveHandler,ot),et==null||et.addEventListener("touchend",st.upHandler,ot)):(et==null||et.addEventListener("mousemove",_e.moveHandler,ot),et==null||et.addEventListener("mouseup",_e.upHandler,ot)),e.setColumnSizingInfo(tt=>({...tt,startOffset:g,startSize:d,deltaOffset:0,deltaPercentage:0,columnSizingStart:h,isResizingColumn:o.id}))}}},createTable:s=>{s.setColumnSizing=e=>s.options.onColumnSizingChange==null?void 0:s.options.onColumnSizingChange(e),s.setColumnSizingInfo=e=>s.options.onColumnSizingInfoChange==null?void 0:s.options.onColumnSizingInfoChange(e),s.resetColumnSizing=e=>{var i;s.setColumnSizing(e?{}:(i=s.initialState.columnSizing)!=null?i:{})},s.resetHeaderSizeInfo=e=>{var i;s.setColumnSizingInfo(e?getDefaultColumnSizingInfoState():(i=s.initialState.columnSizingInfo)!=null?i:getDefaultColumnSizingInfoState())},s.getTotalSize=()=>{var e,i;return(e=(i=s.getHeaderGroups()[0])==null?void 0:i.headers.reduce((o,a)=>o+a.getSize(),0))!=null?e:0},s.getLeftTotalSize=()=>{var e,i;return(e=(i=s.getLeftHeaderGroups()[0])==null?void 0:i.headers.reduce((o,a)=>o+a.getSize(),0))!=null?e:0},s.getCenterTotalSize=()=>{var e,i;return(e=(i=s.getCenterHeaderGroups()[0])==null?void 0:i.headers.reduce((o,a)=>o+a.getSize(),0))!=null?e:0},s.getRightTotalSize=()=>{var e,i;return(e=(i=s.getRightHeaderGroups()[0])==null?void 0:i.headers.reduce((o,a)=>o+a.getSize(),0))!=null?e:0}}};let passiveSupported=null;function passiveEventSupported(){if(typeof passiveSupported=="boolean")return passiveSupported;let s=!1;try{const e={get passive(){return s=!0,!1}},i=()=>{};window.addEventListener("test",i,e),window.removeEventListener("test",i)}catch{s=!1}return passiveSupported=s,passiveSupported}function isTouchStartEvent(s){return s.type==="touchstart"}const ColumnVisibility={getInitialState:s=>({columnVisibility:{},...s}),getDefaultOptions:s=>({onColumnVisibilityChange:makeStateUpdater("columnVisibility",s)}),createColumn:(s,e)=>{s.toggleVisibility=i=>{s.getCanHide()&&e.setColumnVisibility(o=>({...o,[s.id]:i??!s.getIsVisible()}))},s.getIsVisible=()=>{var i,o;const a=s.columns;return(i=a.length?a.some(c=>c.getIsVisible()):(o=e.getState().columnVisibility)==null?void 0:o[s.id])!=null?i:!0},s.getCanHide=()=>{var i,o;return((i=s.columnDef.enableHiding)!=null?i:!0)&&((o=e.options.enableHiding)!=null?o:!0)},s.getToggleVisibilityHandler=()=>i=>{s.toggleVisibility==null||s.toggleVisibility(i.target.checked)}},createRow:(s,e)=>{s._getAllVisibleCells=memo(()=>[s.getAllCells(),e.getState().columnVisibility],i=>i.filter(o=>o.column.getIsVisible()),getMemoOptions(e.options,"debugRows")),s.getVisibleCells=memo(()=>[s.getLeftVisibleCells(),s.getCenterVisibleCells(),s.getRightVisibleCells()],(i,o,a)=>[...i,...o,...a],getMemoOptions(e.options,"debugRows"))},createTable:s=>{const e=(i,o)=>memo(()=>[o(),o().filter(a=>a.getIsVisible()).map(a=>a.id).join("_")],a=>a.filter(c=>c.getIsVisible==null?void 0:c.getIsVisible()),getMemoOptions(s.options,"debugColumns"));s.getVisibleFlatColumns=e("getVisibleFlatColumns",()=>s.getAllFlatColumns()),s.getVisibleLeafColumns=e("getVisibleLeafColumns",()=>s.getAllLeafColumns()),s.getLeftVisibleLeafColumns=e("getLeftVisibleLeafColumns",()=>s.getLeftLeafColumns()),s.getRightVisibleLeafColumns=e("getRightVisibleLeafColumns",()=>s.getRightLeafColumns()),s.getCenterVisibleLeafColumns=e("getCenterVisibleLeafColumns",()=>s.getCenterLeafColumns()),s.setColumnVisibility=i=>s.options.onColumnVisibilityChange==null?void 0:s.options.onColumnVisibilityChange(i),s.resetColumnVisibility=i=>{var o;s.setColumnVisibility(i?{}:(o=s.initialState.columnVisibility)!=null?o:{})},s.toggleAllColumnsVisible=i=>{var o;i=(o=i)!=null?o:!s.getIsAllColumnsVisible(),s.setColumnVisibility(s.getAllLeafColumns().reduce((a,c)=>({...a,[c.id]:i||!(c.getCanHide!=null&&c.getCanHide())}),{}))},s.getIsAllColumnsVisible=()=>!s.getAllLeafColumns().some(i=>!(i.getIsVisible!=null&&i.getIsVisible())),s.getIsSomeColumnsVisible=()=>s.getAllLeafColumns().some(i=>i.getIsVisible==null?void 0:i.getIsVisible()),s.getToggleAllColumnsVisibilityHandler=()=>i=>{var o;s.toggleAllColumnsVisible((o=i.target)==null?void 0:o.checked)}}};function _getVisibleLeafColumns(s,e){return e?e==="center"?s.getCenterVisibleLeafColumns():e==="left"?s.getLeftVisibleLeafColumns():s.getRightVisibleLeafColumns():s.getVisibleLeafColumns()}const GlobalFaceting={createTable:s=>{s._getGlobalFacetedRowModel=s.options.getFacetedRowModel&&s.options.getFacetedRowModel(s,"__global__"),s.getGlobalFacetedRowModel=()=>s.options.manualFiltering||!s._getGlobalFacetedRowModel?s.getPreFilteredRowModel():s._getGlobalFacetedRowModel(),s._getGlobalFacetedUniqueValues=s.options.getFacetedUniqueValues&&s.options.getFacetedUniqueValues(s,"__global__"),s.getGlobalFacetedUniqueValues=()=>s._getGlobalFacetedUniqueValues?s._getGlobalFacetedUniqueValues():new Map,s._getGlobalFacetedMinMaxValues=s.options.getFacetedMinMaxValues&&s.options.getFacetedMinMaxValues(s,"__global__"),s.getGlobalFacetedMinMaxValues=()=>{if(s._getGlobalFacetedMinMaxValues)return s._getGlobalFacetedMinMaxValues()}}},GlobalFiltering={getInitialState:s=>({globalFilter:void 0,...s}),getDefaultOptions:s=>({onGlobalFilterChange:makeStateUpdater("globalFilter",s),globalFilterFn:"auto",getColumnCanGlobalFilter:e=>{var i;const o=(i=s.getCoreRowModel().flatRows[0])==null||(i=i._getAllCellsByColumnId()[e.id])==null?void 0:i.getValue();return typeof o=="string"||typeof o=="number"}}),createColumn:(s,e)=>{s.getCanGlobalFilter=()=>{var i,o,a,c;return((i=s.columnDef.enableGlobalFilter)!=null?i:!0)&&((o=e.options.enableGlobalFilter)!=null?o:!0)&&((a=e.options.enableFilters)!=null?a:!0)&&((c=e.options.getColumnCanGlobalFilter==null?void 0:e.options.getColumnCanGlobalFilter(s))!=null?c:!0)&&!!s.accessorFn}},createTable:s=>{s.getGlobalAutoFilterFn=()=>filterFns.includesString,s.getGlobalFilterFn=()=>{var e,i;const{globalFilterFn:o}=s.options;return isFunction(o)?o:o==="auto"?s.getGlobalAutoFilterFn():(e=(i=s.options.filterFns)==null?void 0:i[o])!=null?e:filterFns[o]},s.setGlobalFilter=e=>{s.options.onGlobalFilterChange==null||s.options.onGlobalFilterChange(e)},s.resetGlobalFilter=e=>{s.setGlobalFilter(e?void 0:s.initialState.globalFilter)}}},RowExpanding={getInitialState:s=>({expanded:{},...s}),getDefaultOptions:s=>({onExpandedChange:makeStateUpdater("expanded",s),paginateExpandedRows:!0}),createTable:s=>{let e=!1,i=!1;s._autoResetExpanded=()=>{var o,a;if(!e){s._queue(()=>{e=!0});return}if((o=(a=s.options.autoResetAll)!=null?a:s.options.autoResetExpanded)!=null?o:!s.options.manualExpanding){if(i)return;i=!0,s._queue(()=>{s.resetExpanded(),i=!1})}},s.setExpanded=o=>s.options.onExpandedChange==null?void 0:s.options.onExpandedChange(o),s.toggleAllRowsExpanded=o=>{o??!s.getIsAllRowsExpanded()?s.setExpanded(!0):s.setExpanded({})},s.resetExpanded=o=>{var a,c;s.setExpanded(o?{}:(a=(c=s.initialState)==null?void 0:c.expanded)!=null?a:{})},s.getCanSomeRowsExpand=()=>s.getPrePaginationRowModel().flatRows.some(o=>o.getCanExpand()),s.getToggleAllRowsExpandedHandler=()=>o=>{o.persist==null||o.persist(),s.toggleAllRowsExpanded()},s.getIsSomeRowsExpanded=()=>{const o=s.getState().expanded;return o===!0||Object.values(o).some(Boolean)},s.getIsAllRowsExpanded=()=>{const o=s.getState().expanded;return typeof o=="boolean"?o===!0:!(!Object.keys(o).length||s.getRowModel().flatRows.some(a=>!a.getIsExpanded()))},s.getExpandedDepth=()=>{let o=0;return(s.getState().expanded===!0?Object.keys(s.getRowModel().rowsById):Object.keys(s.getState().expanded)).forEach(c=>{const d=c.split(".");o=Math.max(o,d.length)}),o},s.getPreExpandedRowModel=()=>s.getSortedRowModel(),s.getExpandedRowModel=()=>(!s._getExpandedRowModel&&s.options.getExpandedRowModel&&(s._getExpandedRowModel=s.options.getExpandedRowModel(s)),s.options.manualExpanding||!s._getExpandedRowModel?s.getPreExpandedRowModel():s._getExpandedRowModel())},createRow:(s,e)=>{s.toggleExpanded=i=>{e.setExpanded(o=>{var a;const c=o===!0?!0:!!(o!=null&&o[s.id]);let d={};if(o===!0?Object.keys(e.getRowModel().rowsById).forEach(h=>{d[h]=!0}):d=o,i=(a=i)!=null?a:!c,!c&&i)return{...d,[s.id]:!0};if(c&&!i){const{[s.id]:h,...g}=d;return g}return o})},s.getIsExpanded=()=>{var i;const o=e.getState().expanded;return!!((i=e.options.getIsRowExpanded==null?void 0:e.options.getIsRowExpanded(s))!=null?i:o===!0||o!=null&&o[s.id])},s.getCanExpand=()=>{var i,o,a;return(i=e.options.getRowCanExpand==null?void 0:e.options.getRowCanExpand(s))!=null?i:((o=e.options.enableExpanding)!=null?o:!0)&&!!((a=s.subRows)!=null&&a.length)},s.getIsAllParentsExpanded=()=>{let i=!0,o=s;for(;i&&o.parentId;)o=e.getRow(o.parentId,!0),i=o.getIsExpanded();return i},s.getToggleExpandedHandler=()=>{const i=s.getCanExpand();return()=>{i&&s.toggleExpanded()}}}},defaultPageIndex=0,defaultPageSize=10,getDefaultPaginationState=()=>({pageIndex:defaultPageIndex,pageSize:defaultPageSize}),RowPagination={getInitialState:s=>({...s,pagination:{...getDefaultPaginationState(),...s==null?void 0:s.pagination}}),getDefaultOptions:s=>({onPaginationChange:makeStateUpdater("pagination",s)}),createTable:s=>{let e=!1,i=!1;s._autoResetPageIndex=()=>{var o,a;if(!e){s._queue(()=>{e=!0});return}if((o=(a=s.options.autoResetAll)!=null?a:s.options.autoResetPageIndex)!=null?o:!s.options.manualPagination){if(i)return;i=!0,s._queue(()=>{s.resetPageIndex(),i=!1})}},s.setPagination=o=>{const a=c=>functionalUpdate(o,c);return s.options.onPaginationChange==null?void 0:s.options.onPaginationChange(a)},s.resetPagination=o=>{var a;s.setPagination(o?getDefaultPaginationState():(a=s.initialState.pagination)!=null?a:getDefaultPaginationState())},s.setPageIndex=o=>{s.setPagination(a=>{let c=functionalUpdate(o,a.pageIndex);const d=typeof s.options.pageCount>"u"||s.options.pageCount===-1?Number.MAX_SAFE_INTEGER:s.options.pageCount-1;return c=Math.max(0,Math.min(c,d)),{...a,pageIndex:c}})},s.resetPageIndex=o=>{var a,c;s.setPageIndex(o?defaultPageIndex:(a=(c=s.initialState)==null||(c=c.pagination)==null?void 0:c.pageIndex)!=null?a:defaultPageIndex)},s.resetPageSize=o=>{var a,c;s.setPageSize(o?defaultPageSize:(a=(c=s.initialState)==null||(c=c.pagination)==null?void 0:c.pageSize)!=null?a:defaultPageSize)},s.setPageSize=o=>{s.setPagination(a=>{const c=Math.max(1,functionalUpdate(o,a.pageSize)),d=a.pageSize*a.pageIndex,h=Math.floor(d/c);return{...a,pageIndex:h,pageSize:c}})},s.setPageCount=o=>s.setPagination(a=>{var c;let d=functionalUpdate(o,(c=s.options.pageCount)!=null?c:-1);return typeof d=="number"&&(d=Math.max(-1,d)),{...a,pageCount:d}}),s.getPageOptions=memo(()=>[s.getPageCount()],o=>{let a=[];return o&&o>0&&(a=[...new Array(o)].fill(null).map((c,d)=>d)),a},getMemoOptions(s.options,"debugTable")),s.getCanPreviousPage=()=>s.getState().pagination.pageIndex>0,s.getCanNextPage=()=>{const{pageIndex:o}=s.getState().pagination,a=s.getPageCount();return a===-1?!0:a===0?!1:o<a-1},s.previousPage=()=>s.setPageIndex(o=>o-1),s.nextPage=()=>s.setPageIndex(o=>o+1),s.firstPage=()=>s.setPageIndex(0),s.lastPage=()=>s.setPageIndex(s.getPageCount()-1),s.getPrePaginationRowModel=()=>s.getExpandedRowModel(),s.getPaginationRowModel=()=>(!s._getPaginationRowModel&&s.options.getPaginationRowModel&&(s._getPaginationRowModel=s.options.getPaginationRowModel(s)),s.options.manualPagination||!s._getPaginationRowModel?s.getPrePaginationRowModel():s._getPaginationRowModel()),s.getPageCount=()=>{var o;return(o=s.options.pageCount)!=null?o:Math.ceil(s.getRowCount()/s.getState().pagination.pageSize)},s.getRowCount=()=>{var o;return(o=s.options.rowCount)!=null?o:s.getPrePaginationRowModel().rows.length}}},getDefaultRowPinningState=()=>({top:[],bottom:[]}),RowPinning={getInitialState:s=>({rowPinning:getDefaultRowPinningState(),...s}),getDefaultOptions:s=>({onRowPinningChange:makeStateUpdater("rowPinning",s)}),createRow:(s,e)=>{s.pin=(i,o,a)=>{const c=o?s.getLeafRows().map(g=>{let{id:_}=g;return _}):[],d=a?s.getParentRows().map(g=>{let{id:_}=g;return _}):[],h=new Set([...d,s.id,...c]);e.setRowPinning(g=>{var _,j;if(i==="bottom"){var b,$;return{top:((b=g==null?void 0:g.top)!=null?b:[]).filter(st=>!(h!=null&&h.has(st))),bottom:[...(($=g==null?void 0:g.bottom)!=null?$:[]).filter(st=>!(h!=null&&h.has(st))),...Array.from(h)]}}if(i==="top"){var et,_e;return{top:[...((et=g==null?void 0:g.top)!=null?et:[]).filter(st=>!(h!=null&&h.has(st))),...Array.from(h)],bottom:((_e=g==null?void 0:g.bottom)!=null?_e:[]).filter(st=>!(h!=null&&h.has(st)))}}return{top:((_=g==null?void 0:g.top)!=null?_:[]).filter(st=>!(h!=null&&h.has(st))),bottom:((j=g==null?void 0:g.bottom)!=null?j:[]).filter(st=>!(h!=null&&h.has(st)))}})},s.getCanPin=()=>{var i;const{enableRowPinning:o,enablePinning:a}=e.options;return typeof o=="function"?o(s):(i=o??a)!=null?i:!0},s.getIsPinned=()=>{const i=[s.id],{top:o,bottom:a}=e.getState().rowPinning,c=i.some(h=>o==null?void 0:o.includes(h)),d=i.some(h=>a==null?void 0:a.includes(h));return c?"top":d?"bottom":!1},s.getPinnedIndex=()=>{var i,o;const a=s.getIsPinned();if(!a)return-1;const c=(i=a==="top"?e.getTopRows():e.getBottomRows())==null?void 0:i.map(d=>{let{id:h}=d;return h});return(o=c==null?void 0:c.indexOf(s.id))!=null?o:-1}},createTable:s=>{s.setRowPinning=e=>s.options.onRowPinningChange==null?void 0:s.options.onRowPinningChange(e),s.resetRowPinning=e=>{var i,o;return s.setRowPinning(e?getDefaultRowPinningState():(i=(o=s.initialState)==null?void 0:o.rowPinning)!=null?i:getDefaultRowPinningState())},s.getIsSomeRowsPinned=e=>{var i;const o=s.getState().rowPinning;if(!e){var a,c;return!!((a=o.top)!=null&&a.length||(c=o.bottom)!=null&&c.length)}return!!((i=o[e])!=null&&i.length)},s._getPinnedRows=(e,i,o)=>{var a;return((a=s.options.keepPinnedRows)==null||a?(i??[]).map(d=>{const h=s.getRow(d,!0);return h.getIsAllParentsExpanded()?h:null}):(i??[]).map(d=>e.find(h=>h.id===d))).filter(Boolean).map(d=>({...d,position:o}))},s.getTopRows=memo(()=>[s.getRowModel().rows,s.getState().rowPinning.top],(e,i)=>s._getPinnedRows(e,i,"top"),getMemoOptions(s.options,"debugRows")),s.getBottomRows=memo(()=>[s.getRowModel().rows,s.getState().rowPinning.bottom],(e,i)=>s._getPinnedRows(e,i,"bottom"),getMemoOptions(s.options,"debugRows")),s.getCenterRows=memo(()=>[s.getRowModel().rows,s.getState().rowPinning.top,s.getState().rowPinning.bottom],(e,i,o)=>{const a=new Set([...i??[],...o??[]]);return e.filter(c=>!a.has(c.id))},getMemoOptions(s.options,"debugRows"))}},RowSelection={getInitialState:s=>({rowSelection:{},...s}),getDefaultOptions:s=>({onRowSelectionChange:makeStateUpdater("rowSelection",s),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:s=>{s.setRowSelection=e=>s.options.onRowSelectionChange==null?void 0:s.options.onRowSelectionChange(e),s.resetRowSelection=e=>{var i;return s.setRowSelection(e?{}:(i=s.initialState.rowSelection)!=null?i:{})},s.toggleAllRowsSelected=e=>{s.setRowSelection(i=>{e=typeof e<"u"?e:!s.getIsAllRowsSelected();const o={...i},a=s.getPreGroupedRowModel().flatRows;return e?a.forEach(c=>{c.getCanSelect()&&(o[c.id]=!0)}):a.forEach(c=>{delete o[c.id]}),o})},s.toggleAllPageRowsSelected=e=>s.setRowSelection(i=>{const o=typeof e<"u"?e:!s.getIsAllPageRowsSelected(),a={...i};return s.getRowModel().rows.forEach(c=>{mutateRowIsSelected(a,c.id,o,!0,s)}),a}),s.getPreSelectedRowModel=()=>s.getCoreRowModel(),s.getSelectedRowModel=memo(()=>[s.getState().rowSelection,s.getCoreRowModel()],(e,i)=>Object.keys(e).length?selectRowsFn(s,i):{rows:[],flatRows:[],rowsById:{}},getMemoOptions(s.options,"debugTable")),s.getFilteredSelectedRowModel=memo(()=>[s.getState().rowSelection,s.getFilteredRowModel()],(e,i)=>Object.keys(e).length?selectRowsFn(s,i):{rows:[],flatRows:[],rowsById:{}},getMemoOptions(s.options,"debugTable")),s.getGroupedSelectedRowModel=memo(()=>[s.getState().rowSelection,s.getSortedRowModel()],(e,i)=>Object.keys(e).length?selectRowsFn(s,i):{rows:[],flatRows:[],rowsById:{}},getMemoOptions(s.options,"debugTable")),s.getIsAllRowsSelected=()=>{const e=s.getFilteredRowModel().flatRows,{rowSelection:i}=s.getState();let o=!!(e.length&&Object.keys(i).length);return o&&e.some(a=>a.getCanSelect()&&!i[a.id])&&(o=!1),o},s.getIsAllPageRowsSelected=()=>{const e=s.getPaginationRowModel().flatRows.filter(a=>a.getCanSelect()),{rowSelection:i}=s.getState();let o=!!e.length;return o&&e.some(a=>!i[a.id])&&(o=!1),o},s.getIsSomeRowsSelected=()=>{var e;const i=Object.keys((e=s.getState().rowSelection)!=null?e:{}).length;return i>0&&i<s.getFilteredRowModel().flatRows.length},s.getIsSomePageRowsSelected=()=>{const e=s.getPaginationRowModel().flatRows;return s.getIsAllPageRowsSelected()?!1:e.filter(i=>i.getCanSelect()).some(i=>i.getIsSelected()||i.getIsSomeSelected())},s.getToggleAllRowsSelectedHandler=()=>e=>{s.toggleAllRowsSelected(e.target.checked)},s.getToggleAllPageRowsSelectedHandler=()=>e=>{s.toggleAllPageRowsSelected(e.target.checked)}},createRow:(s,e)=>{s.toggleSelected=(i,o)=>{const a=s.getIsSelected();e.setRowSelection(c=>{var d;if(i=typeof i<"u"?i:!a,s.getCanSelect()&&a===i)return c;const h={...c};return mutateRowIsSelected(h,s.id,i,(d=o==null?void 0:o.selectChildren)!=null?d:!0,e),h})},s.getIsSelected=()=>{const{rowSelection:i}=e.getState();return isRowSelected(s,i)},s.getIsSomeSelected=()=>{const{rowSelection:i}=e.getState();return isSubRowSelected(s,i)==="some"},s.getIsAllSubRowsSelected=()=>{const{rowSelection:i}=e.getState();return isSubRowSelected(s,i)==="all"},s.getCanSelect=()=>{var i;return typeof e.options.enableRowSelection=="function"?e.options.enableRowSelection(s):(i=e.options.enableRowSelection)!=null?i:!0},s.getCanSelectSubRows=()=>{var i;return typeof e.options.enableSubRowSelection=="function"?e.options.enableSubRowSelection(s):(i=e.options.enableSubRowSelection)!=null?i:!0},s.getCanMultiSelect=()=>{var i;return typeof e.options.enableMultiRowSelection=="function"?e.options.enableMultiRowSelection(s):(i=e.options.enableMultiRowSelection)!=null?i:!0},s.getToggleSelectedHandler=()=>{const i=s.getCanSelect();return o=>{var a;i&&s.toggleSelected((a=o.target)==null?void 0:a.checked)}}}},mutateRowIsSelected=(s,e,i,o,a)=>{var c;const d=a.getRow(e,!0);i?(d.getCanMultiSelect()||Object.keys(s).forEach(h=>delete s[h]),d.getCanSelect()&&(s[e]=!0)):delete s[e],o&&(c=d.subRows)!=null&&c.length&&d.getCanSelectSubRows()&&d.subRows.forEach(h=>mutateRowIsSelected(s,h.id,i,o,a))};function selectRowsFn(s,e){const i=s.getState().rowSelection,o=[],a={},c=function(d,h){return d.map(g=>{var _;const j=isRowSelected(g,i);if(j&&(o.push(g),a[g.id]=g),(_=g.subRows)!=null&&_.length&&(g={...g,subRows:c(g.subRows)}),j)return g}).filter(Boolean)};return{rows:c(e.rows),flatRows:o,rowsById:a}}function isRowSelected(s,e){var i;return(i=e[s.id])!=null?i:!1}function isSubRowSelected(s,e,i){var o;if(!((o=s.subRows)!=null&&o.length))return!1;let a=!0,c=!1;return s.subRows.forEach(d=>{if(!(c&&!a)&&(d.getCanSelect()&&(isRowSelected(d,e)?c=!0:a=!1),d.subRows&&d.subRows.length)){const h=isSubRowSelected(d,e);h==="all"?c=!0:(h==="some"&&(c=!0),a=!1)}}),a?"all":c?"some":!1}const reSplitAlphaNumeric=/([0-9]+)/gm,alphanumeric=(s,e,i)=>compareAlphanumeric(toString(s.getValue(i)).toLowerCase(),toString(e.getValue(i)).toLowerCase()),alphanumericCaseSensitive=(s,e,i)=>compareAlphanumeric(toString(s.getValue(i)),toString(e.getValue(i))),text=(s,e,i)=>compareBasic(toString(s.getValue(i)).toLowerCase(),toString(e.getValue(i)).toLowerCase()),textCaseSensitive=(s,e,i)=>compareBasic(toString(s.getValue(i)),toString(e.getValue(i))),datetime=(s,e,i)=>{const o=s.getValue(i),a=e.getValue(i);return o>a?1:o<a?-1:0},basic=(s,e,i)=>compareBasic(s.getValue(i),e.getValue(i));function compareBasic(s,e){return s===e?0:s>e?1:-1}function toString(s){return typeof s=="number"?isNaN(s)||s===1/0||s===-1/0?"":String(s):typeof s=="string"?s:""}function compareAlphanumeric(s,e){const i=s.split(reSplitAlphaNumeric).filter(Boolean),o=e.split(reSplitAlphaNumeric).filter(Boolean);for(;i.length&&o.length;){const a=i.shift(),c=o.shift(),d=parseInt(a,10),h=parseInt(c,10),g=[d,h].sort();if(isNaN(g[0])){if(a>c)return 1;if(c>a)return-1;continue}if(isNaN(g[1]))return isNaN(d)?-1:1;if(d>h)return 1;if(h>d)return-1}return i.length-o.length}const sortingFns={alphanumeric,alphanumericCaseSensitive,text,textCaseSensitive,datetime,basic},RowSorting={getInitialState:s=>({sorting:[],...s}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:s=>({onSortingChange:makeStateUpdater("sorting",s),isMultiSortEvent:e=>e.shiftKey}),createColumn:(s,e)=>{s.getAutoSortingFn=()=>{const i=e.getFilteredRowModel().flatRows.slice(10);let o=!1;for(const a of i){const c=a==null?void 0:a.getValue(s.id);if(Object.prototype.toString.call(c)==="[object Date]")return sortingFns.datetime;if(typeof c=="string"&&(o=!0,c.split(reSplitAlphaNumeric).length>1))return sortingFns.alphanumeric}return o?sortingFns.text:sortingFns.basic},s.getAutoSortDir=()=>{const i=e.getFilteredRowModel().flatRows[0];return typeof(i==null?void 0:i.getValue(s.id))=="string"?"asc":"desc"},s.getSortingFn=()=>{var i,o;if(!s)throw new Error;return isFunction(s.columnDef.sortingFn)?s.columnDef.sortingFn:s.columnDef.sortingFn==="auto"?s.getAutoSortingFn():(i=(o=e.options.sortingFns)==null?void 0:o[s.columnDef.sortingFn])!=null?i:sortingFns[s.columnDef.sortingFn]},s.toggleSorting=(i,o)=>{const a=s.getNextSortingOrder(),c=typeof i<"u"&&i!==null;e.setSorting(d=>{const h=d==null?void 0:d.find(et=>et.id===s.id),g=d==null?void 0:d.findIndex(et=>et.id===s.id);let _=[],j,b=c?i:a==="desc";if(d!=null&&d.length&&s.getCanMultiSort()&&o?h?j="toggle":j="add":d!=null&&d.length&&g!==d.length-1?j="replace":h?j="toggle":j="replace",j==="toggle"&&(c||a||(j="remove")),j==="add"){var $;_=[...d,{id:s.id,desc:b}],_.splice(0,_.length-(($=e.options.maxMultiSortColCount)!=null?$:Number.MAX_SAFE_INTEGER))}else j==="toggle"?_=d.map(et=>et.id===s.id?{...et,desc:b}:et):j==="remove"?_=d.filter(et=>et.id!==s.id):_=[{id:s.id,desc:b}];return _})},s.getFirstSortDir=()=>{var i,o;return((i=(o=s.columnDef.sortDescFirst)!=null?o:e.options.sortDescFirst)!=null?i:s.getAutoSortDir()==="desc")?"desc":"asc"},s.getNextSortingOrder=i=>{var o,a;const c=s.getFirstSortDir(),d=s.getIsSorted();return d?d!==c&&((o=e.options.enableSortingRemoval)==null||o)&&(!(i&&(a=e.options.enableMultiRemove)!=null)||a)?!1:d==="desc"?"asc":"desc":c},s.getCanSort=()=>{var i,o;return((i=s.columnDef.enableSorting)!=null?i:!0)&&((o=e.options.enableSorting)!=null?o:!0)&&!!s.accessorFn},s.getCanMultiSort=()=>{var i,o;return(i=(o=s.columnDef.enableMultiSort)!=null?o:e.options.enableMultiSort)!=null?i:!!s.accessorFn},s.getIsSorted=()=>{var i;const o=(i=e.getState().sorting)==null?void 0:i.find(a=>a.id===s.id);return o?o.desc?"desc":"asc":!1},s.getSortIndex=()=>{var i,o;return(i=(o=e.getState().sorting)==null?void 0:o.findIndex(a=>a.id===s.id))!=null?i:-1},s.clearSorting=()=>{e.setSorting(i=>i!=null&&i.length?i.filter(o=>o.id!==s.id):[])},s.getToggleSortingHandler=()=>{const i=s.getCanSort();return o=>{i&&(o.persist==null||o.persist(),s.toggleSorting==null||s.toggleSorting(void 0,s.getCanMultiSort()?e.options.isMultiSortEvent==null?void 0:e.options.isMultiSortEvent(o):!1))}}},createTable:s=>{s.setSorting=e=>s.options.onSortingChange==null?void 0:s.options.onSortingChange(e),s.resetSorting=e=>{var i,o;s.setSorting(e?[]:(i=(o=s.initialState)==null?void 0:o.sorting)!=null?i:[])},s.getPreSortedRowModel=()=>s.getGroupedRowModel(),s.getSortedRowModel=()=>(!s._getSortedRowModel&&s.options.getSortedRowModel&&(s._getSortedRowModel=s.options.getSortedRowModel(s)),s.options.manualSorting||!s._getSortedRowModel?s.getPreSortedRowModel():s._getSortedRowModel())}},builtInFeatures=[Headers$1,ColumnVisibility,ColumnOrdering,ColumnPinning,ColumnFaceting,ColumnFiltering,GlobalFaceting,GlobalFiltering,RowSorting,ColumnGrouping,RowExpanding,RowPagination,RowPinning,RowSelection,ColumnSizing];function createTable(s){var e,i;const o=[...builtInFeatures,...(e=s._features)!=null?e:[]];let a={_features:o};const c=a._features.reduce(($,et)=>Object.assign($,et.getDefaultOptions==null?void 0:et.getDefaultOptions(a)),{}),d=$=>a.options.mergeOptions?a.options.mergeOptions(c,$):{...c,...$};let g={...{},...(i=s.initialState)!=null?i:{}};a._features.forEach($=>{var et;g=(et=$.getInitialState==null?void 0:$.getInitialState(g))!=null?et:g});const _=[];let j=!1;const b={_features:o,options:{...c,...s},initialState:g,_queue:$=>{_.push($),j||(j=!0,Promise.resolve().then(()=>{for(;_.length;)_.shift()();j=!1}).catch(et=>setTimeout(()=>{throw et})))},reset:()=>{a.setState(a.initialState)},setOptions:$=>{const et=functionalUpdate($,a.options);a.options=d(et)},getState:()=>a.options.state,setState:$=>{a.options.onStateChange==null||a.options.onStateChange($)},_getRowId:($,et,_e)=>{var st;return(st=a.options.getRowId==null?void 0:a.options.getRowId($,et,_e))!=null?st:`${_e?[_e.id,et].join("."):et}`},getCoreRowModel:()=>(a._getCoreRowModel||(a._getCoreRowModel=a.options.getCoreRowModel(a)),a._getCoreRowModel()),getRowModel:()=>a.getPaginationRowModel(),getRow:($,et)=>{let _e=(et?a.getPrePaginationRowModel():a.getRowModel()).rowsById[$];if(!_e&&(_e=a.getCoreRowModel().rowsById[$],!_e))throw new Error;return _e},_getDefaultColumnDef:memo(()=>[a.options.defaultColumn],$=>{var et;return $=(et=$)!=null?et:{},{header:_e=>{const st=_e.header.column.columnDef;return st.accessorKey?st.accessorKey:st.accessorFn?st.id:null},cell:_e=>{var st,ot;return(st=(ot=_e.renderValue())==null||ot.toString==null?void 0:ot.toString())!=null?st:null},...a._features.reduce((_e,st)=>Object.assign(_e,st.getDefaultColumnDef==null?void 0:st.getDefaultColumnDef()),{}),...$}},getMemoOptions(s,"debugColumns")),_getColumnDefs:()=>a.options.columns,getAllColumns:memo(()=>[a._getColumnDefs()],$=>{const et=function(_e,st,ot){return ot===void 0&&(ot=0),_e.map(tt=>{const nt=createColumn(a,tt,ot,st),rt=tt;return nt.columns=rt.columns?et(rt.columns,nt,ot+1):[],nt})};return et($)},getMemoOptions(s,"debugColumns")),getAllFlatColumns:memo(()=>[a.getAllColumns()],$=>$.flatMap(et=>et.getFlatColumns()),getMemoOptions(s,"debugColumns")),_getAllFlatColumnsById:memo(()=>[a.getAllFlatColumns()],$=>$.reduce((et,_e)=>(et[_e.id]=_e,et),{}),getMemoOptions(s,"debugColumns")),getAllLeafColumns:memo(()=>[a.getAllColumns(),a._getOrderColumnsFn()],($,et)=>{let _e=$.flatMap(st=>st.getLeafColumns());return et(_e)},getMemoOptions(s,"debugColumns")),getColumn:$=>a._getAllFlatColumnsById()[$]};Object.assign(a,b);for(let $=0;$<a._features.length;$++){const et=a._features[$];et==null||et.createTable==null||et.createTable(a)}return a}function getCoreRowModel(){return s=>memo(()=>[s.options.data],e=>{const i={rows:[],flatRows:[],rowsById:{}},o=function(a,c,d){c===void 0&&(c=0);const h=[];for(let _=0;_<a.length;_++){const j=createRow(s,s._getRowId(a[_],_,d),a[_],_,c,void 0,d==null?void 0:d.id);if(i.flatRows.push(j),i.rowsById[j.id]=j,h.push(j),s.options.getSubRows){var g;j.originalSubRows=s.options.getSubRows(a[_],_),(g=j.originalSubRows)!=null&&g.length&&(j.subRows=o(j.originalSubRows,c+1,j))}}return h};return i.rows=o(e),i},getMemoOptions(s.options,"debugTable","getRowModel",()=>s._autoResetPageIndex()))}function expandRows(s){const e=[],i=o=>{var a;e.push(o),(a=o.subRows)!=null&&a.length&&o.getIsExpanded()&&o.subRows.forEach(i)};return s.rows.forEach(i),{rows:e,flatRows:s.flatRows,rowsById:s.rowsById}}function filterRows(s,e,i){return i.options.filterFromLeafRows?filterRowModelFromLeafs(s,e,i):filterRowModelFromRoot(s,e,i)}function filterRowModelFromLeafs(s,e,i){var o;const a=[],c={},d=(o=i.options.maxLeafRowFilterDepth)!=null?o:100,h=function(g,_){_===void 0&&(_=0);const j=[];for(let $=0;$<g.length;$++){var b;let et=g[$];const _e=createRow(i,et.id,et.original,et.index,et.depth,void 0,et.parentId);if(_e.columnFilters=et.columnFilters,(b=et.subRows)!=null&&b.length&&_<d){if(_e.subRows=h(et.subRows,_+1),et=_e,e(et)&&!_e.subRows.length){j.push(et),c[et.id]=et,a.push(et);continue}if(e(et)||_e.subRows.length){j.push(et),c[et.id]=et,a.push(et);continue}}else et=_e,e(et)&&(j.push(et),c[et.id]=et,a.push(et))}return j};return{rows:h(s),flatRows:a,rowsById:c}}function filterRowModelFromRoot(s,e,i){var o;const a=[],c={},d=(o=i.options.maxLeafRowFilterDepth)!=null?o:100,h=function(g,_){_===void 0&&(_=0);const j=[];for(let $=0;$<g.length;$++){let et=g[$];if(e(et)){var b;if((b=et.subRows)!=null&&b.length&&_<d){const st=createRow(i,et.id,et.original,et.index,et.depth,void 0,et.parentId);st.subRows=h(et.subRows,_+1),et=st}j.push(et),a.push(et),c[et.id]=et}}return j};return{rows:h(s),flatRows:a,rowsById:c}}function getFilteredRowModel(){return s=>memo(()=>[s.getPreFilteredRowModel(),s.getState().columnFilters,s.getState().globalFilter],(e,i,o)=>{if(!e.rows.length||!(i!=null&&i.length)&&!o){for(let $=0;$<e.flatRows.length;$++)e.flatRows[$].columnFilters={},e.flatRows[$].columnFiltersMeta={};return e}const a=[],c=[];(i??[]).forEach($=>{var et;const _e=s.getColumn($.id);if(!_e)return;const st=_e.getFilterFn();st&&a.push({id:$.id,filterFn:st,resolvedValue:(et=st.resolveFilterValue==null?void 0:st.resolveFilterValue($.value))!=null?et:$.value})});const d=(i??[]).map($=>$.id),h=s.getGlobalFilterFn(),g=s.getAllLeafColumns().filter($=>$.getCanGlobalFilter());o&&h&&g.length&&(d.push("__global__"),g.forEach($=>{var et;c.push({id:$.id,filterFn:h,resolvedValue:(et=h.resolveFilterValue==null?void 0:h.resolveFilterValue(o))!=null?et:o})}));let _,j;for(let $=0;$<e.flatRows.length;$++){const et=e.flatRows[$];if(et.columnFilters={},a.length)for(let _e=0;_e<a.length;_e++){_=a[_e];const st=_.id;et.columnFilters[st]=_.filterFn(et,st,_.resolvedValue,ot=>{et.columnFiltersMeta[st]=ot})}if(c.length){for(let _e=0;_e<c.length;_e++){j=c[_e];const st=j.id;if(j.filterFn(et,st,j.resolvedValue,ot=>{et.columnFiltersMeta[st]=ot})){et.columnFilters.__global__=!0;break}}et.columnFilters.__global__!==!0&&(et.columnFilters.__global__=!1)}}const b=$=>{for(let et=0;et<d.length;et++)if($.columnFilters[d[et]]===!1)return!1;return!0};return filterRows(e.rows,b,s)},getMemoOptions(s.options,"debugTable","getFilteredRowModel",()=>s._autoResetPageIndex()))}function getPaginationRowModel(s){return e=>memo(()=>[e.getState().pagination,e.getPrePaginationRowModel(),e.options.paginateExpandedRows?void 0:e.getState().expanded],(i,o)=>{if(!o.rows.length)return o;const{pageSize:a,pageIndex:c}=i;let{rows:d,flatRows:h,rowsById:g}=o;const _=a*c,j=_+a;d=d.slice(_,j);let b;e.options.paginateExpandedRows?b={rows:d,flatRows:h,rowsById:g}:b=expandRows({rows:d,flatRows:h,rowsById:g}),b.flatRows=[];const $=et=>{b.flatRows.push(et),et.subRows.length&&et.subRows.forEach($)};return b.rows.forEach($),b},getMemoOptions(e.options,"debugTable"))}function getSortedRowModel(){return s=>memo(()=>[s.getState().sorting,s.getPreSortedRowModel()],(e,i)=>{if(!i.rows.length||!(e!=null&&e.length))return i;const o=s.getState().sorting,a=[],c=o.filter(g=>{var _;return(_=s.getColumn(g.id))==null?void 0:_.getCanSort()}),d={};c.forEach(g=>{const _=s.getColumn(g.id);_&&(d[g.id]={sortUndefined:_.columnDef.sortUndefined,invertSorting:_.columnDef.invertSorting,sortingFn:_.getSortingFn()})});const h=g=>{const _=g.map(j=>({...j}));return _.sort((j,b)=>{for(let et=0;et<c.length;et+=1){var $;const _e=c[et],st=d[_e.id],ot=st.sortUndefined,tt=($=_e==null?void 0:_e.desc)!=null?$:!1;let nt=0;if(ot){const rt=j.getValue(_e.id),it=b.getValue(_e.id),lt=rt===void 0,at=it===void 0;if(lt||at){if(ot==="first")return lt?-1:1;if(ot==="last")return lt?1:-1;nt=lt&&at?0:lt?ot:-ot}}if(nt===0&&(nt=st.sortingFn(j,b,_e.id)),nt!==0)return tt&&(nt*=-1),st.invertSorting&&(nt*=-1),nt}return j.index-b.index}),_.forEach(j=>{var b;a.push(j),(b=j.subRows)!=null&&b.length&&(j.subRows=h(j.subRows))}),_};return{rows:h(i.rows),flatRows:a,rowsById:i.rowsById}},getMemoOptions(s.options,"debugTable","getSortedRowModel",()=>s._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function flexRender(s,e){return s?isReactComponent(s)?reactExports.createElement(s,e):s:null}function isReactComponent(s){return isClassComponent(s)||typeof s=="function"||isExoticComponent(s)}function isClassComponent(s){return typeof s=="function"&&(()=>{const e=Object.getPrototypeOf(s);return e.prototype&&e.prototype.isReactComponent})()}function isExoticComponent(s){return typeof s=="object"&&typeof s.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(s.$$typeof.description)}function useReactTable(s){const e={state:{},onStateChange:()=>{},renderFallbackValue:null,...s},[i]=reactExports.useState(()=>({current:createTable(e)})),[o,a]=reactExports.useState(()=>i.current.initialState);return i.current.setOptions(c=>({...c,...s,state:{...o,...s.state},onStateChange:d=>{a(d),s.onStateChange==null||s.onStateChange(d)}})),i.current}const DataTable=({data:s=[],columns:e=[],loading:i=!1,error:o=null,enablePagination:a=!0,serverSide:c=!1,onServerSideChange:d,totalCount:h=0,pageSize:g=10,pageIndex:_=0,sorting:j=[],globalFilter:b="",className:$=""})=>{const{t:et}=useTranslation(),[_e,st]=reactExports.useState(j),[ot,tt]=reactExports.useState(b),[nt,rt]=reactExports.useState({pageIndex:_,pageSize:g}),it=at=>{c&&d&&d(at)},lt=useReactTable({data:s,columns:e,getCoreRowModel:getCoreRowModel(),getSortedRowModel:getSortedRowModel(),getPaginationRowModel:getPaginationRowModel(),getFilteredRowModel:getFilteredRowModel(),state:{sorting:_e,globalFilter:ot,pagination:nt},onSortingChange:at=>{const ut=typeof at=="function"?at(_e):at;st(ut),c&&it({sorting:ut,pagination:nt,globalFilter:ot})},onGlobalFilterChange:at=>{if(tt(at),c){const ut={...nt,pageIndex:0};rt(ut),it({sorting:_e,pagination:ut,globalFilter:at})}},onPaginationChange:at=>{const ut=typeof at=="function"?at(nt):at;rt(ut),c&&it({sorting:_e,pagination:ut,globalFilter:ot})},manualSorting:c,manualFiltering:c,manualPagination:c,...c&&{rowCount:h}});return i?jsxRuntimeExports.jsxs("div",{className:"data-table-loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),et("dataTable.loadingData")]}):o?jsxRuntimeExports.jsxs("div",{className:"error",children:[jsxRuntimeExports.jsx("h3",{className:"error-title",children:et("dataTable.failedToLoad")}),jsxRuntimeExports.jsx("p",{className:"error-message",children:o})]}):jsxRuntimeExports.jsxs("div",{className:`data-table ${$}`,children:[jsxRuntimeExports.jsxs("div",{className:"data-table-controls",children:[jsxRuntimeExports.jsx("div",{className:"search-container",children:jsxRuntimeExports.jsx("input",{type:"text",placeholder:et("dataTable.searchPlaceholder"),value:ot??"",onChange:at=>lt.setGlobalFilter(at.target.value),className:"search-input"})}),jsxRuntimeExports.jsx("div",{className:"table-info",children:c?jsxRuntimeExports.jsx("span",{className:"table-stats",children:et("dataTable.showingEntries",{start:Math.min(nt.pageIndex*nt.pageSize+1,h),end:Math.min((nt.pageIndex+1)*nt.pageSize,h),total:h})}):jsxRuntimeExports.jsx("span",{className:"table-stats",children:et("dataTable.showingCount",{count:lt.getRowModel().rows.length,total:s.length})})})]}),jsxRuntimeExports.jsx("div",{className:"table-container",children:jsxRuntimeExports.jsxs("table",{className:"data-table-element",children:[jsxRuntimeExports.jsx("thead",{children:lt.getHeaderGroups().map(at=>jsxRuntimeExports.jsx("tr",{children:at.headers.map(ut=>jsxRuntimeExports.jsx("th",{className:"data-table-header",children:ut.isPlaceholder?null:jsxRuntimeExports.jsxs("div",{className:`header-content ${ut.column.getCanSort()?"sortable":""}`,onClick:ut.column.getToggleSortingHandler(),children:[flexRender(ut.column.columnDef.header,ut.getContext()),ut.column.getCanSort()&&jsxRuntimeExports.jsx("span",{className:"sort-indicator",children:{asc:" ",desc:" "}[ut.column.getIsSorted()]??" "})]})},ut.id))},at.id))}),jsxRuntimeExports.jsx("tbody",{children:lt.getRowModel().rows.length===0?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:e.length,className:"empty-row",children:jsxRuntimeExports.jsxs("div",{className:"empty-state",children:[jsxRuntimeExports.jsx("div",{className:"empty-state-icon",children:""}),jsxRuntimeExports.jsx("h3",{className:"empty-state-title",children:et("dataTable.noData")}),jsxRuntimeExports.jsx("p",{className:"empty-state-description",children:et(ot?"dataTable.noResults":"dataTable.noDataAvailable")})]})})}):lt.getRowModel().rows.map(at=>jsxRuntimeExports.jsx("tr",{className:"data-table-row",children:at.getVisibleCells().map(ut=>jsxRuntimeExports.jsx("td",{className:"data-table-cell",children:flexRender(ut.column.columnDef.cell,ut.getContext())},ut.id))},at.id))})]})}),a&&jsxRuntimeExports.jsxs("div",{className:"pagination-controls",children:[jsxRuntimeExports.jsx("div",{className:"pagination-info",children:jsxRuntimeExports.jsx("span",{children:et("dataTable.pageInfo",{current:lt.getState().pagination.pageIndex+1,total:lt.getPageCount()})})}),jsxRuntimeExports.jsxs("div",{className:"pagination-buttons",children:[jsxRuntimeExports.jsx("button",{onClick:()=>lt.setPageIndex(0),disabled:!lt.getCanPreviousPage(),className:"pagination-btn",children:""}),jsxRuntimeExports.jsx("button",{onClick:()=>lt.previousPage(),disabled:!lt.getCanPreviousPage(),className:"pagination-btn",children:""}),jsxRuntimeExports.jsx("button",{onClick:()=>lt.nextPage(),disabled:!lt.getCanNextPage(),className:"pagination-btn",children:""}),jsxRuntimeExports.jsx("button",{onClick:()=>lt.setPageIndex(lt.getPageCount()-1),disabled:!lt.getCanNextPage(),className:"pagination-btn",children:""})]}),jsxRuntimeExports.jsx("div",{className:"page-size-selector",children:jsxRuntimeExports.jsx("select",{value:lt.getState().pagination.pageSize,onChange:at=>{lt.setPageSize(Number(at.target.value))},className:"page-size-select",children:[10,25,50,100].map(at=>jsxRuntimeExports.jsx("option",{value:at,children:et("dataTable.showSize",{size:at})},at))})})]})]})};function AdminReservationForm(){const{reservationService:s}=useServices(),{t:e}=useTranslation(),[i,o]=reactExports.useState([]),[a,c]=reactExports.useState(!0),[d,h]=reactExports.useState(null),[g,_]=reactExports.useState(0),[j,b]=reactExports.useState({pageIndex:0,pageSize:10}),[$,et]=reactExports.useState([{id:"check_in",desc:!0}]),[_e,st]=reactExports.useState(""),ot=reactExports.useCallback(async()=>{try{c(!0),h(null);const lt=await s.getReservations({filters:{globalFilter:_e},sorting:$,pagination:j});o(lt.data),_(lt.count)}catch(lt){h(lt instanceof Error?lt.message:String(lt)),console.error("Error fetching reservations:",lt)}finally{c(!1)}},[s,j,$,_e]);reactExports.useEffect(()=>{ot()},[ot]);const tt=lt=>{lt.pagination&&b(lt.pagination),lt.sorting!==void 0&&et(lt.sorting),lt.globalFilter!==void 0&&st(lt.globalFilter)},nt=reactExports.useCallback(lt=>lt?new Date(lt).toLocaleDateString():e("columns.na"),[e]),rt=reactExports.useCallback(lt=>lt?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(lt):e("columns.na"),[e]),it=reactExports.useMemo(()=>[{accessorKey:"id",header:e("columns.id"),cell:({getValue:lt})=>{const at=lt();return jsxRuntimeExports.jsxs("span",{className:"reservation-id",title:at,children:[at.substring(0,8),"..."]})},enableSorting:!1},{accessorKey:"guest_name",header:e("reservations.guest"),cell:({getValue:lt})=>lt()||e("columns.na")},{accessorKey:"listing_id",header:e("reservations.property"),cell:({getValue:lt})=>lt()||e("columns.na")},{accessorKey:"check_in",header:e("reservations.checkIn"),cell:({getValue:lt})=>nt(lt())},{accessorKey:"check_out",header:e("reservations.checkOut"),cell:({getValue:lt})=>nt(lt())},{accessorKey:"nights",header:e("reservations.nights"),cell:({getValue:lt})=>lt()||e("columns.na")},{accessorKey:"party_size",header:e("reservations.guests"),cell:({getValue:lt})=>lt()||e("columns.na")},{accessorKey:"status",header:e("columns.status"),cell:({getValue:lt})=>{const at=lt();return jsxRuntimeExports.jsx("span",{className:`status-badge status-${at}`,children:at})}},{accessorKey:"pricing_guest_total",header:e("reservations.total"),cell:({getValue:lt})=>jsxRuntimeExports.jsx("span",{className:"currency",children:rt(lt())})},{accessorKey:"pricing_host_payout",header:e("reservations.hostPayout"),cell:({getValue:lt})=>jsxRuntimeExports.jsx("span",{className:"currency",children:rt(lt())})}],[nt,rt,e]);return jsxRuntimeExports.jsx("div",{className:"admin-reservations",children:jsxRuntimeExports.jsx(DataTable,{data:i,columns:it,loading:a,error:d,serverSide:!0,onServerSideChange:tt,totalCount:g,pageSize:j.pageSize,pageIndex:j.pageIndex,sorting:$,globalFilter:_e,className:"reservations-data-table"})})}const useTaskTable=(s=!1,e)=>{const{user:i}=useAuth(),{taskService:o}=useServices(),[a,c]=reactExports.useState([]),[d,h]=reactExports.useState(!0),[g,_]=reactExports.useState(null),[j,b]=reactExports.useState(0),[$,et]=reactExports.useState({pageIndex:0,pageSize:10}),[_e,st]=reactExports.useState([{id:"scheduled_datetime",desc:!1}]),[ot,tt]=reactExports.useState(""),nt=reactExports.useCallback(async()=>{if(!(s&&!(i!=null&&i.id)))try{h(!0),_(null);const ut={};e&&(ut.status=e);const ct=await o.queryTasks({userId:s?i==null?void 0:i.id:null,pagination:$,sorting:_e,globalFilter:ot,additionalFilters:ut});c(ct.tasks),b(ct.totalCount)}catch(ut){const ct=ut instanceof Error?ut.message:String(ut);_(ct),console.error("Error fetching tasks:",ut)}finally{h(!1)}},[o,s,$,_e,ot,i==null?void 0:i.id,e]);reactExports.useEffect(()=>{nt()},[nt]);const rt=reactExports.useCallback(ut=>{ut.pagination&&et(ut.pagination),ut.sorting!==void 0&&st(ut.sorting),ut.globalFilter!==void 0&&tt(ut.globalFilter)},[]),it=reactExports.useCallback(async(ut,ct)=>{try{await o.updateTaskStatus(ut,ct),await nt()}catch(ht){console.error("Error updating task status:",ht);const dt=ht instanceof Error?ht.message:String(ht);throw _(dt),ht}},[o,nt]),lt=reactExports.useCallback(async(ut,ct)=>{try{await o.updateTaskAssignment(ut,ct,i==null?void 0:i.id),await nt()}catch(ht){console.error("Error updating task assignment:",ht);const dt=ht instanceof Error?ht.message:String(ht);throw _(dt),ht}},[o,nt,i==null?void 0:i.id]),at=reactExports.useCallback(async(ut,ct)=>{try{await o.updateTaskTimes(ut,ct),await nt()}catch(ht){console.error("Error updating task times:",ht);const dt=ht instanceof Error?ht.message:String(ht);throw _(dt),ht}},[o,nt]);return{tasks:a,loading:d,error:g,totalCount:j,pagination:$,sorting:_e,globalFilter:ot,handleServerSideChange:rt,updateTaskStatus:it,updateTaskAssignment:lt,updateTaskTimes:at,refetchTasks:nt}},formatDateTime=s=>s?new Date(s).toLocaleString():"N/A",formatDate=s=>s?new Date(s).toLocaleDateString():"N/A",formatTaskType=s=>s?s.charAt(0).toUpperCase()+s.slice(1):"N/A",formatTruncatedId=(s,e=8)=>s?`${s.substring(0,e)}...`:"N/A",formatDescription=(s,e=100)=>s?s.length>e?`${s.substring(0,e)}...`:s:"N/A",useCleaners=()=>{const{userService:s}=useServices(),[e,i]=reactExports.useState([]),[o,a]=reactExports.useState(!0),[c,d]=reactExports.useState(null),h=reactExports.useCallback(async()=>{try{a(!0),d(null);const g=await s.getCleaners();i(g)}catch(g){console.error("Error fetching cleaners:",g),d(g.message),i([])}finally{a(!1)}},[s]);return reactExports.useEffect(()=>{h()},[h]),{cleaners:e,loading:o,error:c,refetch:h}};function AssignmentDropdown({currentAssignedTo:s,taskId:e,onAssignmentChange:i,disabled:o=!1}){const{t:a}=useTranslation(),{cleaners:c,loading:d}=useCleaners(),[h,g]=reactExports.useState(!1),_=async b=>{const $=b.target.value||null;if($!==s){g(!0);try{await i(e,$)}catch(et){console.error("Assignment change failed:",et),b.target.value=s||""}finally{g(!1)}}},j=()=>{if(!s)return a("assignment.unassigned");const b=c.find($=>$.id===s);return b?b.name:`${a("assignment.unknown")} (${s.substring(0,8)}...)`};return d?jsxRuntimeExports.jsx("span",{className:"loading-text",children:a("assignment.loading")}):jsxRuntimeExports.jsxs("select",{value:s||"",onChange:_,disabled:o||h,className:`assignment-dropdown ${h?"updating":""}`,title:`Currently assigned to: ${j()}`,children:[jsxRuntimeExports.jsx("option",{value:"",children:a("assignment.unassigned")}),c.map(b=>jsxRuntimeExports.jsx("option",{value:b.id,children:b.name},b.id))]})}const useTranslatedColumns=()=>{const{t:s}=useTranslation(),e=reactExports.useMemo(()=>({id:{accessorKey:"id",header:s("columns.id"),cell:({getValue:h})=>{const g=h();return jsxRuntimeExports.jsx("span",{className:"reservation-id",title:g,children:formatTruncatedId(g)})},enableSorting:!1},title:{accessorKey:"title",header:s("columns.title"),cell:({getValue:h})=>h()||s("columns.na")},taskTitle:{accessorKey:"title",header:s("columns.task"),cell:({getValue:h})=>h()||s("columns.na")},taskType:{accessorKey:"task_type",header:s("columns.type"),cell:({getValue:h})=>formatTaskType(h())},status:{accessorKey:"status",header:s("columns.status"),cell:({getValue:h})=>{const g=h();return jsxRuntimeExports.jsx("span",{className:`status-badge status-${g}`,children:s(`statuses.${g}`)})}},description:{accessorKey:"description",header:s("columns.description"),cell:({getValue:h})=>formatDescription(h())},listingId:{accessorKey:"listing_id",header:s("columns.listing"),cell:({getValue:h})=>h()||s("columns.na")},reservationId:{accessorKey:"reservation_id",header:s("columns.reservation"),cell:({getValue:h})=>{const g=h();return g?jsxRuntimeExports.jsx("span",{className:"reservation-id",title:g,children:formatTruncatedId(g)}):s("columns.na")}},scheduledDateTime:{accessorKey:"scheduled_datetime",header:s("columns.scheduled"),cell:({getValue:h})=>formatDateTime(h())},assignedTo:{accessorKey:"assigned_to",header:s("columns.assignedTo"),cell:({getValue:h})=>{const g=h();return g?jsxRuntimeExports.jsx("span",{className:"reservation-id",title:g,children:formatTruncatedId(g)}):s("statuses.unassigned")}},assignedAt:{accessorKey:"assigned_at",header:s("columns.assignedAt"),cell:({getValue:h})=>formatDateTime(h())},acceptedAt:{accessorKey:"accepted_at",header:s("columns.acceptedAt"),cell:({getValue:h})=>formatDateTime(h())},completedAt:{accessorKey:"completed_at",header:s("columns.completedAt"),cell:({getValue:h})=>formatDateTime(h())},createdAt:{accessorKey:"created_at",header:s("columns.created"),cell:({getValue:h})=>formatDate(h())}}),[s]),i=reactExports.useMemo(()=>h=>({accessorKey:"assigned_to",header:s("columns.assignedTo"),cell:({getValue:g,row:_})=>{const j=g(),b=_.original;return jsxRuntimeExports.jsx(AssignmentDropdown,{currentAssignedTo:j,taskId:b.id,onAssignmentChange:h})},enableSorting:!1}),[s]),o=reactExports.useMemo(()=>()=>({accessorKey:"actions",header:s("tasks.actions"),cell:({row:h})=>{const g=h.original,_=()=>{window.location.href=`/tasks/${g.id}`};return jsxRuntimeExports.jsx("div",{className:"task-actions",children:jsxRuntimeExports.jsx("button",{className:"btn-view",onClick:_,children:s("columns.view")})})},enableSorting:!1}),[s]),a=reactExports.useMemo(()=>(h,g)=>({accessorKey:"actions",header:s("tasks.actions"),cell:({row:_})=>{const j=_.original,b=j.status==="assigned",$=j.status==="accepted",et=j.status==="in_progress",_e=j.status==="accepted",st=()=>{window.location.href=`/tasks/${j.id}`},ot=async()=>{g?await g(j.id,{started_at:new Date().toISOString()}):h(j.id,"in_progress")},tt=async()=>{g?await g(j.id,{finished_at:new Date().toISOString()}):h(j.id,"completed")};return jsxRuntimeExports.jsxs("div",{className:"task-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-view",onClick:st,children:s("columns.view")}),b&&jsxRuntimeExports.jsx("button",{className:"btn-accept",onClick:()=>h(j.id,"accepted"),children:s("columns.accept")}),$&&jsxRuntimeExports.jsx("button",{className:"btn-start",onClick:ot,children:s("columns.start")}),et&&jsxRuntimeExports.jsx("button",{className:"btn-complete",onClick:tt,children:s("columns.complete")}),_e&&jsxRuntimeExports.jsx("button",{className:"btn-cancel",onClick:()=>h(j.id,"assigned"),children:s("columns.cancel")})]})},enableSorting:!1}),[s]),c=reactExports.useMemo(()=>h=>{const g=e;return[g.id,g.title,g.taskType,g.status,g.listingId,g.reservationId,g.scheduledDateTime,i(h),g.assignedAt,g.acceptedAt,g.completedAt,g.createdAt,o()]},[e,i,o]),d=reactExports.useMemo(()=>(h,g)=>{const _=e;return[_.scheduledDateTime,_.listingId,_.taskType,_.status,a(h,g)]},[e,a]);return{getAdminColumns:c,getCleanerColumns:d}},CreateTaskModal=({isOpen:s,onClose:e,onTaskCreated:i})=>{const{t:o}=useTranslation(),{taskService:a,supabaseService:c}=useServices(),[d,h]=reactExports.useState(!1),[g,_]=reactExports.useState(null),[j,b]=reactExports.useState([]),[$,et]=reactExports.useState([]),[_e,st]=reactExports.useState({title:"",description:"",task_type:"cleaning",listing_id:"",reservation_id:"",scheduled_datetime:"",assigned_to:""});reactExports.useEffect(()=>{s&&(ot(),tt())},[s]);const ot=async()=>{try{const{data:it}=await c.getSupabaseClient().from("profiles").select("id, name, email").order("name");b(it||[])}catch(it){console.error("Error loading users:",it)}},tt=async()=>{try{const{data:it}=await c.getSupabaseClient().from("listings").select("id, name, address").order("name");et(it||[])}catch(it){console.error("Error loading listings:",it)}},nt=it=>{const{name:lt,value:at}=it.target;st(ut=>({...ut,[lt]:at}))},rt=async it=>{it.preventDefault(),h(!0),_(null);try{const lt={title:_e.title,description:_e.description||null,task_type:_e.task_type,listing_id:_e.listing_id,reservation_id:_e.reservation_id||null,scheduled_datetime:_e.scheduled_datetime,assigned_to:_e.assigned_to||null};await a.createTask(lt),st({title:"",description:"",task_type:"cleaning",listing_id:"",reservation_id:"",scheduled_datetime:"",assigned_to:""}),i(),e()}catch(lt){_(lt instanceof Error?lt.message:String(lt))}finally{h(!1)}};return s?jsxRuntimeExports.jsx("div",{className:"modal-overlay",onClick:e,children:jsxRuntimeExports.jsxs("div",{className:"modal-content",onClick:it=>it.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{children:o("tasks.createTask")}),jsxRuntimeExports.jsx("button",{className:"modal-close",onClick:e,children:""})]}),jsxRuntimeExports.jsxs("form",{onSubmit:rt,className:"modal-body",children:[g&&jsxRuntimeExports.jsx("div",{className:"error-message",children:g}),jsxRuntimeExports.jsxs("div",{className:"form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"title",children:[o("tasks.title")," *"]}),jsxRuntimeExports.jsx("input",{type:"text",id:"title",name:"title",value:_e.title,onChange:nt,required:!0,className:"form-control",placeholder:o("tasks.titlePlaceholder")})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"task_type",children:[o("tasks.type")," *"]}),jsxRuntimeExports.jsxs("select",{id:"task_type",name:"task_type",value:_e.task_type,onChange:nt,required:!0,className:"form-control",children:[jsxRuntimeExports.jsx("option",{value:"cleaning",children:o("tasks.types.cleaning")}),jsxRuntimeExports.jsx("option",{value:"maintenance",children:o("tasks.types.maintenance")}),jsxRuntimeExports.jsx("option",{value:"inspection",children:o("tasks.types.inspection")}),jsxRuntimeExports.jsx("option",{value:"setup",children:o("tasks.types.setup")}),jsxRuntimeExports.jsx("option",{value:"other",children:o("tasks.types.other")})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"listing_id",children:[o("tasks.listing")," *"]}),jsxRuntimeExports.jsxs("select",{id:"listing_id",name:"listing_id",value:_e.listing_id,onChange:nt,required:!0,className:"form-control",children:[jsxRuntimeExports.jsx("option",{value:"",children:o("tasks.selectListing")}),$.map(it=>jsxRuntimeExports.jsxs("option",{value:it.id,children:[it.name," - ",it.address]},it.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"scheduled_datetime",children:[o("tasks.scheduledDateTime")," *"]}),jsxRuntimeExports.jsx("input",{type:"datetime-local",id:"scheduled_datetime",name:"scheduled_datetime",value:_e.scheduled_datetime,onChange:nt,required:!0,className:"form-control"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"assigned_to",children:o("tasks.assignTo")}),jsxRuntimeExports.jsxs("select",{id:"assigned_to",name:"assigned_to",value:_e.assigned_to,onChange:nt,className:"form-control",children:[jsxRuntimeExports.jsx("option",{value:"",children:o("tasks.unassigned")}),j.map(it=>jsxRuntimeExports.jsxs("option",{value:it.id,children:[it.name," (",it.email,")"]},it.id))]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"reservation_id",children:o("tasks.reservationId")}),jsxRuntimeExports.jsx("input",{type:"text",id:"reservation_id",name:"reservation_id",value:_e.reservation_id,onChange:nt,className:"form-control",placeholder:o("tasks.reservationIdPlaceholder")})]}),jsxRuntimeExports.jsxs("div",{className:"form-group full-width",children:[jsxRuntimeExports.jsx("label",{htmlFor:"description",children:o("tasks.description")}),jsxRuntimeExports.jsx("textarea",{id:"description",name:"description",value:_e.description,onChange:nt,className:"form-control",rows:3,placeholder:o("tasks.descriptionPlaceholder")})]})]}),jsxRuntimeExports.jsxs("div",{className:"modal-footer",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",disabled:d,children:o("common.cancel")}),jsxRuntimeExports.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d||!_e.title||!_e.listing_id||!_e.scheduled_datetime,children:o(d?"common.creating":"tasks.createTask")})]})]})]})}):null};function AdminTaskView(){const{t:s}=useTranslation(),[e,i]=reactExports.useState(!1),{tasks:o,loading:a,error:c,totalCount:d,pagination:h,sorting:g,globalFilter:_,handleServerSideChange:j,updateTaskAssignment:b,refetchTasks:$}=useTaskTable(!1),{getAdminColumns:et}=useTranslatedColumns(),_e=reactExports.useMemo(()=>et(b),[et,b]);return jsxRuntimeExports.jsxs("div",{className:"admin-reservations",children:[jsxRuntimeExports.jsx("div",{className:"admin-header",children:jsxRuntimeExports.jsxs("div",{className:"admin-header-content",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"admin-title",children:s("tasks.management")}),jsxRuntimeExports.jsx("p",{className:"admin-stats",children:a?s("tasks.loading"):s("tasks.totalTasks",{count:d})})]}),jsxRuntimeExports.jsx("button",{onClick:()=>i(!0),className:"btn btn-primary",children:s("tasks.createTask")})]})}),jsxRuntimeExports.jsx(DataTable,{data:o,columns:_e,loading:a,error:c,serverSide:!0,onServerSideChange:j,totalCount:d,pageSize:h.pageSize,pageIndex:h.pageIndex,sorting:g,globalFilter:_,className:"tasks-data-table"}),jsxRuntimeExports.jsx(CreateTaskModal,{isOpen:e,onClose:()=>i(!1),onTaskCreated:$})]})}const PRODUCTS=["Vinagre","Oxigeno activo","CIF","Multiusos Verde (Limpiacristales)","Soda Caustica/Desatascador","Papel Cocina","Agua oxigenada","Lejia blanqueadora","Detergente Blanqueador Oxi Active","Perfume Spray (perfumador diluido)","Ambientador palitos","Bolsas de basura amarillas","Balletas finitas","Balletas gorditas","Cafe capsulas","Detergente vajilla manos","Esponjas cocina","Sal lavavajillas","Pastillas lavavajillas","Servilletas","Jabon de manos recargable","Bolsas basura bao","Detergente ropa","Suavizante ropa","Papel Higienico","Shampoo","Acondicionador","Botella para Shampoo","Botella para Acondicionador","Cubo","Escurridor","Mopa","Fregona","Escoba","Recogedor (palita)","Palo escoba/fregona/mopa","Guantes","Pinzas de ropa","Fibrn Indeleble","Lapicero","Cinta transparente","Cinta de pintor","Pegamento","Silicona para juntas","Cenicero","Vasos","Cubiertos","Platos grandes","Platos chicos","Bowls","Esponja de alambre/acero","Esponja magica paredes","Agua","Insecticida hormigas y cucarachas","Bajera Grande","Funda Edredon Grande","Funda Almohada","Bajera Pequea","Funda Edredon Pequea","Manta playa","Felpudo bao","Mantel","Repasadores (toalla cocina)"],searchProducts=(s,e=10)=>{if(!s||s.length<2)return[];const i=s.toLowerCase();return PRODUCTS.filter(o=>o.toLowerCase().includes(i)).slice(0,e)},PRODUCT_CATEGORIES={general:{name:"General",products:["Vinagre","Oxigeno activo","CIF","Multiusos Verde (Limpiacristales)","Soda Caustica/Desatascador","Papel Cocina"]},lavado_ropa:{name:"Lavado Ropa",products:["Agua oxigenada","Lejia blanqueadora","Detergente Blanqueador Oxi Active","Perfume Spray (perfumador diluido)"]},reposicion:{name:"Reposicin",products:["Ambientador palitos","Bolsas de basura amarillas","Balletas finitas","Balletas gorditas","Cafe capsulas","Detergente vajilla manos","Esponjas cocina","Sal lavavajillas","Pastillas lavavajillas","Servilletas"]},reposicion_bano:{name:"Reposicin Bao",products:["Jabon de manos recargable","Bolsas basura bao","Detergente ropa","Suavizante ropa","Papel Higienico","Shampoo","Acondicionador","Botella para Shampoo","Botella para Acondicionador"]},materiales_limpieza:{name:"Materiales Limpieza",products:["Cubo","Escurridor","Mopa","Fregona","Escoba","Recogedor (palita)","Palo escoba/fregona/mopa","Guantes","Pinzas de ropa"]},otros:{name:"Otros",products:["Fibrn Indeleble","Lapicero","Cinta transparente","Cinta de pintor","Pegamento","Silicona para juntas","Cenicero","Vasos","Cubiertos","Platos grandes","Platos chicos","Bowls","Esponja de alambre/acero","Esponja magica paredes","Agua","Insecticida hormigas y cucarachas"]},sabanas:{name:"Sbanas",products:["Bajera Grande","Funda Edredon Grande","Funda Almohada","Bajera Pequea","Funda Edredon Pequea","Manta playa","Felpudo bao","Mantel","Repasadores (toalla cocina)"]}};function TodoForm({onTodoCreated:s,onCancel:e,attachedToType:i=null,attachedToId:o=null,title:a="Create New TODO"}){const{t:c}=useTranslation(),{user:d}=useAuth(),{listingService:h,todoService:g}=useServices(),[_,j]=reactExports.useState({title:"",description:""}),[b,$]=reactExports.useState(""),[et,_e]=reactExports.useState([]),[st,ot]=reactExports.useState([]),[tt,nt]=reactExports.useState([]),[rt,it]=reactExports.useState(o||""),[lt,at]=reactExports.useState(!1),[ut,ct]=reactExports.useState(!1),[ht,dt]=reactExports.useState(null);reactExports.useEffect(()=>{(async()=>{try{at(!0);const ft=await h.getListingsForSelection();nt(ft)}catch(ft){console.error("Error fetching listings:",ft),dt(c("todos.failedToLoad"))}finally{at(!1)}})()},[h,c]),reactExports.useEffect(()=>{if(b.length>=2){const _t=searchProducts(b,8);_e(_t)}else _e([])},[b]);const pt=_t=>{const{name:ft,value:mt}=_t.target;j(xt=>({...xt,[ft]:mt}))},gt=_t=>{it(_t.target.value)},yt=_t=>{const ft=st.find(mt=>mt.product_name===_t);ot(ft?mt=>mt.map(xt=>xt.product_name===_t?{...xt,quantity:xt.quantity+1}:xt):mt=>[...mt,{product_name:_t,quantity:1}]),$(""),_e([])},jt=(_t,ft)=>{const mt=parseInt(ft);mt<=0?Tt(_t):ot(xt=>xt.map(Et=>Et.product_name===_t?{...Et,quantity:mt}:Et))},Tt=_t=>{ot(ft=>ft.filter(mt=>mt.product_name!==_t))},Ct=async _t=>{if(_t.preventDefault(),!!d){ct(!0),dt(null);try{const ft={created_by:d.id,title:_.title,description:_.description||null,products:st.length>0?st:null,attached_to_type:rt?"listing":i,attached_to_id:rt||o};await g.createTodo(ft),s==null||s()}catch(ft){console.error("Error creating todo:",ft),dt(ft instanceof Error?ft.message:c("notes.errorOccurred"))}finally{ct(!1)}}};return jsxRuntimeExports.jsxs("div",{className:"todo-form",children:[jsxRuntimeExports.jsxs("div",{className:"todo-form-header",children:[jsxRuntimeExports.jsx("h3",{children:a}),jsxRuntimeExports.jsx("button",{type:"button",onClick:e,className:"btn-close",children:""})]}),ht&&jsxRuntimeExports.jsx("div",{className:"error-message",children:ht}),jsxRuntimeExports.jsxs("form",{onSubmit:Ct,className:"todo-form-content",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"title",children:c("todos.title")}),jsxRuntimeExports.jsx("input",{type:"text",id:"title",name:"title",value:_.title,onChange:pt,required:!0,placeholder:c("todos.titlePlaceholder"),className:"form-input"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"listing",children:c("todos.assignToListing")}),jsxRuntimeExports.jsxs("select",{id:"listing",name:"listing",value:rt,onChange:gt,className:"form-select",disabled:lt,children:[jsxRuntimeExports.jsx("option",{value:"",children:c("todos.noListingAssignment")}),tt.map(_t=>{var ft;return jsxRuntimeExports.jsxs("option",{value:_t.id,children:[_t.id," -"," ",((ft=_t.airbnb_payload)==null?void 0:ft.formattedAddress)||c("forms.noAddress")]},_t.id)})]}),lt&&jsxRuntimeExports.jsx("small",{children:c("todos.loadingListings")})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"product_search",children:c("todos.products")}),jsxRuntimeExports.jsxs("div",{className:"product-search-container",children:[jsxRuntimeExports.jsx("input",{type:"text",id:"product_search",value:b,onChange:_t=>$(_t.target.value),placeholder:c("todos.searchProductsPlaceholder"),className:"form-input"}),et.length>0&&jsxRuntimeExports.jsx("div",{className:"search-results",children:et.map((_t,ft)=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>yt(_t),className:"search-result-item",children:_t},ft))})]}),st.length>0&&jsxRuntimeExports.jsxs("div",{className:"selected-products",children:[jsxRuntimeExports.jsx("h4",{children:c("todos.selectedProducts")}),st.map((_t,ft)=>jsxRuntimeExports.jsxs("div",{className:"selected-product",children:[jsxRuntimeExports.jsx("span",{className:"product-name",children:_t.product_name}),jsxRuntimeExports.jsxs("div",{className:"product-controls",children:[jsxRuntimeExports.jsx("input",{type:"number",min:"1",value:_t.quantity,onChange:mt=>jt(_t.product_name,mt.target.value),className:"quantity-input"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>Tt(_t.product_name),className:"btn-remove",children:c("todos.remove")})]})]},ft))]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"description",children:c("todos.description")}),jsxRuntimeExports.jsx("textarea",{id:"description",name:"description",value:_.description,onChange:pt,rows:3,placeholder:c("todos.detailsPlaceholder"),className:"form-textarea"})]}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:e,className:"btn-secondary",children:c("todos.cancel")}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:ut,className:"btn-primary",children:ut?c("todos.creating"):a})]})]})]})}function AdminTodosView(){const{t:s}=useTranslation(),{isAdmin:e}=useAuth(),{userService:i,todoService:o}=useServices(),[a,c]=reactExports.useState([]),[d,h]=reactExports.useState(!0),[g,_]=reactExports.useState(null),[j,b]=reactExports.useState(!1),[$,et]=reactExports.useState("all"),_e=reactExports.useCallback(async()=>{try{h(!0),_(null);let lt=await o.fetchTodos()||[];$==="done"?lt=lt.filter(at=>at.done):$==="pending"&&(lt=lt.filter(at=>!at.done)),c(lt)}catch(it){console.error("Error fetching todos:",it),_(it instanceof Error?it.message:String(it))}finally{h(!1)}},[$,o]);reactExports.useEffect(()=>{_e()},[_e]);const st=()=>{b(!1),_e()},ot=async(it,lt)=>{try{const at=await i.getCurrentUser(),ut=at==null?void 0:at.id;await o.updateTodoStatus(it,lt,ut),_e()}catch(at){console.error("Error updating todo status:",at),_(at instanceof Error?at.message:String(at))}},tt=async it=>{if(confirm(s("todos.deleteConfirm")))try{await o.deleteTodo(it),_e()}catch(lt){console.error("Error deleting todo:",lt),_(lt instanceof Error?lt.message:String(lt))}},nt=it=>it?"#10b981":"#6b7280",rt=[{accessorKey:"title",header:s("columns.title"),cell:({getValue:it})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:it()})},{accessorKey:"done",header:s("columns.status"),cell:({getValue:it,row:lt})=>{const at=it();return jsxRuntimeExports.jsxs("label",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:at,onChange:ut=>ot(lt.original.id,ut.target.checked),className:"rounded"}),jsxRuntimeExports.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold text-white",style:{backgroundColor:nt(at)},children:s(at?"todos.done":"todos.pending")})]})}},{accessorKey:"attached_to_type",header:s("todos.attachedTo"),cell:({getValue:it,row:lt})=>{const at=it(),ut=lt.original.attached_to_id;return at?jsxRuntimeExports.jsxs("span",{className:"text-sm",children:[at,": ",ut]}):jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:s("todos.unattached")})}},{accessorKey:"created_at",header:s("columns.created"),cell:({getValue:it})=>jsxRuntimeExports.jsx("span",{className:"text-sm",children:new Date(it()).toLocaleDateString()})},{id:"actions",header:s("columns.actions"),cell:({row:it})=>jsxRuntimeExports.jsx("button",{onClick:()=>tt(it.original.id),className:"px-2 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600",children:s("todos.delete")})}];return e?jsxRuntimeExports.jsxs("div",{className:"admin-todos",children:[jsxRuntimeExports.jsxs("div",{className:"admin-header",children:[jsxRuntimeExports.jsx("h1",{className:"admin-title",children:s("todos.allTodos")}),jsxRuntimeExports.jsx("p",{className:"admin-stats",children:d?s("todos.loadingTodos"):s("todos.totalTodos",{count:a.length})})]}),jsxRuntimeExports.jsxs("div",{className:"admin-controls",children:[jsxRuntimeExports.jsxs("div",{className:"filter-controls",children:[jsxRuntimeExports.jsx("label",{htmlFor:"status-filter",children:s("todos.filterByStatus")}),jsxRuntimeExports.jsxs("select",{id:"status-filter",value:$,onChange:it=>et(it.target.value),className:"form-select",children:[jsxRuntimeExports.jsx("option",{value:"all",children:s("todos.all")}),jsxRuntimeExports.jsx("option",{value:"pending",children:s("todos.pending")}),jsxRuntimeExports.jsx("option",{value:"done",children:s("todos.done")})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>b(!0),className:"btn-primary",children:s("todos.createGeneral")})]}),g&&jsxRuntimeExports.jsx("div",{className:"error-message",children:g}),j&&jsxRuntimeExports.jsx("div",{className:"todo-form-overlay",children:jsxRuntimeExports.jsx(TodoForm,{title:s("todos.createGeneral"),onTodoCreated:st,onCancel:()=>b(!1)})}),jsxRuntimeExports.jsx(DataTable,{data:a,columns:rt,loading:d,error:g,enablePagination:!0,className:"todos-data-table"})]}):jsxRuntimeExports.jsx("div",{className:"admin-todos",children:jsxRuntimeExports.jsx("div",{className:"error-message",children:s("todos.adminAccessRequired")})})}var parser$5={};parser$5.load=function(s,e,i={}){var o,a,c;for(o in e)c=e[o],i[o]=(a=s[o])!=null?a:c;return i};parser$5.overwrite=function(s,e,i={}){var o,a;for(o in s)a=s[o],e[o]!==void 0&&(i[o]=a);return i};var DLList$2;DLList$2=class{constructor(e,i){this.incr=e,this.decr=i,this._first=null,this._last=null,this.length=0}push(e){var i;this.length++,typeof this.incr=="function"&&this.incr(),i={value:e,prev:this._last,next:null},this._last!=null?(this._last.next=i,this._last=i):this._first=this._last=i}shift(){var e;if(this._first!=null)return this.length--,typeof this.decr=="function"&&this.decr(),e=this._first.value,(this._first=this._first.next)!=null?this._first.prev=null:this._last=null,e}first(){if(this._first!=null)return this._first.value}getArray(){var e,i,o;for(e=this._first,o=[];e!=null;)o.push((i=e,e=e.next,i.value));return o}forEachShift(e){var i;for(i=this.shift();i!=null;)e(i),i=this.shift()}debug(){var e,i,o,a,c;for(e=this._first,c=[];e!=null;)c.push((i=e,e=e.next,{value:i.value,prev:(o=i.prev)!=null?o.value:void 0,next:(a=i.next)!=null?a.value:void 0}));return c}};var DLList_1=DLList$2;function asyncGeneratorStep$6(s,e,i,o,a,c,d){try{var h=s[c](d),g=h.value}catch(_){i(_);return}h.done?e(g):Promise.resolve(g).then(o,a)}function _asyncToGenerator$6(s){return function(){var e=this,i=arguments;return new Promise(function(o,a){var c=s.apply(e,i);function d(g){asyncGeneratorStep$6(c,o,a,d,h,"next",g)}function h(g){asyncGeneratorStep$6(c,o,a,d,h,"throw",g)}d(void 0)})}}var Events$3;Events$3=class{constructor(e){if(this.instance=e,this._events={},this.instance.on!=null||this.instance.once!=null||this.instance.removeAllListeners!=null)throw new Error("An Emitter already exists for this object");this.instance.on=(i,o)=>this._addListener(i,"many",o),this.instance.once=(i,o)=>this._addListener(i,"once",o),this.instance.removeAllListeners=(i=null)=>i!=null?delete this._events[i]:this._events={}}_addListener(e,i,o){var a;return(a=this._events)[e]==null&&(a[e]=[]),this._events[e].push({cb:o,status:i}),this.instance}listenerCount(e){return this._events[e]!=null?this._events[e].length:0}trigger(e,...i){var o=this;return _asyncToGenerator$6(function*(){var a,c;try{return e!=="debug"&&o.trigger("debug",`Event triggered: ${e}`,i),o._events[e]==null?void 0:(o._events[e]=o._events[e].filter(function(d){return d.status!=="none"}),c=o._events[e].map(function(){var d=_asyncToGenerator$6(function*(h){var g,_;if(h.status!=="none"){h.status==="once"&&(h.status="none");try{return _=typeof h.cb=="function"?h.cb(...i):void 0,typeof(_!=null?_.then:void 0)=="function"?yield _:_}catch(j){return g=j,o.trigger("error",g),null}}});return function(h){return d.apply(this,arguments)}}()),(yield Promise.all(c)).find(function(d){return d!=null}))}catch(d){return a=d,o.trigger("error",a),null}})()}};var Events_1=Events$3,DLList$1,Events$2,Queues;DLList$1=DLList_1;Events$2=Events_1;Queues=class{constructor(e){this.Events=new Events$2(this),this._length=0,this._lists=(function(){var i,o,a;for(a=[],i=1,o=e;1<=o?i<=o:i>=o;1<=o?++i:--i)a.push(new DLList$1(()=>this.incr(),()=>this.decr()));return a}).call(this)}incr(){if(this._length++===0)return this.Events.trigger("leftzero")}decr(){if(--this._length===0)return this.Events.trigger("zero")}push(e){return this._lists[e.options.priority].push(e)}queued(e){return e!=null?this._lists[e].length:this._length}shiftAll(e){return this._lists.forEach(function(i){return i.forEachShift(e)})}getFirst(e=this._lists){var i,o,a;for(i=0,o=e.length;i<o;i++)if(a=e[i],a.length>0)return a;return[]}shiftLastFrom(e){return this.getFirst(this._lists.slice(e).reverse()).shift()}};var Queues_1=Queues,BottleneckError$4;BottleneckError$4=class extends Error{};var BottleneckError_1=BottleneckError$4;function asyncGeneratorStep$5(s,e,i,o,a,c,d){try{var h=s[c](d),g=h.value}catch(_){i(_);return}h.done?e(g):Promise.resolve(g).then(o,a)}function _asyncToGenerator$5(s){return function(){var e=this,i=arguments;return new Promise(function(o,a){var c=s.apply(e,i);function d(g){asyncGeneratorStep$5(c,o,a,d,h,"next",g)}function h(g){asyncGeneratorStep$5(c,o,a,d,h,"throw",g)}d(void 0)})}}var BottleneckError$3,DEFAULT_PRIORITY,Job,NUM_PRIORITIES,parser$4;NUM_PRIORITIES=10;DEFAULT_PRIORITY=5;parser$4=parser$5;BottleneckError$3=BottleneckError_1;Job=class{constructor(e,i,o,a,c,d,h,g){this.task=e,this.args=i,this.rejectOnDrop=c,this.Events=d,this._states=h,this.Promise=g,this.options=parser$4.load(o,a),this.options.priority=this._sanitizePriority(this.options.priority),this.options.id===a.id&&(this.options.id=`${this.options.id}-${this._randomIndex()}`),this.promise=new this.Promise((_,j)=>{this._resolve=_,this._reject=j}),this.retryCount=0}_sanitizePriority(e){var i;return i=~~e!==e?DEFAULT_PRIORITY:e,i<0?0:i>NUM_PRIORITIES-1?NUM_PRIORITIES-1:i}_randomIndex(){return Math.random().toString(36).slice(2)}doDrop({error:e,message:i="This job has been dropped by Bottleneck"}={}){return this._states.remove(this.options.id)?(this.rejectOnDrop&&this._reject(e??new BottleneckError$3(i)),this.Events.trigger("dropped",{args:this.args,options:this.options,task:this.task,promise:this.promise}),!0):!1}_assertStatus(e){var i;if(i=this._states.jobStatus(this.options.id),!(i===e||e==="DONE"&&i===null))throw new BottleneckError$3(`Invalid job status ${i}, expected ${e}. Please open an issue at https://github.com/SGrondin/bottleneck/issues`)}doReceive(){return this._states.start(this.options.id),this.Events.trigger("received",{args:this.args,options:this.options})}doQueue(e,i){return this._assertStatus("RECEIVED"),this._states.next(this.options.id),this.Events.trigger("queued",{args:this.args,options:this.options,reachedHWM:e,blocked:i})}doRun(){return this.retryCount===0?(this._assertStatus("QUEUED"),this._states.next(this.options.id)):this._assertStatus("EXECUTING"),this.Events.trigger("scheduled",{args:this.args,options:this.options})}doExecute(e,i,o,a){var c=this;return _asyncToGenerator$5(function*(){var d,h,g;c.retryCount===0?(c._assertStatus("RUNNING"),c._states.next(c.options.id)):c._assertStatus("EXECUTING"),h={args:c.args,options:c.options,retryCount:c.retryCount},c.Events.trigger("executing",h);try{if(g=yield e!=null?e.schedule(c.options,c.task,...c.args):c.task(...c.args),i())return c.doDone(h),yield a(c.options,h),c._assertStatus("DONE"),c._resolve(g)}catch(_){return d=_,c._onFailure(d,h,i,o,a)}})()}doExpire(e,i,o){var a,c;return this._states.jobStatus(this.options.id==="RUNNING")&&this._states.next(this.options.id),this._assertStatus("EXECUTING"),c={args:this.args,options:this.options,retryCount:this.retryCount},a=new BottleneckError$3(`This job timed out after ${this.options.expiration} ms.`),this._onFailure(a,c,e,i,o)}_onFailure(e,i,o,a,c){var d=this;return _asyncToGenerator$5(function*(){var h,g;if(o())return h=yield d.Events.trigger("failed",e,i),h!=null?(g=~~h,d.Events.trigger("retry",`Retrying ${d.options.id} after ${g} ms`,i),d.retryCount++,a(g)):(d.doDone(i),yield c(d.options,i),d._assertStatus("DONE"),d._reject(e))})()}doDone(e){return this._assertStatus("EXECUTING"),this._states.next(this.options.id),this.Events.trigger("done",e)}};var Job_1=Job;function asyncGeneratorStep$4(s,e,i,o,a,c,d){try{var h=s[c](d),g=h.value}catch(_){i(_);return}h.done?e(g):Promise.resolve(g).then(o,a)}function _asyncToGenerator$4(s){return function(){var e=this,i=arguments;return new Promise(function(o,a){var c=s.apply(e,i);function d(g){asyncGeneratorStep$4(c,o,a,d,h,"next",g)}function h(g){asyncGeneratorStep$4(c,o,a,d,h,"throw",g)}d(void 0)})}}var BottleneckError$2,LocalDatastore,parser$3;parser$3=parser$5;BottleneckError$2=BottleneckError_1;LocalDatastore=class{constructor(e,i,o){this.instance=e,this.storeOptions=i,this.clientId=this.instance._randomIndex(),parser$3.load(o,o,this),this._nextRequest=this._lastReservoirRefresh=this._lastReservoirIncrease=Date.now(),this._running=0,this._done=0,this._unblockTime=0,this.ready=this.Promise.resolve(),this.clients={},this._startHeartbeat()}_startHeartbeat(){var e;return this.heartbeat==null&&(this.storeOptions.reservoirRefreshInterval!=null&&this.storeOptions.reservoirRefreshAmount!=null||this.storeOptions.reservoirIncreaseInterval!=null&&this.storeOptions.reservoirIncreaseAmount!=null)?typeof(e=this.heartbeat=setInterval(()=>{var i,o,a,c,d;if(c=Date.now(),this.storeOptions.reservoirRefreshInterval!=null&&c>=this._lastReservoirRefresh+this.storeOptions.reservoirRefreshInterval&&(this._lastReservoirRefresh=c,this.storeOptions.reservoir=this.storeOptions.reservoirRefreshAmount,this.instance._drainAll(this.computeCapacity())),this.storeOptions.reservoirIncreaseInterval!=null&&c>=this._lastReservoirIncrease+this.storeOptions.reservoirIncreaseInterval){var h=this.storeOptions;if(i=h.reservoirIncreaseAmount,a=h.reservoirIncreaseMaximum,d=h.reservoir,this._lastReservoirIncrease=c,o=a!=null?Math.min(i,a-d):i,o>0)return this.storeOptions.reservoir+=o,this.instance._drainAll(this.computeCapacity())}},this.heartbeatInterval)).unref=="function"?e.unref():void 0:clearInterval(this.heartbeat)}__publish__(e){var i=this;return _asyncToGenerator$4(function*(){return yield i.yieldLoop(),i.instance.Events.trigger("message",e.toString())})()}__disconnect__(e){var i=this;return _asyncToGenerator$4(function*(){return yield i.yieldLoop(),clearInterval(i.heartbeat),i.Promise.resolve()})()}yieldLoop(e=0){return new this.Promise(function(i,o){return setTimeout(i,e)})}computePenalty(){var e;return(e=this.storeOptions.penalty)!=null?e:15*this.storeOptions.minTime||5e3}__updateSettings__(e){var i=this;return _asyncToGenerator$4(function*(){return yield i.yieldLoop(),parser$3.overwrite(e,e,i.storeOptions),i._startHeartbeat(),i.instance._drainAll(i.computeCapacity()),!0})()}__running__(){var e=this;return _asyncToGenerator$4(function*(){return yield e.yieldLoop(),e._running})()}__queued__(){var e=this;return _asyncToGenerator$4(function*(){return yield e.yieldLoop(),e.instance.queued()})()}__done__(){var e=this;return _asyncToGenerator$4(function*(){return yield e.yieldLoop(),e._done})()}__groupCheck__(e){var i=this;return _asyncToGenerator$4(function*(){return yield i.yieldLoop(),i._nextRequest+i.timeout<e})()}computeCapacity(){var e,i,o=this.storeOptions;return e=o.maxConcurrent,i=o.reservoir,e!=null&&i!=null?Math.min(e-this._running,i):e!=null?e-this._running:i??null}conditionsCheck(e){var i;return i=this.computeCapacity(),i==null||e<=i}__incrementReservoir__(e){var i=this;return _asyncToGenerator$4(function*(){var o;return yield i.yieldLoop(),o=i.storeOptions.reservoir+=e,i.instance._drainAll(i.computeCapacity()),o})()}__currentReservoir__(){var e=this;return _asyncToGenerator$4(function*(){return yield e.yieldLoop(),e.storeOptions.reservoir})()}isBlocked(e){return this._unblockTime>=e}check(e,i){return this.conditionsCheck(e)&&this._nextRequest-i<=0}__check__(e){var i=this;return _asyncToGenerator$4(function*(){var o;return yield i.yieldLoop(),o=Date.now(),i.check(e,o)})()}__register__(e,i,o){var a=this;return _asyncToGenerator$4(function*(){var c,d;return yield a.yieldLoop(),c=Date.now(),a.conditionsCheck(i)?(a._running+=i,a.storeOptions.reservoir!=null&&(a.storeOptions.reservoir-=i),d=Math.max(a._nextRequest-c,0),a._nextRequest=c+d+a.storeOptions.minTime,{success:!0,wait:d,reservoir:a.storeOptions.reservoir}):{success:!1}})()}strategyIsBlock(){return this.storeOptions.strategy===3}__submit__(e,i){var o=this;return _asyncToGenerator$4(function*(){var a,c,d;if(yield o.yieldLoop(),o.storeOptions.maxConcurrent!=null&&i>o.storeOptions.maxConcurrent)throw new BottleneckError$2(`Impossible to add a job having a weight of ${i} to a limiter having a maxConcurrent setting of ${o.storeOptions.maxConcurrent}`);return c=Date.now(),d=o.storeOptions.highWater!=null&&e===o.storeOptions.highWater&&!o.check(i,c),a=o.strategyIsBlock()&&(d||o.isBlocked(c)),a&&(o._unblockTime=c+o.computePenalty(),o._nextRequest=o._unblockTime+o.storeOptions.minTime,o.instance._dropAllQueued()),{reachedHWM:d,blocked:a,strategy:o.storeOptions.strategy}})()}__free__(e,i){var o=this;return _asyncToGenerator$4(function*(){return yield o.yieldLoop(),o._running-=i,o._done+=i,o.instance._drainAll(o.computeCapacity()),{running:o._running}})()}};var LocalDatastore_1=LocalDatastore,Scripts$2={};const require$$0={"blacklist_client.lua":`local blacklist = ARGV[num_static_argv + 1]

if redis.call('zscore', client_last_seen_key, blacklist) then
  redis.call('zadd', client_last_seen_key, 0, blacklist)
end


return {}
`,"check.lua":`local weight = tonumber(ARGV[num_static_argv + 1])

local capacity = process_tick(now, false)['capacity']
local nextRequest = tonumber(redis.call('hget', settings_key, 'nextRequest'))

return conditions_check(capacity, weight) and nextRequest - now <= 0
`,"conditions_check.lua":`local conditions_check = function (capacity, weight)
  return capacity == nil or weight <= capacity
end
`,"current_reservoir.lua":`return process_tick(now, false)['reservoir']
`,"done.lua":`process_tick(now, false)

return tonumber(redis.call('hget', settings_key, 'done'))
`,"free.lua":`local index = ARGV[num_static_argv + 1]

redis.call('zadd', job_expirations_key, 0, index)

return process_tick(now, false)['running']
`,"get_time.lua":`redis.replicate_commands()

local get_time = function ()
  local time = redis.call('time')

  return tonumber(time[1]..string.sub(time[2], 1, 3))
end
`,"group_check.lua":`return not (redis.call('exists', settings_key) == 1)
`,"heartbeat.lua":`process_tick(now, true)
`,"increment_reservoir.lua":`local incr = tonumber(ARGV[num_static_argv + 1])

redis.call('hincrby', settings_key, 'reservoir', incr)

local reservoir = process_tick(now, true)['reservoir']

local groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))
refresh_expiration(0, 0, groupTimeout)

return reservoir
`,"init.lua":`local clear = tonumber(ARGV[num_static_argv + 1])
local limiter_version = ARGV[num_static_argv + 2]
local num_local_argv = num_static_argv + 2

if clear == 1 then
  redis.call('del', unpack(KEYS))
end

if redis.call('exists', settings_key) == 0 then
  -- Create
  local args = {'hmset', settings_key}

  for i = num_local_argv + 1, #ARGV do
    table.insert(args, ARGV[i])
  end

  redis.call(unpack(args))
  redis.call('hmset', settings_key,
    'nextRequest', now,
    'lastReservoirRefresh', now,
    'lastReservoirIncrease', now,
    'running', 0,
    'done', 0,
    'unblockTime', 0,
    'capacityPriorityCounter', 0
  )

else
  -- Apply migrations
  local settings = redis.call('hmget', settings_key,
    'id',
    'version'
  )
  local id = settings[1]
  local current_version = settings[2]

  if current_version ~= limiter_version then
    local version_digits = {}
    for k, v in string.gmatch(current_version, "([^.]+)") do
      table.insert(version_digits, tonumber(k))
    end

    -- 2.10.0
    if version_digits[2] < 10 then
      redis.call('hsetnx', settings_key, 'reservoirRefreshInterval', '')
      redis.call('hsetnx', settings_key, 'reservoirRefreshAmount', '')
      redis.call('hsetnx', settings_key, 'lastReservoirRefresh', '')
      redis.call('hsetnx', settings_key, 'done', 0)
      redis.call('hset', settings_key, 'version', '2.10.0')
    end

    -- 2.11.1
    if version_digits[2] < 11 or (version_digits[2] == 11 and version_digits[3] < 1) then
      if redis.call('hstrlen', settings_key, 'lastReservoirRefresh') == 0 then
        redis.call('hmset', settings_key,
          'lastReservoirRefresh', now,
          'version', '2.11.1'
        )
      end
    end

    -- 2.14.0
    if version_digits[2] < 14 then
      local old_running_key = 'b_'..id..'_running'
      local old_executing_key = 'b_'..id..'_executing'

      if redis.call('exists', old_running_key) == 1 then
        redis.call('rename', old_running_key, job_weights_key)
      end
      if redis.call('exists', old_executing_key) == 1 then
        redis.call('rename', old_executing_key, job_expirations_key)
      end
      redis.call('hset', settings_key, 'version', '2.14.0')
    end

    -- 2.15.2
    if version_digits[2] < 15 or (version_digits[2] == 15 and version_digits[3] < 2) then
      redis.call('hsetnx', settings_key, 'capacityPriorityCounter', 0)
      redis.call('hset', settings_key, 'version', '2.15.2')
    end

    -- 2.17.0
    if version_digits[2] < 17 then
      redis.call('hsetnx', settings_key, 'clientTimeout', 10000)
      redis.call('hset', settings_key, 'version', '2.17.0')
    end

    -- 2.18.0
    if version_digits[2] < 18 then
      redis.call('hsetnx', settings_key, 'reservoirIncreaseInterval', '')
      redis.call('hsetnx', settings_key, 'reservoirIncreaseAmount', '')
      redis.call('hsetnx', settings_key, 'reservoirIncreaseMaximum', '')
      redis.call('hsetnx', settings_key, 'lastReservoirIncrease', now)
      redis.call('hset', settings_key, 'version', '2.18.0')
    end

  end

  process_tick(now, false)
end

local groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))
refresh_expiration(0, 0, groupTimeout)

return {}
`,"process_tick.lua":`local process_tick = function (now, always_publish)

  local compute_capacity = function (maxConcurrent, running, reservoir)
    if maxConcurrent ~= nil and reservoir ~= nil then
      return math.min((maxConcurrent - running), reservoir)
    elseif maxConcurrent ~= nil then
      return maxConcurrent - running
    elseif reservoir ~= nil then
      return reservoir
    else
      return nil
    end
  end

  local settings = redis.call('hmget', settings_key,
    'id',
    'maxConcurrent',
    'running',
    'reservoir',
    'reservoirRefreshInterval',
    'reservoirRefreshAmount',
    'lastReservoirRefresh',
    'reservoirIncreaseInterval',
    'reservoirIncreaseAmount',
    'reservoirIncreaseMaximum',
    'lastReservoirIncrease',
    'capacityPriorityCounter',
    'clientTimeout'
  )
  local id = settings[1]
  local maxConcurrent = tonumber(settings[2])
  local running = tonumber(settings[3])
  local reservoir = tonumber(settings[4])
  local reservoirRefreshInterval = tonumber(settings[5])
  local reservoirRefreshAmount = tonumber(settings[6])
  local lastReservoirRefresh = tonumber(settings[7])
  local reservoirIncreaseInterval = tonumber(settings[8])
  local reservoirIncreaseAmount = tonumber(settings[9])
  local reservoirIncreaseMaximum = tonumber(settings[10])
  local lastReservoirIncrease = tonumber(settings[11])
  local capacityPriorityCounter = tonumber(settings[12])
  local clientTimeout = tonumber(settings[13])

  local initial_capacity = compute_capacity(maxConcurrent, running, reservoir)

  --
  -- Process 'running' changes
  --
  local expired = redis.call('zrangebyscore', job_expirations_key, '-inf', '('..now)

  if #expired > 0 then
    redis.call('zremrangebyscore', job_expirations_key, '-inf', '('..now)

    local flush_batch = function (batch, acc)
      local weights = redis.call('hmget', job_weights_key, unpack(batch))
                      redis.call('hdel',  job_weights_key, unpack(batch))
      local clients = redis.call('hmget', job_clients_key, unpack(batch))
                      redis.call('hdel',  job_clients_key, unpack(batch))

      -- Calculate sum of removed weights
      for i = 1, #weights do
        acc['total'] = acc['total'] + (tonumber(weights[i]) or 0)
      end

      -- Calculate sum of removed weights by client
      local client_weights = {}
      for i = 1, #clients do
        local removed = tonumber(weights[i]) or 0
        if removed > 0 then
          acc['client_weights'][clients[i]] = (acc['client_weights'][clients[i]] or 0) + removed
        end
      end
    end

    local acc = {
      ['total'] = 0,
      ['client_weights'] = {}
    }
    local batch_size = 1000

    -- Compute changes to Zsets and apply changes to Hashes
    for i = 1, #expired, batch_size do
      local batch = {}
      for j = i, math.min(i + batch_size - 1, #expired) do
        table.insert(batch, expired[j])
      end

      flush_batch(batch, acc)
    end

    -- Apply changes to Zsets
    if acc['total'] > 0 then
      redis.call('hincrby', settings_key, 'done', acc['total'])
      running = tonumber(redis.call('hincrby', settings_key, 'running', -acc['total']))
    end

    for client, weight in pairs(acc['client_weights']) do
      redis.call('zincrby', client_running_key, -weight, client)
    end
  end

  --
  -- Process 'reservoir' changes
  --
  local reservoirRefreshActive = reservoirRefreshInterval ~= nil and reservoirRefreshAmount ~= nil
  if reservoirRefreshActive and now >= lastReservoirRefresh + reservoirRefreshInterval then
    reservoir = reservoirRefreshAmount
    redis.call('hmset', settings_key,
      'reservoir', reservoir,
      'lastReservoirRefresh', now
    )
  end

  local reservoirIncreaseActive = reservoirIncreaseInterval ~= nil and reservoirIncreaseAmount ~= nil
  if reservoirIncreaseActive and now >= lastReservoirIncrease + reservoirIncreaseInterval then
    local num_intervals = math.floor((now - lastReservoirIncrease) / reservoirIncreaseInterval)
    local incr = reservoirIncreaseAmount * num_intervals
    if reservoirIncreaseMaximum ~= nil then
      incr = math.min(incr, reservoirIncreaseMaximum - (reservoir or 0))
    end
    if incr > 0 then
      reservoir = (reservoir or 0) + incr
    end
    redis.call('hmset', settings_key,
      'reservoir', reservoir,
      'lastReservoirIncrease', lastReservoirIncrease + (num_intervals * reservoirIncreaseInterval)
    )
  end

  --
  -- Clear unresponsive clients
  --
  local unresponsive = redis.call('zrangebyscore', client_last_seen_key, '-inf', (now - clientTimeout))
  local unresponsive_lookup = {}
  local terminated_clients = {}
  for i = 1, #unresponsive do
    unresponsive_lookup[unresponsive[i]] = true
    if tonumber(redis.call('zscore', client_running_key, unresponsive[i])) == 0 then
      table.insert(terminated_clients, unresponsive[i])
    end
  end
  if #terminated_clients > 0 then
    redis.call('zrem', client_running_key,         unpack(terminated_clients))
    redis.call('hdel', client_num_queued_key,      unpack(terminated_clients))
    redis.call('zrem', client_last_registered_key, unpack(terminated_clients))
    redis.call('zrem', client_last_seen_key,       unpack(terminated_clients))
  end

  --
  -- Broadcast capacity changes
  --
  local final_capacity = compute_capacity(maxConcurrent, running, reservoir)

  if always_publish or (initial_capacity ~= nil and final_capacity == nil) then
    -- always_publish or was not unlimited, now unlimited
    redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))

  elseif initial_capacity ~= nil and final_capacity ~= nil and final_capacity > initial_capacity then
    -- capacity was increased
    -- send the capacity message to the limiter having the lowest number of running jobs
    -- the tiebreaker is the limiter having not registered a job in the longest time

    local lowest_concurrency_value = nil
    local lowest_concurrency_clients = {}
    local lowest_concurrency_last_registered = {}
    local client_concurrencies = redis.call('zrange', client_running_key, 0, -1, 'withscores')

    for i = 1, #client_concurrencies, 2 do
      local client = client_concurrencies[i]
      local concurrency = tonumber(client_concurrencies[i+1])

      if (
        lowest_concurrency_value == nil or lowest_concurrency_value == concurrency
      ) and (
        not unresponsive_lookup[client]
      ) and (
        tonumber(redis.call('hget', client_num_queued_key, client)) > 0
      ) then
        lowest_concurrency_value = concurrency
        table.insert(lowest_concurrency_clients, client)
        local last_registered = tonumber(redis.call('zscore', client_last_registered_key, client))
        table.insert(lowest_concurrency_last_registered, last_registered)
      end
    end

    if #lowest_concurrency_clients > 0 then
      local position = 1
      local earliest = lowest_concurrency_last_registered[1]

      for i,v in ipairs(lowest_concurrency_last_registered) do
        if v < earliest then
          position = i
          earliest = v
        end
      end

      local next_client = lowest_concurrency_clients[position]
      redis.call('publish', 'b_'..id,
        'capacity-priority:'..(final_capacity or '')..
        ':'..next_client..
        ':'..capacityPriorityCounter
      )
      redis.call('hincrby', settings_key, 'capacityPriorityCounter', '1')
    else
      redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))
    end
  end

  return {
    ['capacity'] = final_capacity,
    ['running'] = running,
    ['reservoir'] = reservoir
  }
end
`,"queued.lua":`local clientTimeout = tonumber(redis.call('hget', settings_key, 'clientTimeout'))
local valid_clients = redis.call('zrangebyscore', client_last_seen_key, (now - clientTimeout), 'inf')
local client_queued = redis.call('hmget', client_num_queued_key, unpack(valid_clients))

local sum = 0
for i = 1, #client_queued do
  sum = sum + tonumber(client_queued[i])
end

return sum
`,"refresh_expiration.lua":`local refresh_expiration = function (now, nextRequest, groupTimeout)

  if groupTimeout ~= nil then
    local ttl = (nextRequest + groupTimeout) - now

    for i = 1, #KEYS do
      redis.call('pexpire', KEYS[i], ttl)
    end
  end

end
`,"refs.lua":`local settings_key = KEYS[1]
local job_weights_key = KEYS[2]
local job_expirations_key = KEYS[3]
local job_clients_key = KEYS[4]
local client_running_key = KEYS[5]
local client_num_queued_key = KEYS[6]
local client_last_registered_key = KEYS[7]
local client_last_seen_key = KEYS[8]

local now = tonumber(ARGV[1])
local client = ARGV[2]

local num_static_argv = 2
`,"register.lua":`local index = ARGV[num_static_argv + 1]
local weight = tonumber(ARGV[num_static_argv + 2])
local expiration = tonumber(ARGV[num_static_argv + 3])

local state = process_tick(now, false)
local capacity = state['capacity']
local reservoir = state['reservoir']

local settings = redis.call('hmget', settings_key,
  'nextRequest',
  'minTime',
  'groupTimeout'
)
local nextRequest = tonumber(settings[1])
local minTime = tonumber(settings[2])
local groupTimeout = tonumber(settings[3])

if conditions_check(capacity, weight) then

  redis.call('hincrby', settings_key, 'running', weight)
  redis.call('hset', job_weights_key, index, weight)
  if expiration ~= nil then
    redis.call('zadd', job_expirations_key, now + expiration, index)
  end
  redis.call('hset', job_clients_key, index, client)
  redis.call('zincrby', client_running_key, weight, client)
  redis.call('hincrby', client_num_queued_key, client, -1)
  redis.call('zadd', client_last_registered_key, now, client)

  local wait = math.max(nextRequest - now, 0)
  local newNextRequest = now + wait + minTime

  if reservoir == nil then
    redis.call('hset', settings_key,
      'nextRequest', newNextRequest
    )
  else
    reservoir = reservoir - weight
    redis.call('hmset', settings_key,
      'reservoir', reservoir,
      'nextRequest', newNextRequest
    )
  end

  refresh_expiration(now, newNextRequest, groupTimeout)

  return {true, wait, reservoir}

else
  return {false}
end
`,"register_client.lua":`local queued = tonumber(ARGV[num_static_argv + 1])

-- Could have been re-registered concurrently
if not redis.call('zscore', client_last_seen_key, client) then
  redis.call('zadd', client_running_key, 0, client)
  redis.call('hset', client_num_queued_key, client, queued)
  redis.call('zadd', client_last_registered_key, 0, client)
end

redis.call('zadd', client_last_seen_key, now, client)

return {}
`,"running.lua":`return process_tick(now, false)['running']
`,"submit.lua":`local queueLength = tonumber(ARGV[num_static_argv + 1])
local weight = tonumber(ARGV[num_static_argv + 2])

local capacity = process_tick(now, false)['capacity']

local settings = redis.call('hmget', settings_key,
  'id',
  'maxConcurrent',
  'highWater',
  'nextRequest',
  'strategy',
  'unblockTime',
  'penalty',
  'minTime',
  'groupTimeout'
)
local id = settings[1]
local maxConcurrent = tonumber(settings[2])
local highWater = tonumber(settings[3])
local nextRequest = tonumber(settings[4])
local strategy = tonumber(settings[5])
local unblockTime = tonumber(settings[6])
local penalty = tonumber(settings[7])
local minTime = tonumber(settings[8])
local groupTimeout = tonumber(settings[9])

if maxConcurrent ~= nil and weight > maxConcurrent then
  return redis.error_reply('OVERWEIGHT:'..weight..':'..maxConcurrent)
end

local reachedHWM = (highWater ~= nil and queueLength == highWater
  and not (
    conditions_check(capacity, weight)
    and nextRequest - now <= 0
  )
)

local blocked = strategy == 3 and (reachedHWM or unblockTime >= now)

if blocked then
  local computedPenalty = penalty
  if computedPenalty == nil then
    if minTime == 0 then
      computedPenalty = 5000
    else
      computedPenalty = 15 * minTime
    end
  end

  local newNextRequest = now + computedPenalty + minTime

  redis.call('hmset', settings_key,
    'unblockTime', now + computedPenalty,
    'nextRequest', newNextRequest
  )

  local clients_queued_reset = redis.call('hkeys', client_num_queued_key)
  local queued_reset = {}
  for i = 1, #clients_queued_reset do
    table.insert(queued_reset, clients_queued_reset[i])
    table.insert(queued_reset, 0)
  end
  redis.call('hmset', client_num_queued_key, unpack(queued_reset))

  redis.call('publish', 'b_'..id, 'blocked:')

  refresh_expiration(now, newNextRequest, groupTimeout)
end

if not blocked and not reachedHWM then
  redis.call('hincrby', client_num_queued_key, client, 1)
end

return {reachedHWM, blocked, strategy}
`,"update_settings.lua":`local args = {'hmset', settings_key}

for i = num_static_argv + 1, #ARGV do
  table.insert(args, ARGV[i])
end

redis.call(unpack(args))

process_tick(now, true)

local groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))
refresh_expiration(0, 0, groupTimeout)

return {}
`,"validate_client.lua":`if not redis.call('zscore', client_last_seen_key, client) then
  return redis.error_reply('UNKNOWN_CLIENT')
end

redis.call('zadd', client_last_seen_key, now, client)
`,"validate_keys.lua":`if not (redis.call('exists', settings_key) == 1) then
  return redis.error_reply('SETTINGS_KEY_NOT_FOUND')
end
`};(function(s){var e,i,o;i=require$$0,e={refs:i["refs.lua"],validate_keys:i["validate_keys.lua"],validate_client:i["validate_client.lua"],refresh_expiration:i["refresh_expiration.lua"],process_tick:i["process_tick.lua"],conditions_check:i["conditions_check.lua"],get_time:i["get_time.lua"]},s.allKeys=function(a){return[`b_${a}_settings`,`b_${a}_job_weights`,`b_${a}_job_expirations`,`b_${a}_job_clients`,`b_${a}_client_running`,`b_${a}_client_num_queued`,`b_${a}_client_last_registered`,`b_${a}_client_last_seen`]},o={init:{keys:s.allKeys,headers:["process_tick"],refresh_expiration:!0,code:i["init.lua"]},group_check:{keys:s.allKeys,headers:[],refresh_expiration:!1,code:i["group_check.lua"]},register_client:{keys:s.allKeys,headers:["validate_keys"],refresh_expiration:!1,code:i["register_client.lua"]},blacklist_client:{keys:s.allKeys,headers:["validate_keys","validate_client"],refresh_expiration:!1,code:i["blacklist_client.lua"]},heartbeat:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:i["heartbeat.lua"]},update_settings:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:i["update_settings.lua"]},running:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:i["running.lua"]},queued:{keys:s.allKeys,headers:["validate_keys","validate_client"],refresh_expiration:!1,code:i["queued.lua"]},done:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:i["done.lua"]},check:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!1,code:i["check.lua"]},submit:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!0,code:i["submit.lua"]},register:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!0,code:i["register.lua"]},free:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:i["free.lua"]},current_reservoir:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:i["current_reservoir.lua"]},increment_reservoir:{keys:s.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:i["increment_reservoir.lua"]}},s.names=Object.keys(o),s.keys=function(a,c){return o[a].keys(c)},s.payload=function(a){var c;return c=o[a],Array.prototype.concat(e.refs,c.headers.map(function(d){return e[d]}),c.refresh_expiration?e.refresh_expiration:"",c.code).join(`
`)}})(Scripts$2);function asyncGeneratorStep$3(s,e,i,o,a,c,d){try{var h=s[c](d),g=h.value}catch(_){i(_);return}h.done?e(g):Promise.resolve(g).then(o,a)}function _asyncToGenerator$3(s){return function(){var e=this,i=arguments;return new Promise(function(o,a){var c=s.apply(e,i);function d(g){asyncGeneratorStep$3(c,o,a,d,h,"next",g)}function h(g){asyncGeneratorStep$3(c,o,a,d,h,"throw",g)}d(void 0)})}}var Events$1,RedisConnection$1,Scripts$1,parser$2;parser$2=parser$5;Events$1=Events_1;Scripts$1=Scripts$2;RedisConnection$1=(function(){class RedisConnection{constructor(options={}){parser$2.load(options,this.defaults,this),this.Redis==null&&(this.Redis=eval("require")("redis")),this.Events==null&&(this.Events=new Events$1(this)),this.terminated=!1,this.client==null&&(this.client=this.Redis.createClient(this.clientOptions)),this.subscriber=this.client.duplicate(),this.limiters={},this.shas={},this.ready=this.Promise.all([this._setup(this.client,!1),this._setup(this.subscriber,!0)]).then(()=>this._loadScripts()).then(()=>({client:this.client,subscriber:this.subscriber}))}_setup(s,e){return s.setMaxListeners(0),new this.Promise((i,o)=>(s.on("error",a=>this.Events.trigger("error",a)),e&&s.on("message",(a,c)=>{var d;return(d=this.limiters[a])!=null?d._store.onMessage(a,c):void 0}),s.ready?i():s.once("ready",i)))}_loadScript(s){return new this.Promise((e,i)=>{var o;return o=Scripts$1.payload(s),this.client.multi([["script","load",o]]).exec((a,c)=>a!=null?i(a):(this.shas[s]=c[0],e(c[0])))})}_loadScripts(){return this.Promise.all(Scripts$1.names.map(s=>this._loadScript(s)))}__runCommand__(s){var e=this;return _asyncToGenerator$3(function*(){return yield e.ready,new e.Promise((i,o)=>e.client.multi([s]).exec_atomic(function(a,c){return a!=null?o(a):i(c[0])}))})()}__addLimiter__(s){return this.Promise.all([s.channel(),s.channel_client()].map(e=>new this.Promise((i,o)=>{var a;return a=c=>{if(c===e)return this.subscriber.removeListener("subscribe",a),this.limiters[e]=s,i()},this.subscriber.on("subscribe",a),this.subscriber.subscribe(e)})))}__removeLimiter__(s){var e=this;return this.Promise.all([s.channel(),s.channel_client()].map(function(){var i=_asyncToGenerator$3(function*(o){return e.terminated||(yield new e.Promise((a,c)=>e.subscriber.unsubscribe(o,function(d,h){if(d!=null)return c(d);if(h===o)return a()}))),delete e.limiters[o]});return function(o){return i.apply(this,arguments)}}()))}__scriptArgs__(s,e,i,o){var a;return a=Scripts$1.keys(s,e),[this.shas[s],a.length].concat(a,i,o)}__scriptFn__(s){return this.client.evalsha.bind(this.client)}disconnect(s=!0){var e,i,o,a;for(a=Object.keys(this.limiters),e=0,o=a.length;e<o;e++)i=a[e],clearInterval(this.limiters[i]._store.heartbeat);return this.limiters={},this.terminated=!0,this.client.end(s),this.subscriber.end(s),this.Promise.resolve()}}return RedisConnection.prototype.datastore="redis",RedisConnection.prototype.defaults={Redis:null,clientOptions:{},client:null,Promise,Events:null},RedisConnection}).call(void 0);var RedisConnection_1=RedisConnection$1;function _slicedToArray$1(s,e){return _arrayWithHoles$1(s)||_iterableToArrayLimit$1(s,e)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit$1(s,e){var i=[],o=!0,a=!1,c=void 0;try{for(var d=s[Symbol.iterator](),h;!(o=(h=d.next()).done)&&(i.push(h.value),!(e&&i.length===e));o=!0);}catch(g){a=!0,c=g}finally{try{!o&&d.return!=null&&d.return()}finally{if(a)throw c}}return i}function _arrayWithHoles$1(s){if(Array.isArray(s))return s}function asyncGeneratorStep$2(s,e,i,o,a,c,d){try{var h=s[c](d),g=h.value}catch(_){i(_);return}h.done?e(g):Promise.resolve(g).then(o,a)}function _asyncToGenerator$2(s){return function(){var e=this,i=arguments;return new Promise(function(o,a){var c=s.apply(e,i);function d(g){asyncGeneratorStep$2(c,o,a,d,h,"next",g)}function h(g){asyncGeneratorStep$2(c,o,a,d,h,"throw",g)}d(void 0)})}}var Events,IORedisConnection$1,Scripts,parser$1;parser$1=parser$5;Events=Events_1;Scripts=Scripts$2;IORedisConnection$1=(function(){class IORedisConnection{constructor(options={}){parser$1.load(options,this.defaults,this),this.Redis==null&&(this.Redis=eval("require")("ioredis")),this.Events==null&&(this.Events=new Events(this)),this.terminated=!1,this.clusterNodes!=null?(this.client=new this.Redis.Cluster(this.clusterNodes,this.clientOptions),this.subscriber=new this.Redis.Cluster(this.clusterNodes,this.clientOptions)):this.client!=null&&this.client.duplicate==null?this.subscriber=new this.Redis.Cluster(this.client.startupNodes,this.client.options):(this.client==null&&(this.client=new this.Redis(this.clientOptions)),this.subscriber=this.client.duplicate()),this.limiters={},this.ready=this.Promise.all([this._setup(this.client,!1),this._setup(this.subscriber,!0)]).then(()=>(this._loadScripts(),{client:this.client,subscriber:this.subscriber}))}_setup(s,e){return s.setMaxListeners(0),new this.Promise((i,o)=>(s.on("error",a=>this.Events.trigger("error",a)),e&&s.on("message",(a,c)=>{var d;return(d=this.limiters[a])!=null?d._store.onMessage(a,c):void 0}),s.status==="ready"?i():s.once("ready",i)))}_loadScripts(){return Scripts.names.forEach(s=>this.client.defineCommand(s,{lua:Scripts.payload(s)}))}__runCommand__(s){var e=this;return _asyncToGenerator$2(function*(){var i;yield e.ready;var o=yield e.client.pipeline([s]).exec(),a=_slicedToArray$1(o,1),c=_slicedToArray$1(a[0],2);return c[0],i=c[1],i})()}__addLimiter__(s){return this.Promise.all([s.channel(),s.channel_client()].map(e=>new this.Promise((i,o)=>this.subscriber.subscribe(e,()=>(this.limiters[e]=s,i())))))}__removeLimiter__(s){var e=this;return[s.channel(),s.channel_client()].forEach(function(){var i=_asyncToGenerator$2(function*(o){return e.terminated||(yield e.subscriber.unsubscribe(o)),delete e.limiters[o]});return function(o){return i.apply(this,arguments)}}())}__scriptArgs__(s,e,i,o){var a;return a=Scripts.keys(s,e),[a.length].concat(a,i,o)}__scriptFn__(s){return this.client[s].bind(this.client)}disconnect(s=!0){var e,i,o,a;for(a=Object.keys(this.limiters),e=0,o=a.length;e<o;e++)i=a[e],clearInterval(this.limiters[i]._store.heartbeat);return this.limiters={},this.terminated=!0,s?this.Promise.all([this.client.quit(),this.subscriber.quit()]):(this.client.disconnect(),this.subscriber.disconnect(),this.Promise.resolve())}}return IORedisConnection.prototype.datastore="ioredis",IORedisConnection.prototype.defaults={Redis:null,clientOptions:{},clusterNodes:null,client:null,Promise,Events:null},IORedisConnection}).call(void 0);var IORedisConnection_1=IORedisConnection$1;function _slicedToArray(s,e){return _arrayWithHoles(s)||_iterableToArrayLimit(s,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(s,e){var i=[],o=!0,a=!1,c=void 0;try{for(var d=s[Symbol.iterator](),h;!(o=(h=d.next()).done)&&(i.push(h.value),!(e&&i.length===e));o=!0);}catch(g){a=!0,c=g}finally{try{!o&&d.return!=null&&d.return()}finally{if(a)throw c}}return i}function _arrayWithHoles(s){if(Array.isArray(s))return s}function asyncGeneratorStep$1(s,e,i,o,a,c,d){try{var h=s[c](d),g=h.value}catch(_){i(_);return}h.done?e(g):Promise.resolve(g).then(o,a)}function _asyncToGenerator$1(s){return function(){var e=this,i=arguments;return new Promise(function(o,a){var c=s.apply(e,i);function d(g){asyncGeneratorStep$1(c,o,a,d,h,"next",g)}function h(g){asyncGeneratorStep$1(c,o,a,d,h,"throw",g)}d(void 0)})}}var BottleneckError$1,IORedisConnection,RedisConnection,RedisDatastore,parser;parser=parser$5;BottleneckError$1=BottleneckError_1;RedisConnection=RedisConnection_1;IORedisConnection=IORedisConnection_1;RedisDatastore=class{constructor(e,i,o){this.instance=e,this.storeOptions=i,this.originalId=this.instance.id,this.clientId=this.instance._randomIndex(),parser.load(o,o,this),this.clients={},this.capacityPriorityCounters={},this.sharedConnection=this.connection!=null,this.connection==null&&(this.connection=this.instance.datastore==="redis"?new RedisConnection({Redis:this.Redis,clientOptions:this.clientOptions,Promise:this.Promise,Events:this.instance.Events}):this.instance.datastore==="ioredis"?new IORedisConnection({Redis:this.Redis,clientOptions:this.clientOptions,clusterNodes:this.clusterNodes,Promise:this.Promise,Events:this.instance.Events}):void 0),this.instance.connection=this.connection,this.instance.datastore=this.connection.datastore,this.ready=this.connection.ready.then(a=>(this.clients=a,this.runScript("init",this.prepareInitSettings(this.clearDatastore)))).then(()=>this.connection.__addLimiter__(this.instance)).then(()=>this.runScript("register_client",[this.instance.queued()])).then(()=>{var a;return typeof(a=this.heartbeat=setInterval(()=>this.runScript("heartbeat",[]).catch(c=>this.instance.Events.trigger("error",c)),this.heartbeatInterval)).unref=="function"&&a.unref(),this.clients})}__publish__(e){var i=this;return _asyncToGenerator$1(function*(){var o,a=yield i.ready;return o=a.client,o.publish(i.instance.channel(),`message:${e.toString()}`)})()}onMessage(e,i){var o=this;return _asyncToGenerator$1(function*(){var a,c,d,h,g,_,j,b,$,et;try{j=i.indexOf(":");var _e=[i.slice(0,j),i.slice(j+1)];if(et=_e[0],d=_e[1],et==="capacity")return yield o.instance._drainAll(d.length>0?~~d:void 0);if(et==="capacity-priority"){var st=d.split(":"),ot=_slicedToArray(st,3);return $=ot[0],b=ot[1],c=ot[2],a=$.length>0?~~$:void 0,b===o.clientId?(h=yield o.instance._drainAll(a),_=a!=null?a-(h||0):"",yield o.clients.client.publish(o.instance.channel(),`capacity-priority:${_}::${c}`)):b===""?(clearTimeout(o.capacityPriorityCounters[c]),delete o.capacityPriorityCounters[c],o.instance._drainAll(a)):o.capacityPriorityCounters[c]=setTimeout(_asyncToGenerator$1(function*(){var tt;try{return delete o.capacityPriorityCounters[c],yield o.runScript("blacklist_client",[b]),yield o.instance._drainAll(a)}catch(nt){return tt=nt,o.instance.Events.trigger("error",tt)}}),1e3)}else{if(et==="message")return o.instance.Events.trigger("message",d);if(et==="blocked")return yield o.instance._dropAllQueued()}}catch(tt){return g=tt,o.instance.Events.trigger("error",g)}})()}__disconnect__(e){return clearInterval(this.heartbeat),this.sharedConnection?this.connection.__removeLimiter__(this.instance):this.connection.disconnect(e)}runScript(e,i){var o=this;return _asyncToGenerator$1(function*(){return e==="init"||e==="register_client"||(yield o.ready),new o.Promise((a,c)=>{var d,h;return d=[Date.now(),o.clientId].concat(i),o.instance.Events.trigger("debug",`Calling Redis script: ${e}.lua`,d),h=o.connection.__scriptArgs__(e,o.originalId,d,function(g,_){return g!=null?c(g):a(_)}),o.connection.__scriptFn__(e)(...h)}).catch(a=>a.message==="SETTINGS_KEY_NOT_FOUND"?e==="heartbeat"?o.Promise.resolve():o.runScript("init",o.prepareInitSettings(!1)).then(()=>o.runScript(e,i)):a.message==="UNKNOWN_CLIENT"?o.runScript("register_client",[o.instance.queued()]).then(()=>o.runScript(e,i)):o.Promise.reject(a))})()}prepareArray(e){var i,o,a,c;for(a=[],i=0,o=e.length;i<o;i++)c=e[i],a.push(c!=null?c.toString():"");return a}prepareObject(e){var i,o,a;i=[];for(o in e)a=e[o],i.push(o,a!=null?a.toString():"");return i}prepareInitSettings(e){var i;return i=this.prepareObject(Object.assign({},this.storeOptions,{id:this.originalId,version:this.instance.version,groupTimeout:this.timeout,clientTimeout:this.clientTimeout})),i.unshift(e?1:0,this.instance.version),i}convertBool(e){return!!e}__updateSettings__(e){var i=this;return _asyncToGenerator$1(function*(){return yield i.runScript("update_settings",i.prepareObject(e)),parser.overwrite(e,e,i.storeOptions)})()}__running__(){return this.runScript("running",[])}__queued__(){return this.runScript("queued",[])}__done__(){return this.runScript("done",[])}__groupCheck__(){var e=this;return _asyncToGenerator$1(function*(){return e.convertBool(yield e.runScript("group_check",[]))})()}__incrementReservoir__(e){return this.runScript("increment_reservoir",[e])}__currentReservoir__(){return this.runScript("current_reservoir",[])}__check__(e){var i=this;return _asyncToGenerator$1(function*(){return i.convertBool(yield i.runScript("check",i.prepareArray([e])))})()}__register__(e,i,o){var a=this;return _asyncToGenerator$1(function*(){var c,d,h,g=yield a.runScript("register",a.prepareArray([e,i,o])),_=_slicedToArray(g,3);return d=_[0],h=_[1],c=_[2],{success:a.convertBool(d),wait:h,reservoir:c}})()}__submit__(e,i){var o=this;return _asyncToGenerator$1(function*(){var a,c,d,h,g;try{var _=yield o.runScript("submit",o.prepareArray([e,i])),j=_slicedToArray(_,3);return h=j[0],a=j[1],g=j[2],{reachedHWM:o.convertBool(h),blocked:o.convertBool(a),strategy:g}}catch(et){if(c=et,c.message.indexOf("OVERWEIGHT")===0){var b=c.message.split(":"),$=_slicedToArray(b,3);throw $[0],i=$[1],d=$[2],new BottleneckError$1(`Impossible to add a job having a weight of ${i} to a limiter having a maxConcurrent setting of ${d}`)}else throw c}})()}__free__(e,i){var o=this;return _asyncToGenerator$1(function*(){var a;return a=yield o.runScript("free",o.prepareArray([e])),{running:a}})()}};var RedisDatastore_1=RedisDatastore,BottleneckError,States;BottleneckError=BottleneckError_1;States=class{constructor(e){this.status=e,this._jobs={},this.counts=this.status.map(function(){return 0})}next(e){var i,o;if(i=this._jobs[e],o=i+1,i!=null&&o<this.status.length)return this.counts[i]--,this.counts[o]++,this._jobs[e]++;if(i!=null)return this.counts[i]--,delete this._jobs[e]}start(e){var i;return i=0,this._jobs[e]=i,this.counts[i]++}remove(e){var i;return i=this._jobs[e],i!=null&&(this.counts[i]--,delete this._jobs[e]),i!=null}jobStatus(e){var i;return(i=this.status[this._jobs[e]])!=null?i:null}statusJobs(e){var i,o,a,c,d;if(e!=null){if(o=this.status.indexOf(e),o<0)throw new BottleneckError(`status must be one of ${this.status.join(", ")}`);a=this._jobs,c=[];for(i in a)d=a[i],d===o&&c.push(i);return c}else return Object.keys(this._jobs)}statusCounts(){return this.counts.reduce((e,i,o)=>(e[this.status[o]]=i,e),{})}};var States_1=States;function asyncGeneratorStep(s,e,i,o,a,c,d){try{var h=s[c](d),g=h.value}catch(_){i(_);return}h.done?e(g):Promise.resolve(g).then(o,a)}function _asyncToGenerator(s){return function(){var e=this,i=arguments;return new Promise(function(o,a){var c=s.apply(e,i);function d(g){asyncGeneratorStep(c,o,a,d,h,"next",g)}function h(g){asyncGeneratorStep(c,o,a,d,h,"throw",g)}d(void 0)})}}var DLList,Sync;DLList=DLList_1;Sync=class{constructor(e,i){this.schedule=this.schedule.bind(this),this.name=e,this.Promise=i,this._running=0,this._queue=new DLList}isEmpty(){return this._queue.length===0}_tryToRun(){var e=this;return _asyncToGenerator(function*(){var i,o,a,c,d,h,g;if(e._running<1&&e._queue.length>0){e._running++;var _=e._queue.shift();return g=_.task,i=_.args,d=_.resolve,c=_.reject,o=yield _asyncToGenerator(function*(){try{return h=yield g(...i),function(){return d(h)}}catch(j){return a=j,function(){return c(a)}}})(),e._running--,e._tryToRun(),o()}})()}schedule(e,...i){var o,a,c;return c=a=null,o=new this.Promise(function(d,h){return c=d,a=h}),this._queue.push({task:e,args:i,resolve:c,reject:a}),this._tryToRun(),o}};var Sync_1=Sync;const version="2.19.5",require$$8={version};var Group_1,hasRequiredGroup;function requireGroup(){if(hasRequiredGroup)return Group_1;hasRequiredGroup=1;function s($,et){return o($)||i($,et)||e()}function e(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i($,et){var _e=[],st=!0,ot=!1,tt=void 0;try{for(var nt=$[Symbol.iterator](),rt;!(st=(rt=nt.next()).done)&&(_e.push(rt.value),!(et&&_e.length===et));st=!0);}catch(it){ot=!0,tt=it}finally{try{!st&&nt.return!=null&&nt.return()}finally{if(ot)throw tt}}return _e}function o($){if(Array.isArray($))return $}function a($,et,_e,st,ot,tt,nt){try{var rt=$[tt](nt),it=rt.value}catch(lt){_e(lt);return}rt.done?et(it):Promise.resolve(it).then(st,ot)}function c($){return function(){var et=this,_e=arguments;return new Promise(function(st,ot){var tt=$.apply(et,_e);function nt(it){a(tt,st,ot,nt,rt,"next",it)}function rt(it){a(tt,st,ot,nt,rt,"throw",it)}nt(void 0)})}}var d,h,g,_,j,b;return b=parser$5,d=Events_1,_=RedisConnection_1,g=IORedisConnection_1,j=Scripts$2,h=(function(){class ${constructor(_e={}){this.deleteKey=this.deleteKey.bind(this),this.limiterOptions=_e,b.load(this.limiterOptions,this.defaults,this),this.Events=new d(this),this.instances={},this.Bottleneck=requireBottleneck(),this._startAutoCleanup(),this.sharedConnection=this.connection!=null,this.connection==null&&(this.limiterOptions.datastore==="redis"?this.connection=new _(Object.assign({},this.limiterOptions,{Events:this.Events})):this.limiterOptions.datastore==="ioredis"&&(this.connection=new g(Object.assign({},this.limiterOptions,{Events:this.Events}))))}key(_e=""){var st;return(st=this.instances[_e])!=null?st:(()=>{var ot;return ot=this.instances[_e]=new this.Bottleneck(Object.assign(this.limiterOptions,{id:`${this.id}-${_e}`,timeout:this.timeout,connection:this.connection})),this.Events.trigger("created",ot,_e),ot})()}deleteKey(_e=""){var st=this;return c(function*(){var ot,tt;return tt=st.instances[_e],st.connection&&(ot=yield st.connection.__runCommand__(["del",...j.allKeys(`${st.id}-${_e}`)])),tt!=null&&(delete st.instances[_e],yield tt.disconnect()),tt!=null||ot>0})()}limiters(){var _e,st,ot,tt;st=this.instances,ot=[];for(_e in st)tt=st[_e],ot.push({key:_e,limiter:tt});return ot}keys(){return Object.keys(this.instances)}clusterKeys(){var _e=this;return c(function*(){var st,ot,tt,nt,rt,it,lt,at,ut;if(_e.connection==null)return _e.Promise.resolve(_e.keys());for(it=[],st=null,ut=`b_${_e.id}-`.length,ot=9;st!==0;){var ct=yield _e.connection.__runCommand__(["scan",st??0,"match",`b_${_e.id}-*_settings`,"count",1e4]),ht=s(ct,2);for(at=ht[0],tt=ht[1],st=~~at,nt=0,lt=tt.length;nt<lt;nt++)rt=tt[nt],it.push(rt.slice(ut,-ot))}return it})()}_startAutoCleanup(){var _e=this,st;return clearInterval(this.interval),typeof(st=this.interval=setInterval(c(function*(){var ot,tt,nt,rt,it,lt;it=Date.now(),nt=_e.instances,rt=[];for(tt in nt){lt=nt[tt];try{(yield lt._store.__groupCheck__(it))?rt.push(_e.deleteKey(tt)):rt.push(void 0)}catch(at){ot=at,rt.push(lt.Events.trigger("error",ot))}}return rt}),this.timeout/2)).unref=="function"?st.unref():void 0}updateSettings(_e={}){if(b.overwrite(_e,this.defaults,this),b.overwrite(_e,_e,this.limiterOptions),_e.timeout!=null)return this._startAutoCleanup()}disconnect(_e=!0){var st;if(!this.sharedConnection)return(st=this.connection)!=null?st.disconnect(_e):void 0}}return $.prototype.defaults={timeout:1e3*60*5,connection:null,Promise,id:"group-key"},$}).call(void 0),Group_1=h,Group_1}var Batcher_1,hasRequiredBatcher;function requireBatcher(){if(hasRequiredBatcher)return Batcher_1;hasRequiredBatcher=1;var s,e,i;return i=parser$5,e=Events_1,s=(function(){class o{constructor(c={}){this.options=c,i.load(this.options,this.defaults,this),this.Events=new e(this),this._arr=[],this._resetPromise(),this._lastFlush=Date.now()}_resetPromise(){return this._promise=new this.Promise((c,d)=>this._resolve=c)}_flush(){return clearTimeout(this._timeout),this._lastFlush=Date.now(),this._resolve(),this.Events.trigger("batch",this._arr),this._arr=[],this._resetPromise()}add(c){var d;return this._arr.push(c),d=this._promise,this._arr.length===this.maxSize?this._flush():this.maxTime!=null&&this._arr.length===1&&(this._timeout=setTimeout(()=>this._flush(),this.maxTime)),d}}return o.prototype.defaults={maxTime:null,maxSize:null,Promise},o}).call(void 0),Batcher_1=s,Batcher_1}var Bottleneck_1,hasRequiredBottleneck;function requireBottleneck(){if(hasRequiredBottleneck)return Bottleneck_1;hasRequiredBottleneck=1;function s(it,lt){return c(it)||e(it,lt)||o()}function e(it,lt){var at=[],ut=!0,ct=!1,ht=void 0;try{for(var dt=it[Symbol.iterator](),pt;!(ut=(pt=dt.next()).done)&&(at.push(pt.value),!(lt&&at.length===lt));ut=!0);}catch(gt){ct=!0,ht=gt}finally{try{!ut&&dt.return!=null&&dt.return()}finally{if(ct)throw ht}}return at}function i(it){return c(it)||a(it)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function a(it){if(Symbol.iterator in Object(it)||Object.prototype.toString.call(it)==="[object Arguments]")return Array.from(it)}function c(it){if(Array.isArray(it))return it}function d(it,lt,at,ut,ct,ht,dt){try{var pt=it[ht](dt),gt=pt.value}catch(yt){at(yt);return}pt.done?lt(gt):Promise.resolve(gt).then(ut,ct)}function h(it){return function(){var lt=this,at=arguments;return new Promise(function(ut,ct){var ht=it.apply(lt,at);function dt(gt){d(ht,ut,ct,dt,pt,"next",gt)}function pt(gt){d(ht,ut,ct,dt,pt,"throw",gt)}dt(void 0)})}}var g,_,j,b,$,et,_e,st,ot,tt,nt,rt=[].splice;return et=10,_=5,nt=parser$5,_e=Queues_1,b=Job_1,$=LocalDatastore_1,st=RedisDatastore_1,j=Events_1,ot=States_1,tt=Sync_1,g=(function(){class it{constructor(at={},...ut){var ct,ht;this._addToQueue=this._addToQueue.bind(this),this._validateOptions(at,ut),nt.load(at,this.instanceDefaults,this),this._queues=new _e(et),this._scheduled={},this._states=new ot(["RECEIVED","QUEUED","RUNNING","EXECUTING"].concat(this.trackDoneStatus?["DONE"]:[])),this._limiter=null,this.Events=new j(this),this._submitLock=new tt("submit",this.Promise),this._registerLock=new tt("register",this.Promise),ht=nt.load(at,this.storeDefaults,{}),this._store=(function(){if(this.datastore==="redis"||this.datastore==="ioredis"||this.connection!=null)return ct=nt.load(at,this.redisStoreDefaults,{}),new st(this,ht,ct);if(this.datastore==="local")return ct=nt.load(at,this.localStoreDefaults,{}),new $(this,ht,ct);throw new it.prototype.BottleneckError(`Invalid datastore type: ${this.datastore}`)}).call(this),this._queues.on("leftzero",()=>{var dt;return(dt=this._store.heartbeat)!=null&&typeof dt.ref=="function"?dt.ref():void 0}),this._queues.on("zero",()=>{var dt;return(dt=this._store.heartbeat)!=null&&typeof dt.unref=="function"?dt.unref():void 0})}_validateOptions(at,ut){if(!(at!=null&&typeof at=="object"&&ut.length===0))throw new it.prototype.BottleneckError("Bottleneck v2 takes a single object argument. Refer to https://github.com/SGrondin/bottleneck#upgrading-to-v2 if you're upgrading from Bottleneck v1.")}ready(){return this._store.ready}clients(){return this._store.clients}channel(){return`b_${this.id}`}channel_client(){return`b_${this.id}_${this._store.clientId}`}publish(at){return this._store.__publish__(at)}disconnect(at=!0){return this._store.__disconnect__(at)}chain(at){return this._limiter=at,this}queued(at){return this._queues.queued(at)}clusterQueued(){return this._store.__queued__()}empty(){return this.queued()===0&&this._submitLock.isEmpty()}running(){return this._store.__running__()}done(){return this._store.__done__()}jobStatus(at){return this._states.jobStatus(at)}jobs(at){return this._states.statusJobs(at)}counts(){return this._states.statusCounts()}_randomIndex(){return Math.random().toString(36).slice(2)}check(at=1){return this._store.__check__(at)}_clearGlobalState(at){return this._scheduled[at]!=null?(clearTimeout(this._scheduled[at].expiration),delete this._scheduled[at],!0):!1}_free(at,ut,ct,ht){var dt=this;return h(function*(){var pt,gt;try{var yt=yield dt._store.__free__(at,ct.weight);if(gt=yt.running,dt.Events.trigger("debug",`Freed ${ct.id}`,ht),gt===0&&dt.empty())return dt.Events.trigger("idle")}catch(jt){return pt=jt,dt.Events.trigger("error",pt)}})()}_run(at,ut,ct){var ht,dt,pt;return ut.doRun(),ht=this._clearGlobalState.bind(this,at),pt=this._run.bind(this,at,ut),dt=this._free.bind(this,at,ut),this._scheduled[at]={timeout:setTimeout(()=>ut.doExecute(this._limiter,ht,pt,dt),ct),expiration:ut.options.expiration!=null?setTimeout(function(){return ut.doExpire(ht,pt,dt)},ct+ut.options.expiration):void 0,job:ut}}_drainOne(at){return this._registerLock.schedule(()=>{var ut,ct,ht,dt,pt;if(this.queued()===0)return this.Promise.resolve(null);pt=this._queues.getFirst();var gt=ht=pt.first();return dt=gt.options,ut=gt.args,at!=null&&dt.weight>at?this.Promise.resolve(null):(this.Events.trigger("debug",`Draining ${dt.id}`,{args:ut,options:dt}),ct=this._randomIndex(),this._store.__register__(ct,dt.weight,dt.expiration).then(({success:yt,wait:jt,reservoir:Tt})=>{var Ct;return this.Events.trigger("debug",`Drained ${dt.id}`,{success:yt,args:ut,options:dt}),yt?(pt.shift(),Ct=this.empty(),Ct&&this.Events.trigger("empty"),Tt===0&&this.Events.trigger("depleted",Ct),this._run(ct,ht,jt),this.Promise.resolve(dt.weight)):this.Promise.resolve(null)}))})}_drainAll(at,ut=0){return this._drainOne(at).then(ct=>{var ht;return ct!=null?(ht=at!=null?at-ct:at,this._drainAll(ht,ut+ct)):this.Promise.resolve(ut)}).catch(ct=>this.Events.trigger("error",ct))}_dropAllQueued(at){return this._queues.shiftAll(function(ut){return ut.doDrop({message:at})})}stop(at={}){var ut,ct;return at=nt.load(at,this.stopDefaults),ct=ht=>{var dt;return dt=()=>{var pt;return pt=this._states.counts,pt[0]+pt[1]+pt[2]+pt[3]===ht},new this.Promise((pt,gt)=>dt()?pt():this.on("done",()=>{if(dt())return this.removeAllListeners("done"),pt()}))},ut=at.dropWaitingJobs?(this._run=function(ht,dt){return dt.doDrop({message:at.dropErrorMessage})},this._drainOne=()=>this.Promise.resolve(null),this._registerLock.schedule(()=>this._submitLock.schedule(()=>{var ht,dt,pt;dt=this._scheduled;for(ht in dt)pt=dt[ht],this.jobStatus(pt.job.options.id)==="RUNNING"&&(clearTimeout(pt.timeout),clearTimeout(pt.expiration),pt.job.doDrop({message:at.dropErrorMessage}));return this._dropAllQueued(at.dropErrorMessage),ct(0)}))):this.schedule({priority:et-1,weight:0},()=>ct(1)),this._receive=function(ht){return ht._reject(new it.prototype.BottleneckError(at.enqueueErrorMessage))},this.stop=()=>this.Promise.reject(new it.prototype.BottleneckError("stop() has already been called")),ut}_addToQueue(at){var ut=this;return h(function*(){var ct,ht,dt,pt,gt,yt,jt;ct=at.args,pt=at.options;try{var Tt=yield ut._store.__submit__(ut.queued(),pt.weight);gt=Tt.reachedHWM,ht=Tt.blocked,jt=Tt.strategy}catch(Ct){return dt=Ct,ut.Events.trigger("debug",`Could not queue ${pt.id}`,{args:ct,options:pt,error:dt}),at.doDrop({error:dt}),!1}return ht?(at.doDrop(),!0):gt&&(yt=jt===it.prototype.strategy.LEAK?ut._queues.shiftLastFrom(pt.priority):jt===it.prototype.strategy.OVERFLOW_PRIORITY?ut._queues.shiftLastFrom(pt.priority+1):jt===it.prototype.strategy.OVERFLOW?at:void 0,yt!=null&&yt.doDrop(),yt==null||jt===it.prototype.strategy.OVERFLOW)?(yt==null&&at.doDrop(),gt):(at.doQueue(gt,ht),ut._queues.push(at),yield ut._drainAll(),gt)})()}_receive(at){return this._states.jobStatus(at.options.id)!=null?(at._reject(new it.prototype.BottleneckError(`A job with the same id already exists (id=${at.options.id})`)),!1):(at.doReceive(),this._submitLock.schedule(this._addToQueue,at))}submit(...at){var ut,ct,ht,dt,pt,gt,yt;if(typeof at[0]=="function"){var jt,Tt,Ct,_t;pt=at,jt=pt,Tt=i(jt),ct=Tt[0],at=Tt.slice(1),Ct=rt.call(at,-1),_t=s(Ct,1),ut=_t[0],dt=nt.load({},this.jobDefaults)}else{var ft,mt,xt,Et;gt=at,ft=gt,mt=i(ft),dt=mt[0],ct=mt[1],at=mt.slice(2),xt=rt.call(at,-1),Et=s(xt,1),ut=Et[0],dt=nt.load(dt,this.jobDefaults)}return yt=(...St)=>new this.Promise(function(wt,bt){return ct(...St,function(...Lt){return(Lt[0]!=null?bt:wt)(Lt)})}),ht=new b(yt,at,dt,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise),ht.promise.then(function(St){return typeof ut=="function"?ut(...St):void 0}).catch(function(St){return Array.isArray(St)?typeof ut=="function"?ut(...St):void 0:typeof ut=="function"?ut(St):void 0}),this._receive(ht)}schedule(...at){var ut,ct,ht;if(typeof at[0]=="function"){var dt=at,pt=i(dt);ht=pt[0],at=pt.slice(1),ct={}}else{var gt=at,yt=i(gt);ct=yt[0],ht=yt[1],at=yt.slice(2)}return ut=new b(ht,at,ct,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise),this._receive(ut),ut.promise}wrap(at){var ut,ct;return ut=this.schedule.bind(this),ct=function(...dt){return ut(at.bind(this),...dt)},ct.withOptions=function(ht,...dt){return ut(ht,at,...dt)},ct}updateSettings(at={}){var ut=this;return h(function*(){return yield ut._store.__updateSettings__(nt.overwrite(at,ut.storeDefaults)),nt.overwrite(at,ut.instanceDefaults,ut),ut})()}currentReservoir(){return this._store.__currentReservoir__()}incrementReservoir(at=0){return this._store.__incrementReservoir__(at)}}return it.default=it,it.Events=j,it.version=it.prototype.version=require$$8.version,it.strategy=it.prototype.strategy={LEAK:1,OVERFLOW:2,OVERFLOW_PRIORITY:4,BLOCK:3},it.BottleneckError=it.prototype.BottleneckError=BottleneckError_1,it.Group=it.prototype.Group=requireGroup(),it.RedisConnection=it.prototype.RedisConnection=RedisConnection_1,it.IORedisConnection=it.prototype.IORedisConnection=IORedisConnection_1,it.Batcher=it.prototype.Batcher=requireBatcher(),it.prototype.jobDefaults={priority:_,weight:1,expiration:null,id:"<no-id>"},it.prototype.storeDefaults={maxConcurrent:null,minTime:0,highWater:null,strategy:it.prototype.strategy.LEAK,penalty:null,reservoir:null,reservoirRefreshInterval:null,reservoirRefreshAmount:null,reservoirIncreaseInterval:null,reservoirIncreaseAmount:null,reservoirIncreaseMaximum:null},it.prototype.localStoreDefaults={Promise,timeout:null,heartbeatInterval:250},it.prototype.redisStoreDefaults={Promise,timeout:null,heartbeatInterval:5e3,clientTimeout:1e4,Redis:null,clientOptions:{},clusterNodes:null,clearDatastore:!1,connection:null},it.prototype.instanceDefaults={datastore:"local",connection:null,id:"<no-id>",rejectOnDrop:!0,trackDoneStatus:!1,Promise},it.prototype.stopDefaults={enqueueErrorMessage:"This limiter has been stopped and cannot accept new jobs.",dropWaitingJobs:!0,dropErrorMessage:"This limiter has been stopped."},it}).call(void 0),Bottleneck_1=g,Bottleneck_1}var lib=requireBottleneck();const Bottleneck=getDefaultExportFromCjs(lib),CollapsibleJson=({title:s,data:e,defaultExpanded:i=!1})=>{const[o,a]=reactExports.useState(i),c=h=>{if(typeof h=="string")try{const g=JSON.parse(h);return JSON.stringify(g,null,2)}catch{return h}return JSON.stringify(h,null,2)};return e&&(typeof e=="string"?e.trim():!0)?jsxRuntimeExports.jsxs("div",{className:"collapsible-section",children:[jsxRuntimeExports.jsxs("div",{className:"collapsible-header",onClick:()=>a(!o),children:[jsxRuntimeExports.jsx("span",{className:"collapsible-icon",children:o?"":""}),jsxRuntimeExports.jsx("h3",{children:s}),jsxRuntimeExports.jsx("span",{className:"data-size",children:typeof e=="string"?`${e.length} chars`:"object"})]}),o&&jsxRuntimeExports.jsx("div",{className:"collapsible-content",children:jsxRuntimeExports.jsx("pre",{className:"json-content",children:c(e)})})]}):null},ContextModal=({isOpen:s,onClose:e,contextData:i})=>s?jsxRuntimeExports.jsx("div",{className:"modal-overlay",onClick:e,children:jsxRuntimeExports.jsxs("div",{className:"modal-content",onClick:o=>o.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h2",{children:"LLM Context Data"}),jsxRuntimeExports.jsx("button",{className:"modal-close",onClick:e,children:""})]}),jsxRuntimeExports.jsx("div",{className:"modal-body",children:i?jsxRuntimeExports.jsxs("div",{className:"context-sections",children:[jsxRuntimeExports.jsx(CollapsibleJson,{title:"Profile Information",data:i.profileInfo,defaultExpanded:!0}),jsxRuntimeExports.jsx(CollapsibleJson,{title:"Property Information",data:i.propertyInfo}),jsxRuntimeExports.jsx(CollapsibleJson,{title:"Reservation Information",data:i.reservationInfo}),jsxRuntimeExports.jsx(CollapsibleJson,{title:"Quick Replies",data:i.quickReplies}),jsxRuntimeExports.jsx(CollapsibleJson,{title:"RAG Context",data:i.ragContext}),i.conversationHistory&&jsxRuntimeExports.jsx(CollapsibleJson,{title:"Conversation History",data:i.conversationHistory}),Object.entries(i).filter(([o])=>!["profileInfo","propertyInfo","reservationInfo","quickReplies","ragContext","conversationHistory"].includes(o)).map(([o,a])=>jsxRuntimeExports.jsx(CollapsibleJson,{title:o.charAt(0).toUpperCase()+o.slice(1).replace(/([A-Z])/g," $1"),data:a},o))]}):jsxRuntimeExports.jsx("div",{className:"no-data",children:jsxRuntimeExports.jsx("p",{children:"No context data available."})})})]})}):null,limiter=new Bottleneck({maxConcurrent:1,minTime:1}),SELECTED_CHANNELS_KEY="threadsView_selectedChannels",saveSelectedChannelsToLocalStorage=s=>{try{localStorage.setItem(SELECTED_CHANNELS_KEY,JSON.stringify(s))}catch(e){console.warn("Failed to save selected channels to localStorage:",e)}},loadSelectedChannelsFromLocalStorage=()=>{try{const s=localStorage.getItem(SELECTED_CHANNELS_KEY);return s?JSON.parse(s):null}catch(s){return console.warn("Failed to load selected channels from localStorage:",s),null}};function getEntryId(s){const e=s.type,i=s.requestId;return`${e}-${i}`}function entryToMessage(s,e){var i;return e==="status-update"?((i=s.chunks[s.chunks.length-1])==null?void 0:i.message)||"":s.chunks.sort((o,a)=>o.order-a.order).map(o=>o.message).join("").trim()}const formatTime=(s,e)=>{const i=new Date(s),o=new Date,a=new Date(o.getFullYear(),o.getMonth(),o.getDate()),c=new Date(i.getFullYear(),i.getMonth(),i.getDate());return c.getTime()===a.getTime()?i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}):c.getTime()===a.getTime()-24*60*60*1e3?e("threads.yesterday"):i.toLocaleDateString("en-US",{month:"short",day:"numeric"})},ThreadListItem=({thread:s,isSelected:e,lastMessage:i,onClick:o})=>{const{t:a}=useTranslation(),c=()=>s.listing_id?a("threads.listingTitle",{id:s.listing_id}):s.reservation_id?a("threads.reservationTitle",{id:s.reservation_id}):a("threads.channelThread",{channel:s.channel}),d=()=>{const h=s.participants.length>0?s.participants.slice(0,2).join(", "):a("threads.noParticipants");return s.participants.length>2?a("threads.participantsWithMore",{participants:h,count:s.participants.length-2}):h};return jsxRuntimeExports.jsxs("div",{className:`thread-item ${e?"selected":""}`,onClick:o,children:[jsxRuntimeExports.jsx("div",{className:"thread-avatar",children:jsxRuntimeExports.jsx("div",{className:"avatar-icon",children:s.channel.includes("whatsapp")?"":""})}),jsxRuntimeExports.jsxs("div",{className:"thread-content",children:[jsxRuntimeExports.jsxs("div",{className:"thread-header",children:[jsxRuntimeExports.jsx("div",{className:"thread-title",children:c()}),jsxRuntimeExports.jsx("span",{className:"thread-time",children:formatTime((i==null?void 0:i.created_at)||s.created_at,a)})]}),jsxRuntimeExports.jsxs("div",{className:"thread-preview",children:[jsxRuntimeExports.jsx("p",{className:"thread-subtitle",children:d()}),i&&jsxRuntimeExports.jsx("p",{className:"last-message",children:i.message.length>50?`${i.message.substring(0,50)}...`:i.message})]})]})]})},ChannelFilterDropdown=({availableChannels:s,selectedChannels:e,onChannelToggle:i})=>{const[o,a]=reactExports.useState(!1);return reactExports.useEffect(()=>{const c=d=>{d.target.closest(".channel-filter-dropdown")||a(!1)};return o&&document.addEventListener("click",c),()=>{document.removeEventListener("click",c)}},[o]),jsxRuntimeExports.jsxs("div",{className:"channel-filter-dropdown",children:[jsxRuntimeExports.jsxs("button",{className:"channel-filter-trigger",onClick:()=>a(!o),type:"button",children:["Channels (",e.length,"/",s.length,")",jsxRuntimeExports.jsx("span",{className:`dropdown-arrow ${o?"open":""}`,children:"v"})]}),o&&jsxRuntimeExports.jsx("div",{className:"channel-filter-menu",children:s.map(c=>jsxRuntimeExports.jsxs("label",{className:"channel-filter-item",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:e.includes(c),onChange:()=>i(c)}),jsxRuntimeExports.jsx("span",{className:"channel-name",children:c})]},c))})]})},ThreadList=({threads:s,selectedThreadId:e,onThreadSelect:i,availableChannels:o,selectedChannels:a,onChannelToggle:c})=>{const{t:d}=useTranslation();return jsxRuntimeExports.jsxs("div",{className:"thread-list",children:[jsxRuntimeExports.jsxs("div",{className:"thread-list-header",children:[jsxRuntimeExports.jsx("h2",{children:d("threads.title")}),jsxRuntimeExports.jsx(ChannelFilterDropdown,{availableChannels:o,selectedChannels:a,onChannelToggle:c})]}),jsxRuntimeExports.jsx("div",{className:"thread-list-content",children:s.length===0?jsxRuntimeExports.jsx("div",{className:"empty-state",children:jsxRuntimeExports.jsx("p",{children:d("threads.noThreadsFound")})}):s.map(h=>jsxRuntimeExports.jsx(ThreadListItem,{thread:h,isSelected:h.id===e,onClick:()=>i(h)},h.id))})]})},MobileHeader=({selectedThread:s,onBack:e})=>{const{t:i}=useTranslation();return s?jsxRuntimeExports.jsxs("div",{className:"mobile-header",children:[jsxRuntimeExports.jsx("button",{className:"mobile-back-btn",onClick:e,children:""}),jsxRuntimeExports.jsxs("div",{className:"mobile-header-info",children:[jsxRuntimeExports.jsx("h3",{className:"mobile-thread-title",children:s.listing_id?i("threads.listingTitle",{id:s.listing_id}):s.reservation_id?i("threads.reservationTitle",{id:s.reservation_id}):i("threads.channelThread",{channel:s.channel})}),jsxRuntimeExports.jsx("p",{className:"mobile-thread-participants",children:s.participants.length>0?s.participants.slice(0,2).join(", "):i("threads.noParticipants")})]})]}):null},MessageList=({messages:s,selectedThread:e,onShowContext:i,loadingContext:o})=>{const{t:a}=useTranslation();return e?jsxRuntimeExports.jsxs("div",{className:"message-area",children:[jsxRuntimeExports.jsxs("div",{className:"conversation-header",children:[jsxRuntimeExports.jsxs("div",{className:"conversation-info",children:[jsxRuntimeExports.jsx("h3",{children:e.listing_id?a("threads.listingTitle",{id:e.listing_id}):e.reservation_id?a("threads.reservationTitle",{id:e.reservation_id}):a("threads.channelThread",{channel:e.channel})}),jsxRuntimeExports.jsxs("p",{className:"thread-id",children:["Thread ID: ",e.id]}),jsxRuntimeExports.jsx("p",{className:"participants",children:e.participants.length>0?e.participants.join(", "):a("threads.noParticipants")})]}),jsxRuntimeExports.jsxs("div",{className:"conversation-actions",children:[jsxRuntimeExports.jsx("button",{onClick:i,disabled:o,className:"show-context-btn",title:"Show context data sent to LLM",children:o?"Loading...":"Show Context"}),jsxRuntimeExports.jsx("div",{className:"channel-badge",children:e.channel})]})]}),jsxRuntimeExports.jsx("div",{className:"messages-container",children:s.length===0?jsxRuntimeExports.jsx("div",{className:"no-messages",children:jsxRuntimeExports.jsx("p",{children:a("threads.noMessages")})}):jsxRuntimeExports.jsx("div",{className:"messages-list",children:s.map((c,d)=>{var _,j,b;const h=d===0||((_=s[d-1])==null?void 0:_.from_id)!==c.from_id,g=e.channel==="whatsapp-arg"&&((j=c.from_id)==null?void 0:j.toString())==="5491169729783@c.us"||e.channel==="whatsapp-buisness"&&((b=c.from_id)==null?void 0:b.toString())==="34676892817@c.us";return jsxRuntimeExports.jsxs("div",{className:`message-group ${g?"maddie-message":"user-message"}`,children:[h&&jsxRuntimeExports.jsx("div",{className:"message-sender",children:c.from_id}),jsxRuntimeExports.jsxs("div",{className:"message-bubble",children:[jsxRuntimeExports.jsx("div",{className:"message-content",children:c.message}),jsxRuntimeExports.jsx("div",{className:"message-timestamp",children:formatTime(c.created_at,a)})]})]},c.id)})})})]}):jsxRuntimeExports.jsx("div",{className:"message-area empty",children:jsxRuntimeExports.jsxs("div",{className:"empty-conversation",children:[jsxRuntimeExports.jsx("div",{className:"empty-icon",children:""}),jsxRuntimeExports.jsx("h3",{children:a("threads.selectThread")}),jsxRuntimeExports.jsx("p",{children:a("threads.selectThreadDescription")})]})})},ThreadsView=()=>{const{t:s}=useTranslation(),{supabaseService:e}=useAuth(),i=useNavigate(),{threadId:o}=useParams(),[a,c]=reactExports.useState([]),[d,h]=reactExports.useState([]),[g,_]=reactExports.useState(),[j,b]=reactExports.useState([]),[$,et]=reactExports.useState(()=>loadSelectedChannelsFromLocalStorage()||[]),[_e,st]=reactExports.useState(!0),[ot,tt]=reactExports.useState(null),[nt,rt]=reactExports.useState(!1),[it,lt]=reactExports.useState([]),[at,ut]=reactExports.useState(!1),[ct,ht]=reactExports.useState(!1),[dt,pt]=reactExports.useState(300),[gt,yt]=reactExports.useState(400),[jt,Tt]=reactExports.useState(""),[Ct,_t]=reactExports.useState(""),[ft,mt]=reactExports.useState(!1),[xt,Et]=reactExports.useState([]),[St,wt]=reactExports.useState(!1),[bt,Lt]=reactExports.useState(!1),[Ft,Mt]=reactExports.useState(!1),[Bt,Qt]=reactExports.useState(null),[Jt,Ht]=reactExports.useState(!1),qt=it.filter(vt=>vt.chunks.length>0);function Yt(vt,Rt,kt,Nt,Pt,At){lt($t=>{const Ot=$t.findIndex(Ut=>Ut.requestId===vt&&Ut.type===Rt),It=Ot>=0?$t[Ot]:null;if(!It)return console.log("entry not found",vt,Rt),[...$t,{timestamp:Pt,requestId:vt,type:Rt,chunks:[{message:kt,order:Nt,timestamp:Pt}]}];const Dt=[...$t];return It.finalized?(console.log("entry already finalized",vt,Rt),$t):(At?(console.log("finalizing entry",vt,Rt),Dt[Ot]={...It,finalized:At,chunks:[{message:kt,order:0,timestamp:Pt}]}):(console.log("adding chunk to entry",vt,Rt),Dt[Ot]={...It,chunks:[...It.chunks,{message:kt,order:Nt,timestamp:Pt}]}),Dt)})}reactExports.useEffect(()=>{if(o&&a.length>0){const vt=a.find(Rt=>Rt.id===o);vt&&(!g||g.id!==o)&&(_(vt),window.innerWidth<=768&&mt(!0))}else!o&&g&&(_(void 0),lt([]),mt(!1))},[o,a,g]);const Vt=reactExports.useCallback(async()=>{if(e.getSupabaseClient())try{st(!0);const{data:vt,error:Rt}=await e.getSupabaseClient().from("threads").select("*").order("created_at",{ascending:!1});if(Rt)throw Rt;c(vt||[])}catch(vt){console.error("Error loading threads:",vt),tt(s("threads.errorLoadingThreads"))}finally{st(!1)}},[e,s]),Gt=reactExports.useCallback(async vt=>{if(e.getSupabaseClient())try{const{data:Rt,error:kt}=await e.getSupabaseClient().from("messages").select("*").eq("thread_id",vt).order("created_at",{ascending:!0});if(kt)throw kt;h(Rt||[])}catch(Rt){console.error("Error loading messages:",Rt),tt(s("threads.errorLoadingMessages"))}},[e,s]),Xt=vt=>{i(`/admin/threads/${vt.id}`),_(vt),lt([]),window.innerWidth<=768&&mt(!0)},Zt=()=>{i("/admin/threads"),mt(!1),_(void 0)},Wt=async(vt,Rt)=>{if(!e||!g)return;const kt=crypto.randomUUID();console.log("Generated session ID:",kt);const Nt=new Date().toISOString();lt(At=>[...At,{timestamp:Nt,requestId:kt,type:"status-update",chunks:[{message:"Loading...",order:0,timestamp:Nt}]}]);function Pt({payload:At}){limiter.schedule(async()=>{console.log("Received status update:",At);const{type:$t,message:Ot,order:It,timestamp:Dt,finalized:Ut}=At;Yt(kt,$t,Ot,It,Dt,Ut)})}try{rt(!0),tt(null),console.log("Generated session ID:",kt),console.log("Creating channel subscription...");const At=e.getSupabaseClient().channel(`bot-status-${kt}`).on("broadcast",{event:"notification"},Pt).subscribe();for(;At.state!=="joined";)console.log("Waiting for channel to join..."),await new Promise(zt=>setTimeout(zt,20));console.log("Channel created:",At);const{data:$t,error:Ot}=await e.getSupabaseClient().auth.getSession();if(Ot)throw Ot;const It=$t.session;if(!(It!=null&&It.access_token))throw new Error("No valid authentication session found");const Dt=await fetch(`${getSupabaseUrl()}/functions/v1/maddie-bot-response`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${It.access_token}`},body:JSON.stringify({listing_id:vt,reservation_id:Rt,session_id:kt,thread_id:g.id,arbitrary_context:jt,message_draft:Ct})});if(!Dt.ok){const zt=await Dt.text();throw new Error(`HTTP ${Dt.status}: ${zt}`)}const Ut=await Dt.json();Ut||Pt({payload:{type:"streaming-maddie",message:Ut.response,finalized:!0,timestamp:new Date().toISOString()}}),At.unsubscribe()}catch(At){console.error("Error drafting message:",At),tt(s("threads.errorDraftingMessage")),Pt({payload:{type:"status-update",message:s("threads.errorDraftingMessage"),timestamp:new Date().toISOString()}})}finally{rt(!1)}},en=async()=>{if(!(!e||!g))try{wt(!0),Lt(!0);const{data:vt,error:Rt}=await e.getSupabaseClient().auth.getSession();if(Rt)throw Rt;const kt=vt.session;if(!(kt!=null&&kt.access_token))throw new Error("No valid authentication session found");const Nt=await fetch(`${getSupabaseUrl()}/functions/v1/conversation-directions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${kt.access_token}`},body:JSON.stringify({thread_id:g.id})});if(!Nt.ok){const At=await Nt.text();throw new Error(`HTTP ${Nt.status}: ${At}`)}const Pt=await Nt.json();if(!Pt.success)throw new Error(Pt.error||"Failed to load conversation directions");Et(Pt.directions||[])}catch(vt){console.error("Error loading conversation directions:",vt),tt(s("threads.errorLoadingDirections"))}finally{wt(!1)}},tn=vt=>{Tt(vt.context),Lt(!1)},nn=async()=>{if(!(!e||!g))try{Ht(!0);const{data:vt,error:Rt}=await e.getSupabaseClient().auth.getSession();if(Rt)throw Rt;const kt=vt.session;if(!(kt!=null&&kt.access_token))throw new Error("No valid authentication session found");const Nt=await fetch(`${getSupabaseUrl()}/functions/v1/thread-context`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${kt.access_token}`},body:JSON.stringify({thread_id:g.id})});if(!Nt.ok){const At=await Nt.text();throw new Error(`HTTP ${Nt.status}: ${At}`)}const Pt=await Nt.json();Pt.success!==!1?(Qt(Pt.contextData),Mt(!0)):(console.error("Error fetching thread context:",Pt.error),tt("Failed to fetch thread context"))}catch(vt){console.error("Error fetching thread context:",vt),tt("Failed to fetch thread context")}finally{Ht(!1)}},rn=vt=>{ut(!0),vt.preventDefault()},sn=vt=>{ht(!0),vt.preventDefault()};reactExports.useEffect(()=>{const vt=kt=>{if(at){const Nt=document.querySelector(".threads-split-container");if(!Nt)return;const Pt=Nt.getBoundingClientRect(),At=Pt.height,$t=kt.clientY-Pt.top,Ot=At-$t,It=80,Dt=At*.9,Ut=Math.max(It,Math.min(Dt,Ot));pt(Ut)}if(ct){const Nt=document.querySelector(".threads-view");if(!Nt)return;const Pt=Nt.getBoundingClientRect(),At=kt.clientX-Pt.left,$t=300,Ot=Pt.width*.6,It=Math.max($t,Math.min(Ot,At));yt(It)}},Rt=()=>{ut(!1),ht(!1)};return(at||ct)&&(document.addEventListener("mousemove",vt),document.addEventListener("mouseup",Rt)),()=>{document.removeEventListener("mousemove",vt),document.removeEventListener("mouseup",Rt)}},[at,ct]);const on=vt=>{et(Rt=>{const kt=Rt.includes(vt)?Rt.filter(Nt=>Nt!==vt):[...Rt,vt];return saveSelectedChannelsToLocalStorage(kt),kt})};reactExports.useEffect(()=>{const vt=[...new Set(a.map(kt=>kt.channel))].sort();b(vt);const Rt=loadSelectedChannelsFromLocalStorage();if($.length===0&&vt.length>0&&!Rt){const kt=vt;et(kt),saveSelectedChannelsToLocalStorage(kt)}},[a,$.length]);const an=a.filter(vt=>$.includes(vt.channel));return reactExports.useEffect(()=>{Vt()},[Vt]),reactExports.useEffect(()=>{g?Gt(g.id):h([])},[g,Gt]),_e?jsxRuntimeExports.jsxs("div",{className:"threads-loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),jsxRuntimeExports.jsx("span",{children:s("threads.loading")})]}):ot?jsxRuntimeExports.jsx("div",{className:"threads-error",children:jsxRuntimeExports.jsxs("div",{className:"error-message",children:[jsxRuntimeExports.jsx("h3",{children:s("threads.error")}),jsxRuntimeExports.jsx("p",{children:ot}),jsxRuntimeExports.jsx("button",{onClick:Vt,className:"retry-button",children:s("threads.retry")})]})}):jsxRuntimeExports.jsxs("div",{className:`threads-view ${at?"dragging-horizontal":""} ${ct?"dragging-vertical":""} ${ft?"mobile-conversation":""}`,children:[jsxRuntimeExports.jsx("div",{className:"threads-sidebar",style:{width:`${gt}px`},children:jsxRuntimeExports.jsx(ThreadList,{threads:an,selectedThreadId:g==null?void 0:g.id,onThreadSelect:Xt,availableChannels:j,selectedChannels:$,onChannelToggle:on})}),jsxRuntimeExports.jsx("div",{className:"vertical-resize-handle",onMouseDown:sn}),jsxRuntimeExports.jsxs("div",{className:"threads-main",children:[jsxRuntimeExports.jsx(MobileHeader,{selectedThread:g,onBack:Zt}),jsxRuntimeExports.jsxs("div",{className:"threads-split-container",children:[jsxRuntimeExports.jsx("div",{className:"threads-chat-area",children:jsxRuntimeExports.jsx(MessageList,{messages:d,selectedThread:g,onDraftMessage:Wt,onShowContext:nn,loadingContext:Jt})}),jsxRuntimeExports.jsx("div",{className:"resize-handle",onMouseDown:rn}),jsxRuntimeExports.jsx("div",{className:"threads-drafting-area",style:{height:`${dt}px`},children:jsxRuntimeExports.jsx("div",{className:"drafting-panel",children:jsxRuntimeExports.jsxs("div",{className:"drafting-form",children:[jsxRuntimeExports.jsxs("div",{className:"context-row",children:[jsxRuntimeExports.jsx("div",{className:"context-group",children:jsxRuntimeExports.jsxs("div",{className:"context-input-wrapper",children:[jsxRuntimeExports.jsx("textarea",{id:"context-input",className:"context-textarea",rows:1,value:jt,onChange:vt=>Tt(vt.target.value),placeholder:"Give Maddie AI Bot arbitrary context",disabled:nt}),jsxRuntimeExports.jsx("button",{onClick:en,disabled:St||!g,className:"submit-btn",type:"button",title:"Get conversation direction suggestions",children:jsxRuntimeExports.jsx("span",{className:"btn-text",children:St?"Loading...":"Suggestions"})})]})}),jsxRuntimeExports.jsx("div",{className:"button-group",children:jsxRuntimeExports.jsx("button",{onClick:()=>Wt(g==null?void 0:g.listing_id,g==null?void 0:g.reservation_id),disabled:nt||!g,className:"submit-btn",children:jsxRuntimeExports.jsx("span",{className:"btn-text",children:"Generate"})})})]}),bt&&jsxRuntimeExports.jsxs("div",{className:"directions-panel",children:[jsxRuntimeExports.jsxs("div",{className:"directions-header",children:[jsxRuntimeExports.jsx("h4",{children:"Conversation Direction Suggestions"}),jsxRuntimeExports.jsx("button",{onClick:()=>Lt(!1),className:"close-directions-btn",children:""})]}),jsxRuntimeExports.jsx("div",{className:"directions-list",children:St?jsxRuntimeExports.jsxs("div",{className:"directions-loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),jsxRuntimeExports.jsx("span",{children:"Loading suggestions..."})]}):xt.length>0?xt.map((vt,Rt)=>jsxRuntimeExports.jsxs("div",{className:`direction-item direction-${vt.category}`,onClick:()=>tn(vt),children:[jsxRuntimeExports.jsxs("div",{className:"direction-header",children:[jsxRuntimeExports.jsx("h5",{className:"direction-title",children:vt.title}),jsxRuntimeExports.jsx("span",{className:"direction-category",children:vt.category})]}),jsxRuntimeExports.jsx("p",{className:"direction-description",children:vt.description}),jsxRuntimeExports.jsx("div",{className:"direction-context",children:jsxRuntimeExports.jsxs("small",{children:["Context: ",vt.context]})})]},Rt)):jsxRuntimeExports.jsx("div",{className:"no-directions",children:jsxRuntimeExports.jsx("p",{children:"No direction suggestions available"})})})]}),jsxRuntimeExports.jsxs("div",{className:"threads-form-group",children:[jsxRuntimeExports.jsx("textarea",{id:"draft-section-input",value:Ct,onChange:vt=>_t(vt.target.value),className:"context-textarea",rows:2,placeholder:"Draft Section - Type your draft message here...",disabled:nt}),jsxRuntimeExports.jsx("div",{className:"message-response-container",children:jsxRuntimeExports.jsx("div",{className:"message-response-content",children:jsxRuntimeExports.jsxs("div",{className:"terminal-output",children:[qt.sort((vt,Rt)=>new Date(vt.timestamp).getTime()-new Date(Rt.timestamp).getTime()).map(vt=>vt.type==="status-update"?jsxRuntimeExports.jsxs("div",{className:"terminal-line",children:[jsxRuntimeExports.jsxs("span",{className:"terminal-timestamp",children:["[",new Date(vt.timestamp).toLocaleTimeString(),"]"]}),jsxRuntimeExports.jsxs("span",{className:"terminal-message",children:["status:"," ",entryToMessage(vt,"status-update")]})]},getEntryId(vt)):jsxRuntimeExports.jsxs("div",{className:"terminal-response",children:[jsxRuntimeExports.jsxs("div",{className:"terminal-response-header",children:[jsxRuntimeExports.jsx("div",{onClick:()=>navigator.clipboard.writeText(entryToMessage(vt)),className:"terminal-copy-btn",title:"Copy response to clipboard",children:""}),jsxRuntimeExports.jsx("span",{className:"terminal-response-label",children:vt.type==="streaming-maddie"?"Maddie's tone":vt.type})]}),jsxRuntimeExports.jsx("div",{className:"terminal-response-content",children:entryToMessage(vt)})]},getEntryId(vt))),qt.length===0&&!nt&&jsxRuntimeExports.jsx("div",{className:"terminal-placeholder",children:jsxRuntimeExports.jsx("span",{className:"terminal-message",children:"Generated response will appear here..."})})]})})})]})]})})})]})]}),jsxRuntimeExports.jsx(ContextModal,{isOpen:Ft,onClose:()=>Mt(!1),contextData:Bt})]})};function ListingView(){const{t:s}=useTranslation(),[e,i]=reactExports.useState([]),[o,a]=reactExports.useState(!0),[c,d]=reactExports.useState(null),{listingService:h}=useServices();reactExports.useEffect(()=>{(async()=>{try{a(!0),d(null);const j=await h.fetchListings();i(j||[])}catch(j){console.error("Error fetching listings:",j),d(j.message)}finally{a(!1)}})()},[h]);const g=reactExports.useMemo(()=>[{accessorKey:"id",header:s("columns.id"),cell:({getValue:_})=>{const j=_();return jsxRuntimeExports.jsx(Link,{to:`/listing/${j}`,className:"listing-id-link",children:j})}},{accessorKey:"airbnb_payload.formattedAddress",header:s("listings.address"),cell:({getValue:_})=>_()||s("columns.na")}],[s]);return jsxRuntimeExports.jsxs("div",{className:"listings",children:[jsxRuntimeExports.jsxs("div",{className:"listings-header",children:[jsxRuntimeExports.jsx("h1",{className:"listings-title",children:s("listings.title")}),jsxRuntimeExports.jsx("p",{className:"listings-stats",children:o?s("listings.loadingListings"):s("listings.totalListings",{count:e.length})})]}),jsxRuntimeExports.jsx(DataTable,{data:e,columns:g,loading:o,error:c,enablePagination:!0,className:"listings-data-table"})]})}function ResponsivePagination({currentPage:s,totalPages:e,pageSize:i,totalCount:o,onPageChange:a,onPageSizeChange:c}){const{t:d}=useTranslation(),h=Math.min(s*i+1,o),g=Math.min((s+1)*i,o);return jsxRuntimeExports.jsxs("div",{className:"responsive-pagination",children:[jsxRuntimeExports.jsx("div",{className:"pagination-info",children:jsxRuntimeExports.jsx("span",{className:"pagination-stats",children:d("dataTable.showingEntries",{start:h,end:g,total:o})})}),jsxRuntimeExports.jsxs("div",{className:"pagination-controls",children:[jsxRuntimeExports.jsx("button",{onClick:()=>a(0),disabled:s===0,className:"pagination-btn first","aria-label":"First page",children:""}),jsxRuntimeExports.jsx("button",{onClick:()=>a(s-1),disabled:s===0,className:"pagination-btn prev","aria-label":"Previous page",children:""}),jsxRuntimeExports.jsxs("span",{className:"pagination-current",children:[s+1," / ",e]}),jsxRuntimeExports.jsx("button",{onClick:()=>a(s+1),disabled:s>=e-1,className:"pagination-btn next","aria-label":"Next page",children:""}),jsxRuntimeExports.jsx("button",{onClick:()=>a(e-1),disabled:s>=e-1,className:"pagination-btn last","aria-label":"Last page",children:""})]}),jsxRuntimeExports.jsxs("div",{className:"pagination-size",children:[jsxRuntimeExports.jsx("select",{value:i,onChange:_=>c(Number(_.target.value)),className:"page-size-select",children:[5,10,20,50].map(_=>jsxRuntimeExports.jsx("option",{value:_,children:_},_))}),jsxRuntimeExports.jsx("span",{className:"page-size-label",children:d("dataTable.perPage")})]})]})}function TaskCard({task:s,updateTaskStatus:e,updateTaskTimes:i}){const{t:o}=useTranslation(),a=s.status==="assigned",c=s.status==="accepted",d=s.status==="in_progress",h=s.status==="accepted",g=async()=>{await i(s.id,{started_at:new Date().toISOString()})},_=async()=>{await i(s.id,{finished_at:new Date().toISOString()})},j=()=>{window.location.href=`/tasks/${s.id}`};return jsxRuntimeExports.jsxs("div",{className:"task-card",children:[jsxRuntimeExports.jsxs("div",{className:"task-card-header",children:[jsxRuntimeExports.jsx("h3",{className:"task-card-title",children:s.title}),jsxRuntimeExports.jsxs("div",{className:"task-card-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-minimal",onClick:j,children:o("columns.view")}),a&&jsxRuntimeExports.jsx("button",{className:"btn-minimal",onClick:()=>e(s.id,"accepted"),children:o("columns.accept")}),c&&jsxRuntimeExports.jsx("button",{className:"btn-minimal",onClick:g,children:o("columns.start")}),d&&jsxRuntimeExports.jsx("button",{className:"btn-minimal",onClick:_,children:o("columns.complete")}),h&&jsxRuntimeExports.jsx("button",{className:"btn-minimal",onClick:()=>e(s.id,"assigned"),children:o("columns.cancel")})]})]}),jsxRuntimeExports.jsx("div",{className:"task-card-content",children:jsxRuntimeExports.jsxs("div",{className:"task-card-details",children:[jsxRuntimeExports.jsxs("div",{className:"task-field",children:[jsxRuntimeExports.jsxs("span",{className:"task-detail-label",children:[o("columns.status"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-detail-value",children:jsxRuntimeExports.jsx("span",{className:`status-badge status-${s.status}`,children:o(`statuses.${s.status}`)})})]}),jsxRuntimeExports.jsxs("div",{className:"task-field",children:[jsxRuntimeExports.jsxs("span",{className:"task-detail-label",children:[o("columns.scheduled"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-detail-value",children:formatDateTime(s.scheduled_datetime)})]}),jsxRuntimeExports.jsxs("div",{className:"task-field",children:[jsxRuntimeExports.jsxs("span",{className:"task-detail-label",children:[o("columns.listing"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-detail-value",children:s.listing_id})]}),s.started_at&&jsxRuntimeExports.jsxs("div",{className:"task-field",children:[jsxRuntimeExports.jsxs("span",{className:"task-detail-label",children:[o("columns.started"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-detail-value",children:formatDateTime(s.started_at)})]}),s.finished_at&&jsxRuntimeExports.jsxs("div",{className:"task-field",children:[jsxRuntimeExports.jsxs("span",{className:"task-detail-label",children:[o("columns.finished"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-detail-value",children:formatDateTime(s.finished_at)})]}),s.description&&jsxRuntimeExports.jsxs("div",{className:"task-field",children:[jsxRuntimeExports.jsxs("span",{className:"task-detail-label",children:[o("columns.description"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-detail-value",children:s.description})]})]})})]})}function DesktopTable({tasks:s,loading:e,updateTaskStatus:i,updateTaskTimes:o}){const{t:a}=useTranslation();return e||s.length===0?null:jsxRuntimeExports.jsx("div",{className:"desktop-table-container",children:jsxRuntimeExports.jsxs("table",{className:"desktop-task-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:a("columns.scheduled")}),jsxRuntimeExports.jsx("th",{children:a("columns.listing")}),jsxRuntimeExports.jsx("th",{children:a("columns.task")}),jsxRuntimeExports.jsx("th",{children:a("columns.status")}),jsxRuntimeExports.jsx("th",{children:a("tasks.actions")})]})}),jsxRuntimeExports.jsx("tbody",{children:s.map(c=>{const d=c.status==="assigned",h=c.status==="accepted",g=c.status==="in_progress",_=c.status==="accepted",j=async()=>{await o(c.id,{started_at:new Date().toISOString()})},b=async()=>{await o(c.id,{finished_at:new Date().toISOString()})},$=()=>{window.location.href=`/tasks/${c.id}`};return jsxRuntimeExports.jsxs("tr",{className:"desktop-task-row",children:[jsxRuntimeExports.jsx("td",{children:formatDateTime(c.scheduled_datetime)}),jsxRuntimeExports.jsx("td",{children:c.listing_id}),jsxRuntimeExports.jsx("td",{children:c.title}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("span",{className:`status-badge status-${c.status}`,children:a(`statuses.${c.status}`)})}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsxs("div",{className:"desktop-actions",children:[jsxRuntimeExports.jsx("button",{className:"btn-view",onClick:$,children:a("columns.view")}),d&&jsxRuntimeExports.jsx("button",{className:"btn-accept",onClick:()=>i(c.id,"accepted"),children:a("columns.accept")}),h&&jsxRuntimeExports.jsx("button",{className:"btn-start",onClick:j,children:a("columns.start")}),g&&jsxRuntimeExports.jsx("button",{className:"btn-complete",onClick:b,children:a("columns.complete")}),_&&jsxRuntimeExports.jsx("button",{className:"btn-cancel",onClick:()=>i(c.id,"assigned"),children:a("columns.cancel")})]})})]},c.id)})})]})})}function CleanerTaskView(){const{user:s}=useAuth(),{t:e}=useTranslation(),[i,o]=reactExports.useState(!1),[a,c]=reactExports.useState(()=>{const lt=new URLSearchParams(window.location.search);return{assigned:lt.get("assigned")==="true"||!lt.has("assigned")&&!lt.has("accepted")&&!lt.has("in_progress")&&!lt.has("completed")&&!lt.has("admin_accepted"),accepted:lt.get("accepted")==="true"||!lt.has("assigned")&&!lt.has("accepted")&&!lt.has("in_progress")&&!lt.has("completed")&&!lt.has("admin_accepted"),in_progress:lt.get("in_progress")==="true"||!lt.has("assigned")&&!lt.has("accepted")&&!lt.has("in_progress")&&!lt.has("completed")&&!lt.has("admin_accepted"),completed:lt.get("completed")==="true",admin_accepted:lt.get("admin_accepted")==="true"}});reactExports.useEffect(()=>{const lt=new URLSearchParams;Object.entries(a).forEach(([ut,ct])=>{ct&&lt.set(ut,"true")});const at=`${window.location.pathname}${lt.toString()?"?"+lt.toString():""}`;window.history.replaceState({},"",at)},[a]);const d=reactExports.useMemo(()=>{const lt=Object.entries(a).filter(([at,ut])=>ut).map(([at])=>at);return lt.length>0?lt:void 0},[a]),h=lt=>{c(at=>({...at,[lt]:!at[lt]}))};reactExports.useEffect(()=>{const lt=at=>{const ut=at.target;i&&!ut.closest(".status-filter-dropdown")&&o(!1)};return document.addEventListener("mousedown",lt),()=>document.removeEventListener("mousedown",lt)},[i]);const{tasks:g,loading:_,error:j,totalCount:b,pagination:$,sorting:et,globalFilter:_e,handleServerSideChange:st,updateTaskStatus:ot,updateTaskTimes:tt}=useTaskTable(!0,d),nt=Math.ceil(b/$.pageSize),rt=lt=>{st({pagination:{...$,pageIndex:lt},sorting:et,globalFilter:_e})},it=lt=>{st({pagination:{pageIndex:0,pageSize:lt},sorting:et,globalFilter:_e})};return s?jsxRuntimeExports.jsxs("div",{className:"cleaner-tasks-responsive",children:[jsxRuntimeExports.jsxs("div",{className:"tasks-header",children:[jsxRuntimeExports.jsx("h1",{className:"tasks-title",children:e("navigation.tasks")}),jsxRuntimeExports.jsxs("div",{className:"status-filter-dropdown",children:[jsxRuntimeExports.jsxs("button",{className:"filter-dropdown-btn",onClick:()=>o(!i),children:[e("tasks.filterByStatus")," "]}),i&&jsxRuntimeExports.jsxs("div",{className:"filter-dropdown-menu",children:[jsxRuntimeExports.jsxs("label",{className:"filter-dropdown-item",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:a.assigned,onChange:()=>h("assigned")}),e("statuses.assigned")]}),jsxRuntimeExports.jsxs("label",{className:"filter-dropdown-item",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:a.accepted,onChange:()=>h("accepted")}),e("statuses.accepted")]}),jsxRuntimeExports.jsxs("label",{className:"filter-dropdown-item",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:a.in_progress,onChange:()=>h("in_progress")}),e("statuses.in_progress")]}),jsxRuntimeExports.jsxs("label",{className:"filter-dropdown-item",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:a.completed,onChange:()=>h("completed")}),e("statuses.completed")]}),jsxRuntimeExports.jsxs("label",{className:"filter-dropdown-item",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:a.admin_accepted,onChange:()=>h("admin_accepted")}),e("statuses.admin_accepted")]})]})]})]}),_?jsxRuntimeExports.jsxs("div",{className:"loading-container",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),jsxRuntimeExports.jsx("span",{children:e("tasks.loading")})]}):j?jsxRuntimeExports.jsxs("div",{className:"error-container",children:[jsxRuntimeExports.jsx("h3",{className:"error-title",children:e("dataTable.failedToLoad")}),jsxRuntimeExports.jsx("p",{className:"error-message",children:j})]}):g.length===0?jsxRuntimeExports.jsxs("div",{className:"empty-state",children:[jsxRuntimeExports.jsx("div",{className:"empty-state-icon",children:""}),jsxRuntimeExports.jsx("h3",{className:"empty-state-title",children:e("dataTable.noData")}),jsxRuntimeExports.jsx("p",{className:"empty-state-description",children:e("dataTable.noDataAvailable")})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DesktopTable,{tasks:g,loading:_,updateTaskStatus:ot,updateTaskTimes:tt}),jsxRuntimeExports.jsx("div",{className:"mobile-cards",children:g.map(lt=>jsxRuntimeExports.jsx(TaskCard,{task:lt,updateTaskStatus:ot,updateTaskTimes:tt},lt.id))}),nt>1&&jsxRuntimeExports.jsx(ResponsivePagination,{currentPage:$.pageIndex,totalPages:nt,pageSize:$.pageSize,totalCount:b,onPageChange:rt,onPageSizeChange:it})]})]}):jsxRuntimeExports.jsx("div",{className:"cleaner-tasks-responsive",children:jsxRuntimeExports.jsx("div",{className:"error-message",children:e("tasks.loginRequired")})})}function TaskAuditTrail({taskId:s,taskService:e}){const{t:i}=useTranslation(),[o,a]=reactExports.useState([]),[c,d]=reactExports.useState(!0),[h,g]=reactExports.useState(null);reactExports.useEffect(()=>{s&&e&&(async()=>{try{d(!0);const st=await e.getTaskAuditTrail(s);a(st)}catch(st){const ot=st instanceof Error?st.message:String(st);g(ot)}finally{d(!1)}})()},[s,e]);const _=_e=>{switch(_e){case"INSERT":return"";case"UPDATE":return"";case"DELETE":return"";default:return""}},j=_e=>{switch(_e){case"INSERT":return"audit-insert";case"UPDATE":return"audit-update";case"DELETE":return"audit-delete";default:return"audit-default"}},b=(_e,st,ot)=>!ot||ot.length===0?null:ot.map(tt=>{const nt=_e==null?void 0:_e[tt],rt=st==null?void 0:st[tt];return{field:tt,oldValue:nt!==void 0?nt:null,newValue:rt!==void 0?rt:null}}).filter(tt=>tt.oldValue!==tt.newValue),$=_e=>{if(_e==null)return"null";if(typeof _e=="string"&&_e.includes("T"))try{return formatDateTime(_e)}catch{return _e}return String(_e)},et=_e=>{var st;return _e.changed_by?_e.changed_by_name?_e.changed_by_name:_e.changed_by_email?((st=_e.changed_by_email)==null?void 0:st.split("@")[0])||"":i("audit.unknownUser"):i("audit.system")};return c?jsxRuntimeExports.jsxs("div",{className:"audit-trail-loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),jsxRuntimeExports.jsx("p",{children:i("audit.loading")})]}):h?jsxRuntimeExports.jsx("div",{className:"audit-trail-error",children:jsxRuntimeExports.jsx("p",{className:"error-message",children:h})}):o.length===0?jsxRuntimeExports.jsx("div",{className:"audit-trail-empty",children:jsxRuntimeExports.jsx("p",{children:i("audit.noHistory")})}):jsxRuntimeExports.jsx("div",{className:"audit-trail-list",children:o.map((_e,st)=>{var ot;return jsxRuntimeExports.jsxs("div",{className:`audit-entry ${j(_e.action_type||"UPDATE")}`,children:[jsxRuntimeExports.jsxs("div",{className:"audit-entry-header",children:[jsxRuntimeExports.jsx("div",{className:"audit-entry-icon",children:_(_e.action_type||"UPDATE")}),jsxRuntimeExports.jsxs("div",{className:"audit-entry-info",children:[jsxRuntimeExports.jsxs("div",{className:"audit-entry-action",children:[jsxRuntimeExports.jsx("span",{className:"action-type",children:_e.action_type}),jsxRuntimeExports.jsx("span",{className:"action-time",children:formatDateTime(_e.changed_at)})]}),jsxRuntimeExports.jsxs("div",{className:"audit-entry-user",children:[i("audit.by")," ",et(_e)]})]})]}),jsxRuntimeExports.jsxs("div",{className:"audit-entry-content",children:[_e.action_type==="UPDATE"&&_e.old_values&&_e.new_values&&jsxRuntimeExports.jsxs("div",{className:"audit-entry-values",children:[jsxRuntimeExports.jsxs("span",{className:"values-label",children:[i("audit.valuesChanged"),":"]}),jsxRuntimeExports.jsx("div",{className:"values-list",children:(ot=b(_e.old_values,_e.new_values,_e.changed_fields))==null?void 0:ot.map((tt,nt)=>jsxRuntimeExports.jsxs("div",{className:"value-item",children:[jsxRuntimeExports.jsxs("span",{className:"field-name",children:[tt.field,":"]}),jsxRuntimeExports.jsxs("span",{className:"value-change",children:[jsxRuntimeExports.jsx("span",{className:"old-value",children:$(tt.oldValue)}),jsxRuntimeExports.jsx("span",{className:"arrow",children:""}),jsxRuntimeExports.jsx("span",{className:"new-value",children:$(tt.newValue)})]})]},nt))})]}),_e.context&&Object.keys(_e.context).length>0&&jsxRuntimeExports.jsxs("div",{className:"audit-entry-context",children:[jsxRuntimeExports.jsxs("span",{className:"context-label",children:[i("audit.context"),":"]}),jsxRuntimeExports.jsx("pre",{className:"context-data",children:JSON.stringify(_e.context,null,2)})]})]}),st<o.length-1&&jsxRuntimeExports.jsx("div",{className:"audit-entry-connector"})]},_e.id)})})}function TodoList({attachedToType:s=null,attachedToId:e=null,title:i="TODOs",showCreateButton:o=!0,showAttachmentInfo:a=!1}){const{isAdmin:c,isCleaner:d}=useAuth(),{userService:h,todoService:g}=useServices(),[_,j]=reactExports.useState([]),[b,$]=reactExports.useState(!0),[et,_e]=reactExports.useState(null),[st,ot]=reactExports.useState(!1),tt=reactExports.useCallback(async()=>{try{$(!0),_e(null);const ut=await g.fetchTodos({attachedToType:s,attachedToId:e,isDone:!1});j(ut||[])}catch(ut){console.error("Error fetching todos:",ut);const ct=ut instanceof Error?ut.message:String(ut);_e(ct)}finally{$(!1)}},[s,e,g]);reactExports.useEffect(()=>{tt()},[tt]);const nt=()=>{ot(!1),tt()},rt=async(ut,ct)=>{try{const ht=await h.getCurrentUser(),dt=ht==null?void 0:ht.id;await g.updateTodoStatus(ut,ct,dt),tt()}catch(ht){console.error("Error updating todo status:",ht),_e(ht instanceof Error?ht.message:String(ht))}},it=async ut=>{if(c&&confirm("Are you sure you want to delete this TODO?"))try{await g.deleteTodo(ut),tt()}catch(ct){console.error("Error deleting todo:",ct),_e(ct instanceof Error?ct.message:String(ct))}},lt=ut=>ut?"status-completed":"status-pending",at=ut=>ut.attached_to_type?`${ut.attached_to_type}: ${ut.attached_to_id}`:"Unattached";return b?jsxRuntimeExports.jsx("div",{className:"todo-list",children:jsxRuntimeExports.jsx("div",{className:"loading",children:"Loading TODOs..."})}):jsxRuntimeExports.jsxs("div",{className:"todo-list",children:[jsxRuntimeExports.jsxs("div",{className:"todos-header",children:[jsxRuntimeExports.jsx("h3",{children:i}),o&&(c||d)&&!st&&jsxRuntimeExports.jsx("button",{onClick:()=>ot(!0),className:"btn-primary btn-sm",children:"Add TODO"})]}),et&&jsxRuntimeExports.jsx("div",{className:"error-message",children:et}),st&&jsxRuntimeExports.jsx("div",{className:"todo-form-overlay",children:jsxRuntimeExports.jsx(TodoForm,{attachedToType:s,attachedToId:e,onTodoCreated:nt,onCancel:()=>ot(!1)})}),_.length===0?jsxRuntimeExports.jsx("div",{className:"empty-state",children:jsxRuntimeExports.jsx("p",{children:"No TODOs found."})}):jsxRuntimeExports.jsx("div",{className:"todos-list",children:_.map(ut=>jsxRuntimeExports.jsxs("div",{className:`todo-item ${lt(ut.done)}`,children:[jsxRuntimeExports.jsxs("div",{className:"todo-header",children:[jsxRuntimeExports.jsxs("div",{className:"todo-title-row",children:[jsxRuntimeExports.jsx("h4",{className:"todo-title",children:ut.title}),jsxRuntimeExports.jsx("div",{className:"todo-badges",children:jsxRuntimeExports.jsx("span",{className:`status-badge ${lt(ut.done)}`,children:ut.done?"Done":"Pending"})})]}),jsxRuntimeExports.jsxs("div",{className:"todo-meta",children:[jsxRuntimeExports.jsxs("span",{className:"todo-date",children:["Created: ",new Date(ut.created_at).toLocaleDateString()]}),ut.completed_at&&jsxRuntimeExports.jsxs("span",{className:"todo-completed-date",children:["Completed:"," ",new Date(ut.completed_at).toLocaleDateString()]}),a&&jsxRuntimeExports.jsxs("span",{className:"todo-attachment",children:["Attached to: ",at(ut)]})]})]}),ut.description&&jsxRuntimeExports.jsx("p",{className:"todo-description",children:ut.description}),ut.products&&ut.products.length>0&&jsxRuntimeExports.jsxs("div",{className:"todo-products",children:[jsxRuntimeExports.jsx("h5",{children:"Products needed:"}),jsxRuntimeExports.jsx("ul",{className:"products-list",children:ut.products.map((ct,ht)=>jsxRuntimeExports.jsxs("li",{className:"product-item",children:[jsxRuntimeExports.jsx("span",{className:"product-name",children:ct.product_name}),jsxRuntimeExports.jsxs("span",{className:"product-quantity",children:["",ct.quantity]})]},ht))})]}),jsxRuntimeExports.jsxs("div",{className:"todo-actions",children:[c&&jsxRuntimeExports.jsxs("label",{className:"todo-checkbox",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:ut.done,onChange:ct=>rt(ut.id,ct.target.checked)}),"Mark as done"]}),c&&jsxRuntimeExports.jsx("button",{onClick:()=>it(ut.id),className:"btn-danger btn-sm",children:"Delete"})]})]},ut.id))})]})}function useAutoGeneratedTodo({listingId:s,onTodoUpdated:e}){const{user:i}=useAuth(),{todoService:o}=useServices(),[a,c]=reactExports.useState(null),[d,h]=reactExports.useState(!1),[g,_]=reactExports.useState(null),j=reactExports.useCallback(async()=>{try{h(!0),_(null);const _e=await o.fetchTodos({attachedToType:"listing",attachedToId:s,titlePattern:"[AUTO]",isDone:!1}),st=(_e==null?void 0:_e[0])||null;c(st)}catch(_e){console.error("Error fetching auto-generated todo:",_e),_(_e instanceof Error?_e.message:String(_e))}finally{h(!1)}},[s,o]);reactExports.useEffect(()=>{j()},[j]);const b=reactExports.useCallback(async _e=>{if(!a)return;const st=await o.updateTodo(a.id,{products:_e});c(st)},[a,o]),$=reactExports.useCallback(async _e=>{if(!(i!=null&&i.id))return;const st=await o.createTodo({title:`[AUTO] Product Replenishment ${new Date().toLocaleDateString()}`,description:"Auto-generated todo for product replenishment",products:_e,attached_to_type:"listing",attached_to_id:s});c(st),e==null||e(st)},[i==null?void 0:i.id,o,s,e]),et=reactExports.useCallback(async _e=>{if(i!=null&&i.id)try{_(null),a?await b(_e):_e.length>0&&await $(_e)}catch(st){const ot=st instanceof Error?st.message:String(st);throw console.error("Error saving auto-generated todo:",ot),_(ot),st}},[i==null?void 0:i.id,a,b,$]);return{existingTodo:a,loading:d,error:g,saveAutoTodo:et,refetchAutoTodo:j}}function useProductQuantities({existingTodo:s,onQuantitiesChange:e}){const[i,o]=reactExports.useState({}),[a,c]=reactExports.useState(new Set);reactExports.useEffect(()=>{const j={};Object.values(PRODUCT_CATEGORIES).forEach(b=>{b.products.forEach($=>{j[$]=0})}),o(j)},[]),reactExports.useEffect(()=>{s!=null&&s.products&&o(j=>{const b={...j};return s.products.forEach($=>{b[$.product_name]=$.quantity}),b})},[s]);const d=reactExports.useCallback(j=>Object.entries(j).filter(([,b])=>b>0).map(([b,$])=>({product_name:b,quantity:$})),[]),h=reactExports.useCallback(async(j,b)=>{const $=d(j);try{await e($)}catch(et){console.error("Error saving quantities:",et)}finally{b&&c(et=>{const _e=new Set(et);return _e.delete(b),_e})}},[e,d]),g=reactExports.useCallback(j=>{const b=window.scrollY;c($=>new Set($).add(j)),o($=>{const et={...$,[j]:($[j]||0)+1};return h(et,j),et}),setTimeout(()=>window.scrollTo(0,b),0)},[h]),_=reactExports.useCallback(j=>{const b=window.scrollY;c($=>new Set($).add(j)),o($=>{const et=Math.max(0,($[j]||0)-1),_e={...$,[j]:et};return h(_e,j),_e}),setTimeout(()=>window.scrollTo(0,b),0)},[h]);return{quantities:i,updatingProducts:a,incrementQuantity:g,decrementQuantity:_}}function TodoCreationHelper({listingId:s,onTodoUpdated:e}){const{t:i}=useTranslation(),{existingTodo:o,loading:a,error:c,saveAutoTodo:d}=useAutoGeneratedTodo({listingId:s,onTodoUpdated:e}),{quantities:h,updatingProducts:g,incrementQuantity:_,decrementQuantity:j}=useProductQuantities({existingTodo:o,onQuantitiesChange:d}),[b,$]=reactExports.useState(new Set(Object.keys(PRODUCT_CATEGORIES))),et=reactExports.useMemo(()=>{const ot=[];return Object.entries(PRODUCT_CATEGORIES).forEach(([tt,nt])=>{nt.products.forEach(rt=>{ot.push({name:rt,category:tt,categoryName:nt.name})})}),ot},[]),_e=ot=>{$(tt=>{const nt=new Set(tt);return nt.has(ot)?nt.delete(ot):nt.add(ot),nt})},st=reactExports.useMemo(()=>{const ot={};return Object.keys(PRODUCT_CATEGORIES).forEach(tt=>{ot[tt]=[]}),et.forEach(tt=>{const nt=tt.category;ot[nt]||(ot[nt]=[]),ot[nt].push(tt)}),ot},[et]);return a?jsxRuntimeExports.jsx("div",{className:"todo-creation-helper",children:jsxRuntimeExports.jsx("div",{className:"loading",children:i("todos.loadingProducts")})}):jsxRuntimeExports.jsxs("div",{className:"todo-creation-helper",children:[c&&jsxRuntimeExports.jsx("div",{className:"error-message",children:c}),jsxRuntimeExports.jsx("div",{className:"products-by-category",children:Object.entries(st).filter(([ot,tt])=>tt.length>0).map(([ot,tt])=>{const nt=b.has(ot),rt=PRODUCT_CATEGORIES[ot],it=rt?rt.name:ot;return jsxRuntimeExports.jsxs("div",{className:"category-section",children:[jsxRuntimeExports.jsxs("div",{className:"category-header",onClick:()=>_e(ot),children:[jsxRuntimeExports.jsx("span",{className:`category-toggle ${nt?"collapsed":"expanded"}`,children:""}),jsxRuntimeExports.jsx("h4",{className:"category-title",children:it})]}),!nt&&jsxRuntimeExports.jsx("div",{className:"products-grid",children:tt.map(lt=>jsxRuntimeExports.jsxs("div",{className:`product-block ${(h[lt.name]||0)>0?"has-quantity":""} ${g.has(lt.name)?"updating":""}`,children:[g.has(lt.name)&&jsxRuntimeExports.jsx("div",{className:"product-loading-overlay",children:jsxRuntimeExports.jsx("div",{className:"spinner"})}),jsxRuntimeExports.jsx("div",{className:"product-name",children:lt.name}),jsxRuntimeExports.jsxs("div",{className:"product-controls",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:at=>{at.preventDefault(),at.stopPropagation(),j(lt.name)},className:"quantity-btn quantity-btn-minus",disabled:(h[lt.name]||0)===0||g.has(lt.name),children:"-"}),jsxRuntimeExports.jsx("span",{className:"quantity-display",children:h[lt.name]||0}),jsxRuntimeExports.jsx("button",{type:"button",onClick:at=>{at.preventDefault(),at.stopPropagation(),_(lt.name)},className:"quantity-btn quantity-btn-plus",disabled:g.has(lt.name),children:"+"})]})]},lt.name))})]},ot)})})]})}function NoteList({attachedToType:s=null,attachedToId:e=null,title:i="Notes",showAttachmentInfo:o=!1}){const{t:a}=useTranslation(),{user:c,isAdmin:d,isCleaner:h}=useAuth(),{noteService:g}=useServices(),[_,j]=reactExports.useState([]),[b,$]=reactExports.useState(!0),[et,_e]=reactExports.useState(null),[st,ot]=reactExports.useState(""),[tt,nt]=reactExports.useState(!1),rt=reactExports.useRef(null),it=reactExports.useRef(null),lt=reactExports.useCallback(async()=>{try{$(!0),_e(null);const gt=await g.fetchNotes({attachedToType:s,attachedToId:e});j(gt||[])}catch(gt){console.error("Error fetching notes:",gt);const yt=gt instanceof Error?gt.message:String(gt);_e(yt)}finally{$(!1)}},[g,s,e]),at=()=>{var gt;(gt=rt.current)==null||gt.scrollIntoView({behavior:"smooth"})};reactExports.useEffect(()=>{lt()},[lt]);const ut=async gt=>{if(!(!c||!gt.trim())){nt(!0),_e(null);try{const yt={content:gt.trim(),attached_to_type:s,attached_to_id:e};await g.createNote(yt),ot(""),lt(),setTimeout(()=>at(),100)}catch(yt){console.error("Error creating note:",yt),_e(yt instanceof Error?yt.message:String(yt))}finally{nt(!1)}}},ct=gt=>{gt.key==="Enter"&&!gt.shiftKey&&(gt.preventDefault(),st.trim()&&!tt&&ut(st))},ht=gt=>{gt.preventDefault(),st.trim()&&!tt&&ut(st)},dt=async gt=>{if(d&&confirm(a("notes.deleteConfirm")))try{await g.deleteNote(gt),lt()}catch(yt){console.error("Error deleting note:",yt),_e(yt instanceof Error?yt.message:String(yt))}},pt=gt=>gt.attached_to_type?`${gt.attached_to_type}: ${gt.attached_to_id}`:a("todos.unattached");return b?jsxRuntimeExports.jsx("div",{className:"note-list",children:jsxRuntimeExports.jsx("div",{className:"loading",children:a("notes.loadingNotes")})}):jsxRuntimeExports.jsxs("div",{className:"chat-container",children:[i&&jsxRuntimeExports.jsx("div",{className:"chat-header",children:jsxRuntimeExports.jsx("h3",{children:i})}),jsxRuntimeExports.jsxs("div",{className:"chat-messages",children:[b&&jsxRuntimeExports.jsx("div",{className:"chat-loading",children:a("notes.loadingNotes")}),!b&&_.length===0&&jsxRuntimeExports.jsx("div",{className:"chat-empty",children:jsxRuntimeExports.jsx("p",{children:a("notes.noNotesYet")})}),_.map(gt=>jsxRuntimeExports.jsxs("div",{className:"chat-message",children:[jsxRuntimeExports.jsxs("div",{className:"message-header",children:[jsxRuntimeExports.jsx("span",{className:"message-author",children:gt.user_name||gt.user_email||a("notes.unknownUser")}),jsxRuntimeExports.jsx("span",{className:"message-time",children:new Date(gt.created_at).toLocaleString()}),d&&jsxRuntimeExports.jsx("button",{onClick:()=>dt(gt.id),className:"message-delete",title:a("notes.deleteNote"),children:""})]}),jsxRuntimeExports.jsx("div",{className:"message-content",children:gt.content}),o&&jsxRuntimeExports.jsxs("div",{className:"message-attachment",children:[a("notes.attachedToLabel"),pt(gt)]})]},gt.id)),jsxRuntimeExports.jsx("div",{ref:rt})]}),(d||h)&&jsxRuntimeExports.jsxs("div",{className:"chat-input-container",children:[et&&jsxRuntimeExports.jsx("div",{className:"chat-error",children:et}),jsxRuntimeExports.jsxs("form",{onSubmit:ht,className:"chat-input-form",children:[jsxRuntimeExports.jsx("textarea",{ref:it,value:st,onChange:gt=>ot(gt.target.value),onKeyPress:ct,placeholder:a("notes.typePlaceholder"),className:"chat-input",rows:1,disabled:tt}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:!st.trim()||tt,className:"chat-send-btn",children:a(tt?"notes.sending":"notes.send")})]})]})]})}function TaskDetailView(){const{id:s}=useParams(),e=useNavigate(),{user:i,isAdmin:o}=useAuth(),{taskService:a}=useServices(),{t:c}=useTranslation(),[d,h]=reactExports.useState(null),[g,_]=reactExports.useState(!0),[j,b]=reactExports.useState(null),[$,et]=reactExports.useState(!1),[_e,st]=reactExports.useState("chat"),[ot,tt]=reactExports.useState(!1),[nt,rt]=reactExports.useState(!1),[it,lt]=reactExports.useState(!1),[at,ut]=reactExports.useState(!1),[ct,ht]=reactExports.useState(null),[dt,pt]=reactExports.useState(""),gt=reactExports.useCallback(async()=>{try{if(!s)return;_(!0);const wt=await a.getTask(s);h(wt)}catch(wt){b(wt.message)}finally{_(!1)}},[a,s]);reactExports.useEffect(()=>{i&&s&&gt()},[gt,i,s]);const yt=()=>{e(-1)},jt=wt=>`status-badge status-${wt}`,Tt=reactExports.useCallback(async(wt,bt)=>{if(d)try{if(_(!0),wt==="started_at"||wt==="finished_at"){const Lt={[wt]:bt};await a.updateTaskTimes(d.id,Lt)}else await a.updateTaskField(d.id,wt,bt);await gt()}catch(Lt){b(Lt.message)}finally{_(!1)}},[gt,d,a]),Ct=reactExports.useCallback(async wt=>{if(d)try{_(!0),await a.updateTaskStatus(d.id,wt),await gt()}catch(bt){b(bt.message)}finally{_(!1)}},[gt,d,a]),_t=reactExports.useCallback(async()=>{if(d)try{_(!0),b(null),await a.finalizeTask(d.id),console.log("Task finalized successfully"),await gt()}catch(wt){console.error("Finalization error:",wt),b(wt.message||"Failed to finalize task")}finally{_(!1)}},[gt,d,a]),ft=reactExports.useCallback(async(wt,bt)=>{try{_(!0),await a.updateTaskAssignment(wt,bt,i==null?void 0:i.id),await gt()}catch(Lt){throw b(Lt.message),Lt}finally{_(!1)}},[a,i==null?void 0:i.id,gt]),mt=reactExports.useCallback((wt,bt)=>{ht(wt),pt(bt||""),ut(!0)},[]),xt=reactExports.useCallback(()=>{ut(!1),ht(null),pt("")},[]),Et=reactExports.useCallback(async()=>{ct&&dt&&(await Tt(ct,dt),xt())},[ct,dt,Tt,xt]),St=({field:wt,value:bt})=>{if(!d)return null;const Ft=!(wt==="started_at"||wt==="finished_at")||d.status!=="assigned"&&d.status!=="unassigned",Mt=d.status!=="admin_accepted"||o,Bt=Ft&&Mt;return jsxRuntimeExports.jsx("div",{className:`date-field ${Bt?"clickable":""}`,onClick:Bt?()=>mt(wt,bt?bt.slice(0,16):""):void 0,children:jsxRuntimeExports.jsx("span",{children:bt?formatDateTime(bt):c("tasks.notSet")})})};return g?jsxRuntimeExports.jsx("div",{className:"task-detail",children:jsxRuntimeExports.jsxs("div",{className:"task-detail-loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),jsxRuntimeExports.jsx("p",{children:c("tasks.loadingDetails")})]})}):j?jsxRuntimeExports.jsx("div",{className:"task-detail",children:jsxRuntimeExports.jsxs("div",{className:"task-detail-error",children:[jsxRuntimeExports.jsx("h2",{children:c("tasks.errorLoading")}),jsxRuntimeExports.jsx("p",{children:j}),jsxRuntimeExports.jsx("button",{onClick:yt,className:"btn-primary",children:c("tasks.goBack")})]})}):d?jsxRuntimeExports.jsxs("div",{className:"task-detail",children:[jsxRuntimeExports.jsx("div",{className:"task-detail-header",children:jsxRuntimeExports.jsxs("button",{onClick:yt,className:"btn-back",children:[" ",c("tasks.back")]})}),jsxRuntimeExports.jsxs("div",{className:"task-detail-content",children:[jsxRuntimeExports.jsxs("div",{className:"task-detail-section",children:[jsxRuntimeExports.jsx("div",{className:"section-header",children:jsxRuntimeExports.jsx("h2",{className:"section-title",children:c("tasks.information")})}),jsxRuntimeExports.jsxs("div",{className:"task-info-mobile",children:[jsxRuntimeExports.jsxs("div",{className:"task-info-primary",children:[jsxRuntimeExports.jsxs("div",{className:"info-item info-item-primary",children:[jsxRuntimeExports.jsx("label",{children:c("taskDetail.titleLabel")}),jsxRuntimeExports.jsx("span",{className:"task-title",children:d.title||c("columns.na")})]}),jsxRuntimeExports.jsxs("div",{className:"info-item info-item-primary",children:[jsxRuntimeExports.jsx("label",{children:c("taskDetail.statusLabel")}),jsxRuntimeExports.jsx("span",{className:jt(d.status),children:c(`statuses.${d.status}`)})]})]}),jsxRuntimeExports.jsxs("div",{className:"task-info-secondary",children:[jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("label",{children:c("taskDetail.scheduledLabel")}),jsxRuntimeExports.jsx("span",{children:formatDateTime(d.scheduled_datetime)})]}),jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("label",{children:c("taskDetail.listingIdLabel")}),jsxRuntimeExports.jsx("span",{className:"listing-id",children:d.listing_id||c("columns.na")})]}),o&&jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("label",{children:c("taskDetail.assignedToLabel")}),jsxRuntimeExports.jsx(AssignmentDropdown,{currentAssignedTo:d.assigned_to,taskId:d.id,onAssignmentChange:ft,disabled:g})]}),jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("label",{children:c("taskDetail.startedAtLabel")}),jsxRuntimeExports.jsx(St,{field:"started_at",value:d.started_at})]}),jsxRuntimeExports.jsxs("div",{className:"info-item",children:[jsxRuntimeExports.jsx("label",{children:c("taskDetail.finishedAtLabel")}),jsxRuntimeExports.jsx(St,{field:"finished_at",value:d.finished_at})]}),jsxRuntimeExports.jsxs("div",{className:"section-actions",children:[d.status==="assigned"&&jsxRuntimeExports.jsx("button",{onClick:()=>Ct("accepted"),className:"btn-start",disabled:g,children:c("tasks.acceptTask")}),d.status==="accepted"&&jsxRuntimeExports.jsx("button",{onClick:()=>Tt("started_at",new Date().toISOString()),className:"btn-start",disabled:g,children:c("tasks.startTask")}),d.status==="in_progress"&&!d.finished_at&&jsxRuntimeExports.jsx("button",{onClick:()=>Tt("finished_at",new Date().toISOString()),className:"btn-end",disabled:g,children:c("tasks.completeTask")}),o&&d.status==="completed"&&jsxRuntimeExports.jsx("div",{className:"admin-review-actions",children:jsxRuntimeExports.jsx("button",{onClick:_t,className:"btn-accept",disabled:g,children:c("tasks.acceptCompletion")})})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"task-detail-section",children:[jsxRuntimeExports.jsx("div",{className:"section-header",children:jsxRuntimeExports.jsxs("button",{onClick:()=>lt(!it),className:"section-toggle","aria-label":c(it?"collapse_section":"expand_section"),children:[jsxRuntimeExports.jsx("span",{className:`expand-icon ${it?"expanded":""}`,children:""}),jsxRuntimeExports.jsx("span",{className:"section-title",children:c("taskDetail.taskHelper")})]})}),it&&d.listing_id&&jsxRuntimeExports.jsx(TodoCreationHelper,{listingId:d.listing_id})]}),d.listing_id&&jsxRuntimeExports.jsxs("div",{className:"task-detail-section",children:[jsxRuntimeExports.jsx("div",{className:"section-header",children:jsxRuntimeExports.jsxs("button",{onClick:()=>rt(!nt),className:"section-toggle","aria-label":c(nt?"collapse_section":"expand_section"),children:[jsxRuntimeExports.jsx("span",{className:`expand-icon ${nt?"expanded":""}`,children:""}),jsxRuntimeExports.jsx("span",{className:"section-title",children:c("listings.listingTodos")})]})}),nt&&jsxRuntimeExports.jsx(TodoList,{attachedToType:"listing",attachedToId:d.listing_id,title:""})]}),jsxRuntimeExports.jsxs("div",{className:"task-detail-section",children:[jsxRuntimeExports.jsx("div",{className:"section-header",children:jsxRuntimeExports.jsxs("button",{onClick:()=>tt(!ot),className:"section-toggle","aria-label":c(ot?"collapse_section":"expand_section"),children:[jsxRuntimeExports.jsx("span",{className:`expand-icon ${ot?"expanded":""}`,children:""}),jsxRuntimeExports.jsx("span",{className:"section-title",children:c("listings.listingChat")})]})}),ot&&jsxRuntimeExports.jsxs("div",{className:"tabbed-container",children:[jsxRuntimeExports.jsx("div",{className:"tab-header",children:jsxRuntimeExports.jsxs("div",{className:"tab-nav",children:[jsxRuntimeExports.jsx("button",{className:`tab-button ${_e==="chat"?"active":""}`,onClick:()=>st("chat"),children:c("taskDetail.taskTab")}),jsxRuntimeExports.jsx("button",{className:`tab-button ${_e==="listing"?"active":""}`,onClick:()=>st("listing"),children:c("taskDetail.listingTab")})]})}),jsxRuntimeExports.jsx("div",{className:"tab-content",children:_e==="chat"?jsxRuntimeExports.jsx(NoteList,{attachedToType:"task",attachedToId:d.id,title:""}):d.listing_id&&jsxRuntimeExports.jsx(NoteList,{attachedToType:"listing",attachedToId:d.listing_id,title:""})})]})]}),o&&jsxRuntimeExports.jsxs("div",{className:"task-detail-section",children:[jsxRuntimeExports.jsx("div",{className:"section-header",children:jsxRuntimeExports.jsxs("button",{onClick:()=>et(!$),className:"section-toggle","aria-label":c($?"taskDetail.collapseAudit":"taskDetail.expandAudit"),children:[jsxRuntimeExports.jsx("span",{className:`toggle-icon ${$?"expanded":"collapsed"}`,children:""}),jsxRuntimeExports.jsx("h2",{className:"section-title",children:c("audit.history")})]})}),$&&jsxRuntimeExports.jsx("div",{className:"audit-trail-container",children:jsxRuntimeExports.jsx(TaskAuditTrail,{taskId:d.id,taskService:a})})]}),at&&jsxRuntimeExports.jsx("div",{className:"date-modal-overlay",onClick:xt,children:jsxRuntimeExports.jsxs("div",{className:"date-modal",onClick:wt=>wt.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"date-modal-header",children:[jsxRuntimeExports.jsx("h3",{children:c("taskDetail.editDate")}),jsxRuntimeExports.jsx("button",{onClick:xt,className:"date-modal-close",children:""})]}),jsxRuntimeExports.jsx("div",{className:"date-modal-content",children:jsxRuntimeExports.jsx("input",{type:"datetime-local",value:dt,onChange:wt=>pt(wt.target.value),className:"date-modal-input"})}),jsxRuntimeExports.jsxs("div",{className:"date-modal-actions",children:[jsxRuntimeExports.jsx("button",{onClick:xt,className:"btn-cancel",children:c("columns.cancel")}),jsxRuntimeExports.jsx("button",{onClick:Et,className:"btn-save",disabled:g,children:c("columns.save")})]})]})})]})]}):jsxRuntimeExports.jsx("div",{className:"task-detail",children:jsxRuntimeExports.jsxs("div",{className:"task-detail-not-found",children:[jsxRuntimeExports.jsx("h2",{children:c("tasks.notFound")}),jsxRuntimeExports.jsx("p",{children:c("tasks.notFoundDescription")}),jsxRuntimeExports.jsx("button",{onClick:yt,className:"btn-primary",children:c("tasks.goBack")})]})})}function ListingDetailView(){const{t:s}=useTranslation(),{id:e}=useParams(),{listingService:i}=useServices(),[o,a]=reactExports.useState(null),[c,d]=reactExports.useState(!0),[h,g]=reactExports.useState(null);if(reactExports.useEffect(()=>{(async()=>{if(e)try{d(!0),g(null);const b=await i.fetchListing(e);a(b)}catch(b){console.error("Error fetching listing:",b),g(b instanceof Error?b.message:String(b))}finally{d(!1)}})()},[e,i]),c)return jsxRuntimeExports.jsxs("div",{className:"listing-detail-loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner","data-testid":"loading-spinner"}),s("listings.loadingDetails")]});if(h)return jsxRuntimeExports.jsxs("div",{className:"error",children:[jsxRuntimeExports.jsx("h3",{className:"error-title",children:s("listings.failedToLoad")}),jsxRuntimeExports.jsx("p",{className:"error-message",children:h})]});if(!o)return jsxRuntimeExports.jsxs("div",{className:"error",children:[jsxRuntimeExports.jsx("h3",{className:"error-title",children:s("listings.notFound")}),jsxRuntimeExports.jsxs("p",{className:"error-message",children:['The listing with ID "',e,'" was not found.']})]});const _=o.airbnb_payload||{};return jsxRuntimeExports.jsxs("div",{className:"listing-detail",children:[jsxRuntimeExports.jsxs("div",{className:"listing-detail-header",children:[jsxRuntimeExports.jsx("h1",{className:"listing-detail-title",children:s("listings.details")}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-subtitle",children:["ID: ",o.id]})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-content",children:[jsxRuntimeExports.jsxs("div",{className:"listing-detail-section",children:[jsxRuntimeExports.jsx("h2",{children:s("listings.basicInformation")}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-grid",children:[jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.listingId"),":"]}),jsxRuntimeExports.jsx("span",{children:o.id})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.airbnbId"),":"]}),jsxRuntimeExports.jsx("span",{children:o.airbnb_id})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.address"),":"]}),jsxRuntimeExports.jsx("span",{children:_.formattedAddress||s("columns.na")})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.propertyType"),":"]}),jsxRuntimeExports.jsx("span",{children:_.propertyType||s("columns.na")})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.roomType"),":"]}),jsxRuntimeExports.jsx("span",{children:_.roomType||s("columns.na")})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.bedrooms"),":"]}),jsxRuntimeExports.jsx("span",{children:_.bedrooms||s("columns.na")})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.bathrooms"),":"]}),jsxRuntimeExports.jsx("span",{children:_.bathrooms||s("columns.na")})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.maxGuests"),":"]}),jsxRuntimeExports.jsx("span",{children:_.maxGuests||s("columns.na")})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-section",children:[jsxRuntimeExports.jsx("h2",{children:s("listings.dates")}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-grid",children:[jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.created"),":"]}),jsxRuntimeExports.jsx("span",{children:new Date(o.created_at).toLocaleString()})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-item",children:[jsxRuntimeExports.jsxs("label",{children:[s("listings.updated"),":"]}),jsxRuntimeExports.jsx("span",{children:new Date(o.updated_at).toLocaleString()})]})]})]}),_.amenities&&_.amenities.length>0&&jsxRuntimeExports.jsxs("div",{className:"listing-detail-section",children:[jsxRuntimeExports.jsx("h2",{children:s("listings.amenities")}),jsxRuntimeExports.jsx("div",{className:"amenities-list",children:_.amenities.map((j,b)=>jsxRuntimeExports.jsx("span",{className:"amenity-tag",children:j},b))})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-section",children:[jsxRuntimeExports.jsx("h2",{children:s("listings.listingTodos")}),jsxRuntimeExports.jsx(TodoList,{attachedToType:"listing",attachedToId:o.id,title:""})]}),jsxRuntimeExports.jsxs("div",{className:"listing-detail-section",children:[jsxRuntimeExports.jsx("h2",{children:s("listings.listingChat")}),jsxRuntimeExports.jsx(NoteList,{attachedToType:"listing",attachedToId:o.id,title:""})]})]})]})}const LanguageSelector=()=>{const{currentLanguage:s,changeLanguage:e}=useLanguage(),i=[{code:"en",name:"English",flag:""},{code:"es",name:"Espaol",flag:""}];return jsxRuntimeExports.jsx("div",{className:"language-selector",children:jsxRuntimeExports.jsx("select",{value:s,onChange:o=>e(o.target.value),className:"language-select",children:i.map(o=>jsxRuntimeExports.jsxs("option",{value:o.code,children:[o.flag," ",o.name]},o.code))})})},Navigation=()=>{var $,et;const s=useLocation(),{user:e,signOut:i,isAdmin:o,isCleaner:a}=useAuth(),{t:c}=useTranslation(),[d,h]=reactExports.useState(!1),g=reactExports.useRef(null),_=async()=>{try{await i()}catch(_e){console.error("Sign out error:",_e)}},j=()=>{h(!d)},b=()=>{h(!1)};return reactExports.useEffect(()=>{const _e=st=>{g.current&&!g.current.contains(st.target)&&b()};return d?(document.addEventListener("mousedown",_e),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.removeEventListener("mousedown",_e),document.body.style.overflow="unset"}},[d]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("nav",{className:"navigation",children:jsxRuntimeExports.jsx("div",{className:"nav-content",children:jsxRuntimeExports.jsxs("div",{className:"mobile-nav",children:[jsxRuntimeExports.jsxs("div",{className:"mobile-nav-left",children:[jsxRuntimeExports.jsxs("button",{className:"hamburger-btn",onClick:j,"aria-label":"Toggle navigation menu",children:[jsxRuntimeExports.jsx("span",{className:`hamburger-line ${d?"open":""}`}),jsxRuntimeExports.jsx("span",{className:`hamburger-line ${d?"open":""}`}),jsxRuntimeExports.jsx("span",{className:`hamburger-line ${d?"open":""}`})]}),jsxRuntimeExports.jsx(Link,{to:"/",className:"nav-brand",children:c("navigation.brand")})]}),jsxRuntimeExports.jsx("div",{className:"mobile-nav-right",children:jsxRuntimeExports.jsx("span",{className:"mobile-user-email",children:((et=($=e==null?void 0:e.user_metadata)==null?void 0:$.name)==null?void 0:et.split(" ")[0])||(e==null?void 0:e.email)})})]})})}),d&&jsxRuntimeExports.jsx("div",{className:"mobile-overlay",onClick:b}),jsxRuntimeExports.jsxs("div",{ref:g,className:`sidebar ${d?"open":""}`,children:[jsxRuntimeExports.jsxs("div",{className:"sidebar-header",children:[jsxRuntimeExports.jsxs("div",{className:"sidebar-user-info",children:[jsxRuntimeExports.jsx(Link,{to:"/",className:"sidebar-brand",children:c("navigation.brand")}),jsxRuntimeExports.jsx("span",{className:"sidebar-user-email",children:e==null?void 0:e.email}),jsxRuntimeExports.jsx("div",{className:"sidebar-badges",children:o&&jsxRuntimeExports.jsx("span",{className:"admin-badge",children:c("navigation.adminBadge")})})]}),jsxRuntimeExports.jsx("button",{className:"close-btn",onClick:b,"aria-label":"Close navigation menu",children:""})]}),jsxRuntimeExports.jsxs("div",{className:"sidebar-nav-links",children:[jsxRuntimeExports.jsx(Link,{to:"/",className:`sidebar-nav-link ${s.pathname==="/"?"active":""}`,onClick:b,children:c("navigation.dashboard")}),o&&jsxRuntimeExports.jsx(Link,{to:"/healthcheck",className:`sidebar-nav-link ${s.pathname==="/healthcheck"?"active":""}`,onClick:b,children:c("navigation.healthCheck")}),o&&jsxRuntimeExports.jsx(Link,{to:"/listings",className:`sidebar-nav-link ${s.pathname==="/listings"?"active":""}`,onClick:b,children:c("navigation.listings")}),o&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Link,{to:"/admin",className:`sidebar-nav-link ${s.pathname==="/admin"?"active":""}`,onClick:b,children:c("navigation.reservations")}),jsxRuntimeExports.jsx(Link,{to:"/admin/tasks",className:`sidebar-nav-link ${s.pathname==="/admin/tasks"?"active":""}`,onClick:b,children:c("navigation.tasks")}),jsxRuntimeExports.jsx(Link,{to:"/admin/todos",className:`sidebar-nav-link ${s.pathname==="/admin/todos"?"active":""}`,onClick:b,children:c("navigation.todos")}),jsxRuntimeExports.jsx(Link,{to:"/admin/threads",className:`sidebar-nav-link ${s.pathname==="/admin/threads"?"active":""}`,onClick:b,children:c("navigation.threads")})]}),a&&jsxRuntimeExports.jsx(Link,{to:"/cleaner/tasks",className:`sidebar-nav-link ${s.pathname==="/cleaner/tasks"?"active":""}`,onClick:b,children:c("navigation.myTasks")})]}),jsxRuntimeExports.jsxs("div",{className:"sidebar-footer",children:[jsxRuntimeExports.jsx(LanguageSelector,{}),jsxRuntimeExports.jsx("button",{onClick:_,className:"sidebar-signout-btn",children:c("navigation.signOut")})]})]})]})},AuthCallback=()=>{const{t:s}=useTranslation(),[e,i]=reactExports.useState(!0),[o,a]=reactExports.useState(null),c=useNavigate(),{userService:d}=useServices();return reactExports.useEffect(()=>{(async()=>{try{console.log("Handling auth callbackz..."),console.log("URL:",window.location.href);const g=new URLSearchParams(window.location.hash.substring(1));g.has("access_token")||g.has("error")?(console.log("Auth parameters found in URL, processing..."),await d.getCurrentSession()?(console.log("Auth successful, redirecting to home..."),c("/",{replace:!0})):(console.log("Session not ready, waiting..."),setTimeout(()=>{c("/",{replace:!0})},1e3))):(console.log("No auth parameters, checking existing session..."),await d.getCurrentSession()?(console.log("Existing session found, redirecting to home..."),c("/",{replace:!0})):(console.log("No session found, redirecting to login..."),c("/",{replace:!0})))}catch(g){console.error("Unexpected error in auth callback:",g),a(s("auth.unexpectedError")),i(!1)}})()},[d,c,s]),e?jsxRuntimeExports.jsx("div",{className:"container",children:jsxRuntimeExports.jsx("div",{className:"card",children:jsxRuntimeExports.jsxs("div",{className:"loading",children:[jsxRuntimeExports.jsx("h2",{children:s("auth.authenticating")}),jsxRuntimeExports.jsx("p",{children:s("auth.pleaseWait")})]})})}):o?jsxRuntimeExports.jsx("div",{className:"container",children:jsxRuntimeExports.jsx("div",{className:"card",children:jsxRuntimeExports.jsxs("div",{className:"error",children:[jsxRuntimeExports.jsx("h2",{children:s("auth.authenticationError")}),jsxRuntimeExports.jsx("p",{children:o}),jsxRuntimeExports.jsx("button",{onClick:()=>c("/",{replace:!0}),children:s("auth.returnToLogin")})]})})}):null};function CleanerDashboard(){const{user:s}=useAuth(),{t:e}=useTranslation(),{taskService:i}=useServices(),[o,a]=reactExports.useState([]),[c,d]=reactExports.useState(!0),[h,g]=reactExports.useState(null),_=ot=>{const tt=new Date(ot),nt=new Date,rt=tt.getTime()-nt.getTime(),it=Math.ceil(rt/(1e3*60*60*24));return it===0?"today":it===1?"tomorrow":it===-1?"yesterday":it>1?`in ${it} days`:it<-1?`${Math.abs(it)} days ago`:formatDateTime(ot)},j=({task:ot,title:tt,primaryButtonText:nt=e("dashboard.viewTask")})=>jsxRuntimeExports.jsxs("div",{className:"summary-card",children:[jsxRuntimeExports.jsx("h3",{className:"summary-card-title",children:tt}),jsxRuntimeExports.jsxs("div",{className:"task-preview",children:[jsxRuntimeExports.jsx("h4",{className:"task-preview-title",children:ot.title}),jsxRuntimeExports.jsxs("div",{className:"task-preview-details",children:[jsxRuntimeExports.jsxs("span",{className:"task-preview-label",children:[e("columns.scheduled"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-preview-value",children:formatDateTime(ot.scheduled_datetime)})]}),jsxRuntimeExports.jsxs("div",{className:"task-preview-details",children:[jsxRuntimeExports.jsxs("span",{className:"task-preview-label",children:[e("dashboard.when"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-preview-value",children:_(ot.scheduled_datetime)})]}),jsxRuntimeExports.jsxs("div",{className:"task-preview-details",children:[jsxRuntimeExports.jsxs("span",{className:"task-preview-label",children:[e("columns.listing"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-preview-value",children:ot.listing_id})]}),ot.description&&jsxRuntimeExports.jsxs("div",{className:"task-preview-details",children:[jsxRuntimeExports.jsxs("span",{className:"task-preview-label",children:[e("columns.description"),":"]}),jsxRuntimeExports.jsx("span",{className:"task-preview-value",children:ot.description})]})]}),jsxRuntimeExports.jsx("div",{className:"task-preview-actions",children:jsxRuntimeExports.jsx(Link,{to:`/tasks/${ot.id}`,className:"btn-primary",children:nt})})]});reactExports.useEffect(()=>{s&&(async()=>{if(s!=null&&s.id)try{d(!0),g(null);const tt=await i.getTasksCountByStatus(s.id);$(tt);const nt=await i.queryTasks({userId:s.id,pagination:{pageIndex:0,pageSize:10},sorting:[{id:"scheduled_datetime",desc:!1}],globalFilter:"",additionalFilters:{status:["assigned","accepted","in_progress"]}});a(nt.tasks||[])}catch(tt){const nt=tt instanceof Error?tt.message:String(tt);g(nt),console.error("Error fetching dashboard data:",tt),a([])}finally{d(!1)}})()},[s,i]);const[b,$]=reactExports.useState({unassigned:0,assigned:0,accepted:0,in_progress:0,completed:0,admin_accepted:0,cancelled:0}),et=o.filter(ot=>ot.status==="accepted").sort((ot,tt)=>new Date(ot.scheduled_datetime).getTime()-new Date(tt.scheduled_datetime).getTime())[0],_e=o.filter(ot=>ot.status==="assigned").sort((ot,tt)=>new Date(ot.scheduled_datetime).getTime()-new Date(tt.scheduled_datetime).getTime())[0],st=o.filter(ot=>ot.status==="in_progress").sort((ot,tt)=>new Date(ot.started_at||ot.scheduled_datetime).getTime()-new Date(tt.started_at||tt.scheduled_datetime).getTime());return s?c?jsxRuntimeExports.jsx("div",{className:"cleaner-dashboard",children:jsxRuntimeExports.jsxs("div",{className:"loading-container",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),jsxRuntimeExports.jsx("span",{children:e("dashboard.loading")})]})}):h?jsxRuntimeExports.jsx("div",{className:"cleaner-dashboard",children:jsxRuntimeExports.jsxs("div",{className:"error-container",children:[jsxRuntimeExports.jsx("h3",{className:"error-title",children:e("dashboard.errorLoading")}),jsxRuntimeExports.jsx("p",{className:"error-message",children:h})]})}):jsxRuntimeExports.jsx("div",{className:"cleaner-dashboard",children:jsxRuntimeExports.jsxs("div",{className:"dashboard-summary",children:[jsxRuntimeExports.jsxs("div",{className:"summary-card",children:[jsxRuntimeExports.jsx("h3",{className:"summary-card-title",children:e("dashboard.taskSummary")}),jsxRuntimeExports.jsxs("div",{className:"summary-stats",children:[jsxRuntimeExports.jsx(Link,{to:"/cleaner/tasks?status=assigned",className:"summary-stat-link",children:jsxRuntimeExports.jsxs("div",{className:"summary-stat",children:[jsxRuntimeExports.jsx("span",{className:"stat-number",children:b.assigned}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:e("dashboard.pendingAcceptance")})]})}),jsxRuntimeExports.jsx(Link,{to:"/cleaner/tasks?status=accepted",className:"summary-stat-link",children:jsxRuntimeExports.jsxs("div",{className:"summary-stat",children:[jsxRuntimeExports.jsx("span",{className:"stat-number",children:b.accepted}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:e("dashboard.accepted")})]})}),jsxRuntimeExports.jsx(Link,{to:"/cleaner/tasks?status=in_progress",className:"summary-stat-link",children:jsxRuntimeExports.jsxs("div",{className:"summary-stat",children:[jsxRuntimeExports.jsx("span",{className:"stat-number",children:b.in_progress}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:e("dashboard.inProgress")})]})}),jsxRuntimeExports.jsx(Link,{to:"/cleaner/tasks?status=completed",className:"summary-stat-link",children:jsxRuntimeExports.jsxs("div",{className:"summary-stat",children:[jsxRuntimeExports.jsx("span",{className:"stat-number",children:b.completed}),jsxRuntimeExports.jsx("span",{className:"stat-label",children:e("dashboard.completed")})]})})]}),jsxRuntimeExports.jsx("div",{className:"summary-actions",children:jsxRuntimeExports.jsx(Link,{to:"/cleaner/tasks",className:"btn-primary",children:e("dashboard.viewAllTasks")})})]}),et&&jsxRuntimeExports.jsx(j,{task:et,title:e("dashboard.nextAcceptedTask")}),_e&&jsxRuntimeExports.jsx(j,{task:_e,title:e("dashboard.nextPendingTask")}),st.length>0&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:st.map(ot=>jsxRuntimeExports.jsx(j,{task:ot,title:e("dashboard.ongoingTasks"),primaryButtonText:e("dashboard.continueTask")},ot.id))}),o.length===0&&jsxRuntimeExports.jsxs("div",{className:"summary-card",children:[jsxRuntimeExports.jsx("h3",{className:"summary-card-title",children:e("dashboard.noTasks")}),jsxRuntimeExports.jsx("p",{className:"no-tasks-message",children:e("dashboard.noTasksMessage")}),jsxRuntimeExports.jsx("div",{className:"summary-actions",children:jsxRuntimeExports.jsx(Link,{to:"/cleaner/tasks",className:"btn-primary",children:e("dashboard.refreshTasks")})})]})]})}):jsxRuntimeExports.jsx("div",{className:"cleaner-dashboard",children:jsxRuntimeExports.jsx("div",{className:"error-message",children:e("dashboard.loginRequired")})})}const Dashboard=()=>{const{t:s}=useTranslation(),{role:e}=useAuth();return e==="cleaner"?jsxRuntimeExports.jsx(CleanerDashboard,{}):jsxRuntimeExports.jsxs("div",{className:"content-container",children:[jsxRuntimeExports.jsxs("div",{className:"page-header",children:[jsxRuntimeExports.jsx("h1",{className:"page-title",children:s("dashboard.title")}),jsxRuntimeExports.jsx("p",{className:"page-subtitle",children:s("dashboard.welcome")})]}),jsxRuntimeExports.jsxs("div",{className:"empty-state",children:[jsxRuntimeExports.jsx("div",{className:"empty-state-icon",children:""}),jsxRuntimeExports.jsx("h2",{className:"empty-state-title",children:s("dashboard.comingSoon")}),jsxRuntimeExports.jsx("p",{className:"empty-state-description",children:s("dashboard.comingSoonDescription")})]})]})},HealthCheckDisplay=()=>{var _,j,b;const{t:s}=useTranslation(),[e,i]=reactExports.useState(null),[o,a]=reactExports.useState(!0),[c,d]=reactExports.useState(null),{user:h}=useAuth(),{healthCheckService:g}=useServices();return reactExports.useEffect(()=>{h&&(async()=>{try{a(!0),d(null);const et=await g.getHealthCheck();i(et)}catch(et){const _e=et instanceof Error?et.message:"An error occurred";_e.includes("Authentication failed")?d(s("auth.authenticationFailed")):_e.includes("No valid authentication session")?d(s("auth.noAccessToken")):d(_e),console.error("Health check error:",et)}finally{a(!1)}})()},[h,g,s]),o?jsxRuntimeExports.jsxs("div",{className:"loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),s("healthCheck.loading")]}):c?jsxRuntimeExports.jsxs("div",{className:"error",children:[jsxRuntimeExports.jsx("h2",{className:"error-title",children:s("healthCheck.failed")}),jsxRuntimeExports.jsx("p",{className:"error-message",children:c}),c.includes("Authentication failed")&&jsxRuntimeExports.jsx("button",{onClick:()=>window.location.reload(),className:"google-signin-btn",style:{marginTop:"var(--space-4)"},children:s("healthCheck.reloadPage")})]}):jsxRuntimeExports.jsxs("div",{className:"admin-reservations",children:[jsxRuntimeExports.jsxs("div",{className:"admin-header",children:[jsxRuntimeExports.jsx("h1",{className:"admin-title",children:s("healthCheck.title")}),jsxRuntimeExports.jsx("p",{className:"admin-stats",children:s("healthCheck.monitoring")})]}),e&&jsxRuntimeExports.jsxs("div",{style:{padding:"var(--space-6)"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"grid",gap:"var(--space-4)",marginBottom:"var(--space-6)"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-4)",backgroundColor:"var(--graphite-50)",borderRadius:"var(--radius-lg)",border:"1px solid var(--graphite-200)"},children:[jsxRuntimeExports.jsx("strong",{style:{color:"var(--graphite-700)"},children:s("system.overallStatus")}),jsxRuntimeExports.jsx("span",{className:`status-badge status-${e.status==="ok"?"confirmed":"cancelled"}`,children:e.status==="ok"?s("healthCheck.healthy"):s("healthCheck.error")})]}),((_=e.checks)==null?void 0:_.database)&&jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-4)",backgroundColor:"var(--graphite-50)",borderRadius:"var(--radius-lg)",border:"1px solid var(--graphite-200)"},children:[jsxRuntimeExports.jsx("strong",{style:{color:"var(--graphite-700)"},children:s("system.database")}),jsxRuntimeExports.jsxs("div",{style:{textAlign:"right"},children:[jsxRuntimeExports.jsx("span",{className:`status-badge status-${e.checks.database.status==="ok"?"confirmed":"cancelled"}`,children:e.checks.database.status==="ok"?s("healthCheck.connected"):s("healthCheck.error")}),e.checks.database.version&&jsxRuntimeExports.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--graphite-500)",marginTop:"var(--space-1)"},children:[s("system.version"),e.checks.database.version]})]})]}),((j=e.checks)==null?void 0:j.supabase)&&jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-4)",backgroundColor:"var(--graphite-50)",borderRadius:"var(--radius-lg)",border:"1px solid var(--graphite-200)"},children:[jsxRuntimeExports.jsx("strong",{style:{color:"var(--graphite-700)"},children:s("system.supabaseApi")}),jsxRuntimeExports.jsx("span",{className:`status-badge status-${e.checks.supabase.status==="ok"?"confirmed":"cancelled"}`,children:e.checks.supabase.status==="ok"?s("healthCheck.connected"):s("healthCheck.error")})]}),((b=e.checks)==null?void 0:b.environment)&&jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"var(--space-4)",backgroundColor:"var(--graphite-50)",borderRadius:"var(--radius-lg)",border:"1px solid var(--graphite-200)"},children:[jsxRuntimeExports.jsx("strong",{style:{color:"var(--graphite-700)"},children:s("system.environment")}),jsxRuntimeExports.jsx("span",{className:`status-badge status-${e.checks.environment.status==="ok"?"confirmed":"cancelled"}`,children:e.checks.environment.status==="ok"?s("healthCheck.configured"):s("healthCheck.error")})]})]}),jsxRuntimeExports.jsxs("div",{style:{textAlign:"center",color:"var(--graphite-500)",fontSize:"0.875rem",fontStyle:"italic",paddingTop:"var(--space-4)",borderTop:"1px solid var(--graphite-200)"},children:[s("system.lastChecked"),new Date(e.timestamp).toLocaleString()]})]})]})},isString=s=>typeof s=="string",defer=()=>{let s,e;const i=new Promise((o,a)=>{s=o,e=a});return i.resolve=s,i.reject=e,i},makeString=s=>s==null?"":""+s,copy=(s,e,i)=>{s.forEach(o=>{e[o]&&(i[o]=e[o])})},lastOfPathSeparatorRegExp=/###/g,cleanKey=s=>s&&s.indexOf("###")>-1?s.replace(lastOfPathSeparatorRegExp,"."):s,canNotTraverseDeeper=s=>!s||isString(s),getLastOfPath=(s,e,i)=>{const o=isString(e)?e.split("."):e;let a=0;for(;a<o.length-1;){if(canNotTraverseDeeper(s))return{};const c=cleanKey(o[a]);!s[c]&&i&&(s[c]=new i),Object.prototype.hasOwnProperty.call(s,c)?s=s[c]:s={},++a}return canNotTraverseDeeper(s)?{}:{obj:s,k:cleanKey(o[a])}},setPath=(s,e,i)=>{const{obj:o,k:a}=getLastOfPath(s,e,Object);if(o!==void 0||e.length===1){o[a]=i;return}let c=e[e.length-1],d=e.slice(0,e.length-1),h=getLastOfPath(s,d,Object);for(;h.obj===void 0&&d.length;)c=`${d[d.length-1]}.${c}`,d=d.slice(0,d.length-1),h=getLastOfPath(s,d,Object),h!=null&&h.obj&&typeof h.obj[`${h.k}.${c}`]<"u"&&(h.obj=void 0);h.obj[`${h.k}.${c}`]=i},pushPath=(s,e,i,o)=>{const{obj:a,k:c}=getLastOfPath(s,e,Object);a[c]=a[c]||[],a[c].push(i)},getPath=(s,e)=>{const{obj:i,k:o}=getLastOfPath(s,e);if(i&&Object.prototype.hasOwnProperty.call(i,o))return i[o]},getPathWithDefaults=(s,e,i)=>{const o=getPath(s,i);return o!==void 0?o:getPath(e,i)},deepExtend=(s,e,i)=>{for(const o in e)o!=="__proto__"&&o!=="constructor"&&(o in s?isString(s[o])||s[o]instanceof String||isString(e[o])||e[o]instanceof String?i&&(s[o]=e[o]):deepExtend(s[o],e[o],i):s[o]=e[o]);return s},regexEscape=s=>s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const escape=s=>isString(s)?s.replace(/[&<>"'\/]/g,e=>_entityMap[e]):s;class RegExpCache{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const i=this.regExpMap.get(e);if(i!==void 0)return i;const o=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,o),this.regExpQueue.push(e),o}}const chars=[" ",",","?","!",";"],looksLikeObjectPathRegExpCache=new RegExpCache(20),looksLikeObjectPath=(s,e,i)=>{e=e||"",i=i||"";const o=chars.filter(d=>e.indexOf(d)<0&&i.indexOf(d)<0);if(o.length===0)return!0;const a=looksLikeObjectPathRegExpCache.getRegExp(`(${o.map(d=>d==="?"?"\\?":d).join("|")})`);let c=!a.test(s);if(!c){const d=s.indexOf(i);d>0&&!a.test(s.substring(0,d))&&(c=!0)}return c},deepFind=(s,e,i=".")=>{if(!s)return;if(s[e])return Object.prototype.hasOwnProperty.call(s,e)?s[e]:void 0;const o=e.split(i);let a=s;for(let c=0;c<o.length;){if(!a||typeof a!="object")return;let d,h="";for(let g=c;g<o.length;++g)if(g!==c&&(h+=i),h+=o[g],d=a[h],d!==void 0){if(["string","number","boolean"].indexOf(typeof d)>-1&&g<o.length-1)continue;c+=g-c+1;break}a=d}return a},getCleanedCode=s=>s==null?void 0:s.replace("_","-"),consoleLogger={type:"logger",log(s){this.output("log",s)},warn(s){this.output("warn",s)},error(s){this.output("error",s)},output(s,e){var i,o;(o=(i=console==null?void 0:console[s])==null?void 0:i.apply)==null||o.call(i,console,e)}};class Logger{constructor(e,i={}){this.init(e,i)}init(e,i={}){this.prefix=i.prefix||"i18next:",this.logger=e||consoleLogger,this.options=i,this.debug=i.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,i,o,a){return a&&!this.debug?null:(isString(e[0])&&(e[0]=`${o}${this.prefix} ${e[0]}`),this.logger[i](e))}create(e){return new Logger(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Logger(this.logger,e)}}var baseLogger=new Logger;class EventEmitter{constructor(){this.observers={}}on(e,i){return e.split(" ").forEach(o=>{this.observers[o]||(this.observers[o]=new Map);const a=this.observers[o].get(i)||0;this.observers[o].set(i,a+1)}),this}off(e,i){if(this.observers[e]){if(!i){delete this.observers[e];return}this.observers[e].delete(i)}}emit(e,...i){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([a,c])=>{for(let d=0;d<c;d++)a(...i)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([a,c])=>{for(let d=0;d<c;d++)a.apply(a,[e,...i])})}}class ResourceStore extends EventEmitter{constructor(e,i={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=i,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const i=this.options.ns.indexOf(e);i>-1&&this.options.ns.splice(i,1)}getResource(e,i,o,a={}){var _,j;const c=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,d=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let h;e.indexOf(".")>-1?h=e.split("."):(h=[e,i],o&&(Array.isArray(o)?h.push(...o):isString(o)&&c?h.push(...o.split(c)):h.push(o)));const g=getPath(this.data,h);return!g&&!i&&!o&&e.indexOf(".")>-1&&(e=h[0],i=h[1],o=h.slice(2).join(".")),g||!d||!isString(o)?g:deepFind((j=(_=this.data)==null?void 0:_[e])==null?void 0:j[i],o,c)}addResource(e,i,o,a,c={silent:!1}){const d=c.keySeparator!==void 0?c.keySeparator:this.options.keySeparator;let h=[e,i];o&&(h=h.concat(d?o.split(d):o)),e.indexOf(".")>-1&&(h=e.split("."),a=i,i=h[1]),this.addNamespaces(i),setPath(this.data,h,a),c.silent||this.emit("added",e,i,o,a)}addResources(e,i,o,a={silent:!1}){for(const c in o)(isString(o[c])||Array.isArray(o[c]))&&this.addResource(e,i,c,o[c],{silent:!0});a.silent||this.emit("added",e,i,o)}addResourceBundle(e,i,o,a,c,d={silent:!1,skipCopy:!1}){let h=[e,i];e.indexOf(".")>-1&&(h=e.split("."),a=o,o=i,i=h[1]),this.addNamespaces(i);let g=getPath(this.data,h)||{};d.skipCopy||(o=JSON.parse(JSON.stringify(o))),a?deepExtend(g,o,c):g={...g,...o},setPath(this.data,h,g),d.silent||this.emit("added",e,i,o)}removeResourceBundle(e,i){this.hasResourceBundle(e,i)&&delete this.data[e][i],this.removeNamespaces(i),this.emit("removed",e,i)}hasResourceBundle(e,i){return this.getResource(e,i)!==void 0}getResourceBundle(e,i){return i||(i=this.options.defaultNS),this.getResource(e,i)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const i=this.getDataByLanguage(e);return!!(i&&Object.keys(i)||[]).find(a=>i[a]&&Object.keys(i[a]).length>0)}toJSON(){return this.data}}var postProcessor={processors:{},addPostProcessor(s){this.processors[s.name]=s},handle(s,e,i,o,a){return s.forEach(c=>{var d;e=((d=this.processors[c])==null?void 0:d.process(e,i,o,a))??e}),e}};const PATH_KEY=Symbol("i18next/PATH_KEY");function createProxy(){const s=[],e=Object.create(null);let i;return e.get=(o,a)=>{var c;return(c=i==null?void 0:i.revoke)==null||c.call(i),a===PATH_KEY?s:(s.push(a),i=Proxy.revocable(o,e),i.proxy)},Proxy.revocable(Object.create(null),e).proxy}function keysFromSelector(s,e){const{[PATH_KEY]:i}=s(createProxy());return i.join((e==null?void 0:e.keySeparator)??".")}const checkedLoadedFor={},shouldHandleAsObject=s=>!isString(s)&&typeof s!="boolean"&&typeof s!="number";class Translator extends EventEmitter{constructor(e,i={}){super(),copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=i,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=baseLogger.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,i={interpolation:{}}){const o={...i};if(e==null)return!1;const a=this.resolve(e,o);return(a==null?void 0:a.res)!==void 0}extractFromKey(e,i){let o=i.nsSeparator!==void 0?i.nsSeparator:this.options.nsSeparator;o===void 0&&(o=":");const a=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let c=i.ns||this.options.defaultNS||[];const d=o&&e.indexOf(o)>-1,h=!this.options.userDefinedKeySeparator&&!i.keySeparator&&!this.options.userDefinedNsSeparator&&!i.nsSeparator&&!looksLikeObjectPath(e,o,a);if(d&&!h){const g=e.match(this.interpolator.nestingRegexp);if(g&&g.length>0)return{key:e,namespaces:isString(c)?[c]:c};const _=e.split(o);(o!==a||o===a&&this.options.ns.indexOf(_[0])>-1)&&(c=_.shift()),e=_.join(a)}return{key:e,namespaces:isString(c)?[c]:c}}translate(e,i,o){let a=typeof i=="object"?{...i}:i;if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof a=="object"&&(a={...a}),a||(a={}),e==null)return"";typeof e=="function"&&(e=keysFromSelector(e,{...this.options,...a})),Array.isArray(e)||(e=[String(e)]);const c=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,d=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:h,namespaces:g}=this.extractFromKey(e[e.length-1],a),_=g[g.length-1];let j=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;j===void 0&&(j=":");const b=a.lng||this.language,$=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((b==null?void 0:b.toLowerCase())==="cimode")return $?c?{res:`${_}${j}${h}`,usedKey:h,exactUsedKey:h,usedLng:b,usedNS:_,usedParams:this.getUsedParamsDetails(a)}:`${_}${j}${h}`:c?{res:h,usedKey:h,exactUsedKey:h,usedLng:b,usedNS:_,usedParams:this.getUsedParamsDetails(a)}:h;const et=this.resolve(e,a);let _e=et==null?void 0:et.res;const st=(et==null?void 0:et.usedKey)||h,ot=(et==null?void 0:et.exactUsedKey)||h,tt=["[object Number]","[object Function]","[object RegExp]"],nt=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,rt=!this.i18nFormat||this.i18nFormat.handleAsObject,it=a.count!==void 0&&!isString(a.count),lt=Translator.hasDefaultValue(a),at=it?this.pluralResolver.getSuffix(b,a.count,a):"",ut=a.ordinal&&it?this.pluralResolver.getSuffix(b,a.count,{ordinal:!1}):"",ct=it&&!a.ordinal&&a.count===0,ht=ct&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${at}`]||a[`defaultValue${ut}`]||a.defaultValue;let dt=_e;rt&&!_e&&lt&&(dt=ht);const pt=shouldHandleAsObject(dt),gt=Object.prototype.toString.apply(dt);if(rt&&dt&&pt&&tt.indexOf(gt)<0&&!(isString(nt)&&Array.isArray(dt))){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const yt=this.options.returnedObjectHandler?this.options.returnedObjectHandler(st,dt,{...a,ns:g}):`key '${h} (${this.language})' returned an object instead of string.`;return c?(et.res=yt,et.usedParams=this.getUsedParamsDetails(a),et):yt}if(d){const yt=Array.isArray(dt),jt=yt?[]:{},Tt=yt?ot:st;for(const Ct in dt)if(Object.prototype.hasOwnProperty.call(dt,Ct)){const _t=`${Tt}${d}${Ct}`;lt&&!_e?jt[Ct]=this.translate(_t,{...a,defaultValue:shouldHandleAsObject(ht)?ht[Ct]:void 0,joinArrays:!1,ns:g}):jt[Ct]=this.translate(_t,{...a,joinArrays:!1,ns:g}),jt[Ct]===_t&&(jt[Ct]=dt[Ct])}_e=jt}}else if(rt&&isString(nt)&&Array.isArray(_e))_e=_e.join(nt),_e&&(_e=this.extendTranslation(_e,e,a,o));else{let yt=!1,jt=!1;!this.isValidLookup(_e)&&lt&&(yt=!0,_e=ht),this.isValidLookup(_e)||(jt=!0,_e=h);const Ct=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&jt?void 0:_e,_t=lt&&ht!==_e&&this.options.updateMissing;if(jt||yt||_t){if(this.logger.log(_t?"updateKey":"missingKey",b,_,h,_t?ht:_e),d){const Et=this.resolve(h,{...a,keySeparator:!1});Et&&Et.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ft=[];const mt=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&mt&&mt[0])for(let Et=0;Et<mt.length;Et++)ft.push(mt[Et]);else this.options.saveMissingTo==="all"?ft=this.languageUtils.toResolveHierarchy(a.lng||this.language):ft.push(a.lng||this.language);const xt=(Et,St,wt)=>{var Lt;const bt=lt&&wt!==_e?wt:Ct;this.options.missingKeyHandler?this.options.missingKeyHandler(Et,_,St,bt,_t,a):(Lt=this.backendConnector)!=null&&Lt.saveMissing&&this.backendConnector.saveMissing(Et,_,St,bt,_t,a),this.emit("missingKey",Et,_,St,_e)};this.options.saveMissing&&(this.options.saveMissingPlurals&&it?ft.forEach(Et=>{const St=this.pluralResolver.getSuffixes(Et,a);ct&&a[`defaultValue${this.options.pluralSeparator}zero`]&&St.indexOf(`${this.options.pluralSeparator}zero`)<0&&St.push(`${this.options.pluralSeparator}zero`),St.forEach(wt=>{xt([Et],h+wt,a[`defaultValue${wt}`]||ht)})}):xt(ft,h,ht))}_e=this.extendTranslation(_e,e,a,et,o),jt&&_e===h&&this.options.appendNamespaceToMissingKey&&(_e=`${_}${j}${h}`),(jt||yt)&&this.options.parseMissingKeyHandler&&(_e=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${_}${j}${h}`:h,yt?_e:void 0,a))}return c?(et.res=_e,et.usedParams=this.getUsedParamsDetails(a),et):_e}extendTranslation(e,i,o,a,c){var g,_;if((g=this.i18nFormat)!=null&&g.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...o},o.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!o.skipInterpolation){o.interpolation&&this.interpolator.init({...o,interpolation:{...this.options.interpolation,...o.interpolation}});const j=isString(e)&&(((_=o==null?void 0:o.interpolation)==null?void 0:_.skipOnVariables)!==void 0?o.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let b;if(j){const et=e.match(this.interpolator.nestingRegexp);b=et&&et.length}let $=o.replace&&!isString(o.replace)?o.replace:o;if(this.options.interpolation.defaultVariables&&($={...this.options.interpolation.defaultVariables,...$}),e=this.interpolator.interpolate(e,$,o.lng||this.language||a.usedLng,o),j){const et=e.match(this.interpolator.nestingRegexp),_e=et&&et.length;b<_e&&(o.nest=!1)}!o.lng&&a&&a.res&&(o.lng=this.language||a.usedLng),o.nest!==!1&&(e=this.interpolator.nest(e,(...et)=>(c==null?void 0:c[0])===et[0]&&!o.context?(this.logger.warn(`It seems you are nesting recursively key: ${et[0]} in key: ${i[0]}`),null):this.translate(...et,i),o)),o.interpolation&&this.interpolator.reset()}const d=o.postProcess||this.options.postProcess,h=isString(d)?[d]:d;return e!=null&&(h!=null&&h.length)&&o.applyPostProcessor!==!1&&(e=postProcessor.handle(h,e,i,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(o)},...o}:o,this)),e}resolve(e,i={}){let o,a,c,d,h;return isString(e)&&(e=[e]),e.forEach(g=>{if(this.isValidLookup(o))return;const _=this.extractFromKey(g,i),j=_.key;a=j;let b=_.namespaces;this.options.fallbackNS&&(b=b.concat(this.options.fallbackNS));const $=i.count!==void 0&&!isString(i.count),et=$&&!i.ordinal&&i.count===0,_e=i.context!==void 0&&(isString(i.context)||typeof i.context=="number")&&i.context!=="",st=i.lngs?i.lngs:this.languageUtils.toResolveHierarchy(i.lng||this.language,i.fallbackLng);b.forEach(ot=>{var tt,nt;this.isValidLookup(o)||(h=ot,!checkedLoadedFor[`${st[0]}-${ot}`]&&((tt=this.utils)!=null&&tt.hasLoadedNamespace)&&!((nt=this.utils)!=null&&nt.hasLoadedNamespace(h))&&(checkedLoadedFor[`${st[0]}-${ot}`]=!0,this.logger.warn(`key "${a}" for languages "${st.join(", ")}" won't get resolved as namespace "${h}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),st.forEach(rt=>{var at;if(this.isValidLookup(o))return;d=rt;const it=[j];if((at=this.i18nFormat)!=null&&at.addLookupKeys)this.i18nFormat.addLookupKeys(it,j,rt,ot,i);else{let ut;$&&(ut=this.pluralResolver.getSuffix(rt,i.count,i));const ct=`${this.options.pluralSeparator}zero`,ht=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if($&&(i.ordinal&&ut.indexOf(ht)===0&&it.push(j+ut.replace(ht,this.options.pluralSeparator)),it.push(j+ut),et&&it.push(j+ct)),_e){const dt=`${j}${this.options.contextSeparator||"_"}${i.context}`;it.push(dt),$&&(i.ordinal&&ut.indexOf(ht)===0&&it.push(dt+ut.replace(ht,this.options.pluralSeparator)),it.push(dt+ut),et&&it.push(dt+ct))}}let lt;for(;lt=it.pop();)this.isValidLookup(o)||(c=lt,o=this.getResource(rt,ot,lt,i))}))})}),{res:o,usedKey:a,exactUsedKey:c,usedLng:d,usedNS:h}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,i,o,a={}){var c;return(c=this.i18nFormat)!=null&&c.getResource?this.i18nFormat.getResource(e,i,o,a):this.resourceStore.getResource(e,i,o,a)}getUsedParamsDetails(e={}){const i=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],o=e.replace&&!isString(e.replace);let a=o?e.replace:e;if(o&&typeof e.count<"u"&&(a.count=e.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!o){a={...a};for(const c of i)delete a[c]}return a}static hasDefaultValue(e){const i="defaultValue";for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&i===o.substring(0,i.length)&&e[o]!==void 0)return!0;return!1}}class LanguageUtil{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=baseLogger.create("languageUtils")}getScriptPartFromCode(e){if(e=getCleanedCode(e),!e||e.indexOf("-")<0)return null;const i=e.split("-");return i.length===2||(i.pop(),i[i.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(i.join("-"))}getLanguagePartFromCode(e){if(e=getCleanedCode(e),!e||e.indexOf("-")<0)return e;const i=e.split("-");return this.formatLanguageCode(i[0])}formatLanguageCode(e){if(isString(e)&&e.indexOf("-")>-1){let i;try{i=Intl.getCanonicalLocales(e)[0]}catch{}return i&&this.options.lowerCaseLng&&(i=i.toLowerCase()),i||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let i;return e.forEach(o=>{if(i)return;const a=this.formatLanguageCode(o);(!this.options.supportedLngs||this.isSupportedCode(a))&&(i=a)}),!i&&this.options.supportedLngs&&e.forEach(o=>{if(i)return;const a=this.getScriptPartFromCode(o);if(this.isSupportedCode(a))return i=a;const c=this.getLanguagePartFromCode(o);if(this.isSupportedCode(c))return i=c;i=this.options.supportedLngs.find(d=>{if(d===c)return d;if(!(d.indexOf("-")<0&&c.indexOf("-")<0)&&(d.indexOf("-")>0&&c.indexOf("-")<0&&d.substring(0,d.indexOf("-"))===c||d.indexOf(c)===0&&c.length>1))return d})}),i||(i=this.getFallbackCodes(this.options.fallbackLng)[0]),i}getFallbackCodes(e,i){if(!e)return[];if(typeof e=="function"&&(e=e(i)),isString(e)&&(e=[e]),Array.isArray(e))return e;if(!i)return e.default||[];let o=e[i];return o||(o=e[this.getScriptPartFromCode(i)]),o||(o=e[this.formatLanguageCode(i)]),o||(o=e[this.getLanguagePartFromCode(i)]),o||(o=e.default),o||[]}toResolveHierarchy(e,i){const o=this.getFallbackCodes((i===!1?[]:i)||this.options.fallbackLng||[],e),a=[],c=d=>{d&&(this.isSupportedCode(d)?a.push(d):this.logger.warn(`rejecting language code not found in supportedLngs: ${d}`))};return isString(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&c(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&c(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&c(this.getLanguagePartFromCode(e))):isString(e)&&c(this.formatLanguageCode(e)),o.forEach(d=>{a.indexOf(d)<0&&c(this.formatLanguageCode(d))}),a}}const suffixesOrder={zero:0,one:1,two:2,few:3,many:4,other:5},dummyRule={select:s=>s===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class PluralResolver{constructor(e,i={}){this.languageUtils=e,this.options=i,this.logger=baseLogger.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,i){this.rules[e]=i}clearCache(){this.pluralRulesCache={}}getRule(e,i={}){const o=getCleanedCode(e==="dev"?"en":e),a=i.ordinal?"ordinal":"cardinal",c=JSON.stringify({cleanedCode:o,type:a});if(c in this.pluralRulesCache)return this.pluralRulesCache[c];let d;try{d=new Intl.PluralRules(o,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),dummyRule;if(!e.match(/-|_/))return dummyRule;const g=this.languageUtils.getLanguagePartFromCode(e);d=this.getRule(g,i)}return this.pluralRulesCache[c]=d,d}needsPlural(e,i={}){let o=this.getRule(e,i);return o||(o=this.getRule("dev",i)),(o==null?void 0:o.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,i,o={}){return this.getSuffixes(e,o).map(a=>`${i}${a}`)}getSuffixes(e,i={}){let o=this.getRule(e,i);return o||(o=this.getRule("dev",i)),o?o.resolvedOptions().pluralCategories.sort((a,c)=>suffixesOrder[a]-suffixesOrder[c]).map(a=>`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(e,i,o={}){const a=this.getRule(e,o);return a?`${this.options.prepend}${o.ordinal?`ordinal${this.options.prepend}`:""}${a.select(i)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",i,o))}}const deepFindWithDefaults=(s,e,i,o=".",a=!0)=>{let c=getPathWithDefaults(s,e,i);return!c&&a&&isString(i)&&(c=deepFind(s,i,o),c===void 0&&(c=deepFind(e,i,o))),c},regexSafe=s=>s.replace(/\$/g,"$$$$");class Interpolator{constructor(e={}){var i;this.logger=baseLogger.create("interpolator"),this.options=e,this.format=((i=e==null?void 0:e.interpolation)==null?void 0:i.format)||(o=>o),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:i,escapeValue:o,useRawValueToEscape:a,prefix:c,prefixEscaped:d,suffix:h,suffixEscaped:g,formatSeparator:_,unescapeSuffix:j,unescapePrefix:b,nestingPrefix:$,nestingPrefixEscaped:et,nestingSuffix:_e,nestingSuffixEscaped:st,nestingOptionsSeparator:ot,maxReplaces:tt,alwaysFormat:nt}=e.interpolation;this.escape=i!==void 0?i:escape,this.escapeValue=o!==void 0?o:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=c?regexEscape(c):d||"{{",this.suffix=h?regexEscape(h):g||"}}",this.formatSeparator=_||",",this.unescapePrefix=j?"":b||"-",this.unescapeSuffix=this.unescapePrefix?"":j||"",this.nestingPrefix=$?regexEscape($):et||regexEscape("$t("),this.nestingSuffix=_e?regexEscape(_e):st||regexEscape(")"),this.nestingOptionsSeparator=ot||",",this.maxReplaces=tt||1e3,this.alwaysFormat=nt!==void 0?nt:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(i,o)=>(i==null?void 0:i.source)===o?(i.lastIndex=0,i):new RegExp(o,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,i,o,a){var et;let c,d,h;const g=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},_=_e=>{if(_e.indexOf(this.formatSeparator)<0){const nt=deepFindWithDefaults(i,g,_e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(nt,void 0,o,{...a,...i,interpolationkey:_e}):nt}const st=_e.split(this.formatSeparator),ot=st.shift().trim(),tt=st.join(this.formatSeparator).trim();return this.format(deepFindWithDefaults(i,g,ot,this.options.keySeparator,this.options.ignoreJSONStructure),tt,o,{...a,...i,interpolationkey:ot})};this.resetRegExp();const j=(a==null?void 0:a.missingInterpolationHandler)||this.options.missingInterpolationHandler,b=((et=a==null?void 0:a.interpolation)==null?void 0:et.skipOnVariables)!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:_e=>regexSafe(_e)},{regex:this.regexp,safeValue:_e=>this.escapeValue?regexSafe(this.escape(_e)):regexSafe(_e)}].forEach(_e=>{for(h=0;c=_e.regex.exec(e);){const st=c[1].trim();if(d=_(st),d===void 0)if(typeof j=="function"){const tt=j(e,c,a);d=isString(tt)?tt:""}else if(a&&Object.prototype.hasOwnProperty.call(a,st))d="";else if(b){d=c[0];continue}else this.logger.warn(`missed to pass in variable ${st} for interpolating ${e}`),d="";else!isString(d)&&!this.useRawValueToEscape&&(d=makeString(d));const ot=_e.safeValue(d);if(e=e.replace(c[0],ot),b?(_e.regex.lastIndex+=d.length,_e.regex.lastIndex-=c[0].length):_e.regex.lastIndex=0,h++,h>=this.maxReplaces)break}}),e}nest(e,i,o={}){let a,c,d;const h=(g,_)=>{const j=this.nestingOptionsSeparator;if(g.indexOf(j)<0)return g;const b=g.split(new RegExp(`${j}[ ]*{`));let $=`{${b[1]}`;g=b[0],$=this.interpolate($,d);const et=$.match(/'/g),_e=$.match(/"/g);(((et==null?void 0:et.length)??0)%2===0&&!_e||_e.length%2!==0)&&($=$.replace(/'/g,'"'));try{d=JSON.parse($),_&&(d={..._,...d})}catch(st){return this.logger.warn(`failed parsing options string in nesting for key ${g}`,st),`${g}${j}${$}`}return d.defaultValue&&d.defaultValue.indexOf(this.prefix)>-1&&delete d.defaultValue,g};for(;a=this.nestingRegexp.exec(e);){let g=[];d={...o},d=d.replace&&!isString(d.replace)?d.replace:d,d.applyPostProcessor=!1,delete d.defaultValue;const _=/{.*}/.test(a[1])?a[1].lastIndexOf("}")+1:a[1].indexOf(this.formatSeparator);if(_!==-1&&(g=a[1].slice(_).split(this.formatSeparator).map(j=>j.trim()).filter(Boolean),a[1]=a[1].slice(0,_)),c=i(h.call(this,a[1].trim(),d),d),c&&a[0]===e&&!isString(c))return c;isString(c)||(c=makeString(c)),c||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${e}`),c=""),g.length&&(c=g.reduce((j,b)=>this.format(j,b,o.lng,{...o,interpolationkey:a[1].trim()}),c.trim())),e=e.replace(a[0],c),this.regexp.lastIndex=0}return e}}const parseFormatStr=s=>{let e=s.toLowerCase().trim();const i={};if(s.indexOf("(")>-1){const o=s.split("(");e=o[0].toLowerCase().trim();const a=o[1].substring(0,o[1].length-1);e==="currency"&&a.indexOf(":")<0?i.currency||(i.currency=a.trim()):e==="relativetime"&&a.indexOf(":")<0?i.range||(i.range=a.trim()):a.split(";").forEach(d=>{if(d){const[h,...g]=d.split(":"),_=g.join(":").trim().replace(/^'+|'+$/g,""),j=h.trim();i[j]||(i[j]=_),_==="false"&&(i[j]=!1),_==="true"&&(i[j]=!0),isNaN(_)||(i[j]=parseInt(_,10))}})}return{formatName:e,formatOptions:i}},createCachedFormatter=s=>{const e={};return(i,o,a)=>{let c=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(c={...c,[a.interpolationkey]:void 0});const d=o+JSON.stringify(c);let h=e[d];return h||(h=s(getCleanedCode(o),a),e[d]=h),h(i)}},createNonCachedFormatter=s=>(e,i,o)=>s(getCleanedCode(i),o)(e);class Formatter{constructor(e={}){this.logger=baseLogger.create("formatter"),this.options=e,this.init(e)}init(e,i={interpolation:{}}){this.formatSeparator=i.interpolation.formatSeparator||",";const o=i.cacheInBuiltFormats?createCachedFormatter:createNonCachedFormatter;this.formats={number:o((a,c)=>{const d=new Intl.NumberFormat(a,{...c});return h=>d.format(h)}),currency:o((a,c)=>{const d=new Intl.NumberFormat(a,{...c,style:"currency"});return h=>d.format(h)}),datetime:o((a,c)=>{const d=new Intl.DateTimeFormat(a,{...c});return h=>d.format(h)}),relativetime:o((a,c)=>{const d=new Intl.RelativeTimeFormat(a,{...c});return h=>d.format(h,c.range||"day")}),list:o((a,c)=>{const d=new Intl.ListFormat(a,{...c});return h=>d.format(h)})}}add(e,i){this.formats[e.toLowerCase().trim()]=i}addCached(e,i){this.formats[e.toLowerCase().trim()]=createCachedFormatter(i)}format(e,i,o,a={}){const c=i.split(this.formatSeparator);if(c.length>1&&c[0].indexOf("(")>1&&c[0].indexOf(")")<0&&c.find(h=>h.indexOf(")")>-1)){const h=c.findIndex(g=>g.indexOf(")")>-1);c[0]=[c[0],...c.splice(1,h)].join(this.formatSeparator)}return c.reduce((h,g)=>{var b;const{formatName:_,formatOptions:j}=parseFormatStr(g);if(this.formats[_]){let $=h;try{const et=((b=a==null?void 0:a.formatParams)==null?void 0:b[a.interpolationkey])||{},_e=et.locale||et.lng||a.locale||a.lng||o;$=this.formats[_](h,_e,{...j,...a,...et})}catch(et){this.logger.warn(et)}return $}else this.logger.warn(`there was no format function for ${_}`);return h},e)}}const removePending=(s,e)=>{s.pending[e]!==void 0&&(delete s.pending[e],s.pendingCount--)};class Connector extends EventEmitter{constructor(e,i,o,a={}){var c,d;super(),this.backend=e,this.store=i,this.services=o,this.languageUtils=o.languageUtils,this.options=a,this.logger=baseLogger.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],(d=(c=this.backend)==null?void 0:c.init)==null||d.call(c,o,a.backend,a)}queueLoad(e,i,o,a){const c={},d={},h={},g={};return e.forEach(_=>{let j=!0;i.forEach(b=>{const $=`${_}|${b}`;!o.reload&&this.store.hasResourceBundle(_,b)?this.state[$]=2:this.state[$]<0||(this.state[$]===1?d[$]===void 0&&(d[$]=!0):(this.state[$]=1,j=!1,d[$]===void 0&&(d[$]=!0),c[$]===void 0&&(c[$]=!0),g[b]===void 0&&(g[b]=!0)))}),j||(h[_]=!0)}),(Object.keys(c).length||Object.keys(d).length)&&this.queue.push({pending:d,pendingCount:Object.keys(d).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(c),pending:Object.keys(d),toLoadLanguages:Object.keys(h),toLoadNamespaces:Object.keys(g)}}loaded(e,i,o){const a=e.split("|"),c=a[0],d=a[1];i&&this.emit("failedLoading",c,d,i),!i&&o&&this.store.addResourceBundle(c,d,o,void 0,void 0,{skipCopy:!0}),this.state[e]=i?-1:2,i&&o&&(this.state[e]=0);const h={};this.queue.forEach(g=>{pushPath(g.loaded,[c],d),removePending(g,e),i&&g.errors.push(i),g.pendingCount===0&&!g.done&&(Object.keys(g.loaded).forEach(_=>{h[_]||(h[_]={});const j=g.loaded[_];j.length&&j.forEach(b=>{h[_][b]===void 0&&(h[_][b]=!0)})}),g.done=!0,g.errors.length?g.callback(g.errors):g.callback())}),this.emit("loaded",h),this.queue=this.queue.filter(g=>!g.done)}read(e,i,o,a=0,c=this.retryTimeout,d){if(!e.length)return d(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:i,fcName:o,tried:a,wait:c,callback:d});return}this.readingCalls++;const h=(_,j)=>{if(this.readingCalls--,this.waitingReads.length>0){const b=this.waitingReads.shift();this.read(b.lng,b.ns,b.fcName,b.tried,b.wait,b.callback)}if(_&&j&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,e,i,o,a+1,c*2,d)},c);return}d(_,j)},g=this.backend[o].bind(this.backend);if(g.length===2){try{const _=g(e,i);_&&typeof _.then=="function"?_.then(j=>h(null,j)).catch(h):h(null,_)}catch(_){h(_)}return}return g(e,i,h)}prepareLoading(e,i,o={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();isString(e)&&(e=this.languageUtils.toResolveHierarchy(e)),isString(i)&&(i=[i]);const c=this.queueLoad(e,i,o,a);if(!c.toLoad.length)return c.pending.length||a(),null;c.toLoad.forEach(d=>{this.loadOne(d)})}load(e,i,o){this.prepareLoading(e,i,{},o)}reload(e,i,o){this.prepareLoading(e,i,{reload:!0},o)}loadOne(e,i=""){const o=e.split("|"),a=o[0],c=o[1];this.read(a,c,"read",void 0,void 0,(d,h)=>{d&&this.logger.warn(`${i}loading namespace ${c} for language ${a} failed`,d),!d&&h&&this.logger.log(`${i}loaded namespace ${c} for language ${a}`,h),this.loaded(e,d,h)})}saveMissing(e,i,o,a,c,d={},h=()=>{}){var g,_,j,b,$;if((_=(g=this.services)==null?void 0:g.utils)!=null&&_.hasLoadedNamespace&&!((b=(j=this.services)==null?void 0:j.utils)!=null&&b.hasLoadedNamespace(i))){this.logger.warn(`did not save key "${o}" as the namespace "${i}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(o==null||o==="")){if(($=this.backend)!=null&&$.create){const et={...d,isUpdate:c},_e=this.backend.create.bind(this.backend);if(_e.length<6)try{let st;_e.length===5?st=_e(e,i,o,a,et):st=_e(e,i,o,a),st&&typeof st.then=="function"?st.then(ot=>h(null,ot)).catch(h):h(null,st)}catch(st){h(st)}else _e(e,i,o,a,h,et)}!e||!e[0]||this.store.addResource(e[0],i,o,a)}}}const get=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:s=>{let e={};if(typeof s[1]=="object"&&(e=s[1]),isString(s[1])&&(e.defaultValue=s[1]),isString(s[2])&&(e.tDescription=s[2]),typeof s[2]=="object"||typeof s[3]=="object"){const i=s[3]||s[2];Object.keys(i).forEach(o=>{e[o]=i[o]})}return e},interpolation:{escapeValue:!0,format:s=>s,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),transformOptions=s=>{var e,i;return isString(s.ns)&&(s.ns=[s.ns]),isString(s.fallbackLng)&&(s.fallbackLng=[s.fallbackLng]),isString(s.fallbackNS)&&(s.fallbackNS=[s.fallbackNS]),((i=(e=s.supportedLngs)==null?void 0:e.indexOf)==null?void 0:i.call(e,"cimode"))<0&&(s.supportedLngs=s.supportedLngs.concat(["cimode"])),typeof s.initImmediate=="boolean"&&(s.initAsync=s.initImmediate),s},noop=()=>{},bindMemberFunctions=s=>{Object.getOwnPropertyNames(Object.getPrototypeOf(s)).forEach(i=>{typeof s[i]=="function"&&(s[i]=s[i].bind(s))})};class I18n extends EventEmitter{constructor(e={},i){if(super(),this.options=transformOptions(e),this.services={},this.logger=baseLogger,this.modules={external:[]},bindMemberFunctions(this),i&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,i),this;setTimeout(()=>{this.init(e,i)},0)}}init(e={},i){this.isInitializing=!0,typeof e=="function"&&(i=e,e={}),e.defaultNS==null&&e.ns&&(isString(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const o=get();this.options={...o,...this.options,...transformOptions(e)},this.options.interpolation={...o.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const a=_=>_?typeof _=="function"?new _:_:null;if(!this.options.isClone){this.modules.logger?baseLogger.init(a(this.modules.logger),this.options):baseLogger.init(null,this.options);let _;this.modules.formatter?_=this.modules.formatter:_=Formatter;const j=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);const b=this.services;b.logger=baseLogger,b.resourceStore=this.store,b.languageUtils=j,b.pluralResolver=new PluralResolver(j,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==o.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),_&&(!this.options.interpolation.format||this.options.interpolation.format===o.interpolation.format)&&(b.formatter=a(_),b.formatter.init&&b.formatter.init(b,this.options),this.options.interpolation.format=b.formatter.format.bind(b.formatter)),b.interpolator=new Interpolator(this.options),b.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},b.backendConnector=new Connector(a(this.modules.backend),b.resourceStore,b,this.options),b.backendConnector.on("*",(et,..._e)=>{this.emit(et,..._e)}),this.modules.languageDetector&&(b.languageDetector=a(this.modules.languageDetector),b.languageDetector.init&&b.languageDetector.init(b,this.options.detection,this.options)),this.modules.i18nFormat&&(b.i18nFormat=a(this.modules.i18nFormat),b.i18nFormat.init&&b.i18nFormat.init(this)),this.translator=new Translator(this.services,this.options),this.translator.on("*",(et,..._e)=>{this.emit(et,..._e)}),this.modules.external.forEach(et=>{et.init&&et.init(this)})}if(this.format=this.options.interpolation.format,i||(i=noop),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const _=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);_.length>0&&_[0]!=="dev"&&(this.options.lng=_[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(_=>{this[_]=(...j)=>this.store[_](...j)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(_=>{this[_]=(...j)=>(this.store[_](...j),this)});const h=defer(),g=()=>{const _=(j,b)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),h.resolve(b),i(j,b)};if(this.languages&&!this.isInitialized)return _(null,this.t.bind(this));this.changeLanguage(this.options.lng,_)};return this.options.resources||!this.options.initAsync?g():setTimeout(g,0),h}loadResources(e,i=noop){var c,d;let o=i;const a=isString(e)?e:this.language;if(typeof e=="function"&&(o=e),!this.options.resources||this.options.partialBundledLanguages){if((a==null?void 0:a.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return o();const h=[],g=_=>{if(!_||_==="cimode")return;this.services.languageUtils.toResolveHierarchy(_).forEach(b=>{b!=="cimode"&&h.indexOf(b)<0&&h.push(b)})};a?g(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(j=>g(j)),(d=(c=this.options.preload)==null?void 0:c.forEach)==null||d.call(c,_=>g(_)),this.services.backendConnector.load(h,this.options.ns,_=>{!_&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),o(_)})}else o(null)}reloadResources(e,i,o){const a=defer();return typeof e=="function"&&(o=e,e=void 0),typeof i=="function"&&(o=i,i=void 0),e||(e=this.languages),i||(i=this.options.ns),o||(o=noop),this.services.backendConnector.reload(e,i,c=>{a.resolve(),o(c)}),a}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&postProcessor.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let i=0;i<this.languages.length;i++){const o=this.languages[i];if(!(["cimode","dev"].indexOf(o)>-1)&&this.store.hasLanguageSomeTranslations(o)){this.resolvedLanguage=o;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,i){this.isLanguageChangingTo=e;const o=defer();this.emit("languageChanging",e);const a=h=>{this.language=h,this.languages=this.services.languageUtils.toResolveHierarchy(h),this.resolvedLanguage=void 0,this.setResolvedLanguage(h)},c=(h,g)=>{g?this.isLanguageChangingTo===e&&(a(g),this.translator.changeLanguage(g),this.isLanguageChangingTo=void 0,this.emit("languageChanged",g),this.logger.log("languageChanged",g)):this.isLanguageChangingTo=void 0,o.resolve((..._)=>this.t(..._)),i&&i(h,(..._)=>this.t(..._))},d=h=>{var j,b;!e&&!h&&this.services.languageDetector&&(h=[]);const g=isString(h)?h:h&&h[0],_=this.store.hasLanguageSomeTranslations(g)?g:this.services.languageUtils.getBestMatchFromCodes(isString(h)?[h]:h);_&&(this.language||a(_),this.translator.language||this.translator.changeLanguage(_),(b=(j=this.services.languageDetector)==null?void 0:j.cacheUserLanguage)==null||b.call(j,_)),this.loadResources(_,$=>{c($,_)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?d(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(d):this.services.languageDetector.detect(d):d(e),o}getFixedT(e,i,o){const a=(c,d,...h)=>{let g;typeof d!="object"?g=this.options.overloadTranslationOptionHandler([c,d].concat(h)):g={...d},g.lng=g.lng||a.lng,g.lngs=g.lngs||a.lngs,g.ns=g.ns||a.ns,g.keyPrefix!==""&&(g.keyPrefix=g.keyPrefix||o||a.keyPrefix);const _=this.options.keySeparator||".";let j;return g.keyPrefix&&Array.isArray(c)?j=c.map(b=>(typeof b=="function"&&(b=keysFromSelector(b,{...this.options,...d})),`${g.keyPrefix}${_}${b}`)):(typeof c=="function"&&(c=keysFromSelector(c,{...this.options,...d})),j=g.keyPrefix?`${g.keyPrefix}${_}${c}`:c),this.t(j,g)};return isString(e)?a.lng=e:a.lngs=e,a.ns=i,a.keyPrefix=o,a}t(...e){var i;return(i=this.translator)==null?void 0:i.translate(...e)}exists(...e){var i;return(i=this.translator)==null?void 0:i.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,i={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const o=i.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,c=this.languages[this.languages.length-1];if(o.toLowerCase()==="cimode")return!0;const d=(h,g)=>{const _=this.services.backendConnector.state[`${h}|${g}`];return _===-1||_===0||_===2};if(i.precheck){const h=i.precheck(this,d);if(h!==void 0)return h}return!!(this.hasResourceBundle(o,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||d(o,e)&&(!a||d(c,e)))}loadNamespaces(e,i){const o=defer();return this.options.ns?(isString(e)&&(e=[e]),e.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{o.resolve(),i&&i(a)}),o):(i&&i(),Promise.resolve())}loadLanguages(e,i){const o=defer();isString(e)&&(e=[e]);const a=this.options.preload||[],c=e.filter(d=>a.indexOf(d)<0&&this.services.languageUtils.isSupportedCode(d));return c.length?(this.options.preload=a.concat(c),this.loadResources(d=>{o.resolve(),i&&i(d)}),o):(i&&i(),Promise.resolve())}dir(e){var a,c;if(e||(e=this.resolvedLanguage||(((a=this.languages)==null?void 0:a.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const d=new Intl.Locale(e);if(d&&d.getTextInfo){const h=d.getTextInfo();if(h&&h.direction)return h.direction}}catch{}const i=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],o=((c=this.services)==null?void 0:c.languageUtils)||new LanguageUtil(get());return e.toLowerCase().indexOf("-latn")>1?"ltr":i.indexOf(o.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},i){return new I18n(e,i)}cloneInstance(e={},i=noop){const o=e.forkResourceStore;o&&delete e.forkResourceStore;const a={...this.options,...e,isClone:!0},c=new I18n(a);if((e.debug!==void 0||e.prefix!==void 0)&&(c.logger=c.logger.clone(e)),["store","services","language"].forEach(h=>{c[h]=this[h]}),c.services={...this.services},c.services.utils={hasLoadedNamespace:c.hasLoadedNamespace.bind(c)},o){const h=Object.keys(this.store.data).reduce((g,_)=>(g[_]={...this.store.data[_]},g[_]=Object.keys(g[_]).reduce((j,b)=>(j[b]={...g[_][b]},j),g[_]),g),{});c.store=new ResourceStore(h,a),c.services.resourceStore=c.store}return c.translator=new Translator(c.services,a),c.translator.on("*",(h,...g)=>{c.emit(h,...g)}),c.init(a,i),c.translator.options=a,c.translator.backendConnector.services.utils={hasLoadedNamespace:c.hasLoadedNamespace.bind(c)},c}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const instance=I18n.createInstance();instance.createInstance=I18n.createInstance;instance.createInstance;instance.dir;instance.init;instance.loadResources;instance.reloadResources;instance.use;instance.changeLanguage;instance.getFixedT;instance.t;instance.exists;instance.setDefaultNamespace;instance.hasLoadedNamespace;instance.loadNamespaces;instance.loadLanguages;const{slice,forEach}=[];function defaults(s){return forEach.call(slice.call(arguments,1),e=>{if(e)for(const i in e)s[i]===void 0&&(s[i]=e[i])}),s}function hasXSS(s){return typeof s!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(i=>i.test(s))}const fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,serializeCookie=function(s,e){const o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},a=encodeURIComponent(e);let c=`${s}=${a}`;if(o.maxAge>0){const d=o.maxAge-0;if(Number.isNaN(d))throw new Error("maxAge should be a Number");c+=`; Max-Age=${Math.floor(d)}`}if(o.domain){if(!fieldContentRegExp.test(o.domain))throw new TypeError("option domain is invalid");c+=`; Domain=${o.domain}`}if(o.path){if(!fieldContentRegExp.test(o.path))throw new TypeError("option path is invalid");c+=`; Path=${o.path}`}if(o.expires){if(typeof o.expires.toUTCString!="function")throw new TypeError("option expires is invalid");c+=`; Expires=${o.expires.toUTCString()}`}if(o.httpOnly&&(c+="; HttpOnly"),o.secure&&(c+="; Secure"),o.sameSite)switch(typeof o.sameSite=="string"?o.sameSite.toLowerCase():o.sameSite){case!0:c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"strict":c+="; SameSite=Strict";break;case"none":c+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o.partitioned&&(c+="; Partitioned"),c},cookie={create(s,e,i,o){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};i&&(a.expires=new Date,a.expires.setTime(a.expires.getTime()+i*60*1e3)),o&&(a.domain=o),document.cookie=serializeCookie(s,e,a)},read(s){const e=`${s}=`,i=document.cookie.split(";");for(let o=0;o<i.length;o++){let a=i[o];for(;a.charAt(0)===" ";)a=a.substring(1,a.length);if(a.indexOf(e)===0)return a.substring(e.length,a.length)}return null},remove(s,e){this.create(s,"",-1,e)}};var cookie$1={name:"cookie",lookup(s){let{lookupCookie:e}=s;if(e&&typeof document<"u")return cookie.read(e)||void 0},cacheUserLanguage(s,e){let{lookupCookie:i,cookieMinutes:o,cookieDomain:a,cookieOptions:c}=e;i&&typeof document<"u"&&cookie.create(i,s,o,a,c)}},querystring={name:"querystring",lookup(s){var o;let{lookupQuerystring:e}=s,i;if(typeof window<"u"){let{search:a}=window.location;!window.location.search&&((o=window.location.hash)==null?void 0:o.indexOf("?"))>-1&&(a=window.location.hash.substring(window.location.hash.indexOf("?")));const d=a.substring(1).split("&");for(let h=0;h<d.length;h++){const g=d[h].indexOf("=");g>0&&d[h].substring(0,g)===e&&(i=d[h].substring(g+1))}}return i}},hash={name:"hash",lookup(s){var a;let{lookupHash:e,lookupFromHashIndex:i}=s,o;if(typeof window<"u"){const{hash:c}=window.location;if(c&&c.length>2){const d=c.substring(1);if(e){const h=d.split("&");for(let g=0;g<h.length;g++){const _=h[g].indexOf("=");_>0&&h[g].substring(0,_)===e&&(o=h[g].substring(_+1))}}if(o)return o;if(!o&&i>-1){const h=c.match(/\/([a-zA-Z-]*)/g);return Array.isArray(h)?(a=h[typeof i=="number"?i:0])==null?void 0:a.replace("/",""):void 0}}}return o}};let hasLocalStorageSupport=null;const localStorageAvailable=()=>{if(hasLocalStorageSupport!==null)return hasLocalStorageSupport;try{if(hasLocalStorageSupport=typeof window<"u"&&window.localStorage!==null,!hasLocalStorageSupport)return!1;const s="i18next.translate.boo";window.localStorage.setItem(s,"foo"),window.localStorage.removeItem(s)}catch{hasLocalStorageSupport=!1}return hasLocalStorageSupport};var localStorage$1={name:"localStorage",lookup(s){let{lookupLocalStorage:e}=s;if(e&&localStorageAvailable())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(s,e){let{lookupLocalStorage:i}=e;i&&localStorageAvailable()&&window.localStorage.setItem(i,s)}};let hasSessionStorageSupport=null;const sessionStorageAvailable=()=>{if(hasSessionStorageSupport!==null)return hasSessionStorageSupport;try{if(hasSessionStorageSupport=typeof window<"u"&&window.sessionStorage!==null,!hasSessionStorageSupport)return!1;const s="i18next.translate.boo";window.sessionStorage.setItem(s,"foo"),window.sessionStorage.removeItem(s)}catch{hasSessionStorageSupport=!1}return hasSessionStorageSupport};var sessionStorage={name:"sessionStorage",lookup(s){let{lookupSessionStorage:e}=s;if(e&&sessionStorageAvailable())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(s,e){let{lookupSessionStorage:i}=e;i&&sessionStorageAvailable()&&window.sessionStorage.setItem(i,s)}},navigator$1={name:"navigator",lookup(s){const e=[];if(typeof navigator<"u"){const{languages:i,userLanguage:o,language:a}=navigator;if(i)for(let c=0;c<i.length;c++)e.push(i[c]);o&&e.push(o),a&&e.push(a)}return e.length>0?e:void 0}},htmlTag={name:"htmlTag",lookup(s){let{htmlTag:e}=s,i;const o=e||(typeof document<"u"?document.documentElement:null);return o&&typeof o.getAttribute=="function"&&(i=o.getAttribute("lang")),i}},path={name:"path",lookup(s){var a;let{lookupFromPathIndex:e}=s;if(typeof window>"u")return;const i=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(i)?(a=i[typeof e=="number"?e:0])==null?void 0:a.replace("/",""):void 0}},subdomain={name:"subdomain",lookup(s){var a,c;let{lookupFromSubdomainIndex:e}=s;const i=typeof e=="number"?e+1:1,o=typeof window<"u"&&((c=(a=window.location)==null?void 0:a.hostname)==null?void 0:c.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(o)return o[i]}};let canCookies=!1;try{document.cookie,canCookies=!0}catch(s){}const order=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];canCookies||order.splice(1,1);const getDefaults=()=>({order,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:s=>s});class Browser{constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,i)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=defaults(i,this.options||{},getDefaults()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=a=>a.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=o,this.addDetector(cookie$1),this.addDetector(querystring),this.addDetector(localStorage$1),this.addDetector(sessionStorage),this.addDetector(navigator$1),this.addDetector(htmlTag),this.addDetector(path),this.addDetector(subdomain),this.addDetector(hash)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,i=[];return e.forEach(o=>{if(this.detectors[o]){let a=this.detectors[o].lookup(this.options);a&&typeof a=="string"&&(a=[a]),a&&(i=i.concat(a))}}),i=i.filter(o=>o!=null&&!hasXSS(o)).map(o=>this.options.convertDetectedLanguage(o)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?i:i.length>0?i[0]:null}cacheUserLanguage(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;i&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||i.forEach(o=>{this.detectors[o]&&this.detectors[o].cacheUserLanguage(e,this.options)}))}}Browser.type="languageDetector";const navigation$1={brand:"Sonsoles Stays",dashboard:"Dashboard",healthCheck:"Health Check",listings:"Listings",reservations:"Reservations",tasks:"Tasks",todos:"TODOs",threads:"Threads",myTasks:"My Tasks",adminBadge:"Admin",cleanerBadge:"Cleaner",signOut:"Sign Out"},threads$1={title:"Threads",searchPlaceholder:"Search threads...",noThreadsFound:"No threads found",yesterday:"Yesterday",listingTitle:"Listing: {{id}}",reservationTitle:"Reservation: {{id}}",channelThread:"{{channel}} Thread",noParticipants:"No participants",participantsWithMore:"{{participants}} +{{count}}",selectThread:"Select a thread to view messages",selectThreadDescription:"Choose a thread from the sidebar to see the conversation",noMessages:"No messages in this thread yet",loading:"Loading threads...",error:"Error",retry:"Retry",errorLoadingThreads:"Failed to load threads",errorLoadingMessages:"Failed to load messages",draftMessage:"Draft Message",draftingMessage:"Drafting message...",draftedMessage:"Drafted Message",closeDraft:"Close draft",errorDraftingMessage:"Failed to draft message",noDraftMessage:"No Draft Message",selectThreadToDraft:"Create AI-powered responses for your selected conversation",contextLabel:"Give Maddie AI Bot arbitrary context",messageLabel:"Message",generateResponse:"Generate Response"},auth$1={welcome:"Welcome to Sonsoles Stays!",signInDescription:"Please sign in to access your stay management system.",signingIn:"Signing in...",signInWithGoogle:"Sign in with Google",authenticating:" Authenticating...",pleaseWait:"Please wait while we complete your sign-in.",authenticationError:" Authentication Error",returnToLogin:"Return to Login",unexpectedError:"An unexpected error occurred during authentication.",noAccessToken:"No access token available",authenticationFailed:"Authentication failed. Please sign in again."},dashboard$1={title:"Dashboard",welcome:"Welcome to your stay management system",comingSoon:"Dashboard Coming Soon",comingSoonDescription:"Your main dashboard will be available here.",loginRequired:"Please log in to view your dashboard.",loading:"Loading...",errorLoading:"Error Loading Dashboard",taskSummary:"Task Summary",pendingAcceptance:"Pending Acceptance",accepted:"Accepted",inProgress:"In Progress",completed:"Completed",viewAllTasks:"View All Tasks",nextPendingTask:"Next Pending Task",viewTask:"View Task",viewAllPending:"View All Pending",nextAcceptedTask:"Next Accepted Task",viewAllAccepted:"View All Accepted",noTasks:"No Tasks Available",noTasksMessage:"You don't have any tasks assigned at the moment. Check back later for new assignments.",refreshTasks:"Refresh Tasks",when:"When",ongoingTasks:"Ongoing Tasks",startedAt:"Started At",notStarted:"Not started yet",continueTask:"Continue Task",viewAllOngoing:"View All Ongoing"},tasks$1={management:"Task Management",myTasks:"My Tasks",totalTasks:"Total Tasks: {{count}}",loading:"Loading...",loginRequired:"Please log in to view your tasks.",details:"Task Details",information:"Task Information",actions:"Actions",acceptTask:"Accept Task",startTask:"Start Task",completeTask:"Complete Task",acceptCompletion:"Accept Completion",acceptedByAdmin:"Accepted by Admin",noFurtherEdits:"No further edits allowed",loadingDetails:"Loading task details...",errorLoading:"Error Loading Task",goBack:"Go Back",notFound:"Task Not Found",notFoundDescription:"The requested task could not be found.",back:"Back",notSet:"Not set",filterByStatus:"Filter by Status",createTask:"Create Task",title:"Title",titlePlaceholder:"Enter task title...",type:"Task Type",types:{cleaning:"Cleaning",maintenance:"Maintenance",inspection:"Inspection",setup:"Setup",other:"Other"},listing:"Listing",selectListing:"Select a listing...",scheduledDateTime:"Scheduled Date & Time",assignTo:"Assign To",unassigned:"Unassigned",reservationId:"Reservation ID",reservationIdPlaceholder:"Enter reservation ID (optional)...",description:"Description",descriptionPlaceholder:"Enter task description (optional)..."},dataTable$1={searchPlaceholder:"Search all columns...",showingEntries:"Showing {{start}} to {{end}} of {{total}} entries",showingCount:"Showing {{count}} of {{total}} entries",noData:"No Data Found",noResults:"No results match your search criteria.",noDataAvailable:"No data available.",pageInfo:"Page {{current}} of {{total}}",showSize:"Show {{size}}",loadingData:"Loading data...",failedToLoad:"Failed to Load Data"},columns$1={id:"ID",title:"Title",task:"Task",type:"Type",status:"Status",description:"Description",listing:"Listing",reservation:"Reservation",scheduled:"Scheduled",assignedTo:"Assigned To",assignedAt:"Assigned At",acceptedAt:"Accepted At",completedAt:"Completed At",created:"Created",started:"Started",finished:"Finished",na:"N/A",view:"View",accept:"Accept",start:"Start",complete:"Complete",cancel:"Cancel",edit:"Edit",save:"Save"},statuses$1={unassigned:"Unassigned",assigned:"Assigned",accepted:"Accepted",in_progress:"In Progress",completed:"Completed",admin_accepted:"Finished"},reservations$1={guest:"Guest",property:"Property",checkIn:"Check-in",checkOut:"Check-out",nights:"Nights",guests:"Guests",total:"Total",hostPayout:"Host Payout"},admin$1={checkingAccess:"Checking admin access...",authenticationRequired:"Authentication Required",signInToAccess:"Please sign in to access this page.",adminAccessRequired:"Admin Access Required",noAdminPrivileges:"You do not have admin privileges to access this page."},assignment$1={unassigned:"Unassigned",loading:"Loading...",unknown:"Unknown"},common$1={loading:"Loading...",cancel:"Cancel",creating:"Creating..."},audit$1={history:"Audit History",entries:"entries",loading:"Loading audit history...",noHistory:"No audit history available for this task.",by:"by",noDescription:"No description available",fieldsChanged:"Fields changed",valuesChanged:"Values changed",context:"Context",system:"System",unknownUser:"Unknown User"},healthCheck$1={title:"System Health Check",monitoring:"Monitoring system status and connectivity",failed:"Health Check Failed",loading:"Loading health status...",reloadPage:"Reload Page",healthy:"Healthy",error:"Error",connected:"Connected",configured:"Configured"},todos$1={allTodos:"All TODOs",totalTodos:"Total TODOs: {{count}}",loadingTodos:"Loading TODOs...",filterByStatus:"Filter by Status:",all:"All",pending:"Pending",done:"Done",createGeneral:"Create General TODO",createNew:"Create New TODO",adminAccessRequired:"Admin access required to view all TODOs.",attachedTo:"Attached To",unattached:"Unattached",delete:"Delete",deleteConfirm:"Are you sure you want to delete this TODO?",creating:"Creating...",addNote:"Add Note",adding:"Adding...",noListingAssignment:"No listing assignment",description:"Description",failedToLoad:"Failed to load listings",addTodo:"Add TODO",noTodosFound:"No TODOs found.",createdLabel:"Created: ",completedLabel:"Completed: ",attachedToLabel:"Attached to: ",productsNeeded:"Products needed:",markAsDone:"Mark as done",title:"Title *",titlePlaceholder:"e.g., Fix the AC, Buy cleaning supplies",assignToListing:"Assign to Listing (Optional)",loadingListings:"Loading listings...",products:"Products (Optional)",searchProductsPlaceholder:"Search for products to add...",selectedProducts:"Selected Products:",remove:"Remove",detailsPlaceholder:"Additional details or notes...",cancel:"Cancel",filterCategories:"Filter Categories",loadingProducts:"Loading products..."},listings$1={title:"Listings",details:"Listing Details",totalListings:"Total listings: {{count}}",loadingListings:"Loading listings...",loadingDetails:"Loading listing details...",address:"Address",basicInformation:"Basic Information",dates:"Dates",amenities:"Amenities",listingTodos:"Listing TODOs",listingChat:"Listing Chat",notFound:"Listing not found",notFoundWithId:'The listing with ID "{{id}}" was not found.',failedToLoad:"Failed to load listing",listingId:"Listing ID",airbnbId:"Airbnb ID",propertyType:"Property Type",roomType:"Room Type",bedrooms:"Bedrooms",bathrooms:"Bathrooms",maxGuests:"Max Guests",created:"Created",updated:"Updated"},cleaner$1={accessRequired:"Access Required"},notes$1={title:"Notes",unknownUser:"Unknown User",send:"Send",sending:"...",deleteNote:"Delete note",deleteConfirm:"Are you sure you want to delete this note?",loadingNotes:"Loading notes...",noNotesYet:"No notes yet. Start the conversation!",attachedToLabel:"Attached to: ",typePlaceholder:"Type a note... (Press Enter to send, Shift+Enter for new line)",noteLabel:"Note:",notePlaceholder:"Enter your note...",errorOccurred:"An error occurred"},forms$1={noAddress:"No address"},taskDetail$1={collapseAudit:"Collapse audit history",expandAudit:"Expand audit history",titleLabel:"Title:",statusLabel:"Status:",scheduledLabel:"Scheduled Date:",listingIdLabel:"Listing ID:",assignedToLabel:"Assigned To:",startedAtLabel:"Started At:",finishedAtLabel:"Finished At:",productHelper:"Product Replenishment Helper",taskHelper:"Task Helper",editDate:"Edit Date",selectDate:"Select Date and Time",taskTab:"Task",listingTab:"Listing"},system$1={overallStatus:"Overall Status:",authenticatedUser:"Authenticated User:",database:"Database:",version:"Version: ",supabaseApi:"Supabase API:",environment:"Environment:",lastChecked:"Last checked: ",systemLabel:"System",null:"null"},language$1={english:"English",spanish:"Espaol"},enTranslation={navigation:navigation$1,threads:threads$1,auth:auth$1,dashboard:dashboard$1,tasks:tasks$1,dataTable:dataTable$1,columns:columns$1,statuses:statuses$1,reservations:reservations$1,admin:admin$1,assignment:assignment$1,common:common$1,audit:audit$1,healthCheck:healthCheck$1,todos:todos$1,listings:listings$1,cleaner:cleaner$1,notes:notes$1,forms:forms$1,taskDetail:taskDetail$1,system:system$1,language:language$1},navigation={brand:"Sonsoles Stays",dashboard:"Panel de Control",healthCheck:"Verificacin de Estado",listings:"Propiedades",reservations:"Reservas",tasks:"Tareas",todos:"Tareas Pendientes",threads:"Conversaciones",myTasks:"Mis Tareas",adminBadge:"Administrador",cleanerBadge:"Limpiador",signOut:"Cerrar Sesin"},threads={title:"Conversaciones",searchPlaceholder:"Buscar conversaciones...",noThreadsFound:"No se encontraron conversaciones",yesterday:"Ayer",listingTitle:"Propiedad: {{id}}",reservationTitle:"Reserva: {{id}}",channelThread:"Conversacin {{channel}}",noParticipants:"Sin participantes",participantsWithMore:"{{participants}} +{{count}}",selectThread:"Selecciona una conversacin para ver mensajes",selectThreadDescription:"Elige una conversacin de la barra lateral para ver la conversacin",noMessages:"An no hay mensajes en esta conversacin",loading:"Cargando conversaciones...",error:"Error",retry:"Reintentar",errorLoadingThreads:"Error al cargar conversaciones",errorLoadingMessages:"Error al cargar mensajes",draftMessage:"Redactar Mensaje",draftingMessage:"Redactando mensaje...",draftedMessage:"Mensaje Redactado",closeDraft:"Cerrar borrador",errorDraftingMessage:"Error al redactar mensaje",noDraftMessage:"Sin Mensaje Borrador",selectThreadToDraft:"Crea respuestas potenciadas por IA para tu conversacin seleccionada",contextLabel:"Dale contexto arbitrario al Bot IA Maddie",messageLabel:"Mensaje",generateResponse:"Generar Respuesta"},auth={welcome:"Bienvenido a Sonsoles Stays",signInDescription:"Por favor, inicia sesin para acceder a tu sistema de gestin de estancias.",signingIn:"Iniciando sesin...",signInWithGoogle:"Iniciar sesin con Google",authenticating:" Autenticando...",pleaseWait:"Por favor, espera mientras completamos tu inicio de sesin.",authenticationError:" Error de Autenticacin",returnToLogin:"Volver al Inicio de Sesin",unexpectedError:"Ocurri un error inesperado durante la autenticacin.",noAccessToken:"No hay token de acceso disponible",authenticationFailed:"La autenticacin fall. Por favor, inicia sesin nuevamente."},dashboard={title:"Panel de Control",welcome:"Bienvenido a tu sistema de gestin de estancias",comingSoon:"Panel de Control Prximamente",comingSoonDescription:"Tu panel de control principal estar disponible aqu.",loginRequired:"Por favor, inicia sesin para ver tu panel de control.",loading:"Cargando...",errorLoading:"Error al Cargar el Panel de Control",taskSummary:"Resumen de Tareas",pendingAcceptance:"Pendiente de Aceptacin",accepted:"Aceptada",inProgress:"En Progreso",completed:"Completada",viewAllTasks:"Ver Todas las Tareas",nextPendingTask:"Prxima Tarea Por Aceptar",viewTask:"Ver Tarea",viewAllPending:"Ver Todas las Pendientes",nextAcceptedTask:"Prxima Tarea Aceptada",viewAllAccepted:"Ver Todas las Aceptadas",noTasks:"No Hay Tareas Disponibles",noTasksMessage:"No tienes tareas asignadas en este momento. Vuelve ms tarde para nuevas asignaciones.",refreshTasks:"Actualizar Tareas",when:"Cundo",ongoingTasks:"Tareas en Curso",startedAt:"Iniciada En",notStarted:"An no iniciada",continueTask:"Continuar Tarea",viewAllOngoing:"Ver Todas en Curso"},tasks={management:"Gestin de Tareas",myTasks:"Mis Tareas",totalTasks:"Total de Tareas: {{count}}",loading:"Cargando...",loginRequired:"Por favor, inicia sesin para ver tus tareas.",details:"Detalles de la Tarea",information:"Informacin de la Tarea",actions:"Acciones",acceptTask:"Aceptar Tarea",startTask:"Iniciar Tarea",completeTask:"Completar Tarea",acceptCompletion:"Aceptar Finalizacin",acceptedByAdmin:"Aceptado por Administrador",noFurtherEdits:"No se permiten ms ediciones",loadingDetails:"Cargando detalles de la tarea...",errorLoading:"Error al Cargar la Tarea",goBack:"Volver",notFound:"Tarea No Encontrada",notFoundDescription:"La tarea solicitada no pudo ser encontrada.",back:"Atrs",notSet:"No establecido",filterByStatus:"Filtrar por Estado"},dataTable={searchPlaceholder:"Buscar en todas las columnas...",showingEntries:"Mostrando {{start}} a {{end}} de {{total}} entradas",showingCount:"Mostrando {{count}} de {{total}} entradas",noData:"No Se Encontraron Datos",noResults:"No hay resultados que coincidan con tus criterios de bsqueda.",noDataAvailable:"No hay datos disponibles.",pageInfo:"Pgina {{current}} de {{total}}",showSize:"Mostrar {{size}}",loadingData:"Cargando datos...",failedToLoad:"Error al Cargar Datos"},columns={id:"ID",title:"Ttulo",task:"Tarea",type:"Tipo",status:"Estado",description:"Descripcin",listing:"Propiedad",reservation:"Reserva",scheduled:"Programado",assignedTo:"Asignado A",assignedAt:"Asignado En",acceptedAt:"Aceptado En",completedAt:"Completado En",created:"Creado",started:"Iniciado",finished:"Finalizado",na:"N/A",view:"Ver",accept:"Aceptar",start:"Iniciar",complete:"Completar",cancel:"Cancelar",edit:"Editar",save:"Guardar"},statuses={unassigned:"Sin Asignar",assigned:"Asignada",accepted:"Aceptada",in_progress:"En Progreso",completed:"Completada",admin_accepted:"Finalizada"},reservations={guest:"Husped",property:"Propiedad",checkIn:"Llegada",checkOut:"Salida",nights:"Noches",guests:"Huspedes",total:"Total",hostPayout:"Pago al Anfitrin"},admin={checkingAccess:"Verificando acceso de administrador...",authenticationRequired:"Autenticacin Requerida",signInToAccess:"Por favor, inicia sesin para acceder a esta pgina.",adminAccessRequired:"Acceso de Administrador Requerido",noAdminPrivileges:"No tienes privilegios de administrador para acceder a esta pgina."},assignment={unassigned:"Sin Asignar",loading:"Cargando...",unknown:"Desconocido"},common={loading:"Cargando..."},audit={history:"Historial de Auditora",entries:"entradas",loading:"Cargando historial de auditora...",noHistory:"No hay historial de auditora disponible para esta tarea.",by:"por",noDescription:"No hay descripcin disponible",fieldsChanged:"Campos modificados",valuesChanged:"Valores modificados",context:"Contexto",system:"Sistema",unknownUser:"Usuario Desconocido"},healthCheck={title:"Verificacin de Estado del Sistema",monitoring:"Monitoreando estado del sistema y conectividad",failed:"Verificacin de Estado Fall",loading:"Cargando estado de salud...",reloadPage:"Recargar Pgina",healthy:"Saludable",error:"Error",connected:"Conectado",configured:"Configurado"},todos={allTodos:"Todas las Tareas",totalTodos:"Total de Tareas: {{count}}",loadingTodos:"Cargando tareas...",filterByStatus:"Filtrar por Estado:",all:"Todas",pending:"Pendientes",done:"Completadas",createGeneral:"Crear Tarea General",createNew:"Crear Nueva Tarea",adminAccessRequired:"Se requiere acceso de administrador para ver todas las tareas.",attachedTo:"Adjuntado A",unattached:"Sin Adjuntar",delete:"Eliminar",deleteConfirm:"Ests seguro de que quieres eliminar esta tarea?",creating:"Creando...",addNote:"Agregar Nota",adding:"Agregando...",noListingAssignment:"Sin asignacin de propiedad",description:"Descripcin",failedToLoad:"Error al cargar propiedades",addTodo:"Agregar Tarea",noTodosFound:"No se encontraron tareas.",createdLabel:"Creado: ",completedLabel:"Completado: ",attachedToLabel:"Adjuntado a: ",productsNeeded:"Productos necesarios:",markAsDone:"Marcar como completado",title:"Ttulo *",titlePlaceholder:"ej., Arreglar el aire acondicionado, Comprar suministros de limpieza",assignToListing:"Asignar a Propiedad (Opcional)",loadingListings:"Cargando propiedades...",products:"Productos (Opcional)",searchProductsPlaceholder:"Buscar productos para agregar...",selectedProducts:"Productos Seleccionados:",remove:"Quitar",detailsPlaceholder:"Detalles adicionales o notas...",cancel:"Cancelar",filterCategories:"Filtrar Categoras",loadingProducts:"Cargando productos..."},listings={title:"Propiedades",details:"Detalles de la Propiedad",totalListings:"Total de propiedades: {{count}}",loadingListings:"Cargando propiedades...",loadingDetails:"Cargando detalles de la propiedad...",address:"Direccin",basicInformation:"Informacin Bsica",dates:"Fechas",amenities:"Amenidades",listingTodos:"Tareas de la Propiedad",listingChat:"Chat de la Propiedad",notFound:"Propiedad no encontrada",notFoundWithId:'La propiedad con ID "{{id}}" no fue encontrada.',failedToLoad:"Error al cargar propiedad",listingId:"ID de Propiedad",airbnbId:"ID de Airbnb",propertyType:"Tipo de Propiedad",roomType:"Tipo de Habitacin",bedrooms:"Habitaciones",bathrooms:"Baos",maxGuests:"Mximo de Huspedes",created:"Creado",updated:"Actualizado"},cleaner={accessRequired:"Acceso Requerido"},notes={title:"Notas",unknownUser:"Usuario Desconocido",send:"Enviar",sending:"...",deleteNote:"Eliminar nota",deleteConfirm:"Ests seguro de que quieres eliminar esta nota?",loadingNotes:"Cargando notas...",noNotesYet:"An no hay notas. Comienza la conversacin!",attachedToLabel:"Adjuntado a: ",typePlaceholder:"Escribe una nota... (Presiona Enter para enviar, Shift+Enter para nueva lnea)",noteLabel:"Nota:",notePlaceholder:"Ingresa tu nota...",errorOccurred:"Ocurri un error"},forms={noAddress:"Sin direccin"},taskDetail={collapseAudit:"Contraer historial de auditora",expandAudit:"Expandir historial de auditora",titleLabel:"Ttulo:",statusLabel:"Estado:",scheduledLabel:"Fecha Programada:",listingIdLabel:"ID de Propiedad:",assignedToLabel:"Asignado A:",startedAtLabel:"Iniciado En:",finishedAtLabel:"Finalizado En:",productHelper:"Asistente de Reposicin de Productos",taskHelper:"Reposicin de Productos",editDate:"Editar Fecha",selectDate:"Seleccionar Fecha y Hora",taskTab:"Tarea",listingTab:"Propiedad"},system={overallStatus:"Estado General:",authenticatedUser:"Usuario Autenticado:",database:"Base de Datos:",version:"Versin: ",supabaseApi:"API de Supabase:",environment:"Entorno:",lastChecked:"ltima verificacin: ",systemLabel:"Sistema",null:"nulo"},language={english:"English",spanish:"Espaol"},esTranslation={navigation,threads,auth,dashboard,tasks,dataTable,columns,statuses,reservations,admin,assignment,common,audit,healthCheck,todos,listings,cleaner,notes,forms,taskDetail,system,language},resources={en:{translation:enTranslation},es:{translation:esTranslation}};instance.use(Browser).use(initReactI18next).init({resources,fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator","htmlTag"],lookupLocalStorage:"preferred-language",caches:["localStorage"]},supportedLngs:["en","es"],ns:["translation"],defaultNS:"translation"});function App(){return jsxRuntimeExports.jsx("div",{className:"app",children:jsxRuntimeExports.jsx(LanguageProvider,{children:jsxRuntimeExports.jsx(AuthProvider,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/auth/callback",element:jsxRuntimeExports.jsx(AuthCallback,{})}),jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx(Dashboard,{})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/healthcheck",element:jsxRuntimeExports.jsx(AdminRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container",children:jsxRuntimeExports.jsx(HealthCheckDisplay,{})})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/admin",element:jsxRuntimeExports.jsx(AdminRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container",children:jsxRuntimeExports.jsx(AdminReservationForm,{})})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/admin/tasks",element:jsxRuntimeExports.jsx(AdminRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container",children:jsxRuntimeExports.jsx(AdminTaskView,{})})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/admin/todos",element:jsxRuntimeExports.jsx(AdminRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container",children:jsxRuntimeExports.jsx(AdminTodosView,{})})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/admin/threads",element:jsxRuntimeExports.jsx(AdminRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content threads-main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container threads-content-container",children:jsxRuntimeExports.jsx(ThreadsView,{})})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/admin/threads/:threadId",element:jsxRuntimeExports.jsx(AdminRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content threads-main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container threads-content-container",children:jsxRuntimeExports.jsx(ThreadsView,{})})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/listings",element:jsxRuntimeExports.jsx(AdminRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container",children:jsxRuntimeExports.jsx(ListingView,{})})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/cleaner/tasks",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container",children:jsxRuntimeExports.jsx(CleanerTaskView,{})})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/tasks/:id",element:jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container",children:jsxRuntimeExports.jsx(TaskDetailView,{})})})]})})}),jsxRuntimeExports.jsx(Route,{path:"/listing/:id",element:jsxRuntimeExports.jsx(AdminRoute,{children:jsxRuntimeExports.jsxs("div",{className:"app-content",children:[jsxRuntimeExports.jsx(Navigation,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsx("div",{className:"content-container",children:jsxRuntimeExports.jsx(ListingDetailView,{})})})]})})})]})})})})})}const rootElement=document.getElementById("root");if(!rootElement)throw new Error("Root element not found");client.createRoot(rootElement).render(jsxRuntimeExports.jsx(App,{}));
